var base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){var t,r,o,a,i,n,d,c="",s=0;for(e=base64._utf8_encode(e);s<e.length;)t=e.charCodeAt(s++),r=e.charCodeAt(s++),o=e.charCodeAt(s++),a=t>>2,i=(3&t)<<4|r>>4,n=(15&r)<<2|o>>6,d=63&o,isNaN(r)?n=d=64:isNaN(o)&&(d=64),c=c+this._keyStr.charAt(a)+this._keyStr.charAt(i)+this._keyStr.charAt(n)+this._keyStr.charAt(d);return c},decode:function(e){var t,r,o,a,i,n,d,c="",s=0;for(e=e.replace(/[^A-Za-z0-9+/=]/g,"");s<e.length;)a=this._keyStr.indexOf(e.charAt(s++)),i=this._keyStr.indexOf(e.charAt(s++)),n=this._keyStr.indexOf(e.charAt(s++)),d=this._keyStr.indexOf(e.charAt(s++)),t=a<<2|i>>4,r=(15&i)<<4|n>>2,o=(3&n)<<6|d,c+=String.fromCharCode(t),64!==n&&(c+=String.fromCharCode(r)),64!==d&&(c+=String.fromCharCode(o));return base64._utf8_decode(c)},_utf8_encode:function(e){e=e.replace(/rn/g,"n");var t,r;for(t="",r=0;r<e.length;r++){var o=e.charCodeAt(r);128>o?t+=String.fromCharCode(o):o>127&&2048>o?(t+=String.fromCharCode(o>>6|192),t+=String.fromCharCode(63&o|128)):(t+=String.fromCharCode(o>>12|224),t+=String.fromCharCode(o>>6&63|128),t+=String.fromCharCode(63&o|128))}return t},_utf8_decode:function(e){var t,r,o,a,i;for(o="",a=0,i=t=0;a<e.length;)i=e.charCodeAt(a),128>i?(o+=String.fromCharCode(i),a++):i>191&&224>i?(t=e.charCodeAt(a+1),o+=String.fromCharCode((31&i)<<6|63&t),a+=2):(t=e.charCodeAt(a+1),r=e.charCodeAt(a+2),o+=String.fromCharCode((15&i)<<12|(63&t)<<6|63&r),a+=3);return o}};var isMobile=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);var platform=isMobile?2:1;var resolution=window.screen.availWidth+"x"+window.screen.availHeight;var siteId=window.cmsConfig.siteId!==undefined?window.cmsConfig.siteId:0;function getPageType(){var e=document.body.getAttribute("id");if(!e)return getPageTypeByUrl(window.location.pathname);switch(e){case"page-homepage":return"home";case"page-category":return"category";case"page-article":return"article";case"page-tag":return"tag";case"page-search":return"search";case"page-author":return"author";case"page-topic":return"topic";default:return e.replace("page-","")}}function getPageTypeByUrl(e){var t=e.replace(/#.*|\?.*/gi,"").replace(window.cmsConfig.domainDesktop,"").replace(window.cmsConfig.domainMobile,"");if(t=="/"||t==""){return"home"}else if(/-post\d+\.html/i.test(t)){return"article"}else if(/-tag\d+\.html|\/tu-khoa(\/|\.html)|\/tag(\/|\.html)/i.test(t)){return"tag"}else if(/\/video\/|\/video-.*(\/|\.html)/i.test(t)){return"video"}else if(/\/tac-gia\/|\/author\//i.test(t)){return"author"}else if(/\/topic\/|\/chu-de\/|\/event\//i.test(t)){return"topic"}else if(/\/.*\//i.test(t)){return"category"}else{return"other"}}initAnalytics();function initAnalytics(e){if(typeof IS_REDIRECT!="undefined"&&IS_REDIRECT){return}var t=e?getLogUrl(e):getLogUrl();if(t.length>0){var r=new XMLHttpRequest;r.withCredentials=true;r.open("GET",t,true);r.send()}}function getLogUrl(e){var t=window.location.href;var r=document.referrer;if(r.length<=0)r="";if(!e){var o=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"");e=o+window.location.pathname}if(typeof base64!==undefined){var a=base64.encode('{"platform":'+platform+',"siteId": '+siteId+',"resolution":"'+resolution+'","url":"'+e+'","url_referrer":"'+r+'","url_full":"'+t+'"}');return window.cmsConfig.domainLog+"/log?data="+a+"&r="+Math.random()}return""}function logImps(e,t,r,o,a){if(typeof IS_REDIRECT!="undefined"&&IS_REDIRECT){return}var i=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"");var n=i+window.location.pathname;var d=window.location.href;var c=document.referrer;if(c.length<=0)c="";o=o?o:"imps";a=a?a:getPageType();var s=0;var f=t.match(/(.*)-(\d+)/);if(f){t=f[1];s=f[2]}if(typeof base64!==undefined){var h=base64.encode('{"platform":'+platform+',"siteId": '+siteId+',"contentId":'+e+',"page":"'+a+'","type":"'+o+'","source":"'+t+'","sourceId":'+s+',"index":'+r+"}");var l=new XMLHttpRequest;l.withCredentials=true;l.open("GET",window.cmsConfig.domainLog+"/imps?data="+h+"&r="+Math.random(),true);l.send()}}