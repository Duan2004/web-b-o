(function(e,t){"use strict";if(typeof module==="object"&&typeof module.exports==="object"){module.exports=e.document?t(e,true):function(e){if(!e.document){throw new Error("jQuery requires a window with a document")}return t(e)}}else{t(e)}})(typeof window!=="undefined"?window:this,function(w,F){"use strict";var e=[];var _=w.document;var N=Object.getPrototypeOf;var s=e.slice;var j=e.concat;var U=e.push;var i=e.indexOf;var n={};var B=n.toString;var p=n.hasOwnProperty;var H=p.toString;var $=H.call(Object);var g={};function G(e,t){t=t||_;var n=t.createElement("script");n.text=e;t.head.appendChild(n).parentNode.removeChild(n)}var V="3.1.1",S=function(e,t){return new S.fn.init(e,t)},Y=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,z=/^-ms-/,K=/-([a-z])/g,W=function(e,t){return t.toUpperCase()};S.fn=S.prototype={jquery:V,constructor:S,length:0,toArray:function(){return s.call(this)},get:function(e){if(e==null){return s.call(this)}return e<0?this[e+this.length]:this[e]},pushStack:function(e){var t=S.merge(this.constructor(),e);t.prevObject=this;return t},each:function(e){return S.each(this,e)},map:function(n){return this.pushStack(S.map(this,function(e,t){return n.call(e,t,e)}))},slice:function(){return this.pushStack(s.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(e<0?t:0);return this.pushStack(n>=0&&n<t?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:U,sort:e.sort,splice:e.splice};S.extend=S.fn.extend=function(){var e,t,n,r,i,o,a=arguments[0]||{},s=1,l=arguments.length,u=false;if(typeof a==="boolean"){u=a;a=arguments[s]||{};s++}if(typeof a!=="object"&&!S.isFunction(a)){a={}}if(s===l){a=this;s--}for(;s<l;s++){if((e=arguments[s])!=null){for(t in e){n=a[t];r=e[t];if(a===r){continue}if(u&&r&&(S.isPlainObject(r)||(i=S.isArray(r)))){if(i){i=false;o=n&&S.isArray(n)?n:[]}else{o=n&&S.isPlainObject(n)?n:{}}a[t]=S.extend(u,o,r)}else if(r!==undefined){a[t]=r}}}}return a};S.extend({expando:"jQuery"+(V+Math.random()).replace(/\D/g,""),isReady:true,error:function(e){throw new Error(e)},noop:function(){},isFunction:function(e){return S.type(e)==="function"},isArray:Array.isArray,isWindow:function(e){return e!=null&&e===e.window},isNumeric:function(e){var t=S.type(e);return(t==="number"||t==="string")&&!isNaN(e-parseFloat(e))},isPlainObject:function(e){var t,n;if(!e||B.call(e)!=="[object Object]"){return false}t=N(e);if(!t){return true}n=p.call(t,"constructor")&&t.constructor;return typeof n==="function"&&H.call(n)===$},isEmptyObject:function(e){var t;for(t in e){return false}return true},type:function(e){if(e==null){return e+""}return typeof e==="object"||typeof e==="function"?n[B.call(e)]||"object":typeof e},globalEval:function(e){G(e)},camelCase:function(e){return e.replace(z,"ms-").replace(K,W)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t){var n,r=0;if(q(e)){n=e.length;for(;r<n;r++){if(t.call(e[r],r,e[r])===false){break}}}else{for(r in e){if(t.call(e[r],r,e[r])===false){break}}}return e},trim:function(e){return e==null?"":(e+"").replace(Y,"")},makeArray:function(e,t){var n=t||[];if(e!=null){if(q(Object(e))){S.merge(n,typeof e==="string"?[e]:e)}else{U.call(n,e)}}return n},inArray:function(e,t,n){return t==null?-1:i.call(t,e,n)},merge:function(e,t){var n=+t.length,r=0,i=e.length;for(;r<n;r++){e[i++]=t[r]}e.length=i;return e},grep:function(e,t,n){var r,i=[],o=0,a=e.length,s=!n;for(;o<a;o++){r=!t(e[o],o);if(r!==s){i.push(e[o])}}return i},map:function(e,t,n){var r,i,o=0,a=[];if(q(e)){r=e.length;for(;o<r;o++){i=t(e[o],o,n);if(i!=null){a.push(i)}}}else{for(o in e){i=t(e[o],o,n);if(i!=null){a.push(i)}}}return j.apply([],a)},guid:1,proxy:function(e,t){var n,r,i;if(typeof t==="string"){n=e[t];t=e;e=n}if(!S.isFunction(e)){return undefined}r=s.call(arguments,2);i=function(){return e.apply(t||this,r.concat(s.call(arguments)))};i.guid=e.guid=e.guid||S.guid++;return i},now:Date.now,support:g});if(typeof Symbol==="function"){S.fn[Symbol.iterator]=e[Symbol.iterator]}S.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){n["[object "+t+"]"]=t.toLowerCase()});function q(e){var t=!!e&&"length"in e&&e.length,n=S.type(e);if(n==="function"||S.isWindow(e)){return false}return n==="array"||t===0||typeof t==="number"&&t>0&&t-1 in e}var t=function(F){var e,h,E,o,N,p,j,U,T,l,u,k,w,i,_,g,a,s,v,S="sizzle"+1*new Date,y=F.document,A=0,B=0,H=fe(),$=fe(),m=fe(),G=function(e,t){if(e===t){u=true}return 0},V={}.hasOwnProperty,t=[],Y=t.pop,z=t.push,P=t.push,K=t.slice,b=function(e,t){var n=0,r=e.length;for(;n<r;n++){if(e[n]===t){return n}}return-1},W="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",c="[\\x20\\t\\r\\n\\f]",n="(?:\\\\.|[\\w-]|[^\0-\\xa0])+",q="\\["+c+"*("+n+")(?:"+c+"*([*^$|!~]?=)"+c+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+n+"))|)"+c+"*\\]",X=":("+n+")(?:\\(("+"('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|"+"((?:\\\\.|[^\\\\()[\\]]|"+q+")*)|"+".*"+")\\)|)",Q=new RegExp(c+"+","g"),O=new RegExp("^"+c+"+|((?:^|[^\\\\])(?:\\\\.)*)"+c+"+$","g"),J=new RegExp("^"+c+"*,"+c+"*"),Z=new RegExp("^"+c+"*([>+~]|"+c+")"+c+"*"),ee=new RegExp("="+c+"*([^\\]'\"]*?)"+c+"*\\]","g"),te=new RegExp(X),ne=new RegExp("^"+n+"$"),f={ID:new RegExp("^#("+n+")"),CLASS:new RegExp("^\\.("+n+")"),TAG:new RegExp("^("+n+"|[*])"),ATTR:new RegExp("^"+q),PSEUDO:new RegExp("^"+X),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+c+"*(even|odd|(([+-]|)(\\d*)n|)"+c+"*(?:([+-]|)"+c+"*(\\d+)|))"+c+"*\\)|)","i"),bool:new RegExp("^(?:"+W+")$","i"),needsContext:new RegExp("^"+c+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+c+"*((?:-\\d)?\\d*)"+c+"*\\)|)(?=[^-]|$)","i")},re=/^(?:input|select|textarea|button)$/i,ie=/^h\d$/i,d=/^[^{]+\{\s*\[native \w/,oe=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ae=/[+~]/,C=new RegExp("\\\\([\\da-f]{1,6}"+c+"?|("+c+")|.)","ig"),L=function(e,t,n){var r="0x"+t-65536;return r!==r||n?t:r<0?String.fromCharCode(r+65536):String.fromCharCode(r>>10|55296,r&1023|56320)},se=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,le=function(e,t){if(t){if(e==="\0"){return"ï¿½"}return e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" "}return"\\"+e},ue=function(){k()},ce=M(function(e){return e.disabled===true&&("form"in e||"label"in e)},{dir:"parentNode",next:"legend"});try{P.apply(t=K.call(y.childNodes),y.childNodes);t[y.childNodes.length].nodeType}catch(e){P={apply:t.length?function(e,t){z.apply(e,K.call(t))}:function(e,t){var n=e.length,r=0;while(e[n++]=t[r++]){}e.length=n-1}}}function D(e,t,n,r){var i,o,a,s,l,u,c,f=t&&t.ownerDocument,d=t?t.nodeType:9;n=n||[];if(typeof e!=="string"||!e||d!==1&&d!==9&&d!==11){return n}if(!r){if((t?t.ownerDocument||t:y)!==w){k(t)}t=t||w;if(_){if(d!==11&&(l=oe.exec(e))){if(i=l[1]){if(d===9){if(a=t.getElementById(i)){if(a.id===i){n.push(a);return n}}else{return n}}else{if(f&&(a=f.getElementById(i))&&v(t,a)&&a.id===i){n.push(a);return n}}}else if(l[2]){P.apply(n,t.getElementsByTagName(e));return n}else if((i=l[3])&&h.getElementsByClassName&&t.getElementsByClassName){P.apply(n,t.getElementsByClassName(i));return n}}if(h.qsa&&!m[e+" "]&&(!g||!g.test(e))){if(d!==1){f=t;c=e}else if(t.nodeName.toLowerCase()!=="object"){if(s=t.getAttribute("id")){s=s.replace(se,le)}else{t.setAttribute("id",s=S)}u=p(e);o=u.length;while(o--){u[o]="#"+s+" "+I(u[o])}c=u.join(",");f=ae.test(e)&&ye(t.parentNode)||t}if(c){try{P.apply(n,f.querySelectorAll(c));return n}catch(e){}finally{if(s===S){t.removeAttribute("id")}}}}}}return U(e.replace(O,"$1"),t,n,r)}function fe(){var n=[];function r(e,t){if(n.push(e+" ")>E.cacheLength){delete r[n.shift()]}return r[e+" "]=t}return r}function x(e){e[S]=true;return e}function R(e){var t=w.createElement("fieldset");try{return!!e(t)}catch(e){return false}finally{if(t.parentNode){t.parentNode.removeChild(t)}t=null}}function de(e,t){var n=e.split("|"),r=n.length;while(r--){E.attrHandle[n[r]]=t}}function he(e,t){var n=t&&e,r=n&&e.nodeType===1&&t.nodeType===1&&e.sourceIndex-t.sourceIndex;if(r){return r}if(n){while(n=n.nextSibling){if(n===t){return-1}}}return e?1:-1}function pe(n){return function(e){var t=e.nodeName.toLowerCase();return t==="input"&&e.type===n}}function ge(n){return function(e){var t=e.nodeName.toLowerCase();return(t==="input"||t==="button")&&e.type===n}}function ve(t){return function(e){if("form"in e){if(e.parentNode&&e.disabled===false){if("label"in e){if("label"in e.parentNode){return e.parentNode.disabled===t}else{return e.disabled===t}}return e.isDisabled===t||e.isDisabled!==!t&&ce(e)===t}return e.disabled===t}else if("label"in e){return e.disabled===t}return false}}function r(a){return x(function(o){o=+o;return x(function(e,t){var n,r=a([],e.length,o),i=r.length;while(i--){if(e[n=r[i]]){e[n]=!(t[n]=e[n])}}})})}function ye(e){return e&&typeof e.getElementsByTagName!=="undefined"&&e}h=D.support={};N=D.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?t.nodeName!=="HTML":false};k=D.setDocument=function(e){var t,n,r=e?e.ownerDocument||e:y;if(r===w||r.nodeType!==9||!r.documentElement){return w}w=r;i=w.documentElement;_=!N(w);if(y!==w&&(n=w.defaultView)&&n.top!==n){if(n.addEventListener){n.addEventListener("unload",ue,false)}else if(n.attachEvent){n.attachEvent("onunload",ue)}}h.attributes=R(function(e){e.className="i";return!e.getAttribute("className")});h.getElementsByTagName=R(function(e){e.appendChild(w.createComment(""));return!e.getElementsByTagName("*").length});h.getElementsByClassName=d.test(w.getElementsByClassName);h.getById=R(function(e){i.appendChild(e).id=S;return!w.getElementsByName||!w.getElementsByName(S).length});if(h.getById){E.filter["ID"]=function(e){var t=e.replace(C,L);return function(e){return e.getAttribute("id")===t}};E.find["ID"]=function(e,t){if(typeof t.getElementById!=="undefined"&&_){var n=t.getElementById(e);return n?[n]:[]}}}else{E.filter["ID"]=function(e){var n=e.replace(C,L);return function(e){var t=typeof e.getAttributeNode!=="undefined"&&e.getAttributeNode("id");return t&&t.value===n}};E.find["ID"]=function(e,t){if(typeof t.getElementById!=="undefined"&&_){var n,r,i,o=t.getElementById(e);if(o){n=o.getAttributeNode("id");if(n&&n.value===e){return[o]}i=t.getElementsByName(e);r=0;while(o=i[r++]){n=o.getAttributeNode("id");if(n&&n.value===e){return[o]}}}return[]}}}E.find["TAG"]=h.getElementsByTagName?function(e,t){if(typeof t.getElementsByTagName!=="undefined"){return t.getElementsByTagName(e)}else if(h.qsa){return t.querySelectorAll(e)}}:function(e,t){var n,r=[],i=0,o=t.getElementsByTagName(e);if(e==="*"){while(n=o[i++]){if(n.nodeType===1){r.push(n)}}return r}return o};E.find["CLASS"]=h.getElementsByClassName&&function(e,t){if(typeof t.getElementsByClassName!=="undefined"&&_){return t.getElementsByClassName(e)}};a=[];g=[];if(h.qsa=d.test(w.querySelectorAll)){R(function(e){i.appendChild(e).innerHTML="<a id='"+S+"'></a>"+"<select id='"+S+"-\r\\' msallowcapture=''>"+"<option selected=''></option></select>";if(e.querySelectorAll("[msallowcapture^='']").length){g.push("[*^$]="+c+"*(?:''|\"\")")}if(!e.querySelectorAll("[selected]").length){g.push("\\["+c+"*(?:value|"+W+")")}if(!e.querySelectorAll("[id~="+S+"-]").length){g.push("~=")}if(!e.querySelectorAll(":checked").length){g.push(":checked")}if(!e.querySelectorAll("a#"+S+"+*").length){g.push(".#.+[+~]")}});R(function(e){e.innerHTML="<a href='' disabled='disabled'></a>"+"<select disabled='disabled'><option/></select>";var t=w.createElement("input");t.setAttribute("type","hidden");e.appendChild(t).setAttribute("name","D");if(e.querySelectorAll("[name=d]").length){g.push("name"+c+"*[*^$|!~]?=")}if(e.querySelectorAll(":enabled").length!==2){g.push(":enabled",":disabled")}i.appendChild(e).disabled=true;if(e.querySelectorAll(":disabled").length!==2){g.push(":enabled",":disabled")}e.querySelectorAll("*,:x");g.push(",.*:")})}if(h.matchesSelector=d.test(s=i.matches||i.webkitMatchesSelector||i.mozMatchesSelector||i.oMatchesSelector||i.msMatchesSelector)){R(function(e){h.disconnectedMatch=s.call(e,"*");s.call(e,"[s!='']:x");a.push("!=",X)})}g=g.length&&new RegExp(g.join("|"));a=a.length&&new RegExp(a.join("|"));t=d.test(i.compareDocumentPosition);v=t||d.test(i.contains)?function(e,t){var n=e.nodeType===9?e.documentElement:e,r=t&&t.parentNode;return e===r||!!(r&&r.nodeType===1&&(n.contains?n.contains(r):e.compareDocumentPosition&&e.compareDocumentPosition(r)&16))}:function(e,t){if(t){while(t=t.parentNode){if(t===e){return true}}}return false};G=t?function(e,t){if(e===t){u=true;return 0}var n=!e.compareDocumentPosition-!t.compareDocumentPosition;if(n){return n}n=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1;if(n&1||!h.sortDetached&&t.compareDocumentPosition(e)===n){if(e===w||e.ownerDocument===y&&v(y,e)){return-1}if(t===w||t.ownerDocument===y&&v(y,t)){return 1}return l?b(l,e)-b(l,t):0}return n&4?-1:1}:function(e,t){if(e===t){u=true;return 0}var n,r=0,i=e.parentNode,o=t.parentNode,a=[e],s=[t];if(!i||!o){return e===w?-1:t===w?1:i?-1:o?1:l?b(l,e)-b(l,t):0}else if(i===o){return he(e,t)}n=e;while(n=n.parentNode){a.unshift(n)}n=t;while(n=n.parentNode){s.unshift(n)}while(a[r]===s[r]){r++}return r?he(a[r],s[r]):a[r]===y?-1:s[r]===y?1:0};return w};D.matches=function(e,t){return D(e,null,null,t)};D.matchesSelector=function(e,t){if((e.ownerDocument||e)!==w){k(e)}t=t.replace(ee,"='$1']");if(h.matchesSelector&&_&&!m[t+" "]&&(!a||!a.test(t))&&(!g||!g.test(t))){try{var n=s.call(e,t);if(n||h.disconnectedMatch||e.document&&e.document.nodeType!==11){return n}}catch(e){}}return D(t,w,null,[e]).length>0};D.contains=function(e,t){if((e.ownerDocument||e)!==w){k(e)}return v(e,t)};D.attr=function(e,t){if((e.ownerDocument||e)!==w){k(e)}var n=E.attrHandle[t.toLowerCase()],r=n&&V.call(E.attrHandle,t.toLowerCase())?n(e,t,!_):undefined;return r!==undefined?r:h.attributes||!_?e.getAttribute(t):(r=e.getAttributeNode(t))&&r.specified?r.value:null};D.escape=function(e){return(e+"").replace(se,le)};D.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)};D.uniqueSort=function(e){var t,n=[],r=0,i=0;u=!h.detectDuplicates;l=!h.sortStable&&e.slice(0);e.sort(G);if(u){while(t=e[i++]){if(t===e[i]){r=n.push(i)}}while(r--){e.splice(n[r],1)}}l=null;return e};o=D.getText=function(e){var t,n="",r=0,i=e.nodeType;if(!i){while(t=e[r++]){n+=o(t)}}else if(i===1||i===9||i===11){if(typeof e.textContent==="string"){return e.textContent}else{for(e=e.firstChild;e;e=e.nextSibling){n+=o(e)}}}else if(i===3||i===4){return e.nodeValue}return n};E=D.selectors={cacheLength:50,createPseudo:x,match:f,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:true}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:true},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){e[1]=e[1].replace(C,L);e[3]=(e[3]||e[4]||e[5]||"").replace(C,L);if(e[2]==="~="){e[3]=" "+e[3]+" "}return e.slice(0,4)},CHILD:function(e){e[1]=e[1].toLowerCase();if(e[1].slice(0,3)==="nth"){if(!e[3]){D.error(e[0])}e[4]=+(e[4]?e[5]+(e[6]||1):2*(e[3]==="even"||e[3]==="odd"));e[5]=+(e[7]+e[8]||e[3]==="odd")}else if(e[3]){D.error(e[0])}return e},PSEUDO:function(e){var t,n=!e[6]&&e[2];if(f["CHILD"].test(e[0])){return null}if(e[3]){e[2]=e[4]||e[5]||""}else if(n&&te.test(n)&&(t=p(n,true))&&(t=n.indexOf(")",n.length-t)-n.length)){e[0]=e[0].slice(0,t);e[2]=n.slice(0,t)}return e.slice(0,3)}},filter:{TAG:function(e){var t=e.replace(C,L).toLowerCase();return e==="*"?function(){return true}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=H[e+" "];return t||(t=new RegExp("(^|"+c+")"+e+"("+c+"|$)"))&&H(e,function(e){return t.test(typeof e.className==="string"&&e.className||typeof e.getAttribute!=="undefined"&&e.getAttribute("class")||"")})},ATTR:function(n,r,i){return function(e){var t=D.attr(e,n);if(t==null){return r==="!="}if(!r){return true}t+="";return r==="="?t===i:r==="!="?t!==i:r==="^="?i&&t.indexOf(i)===0:r==="*="?i&&t.indexOf(i)>-1:r==="$="?i&&t.slice(-i.length)===i:r==="~="?(" "+t.replace(Q," ")+" ").indexOf(i)>-1:r==="|="?t===i||t.slice(0,i.length+1)===i+"-":false}},CHILD:function(p,e,t,g,v){var y=p.slice(0,3)!=="nth",m=p.slice(-4)!=="last",b=e==="of-type";return g===1&&v===0?function(e){return!!e.parentNode}:function(e,t,n){var r,i,o,a,s,l,u=y!==m?"nextSibling":"previousSibling",c=e.parentNode,f=b&&e.nodeName.toLowerCase(),d=!n&&!b,h=false;if(c){if(y){while(u){a=e;while(a=a[u]){if(b?a.nodeName.toLowerCase()===f:a.nodeType===1){return false}}l=u=p==="only"&&!l&&"nextSibling"}return true}l=[m?c.firstChild:c.lastChild];if(m&&d){a=c;o=a[S]||(a[S]={});i=o[a.uniqueID]||(o[a.uniqueID]={});r=i[p]||[];s=r[0]===A&&r[1];h=s&&r[2];a=s&&c.childNodes[s];while(a=++s&&a&&a[u]||(h=s=0)||l.pop()){if(a.nodeType===1&&++h&&a===e){i[p]=[A,s,h];break}}}else{if(d){a=e;o=a[S]||(a[S]={});i=o[a.uniqueID]||(o[a.uniqueID]={});r=i[p]||[];s=r[0]===A&&r[1];h=s}if(h===false){while(a=++s&&a&&a[u]||(h=s=0)||l.pop()){if((b?a.nodeName.toLowerCase()===f:a.nodeType===1)&&++h){if(d){o=a[S]||(a[S]={});i=o[a.uniqueID]||(o[a.uniqueID]={});i[p]=[A,h]}if(a===e){break}}}}}h-=v;return h===g||h%g===0&&h/g>=0}}},PSEUDO:function(e,o){var t,a=E.pseudos[e]||E.setFilters[e.toLowerCase()]||D.error("unsupported pseudo: "+e);if(a[S]){return a(o)}if(a.length>1){t=[e,e,"",o];return E.setFilters.hasOwnProperty(e.toLowerCase())?x(function(e,t){var n,r=a(e,o),i=r.length;while(i--){n=b(e,r[i]);e[n]=!(t[n]=r[i])}}):function(e){return a(e,0,t)}}return a}},pseudos:{not:x(function(e){var r=[],i=[],s=j(e.replace(O,"$1"));return s[S]?x(function(e,t,n,r){var i,o=s(e,null,r,[]),a=e.length;while(a--){if(i=o[a]){e[a]=!(t[a]=i)}}}):function(e,t,n){r[0]=e;s(r,null,n,i);r[0]=null;return!i.pop()}}),has:x(function(t){return function(e){return D(t,e).length>0}}),contains:x(function(t){t=t.replace(C,L);return function(e){return(e.textContent||e.innerText||o(e)).indexOf(t)>-1}}),lang:x(function(n){if(!ne.test(n||"")){D.error("unsupported lang: "+n)}n=n.replace(C,L).toLowerCase();return function(e){var t;do{if(t=_?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang")){t=t.toLowerCase();return t===n||t.indexOf(n+"-")===0}}while((e=e.parentNode)&&e.nodeType===1);return false}}),target:function(e){var t=F.location&&F.location.hash;return t&&t.slice(1)===e.id},root:function(e){return e===i},focus:function(e){return e===w.activeElement&&(!w.hasFocus||w.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:ve(false),disabled:ve(true),checked:function(e){var t=e.nodeName.toLowerCase();return t==="input"&&!!e.checked||t==="option"&&!!e.selected},selected:function(e){if(e.parentNode){e.parentNode.selectedIndex}return e.selected===true},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling){if(e.nodeType<6){return false}}return true},parent:function(e){return!E.pseudos["empty"](e)},header:function(e){return ie.test(e.nodeName)},input:function(e){return re.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return t==="input"&&e.type==="button"||t==="button"},text:function(e){var t;return e.nodeName.toLowerCase()==="input"&&e.type==="text"&&((t=e.getAttribute("type"))==null||t.toLowerCase()==="text")},first:r(function(){return[0]}),last:r(function(e,t){return[t-1]}),eq:r(function(e,t,n){return[n<0?n+t:n]}),even:r(function(e,t){var n=0;for(;n<t;n+=2){e.push(n)}return e}),odd:r(function(e,t){var n=1;for(;n<t;n+=2){e.push(n)}return e}),lt:r(function(e,t,n){var r=n<0?n+t:n;for(;--r>=0;){e.push(r)}return e}),gt:r(function(e,t,n){var r=n<0?n+t:n;for(;++r<t;){e.push(r)}return e})}};E.pseudos["nth"]=E.pseudos["eq"];for(e in{radio:true,checkbox:true,file:true,password:true,image:true}){E.pseudos[e]=pe(e)}for(e in{submit:true,reset:true}){E.pseudos[e]=ge(e)}function me(){}me.prototype=E.filters=E.pseudos;E.setFilters=new me;p=D.tokenize=function(e,t){var n,r,i,o,a,s,l,u=$[e+" "];if(u){return t?0:u.slice(0)}a=e;s=[];l=E.preFilter;while(a){if(!n||(r=J.exec(a))){if(r){a=a.slice(r[0].length)||a}s.push(i=[])}n=false;if(r=Z.exec(a)){n=r.shift();i.push({value:n,type:r[0].replace(O," ")});a=a.slice(n.length)}for(o in E.filter){if((r=f[o].exec(a))&&(!l[o]||(r=l[o](r)))){n=r.shift();i.push({value:n,type:o,matches:r});a=a.slice(n.length)}}if(!n){break}}return t?a.length:a?D.error(e):$(e,s).slice(0)};function I(e){var t=0,n=e.length,r="";for(;t<n;t++){r+=e[t].value}return r}function M(s,e,t){var l=e.dir,u=e.next,c=u||l,f=t&&c==="parentNode",d=B++;return e.first?function(e,t,n){while(e=e[l]){if(e.nodeType===1||f){return s(e,t,n)}}return false}:function(e,t,n){var r,i,o,a=[A,d];if(n){while(e=e[l]){if(e.nodeType===1||f){if(s(e,t,n)){return true}}}}else{while(e=e[l]){if(e.nodeType===1||f){o=e[S]||(e[S]={});i=o[e.uniqueID]||(o[e.uniqueID]={});if(u&&u===e.nodeName.toLowerCase()){e=e[l]||e}else if((r=i[c])&&r[0]===A&&r[1]===d){return a[2]=r[2]}else{i[c]=a;if(a[2]=s(e,t,n)){return true}}}}}return false}}function be(i){return i.length>1?function(e,t,n){var r=i.length;while(r--){if(!i[r](e,t,n)){return false}}return true}:i[0]}function Ee(e,t,n){var r=0,i=t.length;for(;r<i;r++){D(e,t[r],n)}return n}function Te(e,t,n,r,i){var o,a=[],s=0,l=e.length,u=t!=null;for(;s<l;s++){if(o=e[s]){if(!n||n(o,r,i)){a.push(o);if(u){t.push(s)}}}}return a}function ke(h,p,g,v,y,e){if(v&&!v[S]){v=ke(v)}if(y&&!y[S]){y=ke(y,e)}return x(function(e,t,n,r){var i,o,a,s=[],l=[],u=t.length,c=e||Ee(p||"*",n.nodeType?[n]:n,[]),f=h&&(e||!p)?Te(c,s,h,n,r):c,d=g?y||(e?h:u||v)?[]:t:f;if(g){g(f,d,n,r)}if(v){i=Te(d,l);v(i,[],n,r);o=i.length;while(o--){if(a=i[o]){d[l[o]]=!(f[l[o]]=a)}}}if(e){if(y||h){if(y){i=[];o=d.length;while(o--){if(a=d[o]){i.push(f[o]=a)}}y(null,d=[],i,r)}o=d.length;while(o--){if((a=d[o])&&(i=y?b(e,a):s[o])>-1){e[i]=!(t[i]=a)}}}}else{d=Te(d===t?d.splice(u,d.length):d);if(y){y(null,t,d,r)}else{P.apply(t,d)}}})}function we(e){var i,t,n,r=e.length,o=E.relative[e[0].type],a=o||E.relative[" "],s=o?1:0,l=M(function(e){return e===i},a,true),u=M(function(e){return b(i,e)>-1},a,true),c=[function(e,t,n){var r=!o&&(n||t!==T)||((i=t).nodeType?l(e,t,n):u(e,t,n));i=null;return r}];for(;s<r;s++){if(t=E.relative[e[s].type]){c=[M(be(c),t)]}else{t=E.filter[e[s].type].apply(null,e[s].matches);if(t[S]){n=++s;for(;n<r;n++){if(E.relative[e[n].type]){break}}return ke(s>1&&be(c),s>1&&I(e.slice(0,s-1).concat({value:e[s-2].type===" "?"*":""})).replace(O,"$1"),t,s<n&&we(e.slice(s,n)),n<r&&we(e=e.slice(n)),n<r&&I(e))}c.push(t)}}return be(c)}function _e(v,y){var m=y.length>0,b=v.length>0,e=function(e,t,n,r,i){var o,a,s,l=0,u="0",c=e&&[],f=[],d=T,h=e||b&&E.find["TAG"]("*",i),p=A+=d==null?1:Math.random()||.1,g=h.length;if(i){T=t===w||t||i}for(;u!==g&&(o=h[u])!=null;u++){if(b&&o){a=0;if(!t&&o.ownerDocument!==w){k(o);n=!_}while(s=v[a++]){if(s(o,t||w,n)){r.push(o);break}}if(i){A=p}}if(m){if(o=!s&&o){l--}if(e){c.push(o)}}}l+=u;if(m&&u!==l){a=0;while(s=y[a++]){s(c,f,t,n)}if(e){if(l>0){while(u--){if(!(c[u]||f[u])){f[u]=Y.call(r)}}}f=Te(f)}P.apply(r,f);if(i&&!e&&f.length>0&&l+y.length>1){D.uniqueSort(r)}}if(i){A=p;T=d}return c};return m?x(e):e}j=D.compile=function(e,t){var n,r=[],i=[],o=m[e+" "];if(!o){if(!t){t=p(e)}n=t.length;while(n--){o=we(t[n]);if(o[S]){r.push(o)}else{i.push(o)}}o=m(e,_e(i,r));o.selector=e}return o};U=D.select=function(e,t,n,r){var i,o,a,s,l,u=typeof e==="function"&&e,c=!r&&p(e=u.selector||e);n=n||[];if(c.length===1){o=c[0]=c[0].slice(0);if(o.length>2&&(a=o[0]).type==="ID"&&t.nodeType===9&&_&&E.relative[o[1].type]){t=(E.find["ID"](a.matches[0].replace(C,L),t)||[])[0];if(!t){return n}else if(u){t=t.parentNode}e=e.slice(o.shift().value.length)}i=f["needsContext"].test(e)?0:o.length;while(i--){a=o[i];if(E.relative[s=a.type]){break}if(l=E.find[s]){if(r=l(a.matches[0].replace(C,L),ae.test(o[0].type)&&ye(t.parentNode)||t)){o.splice(i,1);e=r.length&&I(o);if(!e){P.apply(n,r);return n}break}}}}(u||j(e,c))(r,t,!_,n,!t||ae.test(e)&&ye(t.parentNode)||t);return n};h.sortStable=S.split("").sort(G).join("")===S;h.detectDuplicates=!!u;k();h.sortDetached=R(function(e){return e.compareDocumentPosition(w.createElement("fieldset"))&1});if(!R(function(e){e.innerHTML="<a href='#'></a>";return e.firstChild.getAttribute("href")==="#"})){de("type|href|height|width",function(e,t,n){if(!n){return e.getAttribute(t,t.toLowerCase()==="type"?1:2)}})}if(!h.attributes||!R(function(e){e.innerHTML="<input/>";e.firstChild.setAttribute("value","");return e.firstChild.getAttribute("value")===""})){de("value",function(e,t,n){if(!n&&e.nodeName.toLowerCase()==="input"){return e.defaultValue}})}if(!R(function(e){return e.getAttribute("disabled")==null})){de(W,function(e,t,n){var r;if(!n){return e[t]===true?t.toLowerCase():(r=e.getAttributeNode(t))&&r.specified?r.value:null}})}return D}(w);S.find=t;S.expr=t.selectors;S.expr[":"]=S.expr.pseudos;S.uniqueSort=S.unique=t.uniqueSort;S.text=t.getText;S.isXMLDoc=t.isXML;S.contains=t.contains;S.escapeSelector=t.escape;var r=function(e,t,n){var r=[],i=n!==undefined;while((e=e[t])&&e.nodeType!==9){if(e.nodeType===1){if(i&&S(e).is(n)){break}r.push(e)}}return r};var X=function(e,t){var n=[];for(;e;e=e.nextSibling){if(e.nodeType===1&&e!==t){n.push(e)}}return n};var Q=S.expr.match.needsContext;var J=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;var Z=/^.[^:#\[\.,]*$/;function ee(e,n,r){if(S.isFunction(n)){return S.grep(e,function(e,t){return!!n.call(e,t,e)!==r})}if(n.nodeType){return S.grep(e,function(e){return e===n!==r})}if(typeof n!=="string"){return S.grep(e,function(e){return i.call(n,e)>-1!==r})}if(Z.test(n)){return S.filter(n,e,r)}n=S.filter(n,e);return S.grep(e,function(e){return i.call(n,e)>-1!==r&&e.nodeType===1})}S.filter=function(e,t,n){var r=t[0];if(n){e=":not("+e+")"}if(t.length===1&&r.nodeType===1){return S.find.matchesSelector(r,e)?[r]:[]}return S.find.matches(e,S.grep(t,function(e){return e.nodeType===1}))};S.fn.extend({find:function(e){var t,n,r=this.length,i=this;if(typeof e!=="string"){return this.pushStack(S(e).filter(function(){for(t=0;t<r;t++){if(S.contains(i[t],this)){return true}}}))}n=this.pushStack([]);for(t=0;t<r;t++){S.find(e,i[t],n)}return r>1?S.uniqueSort(n):n},filter:function(e){return this.pushStack(ee(this,e||[],false))},not:function(e){return this.pushStack(ee(this,e||[],true))},is:function(e){return!!ee(this,typeof e==="string"&&Q.test(e)?S(e):e||[],false).length}});var te,ne=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/,re=S.fn.init=function(e,t,n){var r,i;if(!e){return this}n=n||te;if(typeof e==="string"){if(e[0]==="<"&&e[e.length-1]===">"&&e.length>=3){r=[null,e,null]}else{r=ne.exec(e)}if(r&&(r[1]||!t)){if(r[1]){t=t instanceof S?t[0]:t;S.merge(this,S.parseHTML(r[1],t&&t.nodeType?t.ownerDocument||t:_,true));if(J.test(r[1])&&S.isPlainObject(t)){for(r in t){if(S.isFunction(this[r])){this[r](t[r])}else{this.attr(r,t[r])}}}return this}else{i=_.getElementById(r[2]);if(i){this[0]=i;this.length=1}return this}}else if(!t||t.jquery){return(t||n).find(e)}else{return this.constructor(t).find(e)}}else if(e.nodeType){this[0]=e;this.length=1;return this}else if(S.isFunction(e)){return n.ready!==undefined?n.ready(e):e(S)}return S.makeArray(e,this)};re.prototype=S.fn;te=S(_);var ie=/^(?:parents|prev(?:Until|All))/,oe={children:true,contents:true,next:true,prev:true};S.fn.extend({has:function(e){var t=S(e,this),n=t.length;return this.filter(function(){var e=0;for(;e<n;e++){if(S.contains(this,t[e])){return true}}})},closest:function(e,t){var n,r=0,i=this.length,o=[],a=typeof e!=="string"&&S(e);if(!Q.test(e)){for(;r<i;r++){for(n=this[r];n&&n!==t;n=n.parentNode){if(n.nodeType<11&&(a?a.index(n)>-1:n.nodeType===1&&S.find.matchesSelector(n,e))){o.push(n);break}}}}return this.pushStack(o.length>1?S.uniqueSort(o):o)},index:function(e){if(!e){return this[0]&&this[0].parentNode?this.first().prevAll().length:-1}if(typeof e==="string"){return i.call(S(e),this[0])}return i.call(this,e.jquery?e[0]:e)},add:function(e,t){return this.pushStack(S.uniqueSort(S.merge(this.get(),S(e,t))))},addBack:function(e){return this.add(e==null?this.prevObject:this.prevObject.filter(e))}});function ae(e,t){while((e=e[t])&&e.nodeType!==1){}return e}S.each({parent:function(e){var t=e.parentNode;return t&&t.nodeType!==11?t:null},parents:function(e){return r(e,"parentNode")},parentsUntil:function(e,t,n){return r(e,"parentNode",n)},next:function(e){return ae(e,"nextSibling")},prev:function(e){return ae(e,"previousSibling")},nextAll:function(e){return r(e,"nextSibling")},prevAll:function(e){return r(e,"previousSibling")},nextUntil:function(e,t,n){return r(e,"nextSibling",n)},prevUntil:function(e,t,n){return r(e,"previousSibling",n)},siblings:function(e){return X((e.parentNode||{}).firstChild,e)},children:function(e){return X(e.firstChild)},contents:function(e){return e.contentDocument||S.merge([],e.childNodes)}},function(r,i){S.fn[r]=function(e,t){var n=S.map(this,i,e);if(r.slice(-5)!=="Until"){t=e}if(t&&typeof t==="string"){n=S.filter(t,n)}if(this.length>1){if(!oe[r]){S.uniqueSort(n)}if(ie.test(r)){n.reverse()}}return this.pushStack(n)}});var A=/[^\x20\t\r\n\f]+/g;function se(e){var n={};S.each(e.match(A)||[],function(e,t){n[t]=true});return n}S.Callbacks=function(r){r=typeof r==="string"?se(r):S.extend({},r);var n,e,t,i,o=[],a=[],s=-1,l=function(){i=r.once;t=n=true;for(;a.length;s=-1){e=a.shift();while(++s<o.length){if(o[s].apply(e[0],e[1])===false&&r.stopOnFalse){s=o.length;e=false}}}if(!r.memory){e=false}n=false;if(i){if(e){o=[]}else{o=""}}},u={add:function(){if(o){if(e&&!n){s=o.length-1;a.push(e)}(function n(e){S.each(e,function(e,t){if(S.isFunction(t)){if(!r.unique||!u.has(t)){o.push(t)}}else if(t&&t.length&&S.type(t)!=="string"){n(t)}})})(arguments);if(e&&!n){l()}}return this},remove:function(){S.each(arguments,function(e,t){var n;while((n=S.inArray(t,o,n))>-1){o.splice(n,1);if(n<=s){s--}}});return this},has:function(e){return e?S.inArray(e,o)>-1:o.length>0},empty:function(){if(o){o=[]}return this},disable:function(){i=a=[];o=e="";return this},disabled:function(){return!o},lock:function(){i=a=[];if(!e&&!n){o=e=""}return this},locked:function(){return!!i},fireWith:function(e,t){if(!i){t=t||[];t=[e,t.slice?t.slice():t];a.push(t);if(!n){l()}}return this},fire:function(){u.fireWith(this,arguments);return this},fired:function(){return!!t}};return u};function c(e){return e}function f(e){throw e}function le(e,t,n){var r;try{if(e&&S.isFunction(r=e.promise)){r.call(e).done(t).fail(n)}else if(e&&S.isFunction(r=e.then)){r.call(e,t,n)}else{t.call(undefined,e)}}catch(e){n.call(undefined,e)}}S.extend({Deferred:function(e){var o=[["notify","progress",S.Callbacks("memory"),S.Callbacks("memory"),2],["resolve","done",S.Callbacks("once memory"),S.Callbacks("once memory"),0,"resolved"],["reject","fail",S.Callbacks("once memory"),S.Callbacks("once memory"),1,"rejected"]],i="pending",a={state:function(){return i},always:function(){s.done(arguments).fail(arguments);return this},catch:function(e){return a.then(null,e)},pipe:function(){var i=arguments;return S.Deferred(function(r){S.each(o,function(e,t){var n=S.isFunction(i[t[4]])&&i[t[4]];s[t[1]](function(){var e=n&&n.apply(this,arguments);if(e&&S.isFunction(e.promise)){e.promise().progress(r.notify).done(r.resolve).fail(r.reject)}else{r[t[0]+"With"](this,n?[e]:arguments)}})});i=null}).promise()},then:function(t,n,r){var l=0;function u(i,o,a,s){return function(){var n=this,r=arguments,e=function(){var e,t;if(i<l){return}e=a.apply(n,r);if(e===o.promise()){throw new TypeError("Thenable self-resolution")}t=e&&(typeof e==="object"||typeof e==="function")&&e.then;if(S.isFunction(t)){if(s){t.call(e,u(l,o,c,s),u(l,o,f,s))}else{l++;t.call(e,u(l,o,c,s),u(l,o,f,s),u(l,o,c,o.notifyWith))}}else{if(a!==c){n=undefined;r=[e]}(s||o.resolveWith)(n,r)}},t=s?e:function(){try{e()}catch(e){if(S.Deferred.exceptionHook){S.Deferred.exceptionHook(e,t.stackTrace)}if(i+1>=l){if(a!==f){n=undefined;r=[e]}o.rejectWith(n,r)}}};if(i){t()}else{if(S.Deferred.getStackHook){t.stackTrace=S.Deferred.getStackHook()}w.setTimeout(t)}}}return S.Deferred(function(e){o[0][3].add(u(0,e,S.isFunction(r)?r:c,e.notifyWith));o[1][3].add(u(0,e,S.isFunction(t)?t:c));o[2][3].add(u(0,e,S.isFunction(n)?n:f))}).promise()},promise:function(e){return e!=null?S.extend(e,a):a}},s={};S.each(o,function(e,t){var n=t[2],r=t[5];a[t[1]]=n.add;if(r){n.add(function(){i=r},o[3-e][2].disable,o[0][2].lock)}n.add(t[3].fire);s[t[0]]=function(){s[t[0]+"With"](this===s?undefined:this,arguments);return this};s[t[0]+"With"]=n.fireWith});a.promise(s);if(e){e.call(s,s)}return s},when:function(e){var n=arguments.length,t=n,r=Array(t),i=s.call(arguments),o=S.Deferred(),a=function(t){return function(e){r[t]=this;i[t]=arguments.length>1?s.call(arguments):e;if(!--n){o.resolveWith(r,i)}}};if(n<=1){le(e,o.done(a(t)).resolve,o.reject);if(o.state()==="pending"||S.isFunction(i[t]&&i[t].then)){return o.then()}}while(t--){le(i[t],a(t),o.reject)}return o.promise()}});var ue=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;S.Deferred.exceptionHook=function(e,t){if(w.console&&w.console.warn&&e&&ue.test(e.name)){w.console.warn("jQuery.Deferred exception: "+e.message,e.stack,t)}};S.readyException=function(e){w.setTimeout(function(){throw e})};var ce=S.Deferred();S.fn.ready=function(e){ce.then(e).catch(function(e){S.readyException(e)});return this};S.extend({isReady:false,readyWait:1,holdReady:function(e){if(e){S.readyWait++}else{S.ready(true)}},ready:function(e){if(e===true?--S.readyWait:S.isReady){return}S.isReady=true;if(e!==true&&--S.readyWait>0){return}ce.resolveWith(_,[S])}});S.ready.then=ce.then;function o(){_.removeEventListener("DOMContentLoaded",o);w.removeEventListener("load",o);S.ready()}if(_.readyState==="complete"||_.readyState!=="loading"&&!_.documentElement.doScroll){w.setTimeout(S.ready)}else{_.addEventListener("DOMContentLoaded",o);w.addEventListener("load",o)}var d=function(e,t,n,r,i,o,a){var s=0,l=e.length,u=n==null;if(S.type(n)==="object"){i=true;for(s in n){d(e,t,s,n[s],true,o,a)}}else if(r!==undefined){i=true;if(!S.isFunction(r)){a=true}if(u){if(a){t.call(e,r);t=null}else{u=t;t=function(e,t,n){return u.call(S(e),n)}}}if(t){for(;s<l;s++){t(e[s],n,a?r:r.call(e[s],s,t(e[s],n)))}}}if(i){return e}if(u){return t.call(e)}return l?t(e[0],n):o};var fe=function(e){return e.nodeType===1||e.nodeType===9||!+e.nodeType};function a(){this.expando=S.expando+a.uid++}a.uid=1;a.prototype={cache:function(e){var t=e[this.expando];if(!t){t={};if(fe(e)){if(e.nodeType){e[this.expando]=t}else{Object.defineProperty(e,this.expando,{value:t,configurable:true})}}}return t},set:function(e,t,n){var r,i=this.cache(e);if(typeof t==="string"){i[S.camelCase(t)]=n}else{for(r in t){i[S.camelCase(r)]=t[r]}}return i},get:function(e,t){return t===undefined?this.cache(e):e[this.expando]&&e[this.expando][S.camelCase(t)]},access:function(e,t,n){if(t===undefined||t&&typeof t==="string"&&n===undefined){return this.get(e,t)}this.set(e,t,n);return n!==undefined?n:t},remove:function(e,t){var n,r=e[this.expando];if(r===undefined){return}if(t!==undefined){if(S.isArray(t)){t=t.map(S.camelCase)}else{t=S.camelCase(t);t=t in r?[t]:t.match(A)||[]}n=t.length;while(n--){delete r[t[n]]}}if(t===undefined||S.isEmptyObject(r)){if(e.nodeType){e[this.expando]=undefined}else{delete e[this.expando]}}},hasData:function(e){var t=e[this.expando];return t!==undefined&&!S.isEmptyObject(t)}};var y=new a;var h=new a;var de=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,he=/[A-Z]/g;function pe(e){if(e==="true"){return true}if(e==="false"){return false}if(e==="null"){return null}if(e===+e+""){return+e}if(de.test(e)){return JSON.parse(e)}return e}function ge(e,t,n){var r;if(n===undefined&&e.nodeType===1){r="data-"+t.replace(he,"-$&").toLowerCase();n=e.getAttribute(r);if(typeof n==="string"){try{n=pe(n)}catch(e){}h.set(e,t,n)}else{n=undefined}}return n}S.extend({hasData:function(e){return h.hasData(e)||y.hasData(e)},data:function(e,t,n){return h.access(e,t,n)},removeData:function(e,t){h.remove(e,t)},_data:function(e,t,n){return y.access(e,t,n)},_removeData:function(e,t){y.remove(e,t)}});S.fn.extend({data:function(n,e){var t,r,i,o=this[0],a=o&&o.attributes;if(n===undefined){if(this.length){i=h.get(o);if(o.nodeType===1&&!y.get(o,"hasDataAttrs")){t=a.length;while(t--){if(a[t]){r=a[t].name;if(r.indexOf("data-")===0){r=S.camelCase(r.slice(5));ge(o,r,i[r])}}}y.set(o,"hasDataAttrs",true)}}return i}if(typeof n==="object"){return this.each(function(){h.set(this,n)})}return d(this,function(e){var t;if(o&&e===undefined){t=h.get(o,n);if(t!==undefined){return t}t=ge(o,n);if(t!==undefined){return t}return}this.each(function(){h.set(this,n,e)})},null,e,arguments.length>1,null,true)},removeData:function(e){return this.each(function(){h.remove(this,e)})}});S.extend({queue:function(e,t,n){var r;if(e){t=(t||"fx")+"queue";r=y.get(e,t);if(n){if(!r||S.isArray(n)){r=y.access(e,t,S.makeArray(n))}else{r.push(n)}}return r||[]}},dequeue:function(e,t){t=t||"fx";var n=S.queue(e,t),r=n.length,i=n.shift(),o=S._queueHooks(e,t),a=function(){S.dequeue(e,t)};if(i==="inprogress"){i=n.shift();r--}if(i){if(t==="fx"){n.unshift("inprogress")}delete o.stop;i.call(e,a,o)}if(!r&&o){o.empty.fire()}},_queueHooks:function(e,t){var n=t+"queueHooks";return y.get(e,n)||y.access(e,n,{empty:S.Callbacks("once memory").add(function(){y.remove(e,[t+"queue",n])})})}});S.fn.extend({queue:function(t,n){var e=2;if(typeof t!=="string"){n=t;t="fx";e--}if(arguments.length<e){return S.queue(this[0],t)}return n===undefined?this:this.each(function(){var e=S.queue(this,t,n);S._queueHooks(this,t);if(t==="fx"&&e[0]!=="inprogress"){S.dequeue(this,t)}})},dequeue:function(e){return this.each(function(){S.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,r=1,i=S.Deferred(),o=this,a=this.length,s=function(){if(!--r){i.resolveWith(o,[o])}};if(typeof e!=="string"){t=e;e=undefined}e=e||"fx";while(a--){n=y.get(o[a],e+"queueHooks");if(n&&n.empty){r++;n.empty.add(s)}}s();return i.promise(t)}});var ve=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source;var v=new RegExp("^(?:([+-])=|)("+ve+")([a-z%]*)$","i");var l=["Top","Right","Bottom","Left"];var ye=function(e,t){e=t||e;return e.style.display==="none"||e.style.display===""&&S.contains(e.ownerDocument,e)&&S.css(e,"display")==="none"};var me=function(e,t,n,r){var i,o,a={};for(o in t){a[o]=e.style[o];e.style[o]=t[o]}i=n.apply(e,r||[]);for(o in t){e.style[o]=a[o]}return i};function be(e,t,n,r){var i,o=1,a=20,s=r?function(){return r.cur()}:function(){return S.css(e,t,"")},l=s(),u=n&&n[3]||(S.cssNumber[t]?"":"px"),c=(S.cssNumber[t]||u!=="px"&&+l)&&v.exec(S.css(e,t));if(c&&c[3]!==u){u=u||c[3];n=n||[];c=+l||1;do{o=o||".5";c=c/o;S.style(e,t,c+u)}while(o!==(o=s()/l)&&o!==1&&--a)}if(n){c=+c||+l||0;i=n[1]?c+(n[1]+1)*n[2]:+n[2];if(r){r.unit=u;r.start=c;r.end=i}}return i}var Ee={};function Te(e){var t,n=e.ownerDocument,r=e.nodeName,i=Ee[r];if(i){return i}t=n.body.appendChild(n.createElement(r));i=S.css(t,"display");t.parentNode.removeChild(t);if(i==="none"){i="block"}Ee[r]=i;return i}function m(e,t){var n,r,i=[],o=0,a=e.length;for(;o<a;o++){r=e[o];if(!r.style){continue}n=r.style.display;if(t){if(n==="none"){i[o]=y.get(r,"display")||null;if(!i[o]){r.style.display=""}}if(r.style.display===""&&ye(r)){i[o]=Te(r)}}else{if(n!=="none"){i[o]="none";y.set(r,"display",n)}}}for(o=0;o<a;o++){if(i[o]!=null){e[o].style.display=i[o]}}return e}S.fn.extend({show:function(){return m(this,true)},hide:function(){return m(this)},toggle:function(e){if(typeof e==="boolean"){return e?this.show():this.hide()}return this.each(function(){if(ye(this)){S(this).show()}else{S(this).hide()}})}});var ke=/^(?:checkbox|radio)$/i;var we=/<([a-z][^\/\0>\x20\t\r\n\f]+)/i;var _e=/^$|\/(?:java|ecma)script/i;var b={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};b.optgroup=b.option;b.tbody=b.tfoot=b.colgroup=b.caption=b.thead;b.th=b.td;function E(e,t){var n;if(typeof e.getElementsByTagName!=="undefined"){n=e.getElementsByTagName(t||"*")}else if(typeof e.querySelectorAll!=="undefined"){n=e.querySelectorAll(t||"*")}else{n=[]}if(t===undefined||t&&S.nodeName(e,t)){return S.merge([e],n)}return n}function Se(e,t){var n=0,r=e.length;for(;n<r;n++){y.set(e[n],"globalEval",!t||y.get(t[n],"globalEval"))}}var Ae=/<|&#?\w+;/;function Pe(e,t,n,r,i){var o,a,s,l,u,c,f=t.createDocumentFragment(),d=[],h=0,p=e.length;for(;h<p;h++){o=e[h];if(o||o===0){if(S.type(o)==="object"){S.merge(d,o.nodeType?[o]:o)}else if(!Ae.test(o)){d.push(t.createTextNode(o))}else{a=a||f.appendChild(t.createElement("div"));s=(we.exec(o)||["",""])[1].toLowerCase();l=b[s]||b._default;a.innerHTML=l[1]+S.htmlPrefilter(o)+l[2];c=l[0];while(c--){a=a.lastChild}S.merge(d,a.childNodes);a=f.firstChild;a.textContent=""}}}f.textContent="";h=0;while(o=d[h++]){if(r&&S.inArray(o,r)>-1){if(i){i.push(o)}continue}u=S.contains(o.ownerDocument,o);a=E(f.appendChild(o),"script");if(u){Se(a)}if(n){c=0;while(o=a[c++]){if(_e.test(o.type||"")){n.push(o)}}}}return f}(function(){var e=_.createDocumentFragment(),t=e.appendChild(_.createElement("div")),n=_.createElement("input");n.setAttribute("type","radio");n.setAttribute("checked","checked");n.setAttribute("name","t");t.appendChild(n);g.checkClone=t.cloneNode(true).cloneNode(true).lastChild.checked;t.innerHTML="<textarea>x</textarea>";g.noCloneChecked=!!t.cloneNode(true).lastChild.defaultValue})();var Oe=_.documentElement;var Ce=/^key/,Le=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,De=/^([^.]*)(?:\.(.+)|)/;function xe(){return true}function u(){return false}function Re(){try{return _.activeElement}catch(e){}}function Ie(e,t,n,r,i,o){var a,s;if(typeof t==="object"){if(typeof n!=="string"){r=r||n;n=undefined}for(s in t){Ie(e,s,n,r,t[s],o)}return e}if(r==null&&i==null){i=n;r=n=undefined}else if(i==null){if(typeof n==="string"){i=r;r=undefined}else{i=r;r=n;n=undefined}}if(i===false){i=u}else if(!i){return e}if(o===1){a=i;i=function(e){S().off(e);return a.apply(this,arguments)};i.guid=a.guid||(a.guid=S.guid++)}return e.each(function(){S.event.add(this,t,i,r,n)})}S.event={global:{},add:function(t,e,n,r,i){var o,a,s,l,u,c,f,d,h,p,g,v=y.get(t);if(!v){return}if(n.handler){o=n;n=o.handler;i=o.selector}if(i){S.find.matchesSelector(Oe,i)}if(!n.guid){n.guid=S.guid++}if(!(l=v.events)){l=v.events={}}if(!(a=v.handle)){a=v.handle=function(e){return typeof S!=="undefined"&&S.event.triggered!==e.type?S.event.dispatch.apply(t,arguments):undefined}}e=(e||"").match(A)||[""];u=e.length;while(u--){s=De.exec(e[u])||[];h=g=s[1];p=(s[2]||"").split(".").sort();if(!h){continue}f=S.event.special[h]||{};h=(i?f.delegateType:f.bindType)||h;f=S.event.special[h]||{};c=S.extend({type:h,origType:g,data:r,handler:n,guid:n.guid,selector:i,needsContext:i&&S.expr.match.needsContext.test(i),namespace:p.join(".")},o);if(!(d=l[h])){d=l[h]=[];d.delegateCount=0;if(!f.setup||f.setup.call(t,r,p,a)===false){if(t.addEventListener){t.addEventListener(h,a)}}}if(f.add){f.add.call(t,c);if(!c.handler.guid){c.handler.guid=n.guid}}if(i){d.splice(d.delegateCount++,0,c)}else{d.push(c)}S.event.global[h]=true}},remove:function(e,t,n,r,i){var o,a,s,l,u,c,f,d,h,p,g,v=y.hasData(e)&&y.get(e);if(!v||!(l=v.events)){return}t=(t||"").match(A)||[""];u=t.length;while(u--){s=De.exec(t[u])||[];h=g=s[1];p=(s[2]||"").split(".").sort();if(!h){for(h in l){S.event.remove(e,h+t[u],n,r,true)}continue}f=S.event.special[h]||{};h=(r?f.delegateType:f.bindType)||h;d=l[h]||[];s=s[2]&&new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)");a=o=d.length;while(o--){c=d[o];if((i||g===c.origType)&&(!n||n.guid===c.guid)&&(!s||s.test(c.namespace))&&(!r||r===c.selector||r==="**"&&c.selector)){d.splice(o,1);if(c.selector){d.delegateCount--}if(f.remove){f.remove.call(e,c)}}}if(a&&!d.length){if(!f.teardown||f.teardown.call(e,p,v.handle)===false){S.removeEvent(e,h,v.handle)}delete l[h]}}if(S.isEmptyObject(l)){y.remove(e,"handle events")}},dispatch:function(e){var t=S.event.fix(e);var n,r,i,o,a,s,l=new Array(arguments.length),u=(y.get(this,"events")||{})[t.type]||[],c=S.event.special[t.type]||{};l[0]=t;for(n=1;n<arguments.length;n++){l[n]=arguments[n]}t.delegateTarget=this;if(c.preDispatch&&c.preDispatch.call(this,t)===false){return}s=S.event.handlers.call(this,t,u);n=0;while((o=s[n++])&&!t.isPropagationStopped()){t.currentTarget=o.elem;r=0;while((a=o.handlers[r++])&&!t.isImmediatePropagationStopped()){if(!t.rnamespace||t.rnamespace.test(a.namespace)){t.handleObj=a;t.data=a.data;i=((S.event.special[a.origType]||{}).handle||a.handler).apply(o.elem,l);if(i!==undefined){if((t.result=i)===false){t.preventDefault();t.stopPropagation()}}}}}if(c.postDispatch){c.postDispatch.call(this,t)}return t.result},handlers:function(e,t){var n,r,i,o,a,s=[],l=t.delegateCount,u=e.target;if(l&&u.nodeType&&!(e.type==="click"&&e.button>=1)){for(;u!==this;u=u.parentNode||this){if(u.nodeType===1&&!(e.type==="click"&&u.disabled===true)){o=[];a={};for(n=0;n<l;n++){r=t[n];i=r.selector+" ";if(a[i]===undefined){a[i]=r.needsContext?S(i,this).index(u)>-1:S.find(i,this,null,[u]).length}if(a[i]){o.push(r)}}if(o.length){s.push({elem:u,handlers:o})}}}}u=this;if(l<t.length){s.push({elem:u,handlers:t.slice(l)})}return s},addProp:function(t,e){Object.defineProperty(S.Event.prototype,t,{enumerable:true,configurable:true,get:S.isFunction(e)?function(){if(this.originalEvent){return e(this.originalEvent)}}:function(){if(this.originalEvent){return this.originalEvent[t]}},set:function(e){Object.defineProperty(this,t,{enumerable:true,configurable:true,writable:true,value:e})}})},fix:function(e){return e[S.expando]?e:new S.Event(e)},special:{load:{noBubble:true},focus:{trigger:function(){if(this!==Re()&&this.focus){this.focus();return false}},delegateType:"focusin"},blur:{trigger:function(){if(this===Re()&&this.blur){this.blur();return false}},delegateType:"focusout"},click:{trigger:function(){if(this.type==="checkbox"&&this.click&&S.nodeName(this,"input")){this.click();return false}},_default:function(e){return S.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){if(e.result!==undefined&&e.originalEvent){e.originalEvent.returnValue=e.result}}}}};S.removeEvent=function(e,t,n){if(e.removeEventListener){e.removeEventListener(t,n)}};S.Event=function(e,t){if(!(this instanceof S.Event)){return new S.Event(e,t)}if(e&&e.type){this.originalEvent=e;this.type=e.type;this.isDefaultPrevented=e.defaultPrevented||e.defaultPrevented===undefined&&e.returnValue===false?xe:u;this.target=e.target&&e.target.nodeType===3?e.target.parentNode:e.target;this.currentTarget=e.currentTarget;this.relatedTarget=e.relatedTarget}else{this.type=e}if(t){S.extend(this,t)}this.timeStamp=e&&e.timeStamp||S.now();this[S.expando]=true};S.Event.prototype={constructor:S.Event,isDefaultPrevented:u,isPropagationStopped:u,isImmediatePropagationStopped:u,isSimulated:false,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=xe;if(e&&!this.isSimulated){e.preventDefault()}},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=xe;if(e&&!this.isSimulated){e.stopPropagation()}},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=xe;if(e&&!this.isSimulated){e.stopImmediatePropagation()}this.stopPropagation()}};S.each({altKey:true,bubbles:true,cancelable:true,changedTouches:true,ctrlKey:true,detail:true,eventPhase:true,metaKey:true,pageX:true,pageY:true,shiftKey:true,view:true,char:true,charCode:true,key:true,keyCode:true,button:true,buttons:true,clientX:true,clientY:true,offsetX:true,offsetY:true,pointerId:true,pointerType:true,screenX:true,screenY:true,targetTouches:true,toElement:true,touches:true,which:function(e){var t=e.button;if(e.which==null&&Ce.test(e.type)){return e.charCode!=null?e.charCode:e.keyCode}if(!e.which&&t!==undefined&&Le.test(e.type)){if(t&1){return 1}if(t&2){return 3}if(t&4){return 2}return 0}return e.which}},S.event.addProp);S.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,o){S.event.special[e]={delegateType:o,bindType:o,handle:function(e){var t,n=this,r=e.relatedTarget,i=e.handleObj;if(!r||r!==n&&!S.contains(n,r)){e.type=i.origType;t=i.handler.apply(this,arguments);e.type=o}return t}}});S.fn.extend({on:function(e,t,n,r){return Ie(this,e,t,n,r)},one:function(e,t,n,r){return Ie(this,e,t,n,r,1)},off:function(e,t,n){var r,i;if(e&&e.preventDefault&&e.handleObj){r=e.handleObj;S(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler);return this}if(typeof e==="object"){for(i in e){this.off(i,t,e[i])}return this}if(t===false||typeof t==="function"){n=t;t=undefined}if(n===false){n=u}return this.each(function(){S.event.remove(this,e,n,t)})}});var Me=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,Fe=/<script|<style|<link/i,Ne=/checked\s*(?:[^=]|=\s*.checked.)/i,je=/^true\/(.*)/,Ue=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function Be(e,t){if(S.nodeName(e,"table")&&S.nodeName(t.nodeType!==11?t:t.firstChild,"tr")){return e.getElementsByTagName("tbody")[0]||e}return e}function He(e){e.type=(e.getAttribute("type")!==null)+"/"+e.type;return e}function $e(e){var t=je.exec(e.type);if(t){e.type=t[1]}else{e.removeAttribute("type")}return e}function Ge(e,t){var n,r,i,o,a,s,l,u;if(t.nodeType!==1){return}if(y.hasData(e)){o=y.access(e);a=y.set(t,o);u=o.events;if(u){delete a.handle;a.events={};for(i in u){for(n=0,r=u[i].length;n<r;n++){S.event.add(t,i,u[i][n])}}}}if(h.hasData(e)){s=h.access(e);l=S.extend({},s);h.set(t,l)}}function Ve(e,t){var n=t.nodeName.toLowerCase();if(n==="input"&&ke.test(e.type)){t.checked=e.checked}else if(n==="input"||n==="textarea"){t.defaultValue=e.defaultValue}}function T(n,r,i,o){r=j.apply([],r);var e,t,a,s,l,u,c=0,f=n.length,d=f-1,h=r[0],p=S.isFunction(h);if(p||f>1&&typeof h==="string"&&!g.checkClone&&Ne.test(h)){return n.each(function(e){var t=n.eq(e);if(p){r[0]=h.call(this,e,t.html())}T(t,r,i,o)})}if(f){e=Pe(r,n[0].ownerDocument,false,n,o);t=e.firstChild;if(e.childNodes.length===1){e=t}if(t||o){a=S.map(E(e,"script"),He);s=a.length;for(;c<f;c++){l=e;if(c!==d){l=S.clone(l,true,true);if(s){S.merge(a,E(l,"script"))}}i.call(n[c],l,c)}if(s){u=a[a.length-1].ownerDocument;S.map(a,$e);for(c=0;c<s;c++){l=a[c];if(_e.test(l.type||"")&&!y.access(l,"globalEval")&&S.contains(u,l)){if(l.src){if(S._evalUrl){S._evalUrl(l.src)}}else{G(l.textContent.replace(Ue,""),u)}}}}}}return n}function Ye(e,t,n){var r,i=t?S.filter(t,e):e,o=0;for(;(r=i[o])!=null;o++){if(!n&&r.nodeType===1){S.cleanData(E(r))}if(r.parentNode){if(n&&S.contains(r.ownerDocument,r)){Se(E(r,"script"))}r.parentNode.removeChild(r)}}return e}S.extend({htmlPrefilter:function(e){return e.replace(Me,"<$1></$2>")},clone:function(e,t,n){var r,i,o,a,s=e.cloneNode(true),l=S.contains(e.ownerDocument,e);if(!g.noCloneChecked&&(e.nodeType===1||e.nodeType===11)&&!S.isXMLDoc(e)){a=E(s);o=E(e);for(r=0,i=o.length;r<i;r++){Ve(o[r],a[r])}}if(t){if(n){o=o||E(e);a=a||E(s);for(r=0,i=o.length;r<i;r++){Ge(o[r],a[r])}}else{Ge(e,s)}}a=E(s,"script");if(a.length>0){Se(a,!l&&E(e,"script"))}return s},cleanData:function(e){var t,n,r,i=S.event.special,o=0;for(;(n=e[o])!==undefined;o++){if(fe(n)){if(t=n[y.expando]){if(t.events){for(r in t.events){if(i[r]){S.event.remove(n,r)}else{S.removeEvent(n,r,t.handle)}}}n[y.expando]=undefined}if(n[h.expando]){n[h.expando]=undefined}}}}});S.fn.extend({detach:function(e){return Ye(this,e,true)},remove:function(e){return Ye(this,e)},text:function(e){return d(this,function(e){return e===undefined?S.text(this):this.empty().each(function(){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){this.textContent=e}})},null,e,arguments.length)},append:function(){return T(this,arguments,function(e){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var t=Be(this,e);t.appendChild(e)}})},prepend:function(){return T(this,arguments,function(e){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var t=Be(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return T(this,arguments,function(e){if(this.parentNode){this.parentNode.insertBefore(e,this)}})},after:function(){return T(this,arguments,function(e){if(this.parentNode){this.parentNode.insertBefore(e,this.nextSibling)}})},empty:function(){var e,t=0;for(;(e=this[t])!=null;t++){if(e.nodeType===1){S.cleanData(E(e,false));e.textContent=""}}return this},clone:function(e,t){e=e==null?false:e;t=t==null?e:t;return this.map(function(){return S.clone(this,e,t)})},html:function(e){return d(this,function(e){var t=this[0]||{},n=0,r=this.length;if(e===undefined&&t.nodeType===1){return t.innerHTML}if(typeof e==="string"&&!Fe.test(e)&&!b[(we.exec(e)||["",""])[1].toLowerCase()]){e=S.htmlPrefilter(e);try{for(;n<r;n++){t=this[n]||{};if(t.nodeType===1){S.cleanData(E(t,false));t.innerHTML=e}}t=0}catch(e){}}if(t){this.empty().append(e)}},null,e,arguments.length)},replaceWith:function(){var n=[];return T(this,arguments,function(e){var t=this.parentNode;if(S.inArray(this,n)<0){S.cleanData(E(this));if(t){t.replaceChild(e,this)}}},n)}});S.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,a){S.fn[e]=function(e){var t,n=[],r=S(e),i=r.length-1,o=0;for(;o<=i;o++){t=o===i?this:this.clone(true);S(r[o])[a](t);U.apply(n,t.get())}return this.pushStack(n)}});var ze=/^margin/;var Ke=new RegExp("^("+ve+")(?!px)[a-z%]+$","i");var We=function(e){var t=e.ownerDocument.defaultView;if(!t||!t.opener){t=w}return t.getComputedStyle(e)};(function(){function e(){if(!a){return}a.style.cssText="box-sizing:border-box;"+"position:relative;display:block;"+"margin:auto;border:1px;padding:1px;"+"top:1%;width:50%";a.innerHTML="";Oe.appendChild(o);var e=w.getComputedStyle(a);t=e.top!=="1%";i=e.marginLeft==="2px";n=e.width==="4px";a.style.marginRight="50%";r=e.marginRight==="4px";Oe.removeChild(o);a=null}var t,n,r,i,o=_.createElement("div"),a=_.createElement("div");if(!a.style){return}a.style.backgroundClip="content-box";a.cloneNode(true).style.backgroundClip="";g.clearCloneStyle=a.style.backgroundClip==="content-box";o.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;"+"padding:0;margin-top:1px;position:absolute";o.appendChild(a);S.extend(g,{pixelPosition:function(){e();return t},boxSizingReliable:function(){e();return n},pixelMarginRight:function(){e();return r},reliableMarginLeft:function(){e();return i}})})();function k(e,t,n){var r,i,o,a,s=e.style;n=n||We(e);if(n){a=n.getPropertyValue(t)||n[t];if(a===""&&!S.contains(e.ownerDocument,e)){a=S.style(e,t)}if(!g.pixelMarginRight()&&Ke.test(a)&&ze.test(t)){r=s.width;i=s.minWidth;o=s.maxWidth;s.minWidth=s.maxWidth=s.width=a;a=n.width;s.width=r;s.minWidth=i;s.maxWidth=o}}return a!==undefined?a+"":a}function qe(e,t){return{get:function(){if(e()){delete this.get;return}return(this.get=t).apply(this,arguments)}}}var Xe=/^(none|table(?!-c[ea]).+)/,Qe={position:"absolute",visibility:"hidden",display:"block"},Je={letterSpacing:"0",fontWeight:"400"},Ze=["Webkit","Moz","ms"],et=_.createElement("div").style;function tt(e){if(e in et){return e}var t=e[0].toUpperCase()+e.slice(1),n=Ze.length;while(n--){e=Ze[n]+t;if(e in et){return e}}}function nt(e,t,n){var r=v.exec(t);return r?Math.max(0,r[2]-(n||0))+(r[3]||"px"):t}function rt(e,t,n,r,i){var o,a=0;if(n===(r?"border":"content")){o=4}else{o=t==="width"?1:0}for(;o<4;o+=2){if(n==="margin"){a+=S.css(e,n+l[o],true,i)}if(r){if(n==="content"){a-=S.css(e,"padding"+l[o],true,i)}if(n!=="margin"){a-=S.css(e,"border"+l[o]+"Width",true,i)}}else{a+=S.css(e,"padding"+l[o],true,i);if(n!=="padding"){a+=S.css(e,"border"+l[o]+"Width",true,i)}}}return a}function it(e,t,n){var r,i=true,o=We(e),a=S.css(e,"boxSizing",false,o)==="border-box";if(e.getClientRects().length){r=e.getBoundingClientRect()[t]}if(r<=0||r==null){r=k(e,t,o);if(r<0||r==null){r=e.style[t]}if(Ke.test(r)){return r}i=a&&(g.boxSizingReliable()||r===e.style[t]);r=parseFloat(r)||0}return r+rt(e,t,n||(a?"border":"content"),i,o)+"px"}S.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=k(e,"opacity");return n===""?"1":n}}}},cssNumber:{animationIterationCount:true,columnCount:true,fillOpacity:true,flexGrow:true,flexShrink:true,fontWeight:true,lineHeight:true,opacity:true,order:true,orphans:true,widows:true,zIndex:true,zoom:true},cssProps:{float:"cssFloat"},style:function(e,t,n,r){if(!e||e.nodeType===3||e.nodeType===8||!e.style){return}var i,o,a,s=S.camelCase(t),l=e.style;t=S.cssProps[s]||(S.cssProps[s]=tt(s)||s);a=S.cssHooks[t]||S.cssHooks[s];if(n!==undefined){o=typeof n;if(o==="string"&&(i=v.exec(n))&&i[1]){n=be(e,t,i);o="number"}if(n==null||n!==n){return}if(o==="number"){n+=i&&i[3]||(S.cssNumber[s]?"":"px")}if(!g.clearCloneStyle&&n===""&&t.indexOf("background")===0){l[t]="inherit"}if(!a||!("set"in a)||(n=a.set(e,n,r))!==undefined){l[t]=n}}else{if(a&&"get"in a&&(i=a.get(e,false,r))!==undefined){return i}return l[t]}},css:function(e,t,n,r){var i,o,a,s=S.camelCase(t);t=S.cssProps[s]||(S.cssProps[s]=tt(s)||s);a=S.cssHooks[t]||S.cssHooks[s];if(a&&"get"in a){i=a.get(e,true,n)}if(i===undefined){i=k(e,t,r)}if(i==="normal"&&t in Je){i=Je[t]}if(n===""||n){o=parseFloat(i);return n===true||isFinite(o)?o||0:i}return i}});S.each(["height","width"],function(e,a){S.cssHooks[a]={get:function(e,t,n){if(t){return Xe.test(S.css(e,"display"))&&(!e.getClientRects().length||!e.getBoundingClientRect().width)?me(e,Qe,function(){return it(e,a,n)}):it(e,a,n)}},set:function(e,t,n){var r,i=n&&We(e),o=n&&rt(e,a,n,S.css(e,"boxSizing",false,i)==="border-box",i);if(o&&(r=v.exec(t))&&(r[3]||"px")!=="px"){e.style[a]=t;t=S.css(e,a)}return nt(e,t,o)}}});S.cssHooks.marginLeft=qe(g.reliableMarginLeft,function(e,t){if(t){return(parseFloat(k(e,"marginLeft"))||e.getBoundingClientRect().left-me(e,{marginLeft:0},function(){return e.getBoundingClientRect().left}))+"px"}});S.each({margin:"",padding:"",border:"Width"},function(i,o){S.cssHooks[i+o]={expand:function(e){var t=0,n={},r=typeof e==="string"?e.split(" "):[e];for(;t<4;t++){n[i+l[t]+o]=r[t]||r[t-2]||r[0]}return n}};if(!ze.test(i)){S.cssHooks[i+o].set=nt}});S.fn.extend({css:function(e,t){return d(this,function(e,t,n){var r,i,o={},a=0;if(S.isArray(t)){r=We(e);i=t.length;for(;a<i;a++){o[t[a]]=S.css(e,t[a],false,r)}return o}return n!==undefined?S.style(e,t,n):S.css(e,t)},e,t,arguments.length>1)}});function P(e,t,n,r,i){return new P.prototype.init(e,t,n,r,i)}S.Tween=P;P.prototype={constructor:P,init:function(e,t,n,r,i,o){this.elem=e;this.prop=n;this.easing=i||S.easing._default;this.options=t;this.start=this.now=this.cur();this.end=r;this.unit=o||(S.cssNumber[n]?"":"px")},cur:function(){var e=P.propHooks[this.prop];return e&&e.get?e.get(this):P.propHooks._default.get(this)},run:function(e){var t,n=P.propHooks[this.prop];if(this.options.duration){this.pos=t=S.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration)}else{this.pos=t=e}this.now=(this.end-this.start)*t+this.start;if(this.options.step){this.options.step.call(this.elem,this.now,this)}if(n&&n.set){n.set(this)}else{P.propHooks._default.set(this)}return this}};P.prototype.init.prototype=P.prototype;P.propHooks={_default:{get:function(e){var t;if(e.elem.nodeType!==1||e.elem[e.prop]!=null&&e.elem.style[e.prop]==null){return e.elem[e.prop]}t=S.css(e.elem,e.prop,"");return!t||t==="auto"?0:t},set:function(e){if(S.fx.step[e.prop]){S.fx.step[e.prop](e)}else if(e.elem.nodeType===1&&(e.elem.style[S.cssProps[e.prop]]!=null||S.cssHooks[e.prop])){S.style(e.elem,e.prop,e.now+e.unit)}else{e.elem[e.prop]=e.now}}}};P.propHooks.scrollTop=P.propHooks.scrollLeft={set:function(e){if(e.elem.nodeType&&e.elem.parentNode){e.elem[e.prop]=e.now}}};S.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"};S.fx=P.prototype.init;S.fx.step={};var O,C,ot=/^(?:toggle|show|hide)$/,at=/queueHooks$/;function st(){if(C){w.requestAnimationFrame(st);S.fx.tick()}}function lt(){w.setTimeout(function(){O=undefined});return O=S.now()}function ut(e,t){var n,r=0,i={height:e};t=t?1:0;for(;r<4;r+=2-t){n=l[r];i["margin"+n]=i["padding"+n]=e}if(t){i.opacity=i.width=e}return i}function ct(e,t,n){var r,i=(L.tweeners[t]||[]).concat(L.tweeners["*"]),o=0,a=i.length;for(;o<a;o++){if(r=i[o].call(n,t,e)){return r}}}function ft(e,t,n){var r,i,o,a,s,l,u,c,f="width"in t||"height"in t,d=this,h={},p=e.style,g=e.nodeType&&ye(e),v=y.get(e,"fxshow");if(!n.queue){a=S._queueHooks(e,"fx");if(a.unqueued==null){a.unqueued=0;s=a.empty.fire;a.empty.fire=function(){if(!a.unqueued){s()}}}a.unqueued++;d.always(function(){d.always(function(){a.unqueued--;if(!S.queue(e,"fx").length){a.empty.fire()}})})}for(r in t){i=t[r];if(ot.test(i)){delete t[r];o=o||i==="toggle";if(i===(g?"hide":"show")){if(i==="show"&&v&&v[r]!==undefined){g=true}else{continue}}h[r]=v&&v[r]||S.style(e,r)}}l=!S.isEmptyObject(t);if(!l&&S.isEmptyObject(h)){return}if(f&&e.nodeType===1){n.overflow=[p.overflow,p.overflowX,p.overflowY];u=v&&v.display;if(u==null){u=y.get(e,"display")}c=S.css(e,"display");if(c==="none"){if(u){c=u}else{m([e],true);u=e.style.display||u;c=S.css(e,"display");m([e])}}if(c==="inline"||c==="inline-block"&&u!=null){if(S.css(e,"float")==="none"){if(!l){d.done(function(){p.display=u});if(u==null){c=p.display;u=c==="none"?"":c}}p.display="inline-block"}}}if(n.overflow){p.overflow="hidden";d.always(function(){p.overflow=n.overflow[0];p.overflowX=n.overflow[1];p.overflowY=n.overflow[2]})}l=false;for(r in h){if(!l){if(v){if("hidden"in v){g=v.hidden}}else{v=y.access(e,"fxshow",{display:u})}if(o){v.hidden=!g}if(g){m([e],true)}d.done(function(){if(!g){m([e])}y.remove(e,"fxshow");for(r in h){S.style(e,r,h[r])}})}l=ct(g?v[r]:0,r,d);if(!(r in v)){v[r]=l.start;if(g){l.end=l.start;l.start=0}}}}function dt(e,t){var n,r,i,o,a;for(n in e){r=S.camelCase(n);i=t[r];o=e[n];if(S.isArray(o)){i=o[1];o=e[n]=o[0]}if(n!==r){e[r]=o;delete e[n]}a=S.cssHooks[r];if(a&&"expand"in a){o=a.expand(o);delete e[r];for(n in o){if(!(n in e)){e[n]=o[n];t[n]=i}}}else{t[r]=i}}}function L(a,e,t){var n,s,r=0,i=L.prefilters.length,l=S.Deferred().always(function(){delete o.elem}),o=function(){if(s){return false}var e=O||lt(),t=Math.max(0,u.startTime+u.duration-e),n=t/u.duration||0,r=1-n,i=0,o=u.tweens.length;for(;i<o;i++){u.tweens[i].run(r)}l.notifyWith(a,[u,r,t]);if(r<1&&o){return t}else{l.resolveWith(a,[u]);return false}},u=l.promise({elem:a,props:S.extend({},e),opts:S.extend(true,{specialEasing:{},easing:S.easing._default},t),originalProperties:e,originalOptions:t,startTime:O||lt(),duration:t.duration,tweens:[],createTween:function(e,t){var n=S.Tween(a,u.opts,e,t,u.opts.specialEasing[e]||u.opts.easing);u.tweens.push(n);return n},stop:function(e){var t=0,n=e?u.tweens.length:0;if(s){return this}s=true;for(;t<n;t++){u.tweens[t].run(1)}if(e){l.notifyWith(a,[u,1,0]);l.resolveWith(a,[u,e])}else{l.rejectWith(a,[u,e])}return this}}),c=u.props;dt(c,u.opts.specialEasing);for(;r<i;r++){n=L.prefilters[r].call(u,a,c,u.opts);if(n){if(S.isFunction(n.stop)){S._queueHooks(u.elem,u.opts.queue).stop=S.proxy(n.stop,n)}return n}}S.map(c,ct,u);if(S.isFunction(u.opts.start)){u.opts.start.call(a,u)}S.fx.timer(S.extend(o,{elem:a,anim:u,queue:u.opts.queue}));return u.progress(u.opts.progress).done(u.opts.done,u.opts.complete).fail(u.opts.fail).always(u.opts.always)}S.Animation=S.extend(L,{tweeners:{"*":[function(e,t){var n=this.createTween(e,t);be(n.elem,e,v.exec(t),n);return n}]},tweener:function(e,t){if(S.isFunction(e)){t=e;e=["*"]}else{e=e.match(A)}var n,r=0,i=e.length;for(;r<i;r++){n=e[r];L.tweeners[n]=L.tweeners[n]||[];L.tweeners[n].unshift(t)}},prefilters:[ft],prefilter:function(e,t){if(t){L.prefilters.unshift(e)}else{L.prefilters.push(e)}}});S.speed=function(e,t,n){var r=e&&typeof e==="object"?S.extend({},e):{complete:n||!n&&t||S.isFunction(e)&&e,duration:e,easing:n&&t||t&&!S.isFunction(t)&&t};if(S.fx.off||_.hidden){r.duration=0}else{if(typeof r.duration!=="number"){if(r.duration in S.fx.speeds){r.duration=S.fx.speeds[r.duration]}else{r.duration=S.fx.speeds._default}}}if(r.queue==null||r.queue===true){r.queue="fx"}r.old=r.complete;r.complete=function(){if(S.isFunction(r.old)){r.old.call(this)}if(r.queue){S.dequeue(this,r.queue)}};return r};S.fn.extend({fadeTo:function(e,t,n,r){return this.filter(ye).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(t,e,n,r){var i=S.isEmptyObject(t),o=S.speed(e,n,r),a=function(){var e=L(this,S.extend({},t),o);if(i||y.get(this,"finish")){e.stop(true)}};a.finish=a;return i||o.queue===false?this.each(a):this.queue(o.queue,a)},stop:function(i,e,o){var a=function(e){var t=e.stop;delete e.stop;t(o)};if(typeof i!=="string"){o=e;e=i;i=undefined}if(e&&i!==false){this.queue(i||"fx",[])}return this.each(function(){var e=true,t=i!=null&&i+"queueHooks",n=S.timers,r=y.get(this);if(t){if(r[t]&&r[t].stop){a(r[t])}}else{for(t in r){if(r[t]&&r[t].stop&&at.test(t)){a(r[t])}}}for(t=n.length;t--;){if(n[t].elem===this&&(i==null||n[t].queue===i)){n[t].anim.stop(o);e=false;n.splice(t,1)}}if(e||!o){S.dequeue(this,i)}})},finish:function(a){if(a!==false){a=a||"fx"}return this.each(function(){var e,t=y.get(this),n=t[a+"queue"],r=t[a+"queueHooks"],i=S.timers,o=n?n.length:0;t.finish=true;S.queue(this,a,[]);if(r&&r.stop){r.stop.call(this,true)}for(e=i.length;e--;){if(i[e].elem===this&&i[e].queue===a){i[e].anim.stop(true);i.splice(e,1)}}for(e=0;e<o;e++){if(n[e]&&n[e].finish){n[e].finish.call(this)}}delete t.finish})}});S.each(["toggle","show","hide"],function(e,r){var i=S.fn[r];S.fn[r]=function(e,t,n){return e==null||typeof e==="boolean"?i.apply(this,arguments):this.animate(ut(r,true),e,t,n)}});S.each({slideDown:ut("show"),slideUp:ut("hide"),slideToggle:ut("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,r){S.fn[e]=function(e,t,n){return this.animate(r,e,t,n)}});S.timers=[];S.fx.tick=function(){var e,t=0,n=S.timers;O=S.now();for(;t<n.length;t++){e=n[t];if(!e()&&n[t]===e){n.splice(t--,1)}}if(!n.length){S.fx.stop()}O=undefined};S.fx.timer=function(e){S.timers.push(e);if(e()){S.fx.start()}else{S.timers.pop()}};S.fx.interval=13;S.fx.start=function(){if(!C){C=w.requestAnimationFrame?w.requestAnimationFrame(st):w.setInterval(S.fx.tick,S.fx.interval)}};S.fx.stop=function(){if(w.cancelAnimationFrame){w.cancelAnimationFrame(C)}else{w.clearInterval(C)}C=null};S.fx.speeds={slow:600,fast:200,_default:400};S.fn.delay=function(r,e){r=S.fx?S.fx.speeds[r]||r:r;e=e||"fx";return this.queue(e,function(e,t){var n=w.setTimeout(e,r);t.stop=function(){w.clearTimeout(n)}})};(function(){var e=_.createElement("input"),t=_.createElement("select"),n=t.appendChild(_.createElement("option"));e.type="checkbox";g.checkOn=e.value!=="";g.optSelected=n.selected;e=_.createElement("input");e.value="t";e.type="radio";g.radioValue=e.value==="t"})();var ht,D=S.expr.attrHandle;S.fn.extend({attr:function(e,t){return d(this,S.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){S.removeAttr(this,e)})}});S.extend({attr:function(e,t,n){var r,i,o=e.nodeType;if(o===3||o===8||o===2){return}if(typeof e.getAttribute==="undefined"){return S.prop(e,t,n)}if(o!==1||!S.isXMLDoc(e)){i=S.attrHooks[t.toLowerCase()]||(S.expr.match.bool.test(t)?ht:undefined)}if(n!==undefined){if(n===null){S.removeAttr(e,t);return}if(i&&"set"in i&&(r=i.set(e,n,t))!==undefined){return r}e.setAttribute(t,n+"");return n}if(i&&"get"in i&&(r=i.get(e,t))!==null){return r}r=S.find.attr(e,t);return r==null?undefined:r},attrHooks:{type:{set:function(e,t){if(!g.radioValue&&t==="radio"&&S.nodeName(e,"input")){var n=e.value;e.setAttribute("type",t);if(n){e.value=n}return t}}}},removeAttr:function(e,t){var n,r=0,i=t&&t.match(A);if(i&&e.nodeType===1){while(n=i[r++]){e.removeAttribute(n)}}}});ht={set:function(e,t,n){if(t===false){S.removeAttr(e,n)}else{e.setAttribute(n,n)}return n}};S.each(S.expr.match.bool.source.match(/\w+/g),function(e,t){var a=D[t]||S.find.attr;D[t]=function(e,t,n){var r,i,o=t.toLowerCase();if(!n){i=D[o];D[o]=r;r=a(e,t,n)!=null?o:null;D[o]=i}return r}});var pt=/^(?:input|select|textarea|button)$/i,gt=/^(?:a|area)$/i;S.fn.extend({prop:function(e,t){return d(this,S.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[S.propFix[e]||e]})}});S.extend({prop:function(e,t,n){var r,i,o=e.nodeType;if(o===3||o===8||o===2){return}if(o!==1||!S.isXMLDoc(e)){t=S.propFix[t]||t;i=S.propHooks[t]}if(n!==undefined){if(i&&"set"in i&&(r=i.set(e,n,t))!==undefined){return r}return e[t]=n}if(i&&"get"in i&&(r=i.get(e,t))!==null){return r}return e[t]},propHooks:{tabIndex:{get:function(e){var t=S.find.attr(e,"tabindex");if(t){return parseInt(t,10)}if(pt.test(e.nodeName)||gt.test(e.nodeName)&&e.href){return 0}return-1}}},propFix:{for:"htmlFor",class:"className"}});if(!g.optSelected){S.propHooks.selected={get:function(e){var t=e.parentNode;if(t&&t.parentNode){t.parentNode.selectedIndex}return null},set:function(e){var t=e.parentNode;if(t){t.selectedIndex;if(t.parentNode){t.parentNode.selectedIndex}}}}}S.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){S.propFix[this.toLowerCase()]=this});function x(e){var t=e.match(A)||[];return t.join(" ")}function R(e){return e.getAttribute&&e.getAttribute("class")||""}S.fn.extend({addClass:function(t){var e,n,r,i,o,a,s,l=0;if(S.isFunction(t)){return this.each(function(e){S(this).addClass(t.call(this,e,R(this)))})}if(typeof t==="string"&&t){e=t.match(A)||[];while(n=this[l++]){i=R(n);r=n.nodeType===1&&" "+x(i)+" ";if(r){a=0;while(o=e[a++]){if(r.indexOf(" "+o+" ")<0){r+=o+" "}}s=x(r);if(i!==s){n.setAttribute("class",s)}}}}return this},removeClass:function(t){var e,n,r,i,o,a,s,l=0;if(S.isFunction(t)){return this.each(function(e){S(this).removeClass(t.call(this,e,R(this)))})}if(!arguments.length){return this.attr("class","")}if(typeof t==="string"&&t){e=t.match(A)||[];while(n=this[l++]){i=R(n);r=n.nodeType===1&&" "+x(i)+" ";if(r){a=0;while(o=e[a++]){while(r.indexOf(" "+o+" ")>-1){r=r.replace(" "+o+" "," ")}}s=x(r);if(i!==s){n.setAttribute("class",s)}}}}return this},toggleClass:function(i,t){var o=typeof i;if(typeof t==="boolean"&&o==="string"){return t?this.addClass(i):this.removeClass(i)}if(S.isFunction(i)){return this.each(function(e){S(this).toggleClass(i.call(this,e,R(this),t),t)})}return this.each(function(){var e,t,n,r;if(o==="string"){t=0;n=S(this);r=i.match(A)||[];while(e=r[t++]){if(n.hasClass(e)){n.removeClass(e)}else{n.addClass(e)}}}else if(i===undefined||o==="boolean"){e=R(this);if(e){y.set(this,"__className__",e)}if(this.setAttribute){this.setAttribute("class",e||i===false?"":y.get(this,"__className__")||"")}}})},hasClass:function(e){var t,n,r=0;t=" "+e+" ";while(n=this[r++]){if(n.nodeType===1&&(" "+x(R(n))+" ").indexOf(t)>-1){return true}}return false}});var vt=/\r/g;S.fn.extend({val:function(n){var r,e,i,t=this[0];if(!arguments.length){if(t){r=S.valHooks[t.type]||S.valHooks[t.nodeName.toLowerCase()];if(r&&"get"in r&&(e=r.get(t,"value"))!==undefined){return e}e=t.value;if(typeof e==="string"){return e.replace(vt,"")}return e==null?"":e}return}i=S.isFunction(n);return this.each(function(e){var t;if(this.nodeType!==1){return}if(i){t=n.call(this,e,S(this).val())}else{t=n}if(t==null){t=""}else if(typeof t==="number"){t+=""}else if(S.isArray(t)){t=S.map(t,function(e){return e==null?"":e+""})}r=S.valHooks[this.type]||S.valHooks[this.nodeName.toLowerCase()];if(!r||!("set"in r)||r.set(this,t,"value")===undefined){this.value=t}})}});S.extend({valHooks:{option:{get:function(e){var t=S.find.attr(e,"value");return t!=null?t:x(S.text(e))}},select:{get:function(e){var t,n,r,i=e.options,o=e.selectedIndex,a=e.type==="select-one",s=a?null:[],l=a?o+1:i.length;if(o<0){r=l}else{r=a?o:0}for(;r<l;r++){n=i[r];if((n.selected||r===o)&&!n.disabled&&(!n.parentNode.disabled||!S.nodeName(n.parentNode,"optgroup"))){t=S(n).val();if(a){return t}s.push(t)}}return s},set:function(e,t){var n,r,i=e.options,o=S.makeArray(t),a=i.length;while(a--){r=i[a];if(r.selected=S.inArray(S.valHooks.option.get(r),o)>-1){n=true}}if(!n){e.selectedIndex=-1}return o}}}});S.each(["radio","checkbox"],function(){S.valHooks[this]={set:function(e,t){if(S.isArray(t)){return e.checked=S.inArray(S(e).val(),t)>-1}}};if(!g.checkOn){S.valHooks[this].get=function(e){return e.getAttribute("value")===null?"on":e.value}}});var yt=/^(?:focusinfocus|focusoutblur)$/;S.extend(S.event,{trigger:function(e,t,n,r){var i,o,a,s,l,u,c,f=[n||_],d=p.call(e,"type")?e.type:e,h=p.call(e,"namespace")?e.namespace.split("."):[];o=a=n=n||_;if(n.nodeType===3||n.nodeType===8){return}if(yt.test(d+S.event.triggered)){return}if(d.indexOf(".")>-1){h=d.split(".");d=h.shift();h.sort()}l=d.indexOf(":")<0&&"on"+d;e=e[S.expando]?e:new S.Event(d,typeof e==="object"&&e);e.isTrigger=r?2:3;e.namespace=h.join(".");e.rnamespace=e.namespace?new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"):null;e.result=undefined;if(!e.target){e.target=n}t=t==null?[e]:S.makeArray(t,[e]);c=S.event.special[d]||{};if(!r&&c.trigger&&c.trigger.apply(n,t)===false){return}if(!r&&!c.noBubble&&!S.isWindow(n)){s=c.delegateType||d;if(!yt.test(s+d)){o=o.parentNode}for(;o;o=o.parentNode){f.push(o);a=o}if(a===(n.ownerDocument||_)){f.push(a.defaultView||a.parentWindow||w)}}i=0;while((o=f[i++])&&!e.isPropagationStopped()){e.type=i>1?s:c.bindType||d;u=(y.get(o,"events")||{})[e.type]&&y.get(o,"handle");if(u){u.apply(o,t)}u=l&&o[l];if(u&&u.apply&&fe(o)){e.result=u.apply(o,t);if(e.result===false){e.preventDefault()}}}e.type=d;if(!r&&!e.isDefaultPrevented()){if((!c._default||c._default.apply(f.pop(),t)===false)&&fe(n)){if(l&&S.isFunction(n[d])&&!S.isWindow(n)){a=n[l];if(a){n[l]=null}S.event.triggered=d;n[d]();S.event.triggered=undefined;if(a){n[l]=a}}}}return e.result},simulate:function(e,t,n){var r=S.extend(new S.Event,n,{type:e,isSimulated:true});S.event.trigger(r,null,t)}});S.fn.extend({trigger:function(e,t){return this.each(function(){S.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];if(n){return S.event.trigger(e,t,n,true)}}});S.each(("blur focus focusin focusout resize scroll click dblclick "+"mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave "+"change select submit keydown keypress keyup contextmenu").split(" "),function(e,n){S.fn[n]=function(e,t){return arguments.length>0?this.on(n,null,e,t):this.trigger(n)}});S.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}});g.focusin="onfocusin"in w;if(!g.focusin){S.each({focus:"focusin",blur:"focusout"},function(n,r){var i=function(e){S.event.simulate(r,e.target,S.event.fix(e))};S.event.special[r]={setup:function(){var e=this.ownerDocument||this,t=y.access(e,r);if(!t){e.addEventListener(n,i,true)}y.access(e,r,(t||0)+1)},teardown:function(){var e=this.ownerDocument||this,t=y.access(e,r)-1;if(!t){e.removeEventListener(n,i,true);y.remove(e,r)}else{y.access(e,r,t)}}}})}var I=w.location;var mt=S.now();var bt=/\?/;S.parseXML=function(e){var t;if(!e||typeof e!=="string"){return null}try{t=(new w.DOMParser).parseFromString(e,"text/xml")}catch(e){t=undefined}if(!t||t.getElementsByTagName("parsererror").length){S.error("Invalid XML: "+e)}return t};var Et=/\[\]$/,Tt=/\r?\n/g,kt=/^(?:submit|button|image|reset|file)$/i,wt=/^(?:input|select|textarea|keygen)/i;function _t(n,e,r,i){var t;if(S.isArray(e)){S.each(e,function(e,t){if(r||Et.test(n)){i(n,t)}else{_t(n+"["+(typeof t==="object"&&t!=null?e:"")+"]",t,r,i)}})}else if(!r&&S.type(e)==="object"){for(t in e){_t(n+"["+t+"]",e[t],r,i)}}else{i(n,e)}}S.param=function(e,t){var n,r=[],i=function(e,t){var n=S.isFunction(t)?t():t;r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(n==null?"":n)};if(S.isArray(e)||e.jquery&&!S.isPlainObject(e)){S.each(e,function(){i(this.name,this.value)})}else{for(n in e){_t(n,e[n],t,i)}}return r.join("&")};S.fn.extend({serialize:function(){return S.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=S.prop(this,"elements");return e?S.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!S(this).is(":disabled")&&wt.test(this.nodeName)&&!kt.test(e)&&(this.checked||!ke.test(e))}).map(function(e,t){var n=S(this).val();if(n==null){return null}if(S.isArray(n)){return S.map(n,function(e){return{name:t.name,value:e.replace(Tt,"\r\n")}})}return{name:t.name,value:n.replace(Tt,"\r\n")}}).get()}});var St=/%20/g,At=/#.*$/,Pt=/([?&])_=[^&]*/,Ot=/^(.*?):[ \t]*([^\r\n]*)$/gm,Ct=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Lt=/^(?:GET|HEAD)$/,Dt=/^\/\//,xt={},Rt={},It="*/".concat("*"),Mt=_.createElement("a");Mt.href=I.href;function Ft(o){return function(e,t){if(typeof e!=="string"){t=e;e="*"}var n,r=0,i=e.toLowerCase().match(A)||[];if(S.isFunction(t)){while(n=i[r++]){if(n[0]==="+"){n=n.slice(1)||"*";(o[n]=o[n]||[]).unshift(t)}else{(o[n]=o[n]||[]).push(t)}}}}}function Nt(t,i,o,a){var s={},l=t===Rt;function u(e){var r;s[e]=true;S.each(t[e]||[],function(e,t){var n=t(i,o,a);if(typeof n==="string"&&!l&&!s[n]){i.dataTypes.unshift(n);u(n);return false}else if(l){return!(r=n)}});return r}return u(i.dataTypes[0])||!s["*"]&&u("*")}function jt(e,t){var n,r,i=S.ajaxSettings.flatOptions||{};for(n in t){if(t[n]!==undefined){(i[n]?e:r||(r={}))[n]=t[n]}}if(r){S.extend(true,e,r)}return e}function Ut(e,t,n){var r,i,o,a,s=e.contents,l=e.dataTypes;while(l[0]==="*"){l.shift();if(r===undefined){r=e.mimeType||t.getResponseHeader("Content-Type")}}if(r){for(i in s){if(s[i]&&s[i].test(r)){l.unshift(i);break}}}if(l[0]in n){o=l[0]}else{for(i in n){if(!l[0]||e.converters[i+" "+l[0]]){o=i;break}if(!a){a=i}}o=o||a}if(o){if(o!==l[0]){l.unshift(o)}return n[o]}}function Bt(e,t,n,r){var i,o,a,s,l,u={},c=e.dataTypes.slice();if(c[1]){for(a in e.converters){u[a.toLowerCase()]=e.converters[a]}}o=c.shift();while(o){if(e.responseFields[o]){n[e.responseFields[o]]=t}if(!l&&r&&e.dataFilter){t=e.dataFilter(t,e.dataType)}l=o;o=c.shift();if(o){if(o==="*"){o=l}else if(l!=="*"&&l!==o){a=u[l+" "+o]||u["* "+o];if(!a){for(i in u){s=i.split(" ");if(s[1]===o){a=u[l+" "+s[0]]||u["* "+s[0]];if(a){if(a===true){a=u[i]}else if(u[i]!==true){o=s[0];c.unshift(s[1])}break}}}}if(a!==true){if(a&&e.throws){t=a(t)}else{try{t=a(t)}catch(e){return{state:"parsererror",error:a?e:"No conversion from "+l+" to "+o}}}}}}}return{state:"success",data:t}}S.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:I.href,type:"GET",isLocal:Ct.test(I.protocol),global:true,processData:true,async:true,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":It,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":true,"text json":JSON.parse,"text xml":S.parseXML},flatOptions:{url:true,context:true}},ajaxSetup:function(e,t){return t?jt(jt(e,S.ajaxSettings),t):jt(S.ajaxSettings,e)},ajaxPrefilter:Ft(xt),ajaxTransport:Ft(Rt),ajax:function(e,t){if(typeof e==="object"){t=e;e=undefined}t=t||{};var c,f,d,n,h,r,p,g,i,o,v=S.ajaxSetup({},t),y=v.context||v,m=v.context&&(y.nodeType||y.jquery)?S(y):S.event,b=S.Deferred(),E=S.Callbacks("once memory"),T=v.statusCode||{},a={},s={},l="canceled",k={readyState:0,getResponseHeader:function(e){var t;if(p){if(!n){n={};while(t=Ot.exec(d)){n[t[1].toLowerCase()]=t[2]}}t=n[e.toLowerCase()]}return t==null?null:t},getAllResponseHeaders:function(){return p?d:null},setRequestHeader:function(e,t){if(p==null){e=s[e.toLowerCase()]=s[e.toLowerCase()]||e;a[e]=t}return this},overrideMimeType:function(e){if(p==null){v.mimeType=e}return this},statusCode:function(e){var t;if(e){if(p){k.always(e[k.status])}else{for(t in e){T[t]=[T[t],e[t]]}}}return this},abort:function(e){var t=e||l;if(c){c.abort(t)}u(0,t);return this}};b.promise(k);v.url=((e||v.url||I.href)+"").replace(Dt,I.protocol+"//");v.type=t.method||t.type||v.method||v.type;v.dataTypes=(v.dataType||"*").toLowerCase().match(A)||[""];if(v.crossDomain==null){r=_.createElement("a");try{r.href=v.url;r.href=r.href;v.crossDomain=Mt.protocol+"//"+Mt.host!==r.protocol+"//"+r.host}catch(e){v.crossDomain=true}}if(v.data&&v.processData&&typeof v.data!=="string"){v.data=S.param(v.data,v.traditional)}Nt(xt,v,t,k);if(p){return k}g=S.event&&v.global;if(g&&S.active++===0){S.event.trigger("ajaxStart")}v.type=v.type.toUpperCase();v.hasContent=!Lt.test(v.type);f=v.url.replace(At,"");if(!v.hasContent){o=v.url.slice(f.length);if(v.data){f+=(bt.test(f)?"&":"?")+v.data;delete v.data}if(v.cache===false){f=f.replace(Pt,"$1");o=(bt.test(f)?"&":"?")+"_="+mt+++o}v.url=f+o}else if(v.data&&v.processData&&(v.contentType||"").indexOf("application/x-www-form-urlencoded")===0){v.data=v.data.replace(St,"+")}if(v.ifModified){if(S.lastModified[f]){k.setRequestHeader("If-Modified-Since",S.lastModified[f])}if(S.etag[f]){k.setRequestHeader("If-None-Match",S.etag[f])}}if(v.data&&v.hasContent&&v.contentType!==false||t.contentType){k.setRequestHeader("Content-Type",v.contentType)}k.setRequestHeader("Accept",v.dataTypes[0]&&v.accepts[v.dataTypes[0]]?v.accepts[v.dataTypes[0]]+(v.dataTypes[0]!=="*"?", "+It+"; q=0.01":""):v.accepts["*"]);for(i in v.headers){k.setRequestHeader(i,v.headers[i])}if(v.beforeSend&&(v.beforeSend.call(y,k,v)===false||p)){return k.abort()}l="abort";E.add(v.complete);k.done(v.success);k.fail(v.error);c=Nt(Rt,v,t,k);if(!c){u(-1,"No Transport")}else{k.readyState=1;if(g){m.trigger("ajaxSend",[k,v])}if(p){return k}if(v.async&&v.timeout>0){h=w.setTimeout(function(){k.abort("timeout")},v.timeout)}try{p=false;c.send(a,u)}catch(e){if(p){throw e}u(-1,e)}}function u(e,t,n,r){var i,o,a,s,l,u=t;if(p){return}p=true;if(h){w.clearTimeout(h)}c=undefined;d=r||"";k.readyState=e>0?4:0;i=e>=200&&e<300||e===304;if(n){s=Ut(v,k,n)}s=Bt(v,s,k,i);if(i){if(v.ifModified){l=k.getResponseHeader("Last-Modified");if(l){S.lastModified[f]=l}l=k.getResponseHeader("etag");if(l){S.etag[f]=l}}if(e===204||v.type==="HEAD"){u="nocontent"}else if(e===304){u="notmodified"}else{u=s.state;o=s.data;a=s.error;i=!a}}else{a=u;if(e||!u){u="error";if(e<0){e=0}}}k.status=e;k.statusText=(t||u)+"";if(i){b.resolveWith(y,[o,u,k])}else{b.rejectWith(y,[k,u,a])}k.statusCode(T);T=undefined;if(g){m.trigger(i?"ajaxSuccess":"ajaxError",[k,v,i?o:a])}E.fireWith(y,[k,u]);if(g){m.trigger("ajaxComplete",[k,v]);if(!--S.active){S.event.trigger("ajaxStop")}}}return k},getJSON:function(e,t,n){return S.get(e,t,n,"json")},getScript:function(e,t){return S.get(e,undefined,t,"script")}});S.each(["get","post"],function(e,i){S[i]=function(e,t,n,r){if(S.isFunction(t)){r=r||n;n=t;t=undefined}return S.ajax(S.extend({url:e,type:i,dataType:r,data:t,success:n},S.isPlainObject(e)&&e))}});S._evalUrl=function(e){return S.ajax({url:e,type:"GET",dataType:"script",cache:true,async:false,global:false,throws:true})};S.fn.extend({wrapAll:function(e){var t;if(this[0]){if(S.isFunction(e)){e=e.call(this[0])}t=S(e,this[0].ownerDocument).eq(0).clone(true);if(this[0].parentNode){t.insertBefore(this[0])}t.map(function(){var e=this;while(e.firstElementChild){e=e.firstElementChild}return e}).append(this)}return this},wrapInner:function(n){if(S.isFunction(n)){return this.each(function(e){S(this).wrapInner(n.call(this,e))})}return this.each(function(){var e=S(this),t=e.contents();if(t.length){t.wrapAll(n)}else{e.append(n)}})},wrap:function(t){var n=S.isFunction(t);return this.each(function(e){S(this).wrapAll(n?t.call(this,e):t)})},unwrap:function(e){this.parent(e).not("body").each(function(){S(this).replaceWith(this.childNodes)});return this}});S.expr.pseudos.hidden=function(e){return!S.expr.pseudos.visible(e)};S.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)};S.ajaxSettings.xhr=function(){try{return new w.XMLHttpRequest}catch(e){}};var Ht={0:200,1223:204},M=S.ajaxSettings.xhr();g.cors=!!M&&"withCredentials"in M;g.ajax=M=!!M;S.ajaxTransport(function(i){var o,a;if(g.cors||M&&!i.crossDomain){return{send:function(e,t){var n,r=i.xhr();r.open(i.type,i.url,i.async,i.username,i.password);if(i.xhrFields){for(n in i.xhrFields){r[n]=i.xhrFields[n]}}if(i.mimeType&&r.overrideMimeType){r.overrideMimeType(i.mimeType)}if(!i.crossDomain&&!e["X-Requested-With"]){e["X-Requested-With"]="XMLHttpRequest"}for(n in e){r.setRequestHeader(n,e[n])}o=function(e){return function(){if(o){o=a=r.onload=r.onerror=r.onabort=r.onreadystatechange=null;if(e==="abort"){r.abort()}else if(e==="error"){if(typeof r.status!=="number"){t(0,"error")}else{t(r.status,r.statusText)}}else{t(Ht[r.status]||r.status,r.statusText,(r.responseType||"text")!=="text"||typeof r.responseText!=="string"?{binary:r.response}:{text:r.responseText},r.getAllResponseHeaders())}}}};r.onload=o();a=r.onerror=o("error");if(r.onabort!==undefined){r.onabort=a}else{r.onreadystatechange=function(){if(r.readyState===4){w.setTimeout(function(){if(o){a()}})}}}o=o("abort");try{r.send(i.hasContent&&i.data||null)}catch(e){if(o){throw e}}},abort:function(){if(o){o()}}}}});S.ajaxPrefilter(function(e){if(e.crossDomain){e.contents.script=false}});S.ajaxSetup({accepts:{script:"text/javascript, application/javascript, "+"application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){S.globalEval(e);return e}}});S.ajaxPrefilter("script",function(e){if(e.cache===undefined){e.cache=false}if(e.crossDomain){e.type="GET"}});S.ajaxTransport("script",function(n){if(n.crossDomain){var r,i;return{send:function(e,t){r=S("<script>").prop({charset:n.scriptCharset,src:n.url}).on("load error",i=function(e){r.remove();i=null;if(e){t(e.type==="error"?404:200,e.type)}});_.head.appendChild(r[0])},abort:function(){if(i){i()}}}}});var $t=[],Gt=/(=)\?(?=&|$)|\?\?/;S.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=$t.pop()||S.expando+"_"+mt++;this[e]=true;return e}});S.ajaxPrefilter("json jsonp",function(e,t,n){var r,i,o,a=e.jsonp!==false&&(Gt.test(e.url)?"url":typeof e.data==="string"&&(e.contentType||"").indexOf("application/x-www-form-urlencoded")===0&&Gt.test(e.data)&&"data");if(a||e.dataTypes[0]==="jsonp"){r=e.jsonpCallback=S.isFunction(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback;if(a){e[a]=e[a].replace(Gt,"$1"+r)}else if(e.jsonp!==false){e.url+=(bt.test(e.url)?"&":"?")+e.jsonp+"="+r}e.converters["script json"]=function(){if(!o){S.error(r+" was not called")}return o[0]};e.dataTypes[0]="json";i=w[r];w[r]=function(){o=arguments};n.always(function(){if(i===undefined){S(w).removeProp(r)}else{w[r]=i}if(e[r]){e.jsonpCallback=t.jsonpCallback;$t.push(r)}if(o&&S.isFunction(i)){i(o[0])}o=i=undefined});return"script"}});g.createHTMLDocument=function(){var e=_.implementation.createHTMLDocument("").body;e.innerHTML="<form></form><form></form>";return e.childNodes.length===2}();S.parseHTML=function(e,t,n){if(typeof e!=="string"){return[]}if(typeof t==="boolean"){n=t;t=false}var r,i,o;if(!t){if(g.createHTMLDocument){t=_.implementation.createHTMLDocument("");r=t.createElement("base");r.href=_.location.href;t.head.appendChild(r)}else{t=_}}i=J.exec(e);o=!n&&[];if(i){return[t.createElement(i[1])]}i=Pe([e],t,o);if(o&&o.length){S(o).remove()}return S.merge([],i.childNodes)};S.fn.load=function(e,t,n){var r,i,o,a=this,s=e.indexOf(" ");if(s>-1){r=x(e.slice(s));e=e.slice(0,s)}if(S.isFunction(t)){n=t;t=undefined}else if(t&&typeof t==="object"){i="POST"}if(a.length>0){S.ajax({url:e,type:i||"GET",dataType:"html",data:t}).done(function(e){o=arguments;a.html(r?S("<div>").append(S.parseHTML(e)).find(r):e)}).always(n&&function(e,t){a.each(function(){n.apply(this,o||[e.responseText,t,e])})})}return this};S.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){S.fn[t]=function(e){return this.on(t,e)}});S.expr.pseudos.animated=function(t){return S.grep(S.timers,function(e){return t===e.elem}).length};function Vt(e){return S.isWindow(e)?e:e.nodeType===9&&e.defaultView}S.offset={setOffset:function(e,t,n){var r,i,o,a,s,l,u,c=S.css(e,"position"),f=S(e),d={};if(c==="static"){e.style.position="relative"}s=f.offset();o=S.css(e,"top");l=S.css(e,"left");u=(c==="absolute"||c==="fixed")&&(o+l).indexOf("auto")>-1;if(u){r=f.position();a=r.top;i=r.left}else{a=parseFloat(o)||0;i=parseFloat(l)||0}if(S.isFunction(t)){t=t.call(e,n,S.extend({},s))}if(t.top!=null){d.top=t.top-s.top+a}if(t.left!=null){d.left=t.left-s.left+i}if("using"in t){t.using.call(e,d)}else{f.css(d)}}};S.fn.extend({offset:function(t){if(arguments.length){return t===undefined?this:this.each(function(e){S.offset.setOffset(this,t,e)})}var e,n,r,i,o=this[0];if(!o){return}if(!o.getClientRects().length){return{top:0,left:0}}r=o.getBoundingClientRect();if(r.width||r.height){i=o.ownerDocument;n=Vt(i);e=i.documentElement;return{top:r.top+n.pageYOffset-e.clientTop,left:r.left+n.pageXOffset-e.clientLeft}}return r},position:function(){if(!this[0]){return}var e,t,n=this[0],r={top:0,left:0};if(S.css(n,"position")==="fixed"){t=n.getBoundingClientRect()}else{e=this.offsetParent();t=this.offset();if(!S.nodeName(e[0],"html")){r=e.offset()}r={top:r.top+S.css(e[0],"borderTopWidth",true),left:r.left+S.css(e[0],"borderLeftWidth",true)}}return{top:t.top-r.top-S.css(n,"marginTop",true),left:t.left-r.left-S.css(n,"marginLeft",true)}},offsetParent:function(){return this.map(function(){var e=this.offsetParent;while(e&&S.css(e,"position")==="static"){e=e.offsetParent}return e||Oe})}});S.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,i){var o="pageYOffset"===i;S.fn[t]=function(e){return d(this,function(e,t,n){var r=Vt(e);if(n===undefined){return r?r[i]:e[t]}if(r){r.scrollTo(!o?n:r.pageXOffset,o?n:r.pageYOffset)}else{e[t]=n}},t,e,arguments.length)}});S.each(["top","left"],function(e,n){S.cssHooks[n]=qe(g.pixelPosition,function(e,t){if(t){t=k(e,n);return Ke.test(t)?S(e).position()[n]+"px":t}})});S.each({Height:"height",Width:"width"},function(a,s){S.each({padding:"inner"+a,content:s,"":"outer"+a},function(r,o){S.fn[o]=function(e,t){var n=arguments.length&&(r||typeof e!=="boolean"),i=r||(e===true||t===true?"margin":"border");return d(this,function(e,t,n){var r;if(S.isWindow(e)){return o.indexOf("outer")===0?e["inner"+a]:e.document.documentElement["client"+a]}if(e.nodeType===9){r=e.documentElement;return Math.max(e.body["scroll"+a],r["scroll"+a],e.body["offset"+a],r["offset"+a],r["client"+a])}return n===undefined?S.css(e,t,i):S.style(e,t,n,i)},s,n?e:undefined,n)}})});S.fn.extend({bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return arguments.length===1?this.off(e,"**"):this.off(t,e||"**",n)}});S.parseJSON=JSON.parse;if(typeof define==="function"&&define.amd){define("jquery",[],function(){return S})}var Yt=w.jQuery,zt=w.$;S.noConflict=function(e){if(w.$===S){w.$=zt}if(e&&w.jQuery===S){w.jQuery=Yt}return S};if(!F){w.jQuery=w.$=S}return S});(function(e){if(typeof define=="function"&&define.amd){define(["jquery"],e)}else if(typeof exports==="object"){module.exports=e(require("jquery"))}else{e(jQuery)}})(function(a){var s=[],l,u,r=document,i=window,c=r.documentElement,o;a.event.special.inview={add:function(e){s.push({data:e,$element:a(this),element:this});if(!o&&s.length){o=setInterval(t,250)}},remove:function(e){for(var t=0;t<s.length;t++){var n=s[t];if(n.element===this&&n.data.guid===e.guid){s.splice(t,1);break}}if(!s.length){clearInterval(o);o=null}}};function f(){var e,t,n={height:i.innerHeight,width:i.innerWidth};if(!n.height){e=r.compatMode;if(e||!a.support.boxModel){t=e==="CSS1Compat"?c:r.body;n={height:t.clientHeight,width:t.clientWidth}}}return n}function d(){return{top:i.pageYOffset||c.scrollTop||r.body.scrollTop,left:i.pageXOffset||c.scrollLeft||r.body.scrollLeft}}function t(){if(!s.length){return}var e=0,t=a.map(s,function(e){var t=e.data.selector,n=e.$element;return t?n.find(t):n});l=l||f();u=u||d();for(;e<s.length;e++){if(!a.contains(c,t[e][0])){continue}var n=a(t[e]),r={height:n[0].offsetHeight,width:n[0].offsetWidth},i=n.offset(),o=n.data("inview");if(!u||!l){return}if(i.top+r.height>u.top&&i.top<u.top+l.height&&i.left+r.width>u.left&&i.left<u.left+l.width){if(!o){n.data("inview",true).trigger("inview",[true])}}else if(o){n.data("inview",false).trigger("inview",[false])}}}a(i).bind("scroll resize scrollstop",function(){l=u=null});if(!c.addEventListener&&c.attachEvent){c.attachEvent("onfocusin",function(){u=null})}});!function(e){var t=function(u,F,c){"use strict";var N,j;if(function(){var e;var t={lazyClass:"lazyload",loadedClass:"lazyloaded",loadingClass:"lazyloading",preloadClass:"lazypreload",errorClass:"lazyerror",autosizesClass:"lazyautosizes",fastLoadedClass:"ls-is-cached",iframeLoadMode:0,srcAttr:"data-src",srcsetAttr:"data-srcset",sizesAttr:"data-sizes",minSize:40,customMedia:{},init:true,expFactor:1.5,hFac:.8,loadMode:2,loadHidden:true,ricTimeout:0,throttleDelay:125};j=u.lazySizesConfig||u.lazysizesConfig||{};for(e in t){if(!(e in j)){j[e]=t[e]}}}(),!F||!F.getElementsByClassName){return{init:function(){},cfg:j,noSupport:true}}var U=F.documentElement,r=u.HTMLPictureElement,B="addEventListener",H="getAttribute",$=u[B].bind(u),G=u.setTimeout,V=u.requestAnimationFrame||G,s=u.requestIdleCallback,Y=/^picture$/i,i=["load","error","lazyincluded","_lazyloaded"],n={},z=Array.prototype.forEach,K=function(e,t){if(!n[t]){n[t]=new RegExp("(\\s|^)"+t+"(\\s|$)")}return n[t].test(e[H]("class")||"")&&n[t]},W=function(e,t){if(!K(e,t)){e.setAttribute("class",(e[H]("class")||"").trim()+" "+t)}},q=function(e,t){var n;if(n=K(e,t)){e.setAttribute("class",(e[H]("class")||"").replace(n," "))}},X=function(t,n,e){var r=e?B:"removeEventListener";if(e){X(t,n)}i.forEach(function(e){t[r](e,n)})},Q=function(e,t,n,r,i){var o=F.createEvent("Event");if(!n){n={}}n.instance=N;o.initEvent(t,!r,!i);o.detail=n;e.dispatchEvent(o);return o},J=function(e,t){var n;if(!r&&(n=u.picturefill||j.pf)){if(t&&t.src&&!e[H]("srcset")){e.setAttribute("srcset",t.src)}n({reevaluate:true,elements:[e]})}else if(t&&t.src){e.src=t.src}},Z=function(e,t){return(getComputedStyle(e,null)||{})[t]},a=function(e,t,n){n=n||e.offsetWidth;while(n<j.minSize&&t&&!e._lazysizesWidth){n=t.offsetWidth;t=t.parentNode}return n},ee=function(){var n,r;var t=[];var i=[];var o=t;var a=function(){var e=o;o=t.length?i:t;n=true;r=false;while(e.length){e.shift()()}n=false};var e=function(e,t){if(n&&!t){e.apply(this,arguments)}else{o.push(e);if(!r){r=true;(F.hidden?G:V)(a)}}};e._lsFlush=a;return e}(),te=function(n,e){return e?function(){ee(n)}:function(){var e=this;var t=arguments;ee(function(){n.apply(e,t)})}},ne=function(e){var n;var r=0;var i=j.throttleDelay;var o=j.ricTimeout;var t=function(){n=false;r=c.now();e()};var a=s&&o>49?function(){s(t,{timeout:o});if(o!==j.ricTimeout){o=j.ricTimeout}}:te(function(){G(t)},true);return function(e){var t;if(e=e===true){o=33}if(n){return}n=true;t=i-(c.now()-r);if(t<0){t=0}if(e||t<9){a()}else{G(a,t)}}},re=function(e){var t,n;var r=99;var i=function(){t=null;e()};var o=function(){var e=c.now()-n;if(e<r){G(o,r-e)}else{(s||i)(i)}};return function(){n=c.now();if(!t){t=G(o,r)}}},e=function(){var h,p,f,g,e;var v,y,m,b,E,T,k;var o=/^img$/i;var d=/^iframe$/i;var w="onscroll"in u&&!/(gle|ing)bot/.test(navigator.userAgent);var _=0;var S=0;var A=0;var P=-1;var O=function(e){A--;if(!e||A<0||!e.target){A=0}};var C=function(e){if(k==null){k=Z(F.body,"visibility")=="hidden"}return k||!(Z(e.parentNode,"visibility")=="hidden"&&Z(e,"visibility")=="hidden")};var L=function(e,t){var n;var r=e;var i=C(e);m-=t;T+=t;b-=t;E+=t;while(i&&(r=r.offsetParent)&&r!=F.body&&r!=U){i=(Z(r,"opacity")||1)>0;if(i&&Z(r,"overflow")!="visible"){n=r.getBoundingClientRect();i=E>n.left&&b<n.right&&T>n.top-1&&m<n.bottom+1}}return i};var t=function(){var e,t,n,r,i,o,a,s,l,u,c,f;var d=N.elements;if((g=j.loadMode)&&A<8&&(e=d.length)){t=0;P++;for(;t<e;t++){if(!d[t]||d[t]._lazyRace){continue}if(!w||N.prematureUnveil&&N.prematureUnveil(d[t])){M(d[t]);continue}if(!(s=d[t][H]("data-expand"))||!(o=s*1)){o=S}if(!u){u=!j.expand||j.expand<1?U.clientHeight>500&&U.clientWidth>500?500:370:j.expand;N._defEx=u;c=u*j.expFactor;f=j.hFac;k=null;if(S<c&&A<1&&P>2&&g>2&&!F.hidden){S=c;P=0}else if(g>1&&P>1&&A<6){S=u}else{S=_}}if(l!==o){v=innerWidth+o*f;y=innerHeight+o;a=o*-1;l=o}n=d[t].getBoundingClientRect();if((T=n.bottom)>=a&&(m=n.top)<=y&&(E=n.right)>=a*f&&(b=n.left)<=v&&(T||E||b||m)&&(j.loadHidden||C(d[t]))&&(p&&A<3&&!s&&(g<3||P<4)||L(d[t],o))){M(d[t]);i=true;if(A>9){break}}else if(!i&&p&&!r&&A<4&&P<4&&g>2&&(h[0]||j.preloadAfterLoad)&&(h[0]||!s&&(T||E||b||m||d[t][H](j.sizesAttr)!="auto"))){r=h[0]||d[t]}}if(r&&!i){M(r)}}};var n=ne(t);var D=function(e){var t=e.target;if(t._lazyCache){delete t._lazyCache;return}O(e);W(t,j.loadedClass);q(t,j.loadingClass);X(t,x);Q(t,"lazyloaded")};var r=te(D);var x=function(e){r({target:e.target})};var R=function(e,t){var n=e.getAttribute("data-load-mode")||j.iframeLoadMode;if(n==0){e.contentWindow.location.replace(t)}else if(n==1){e.src=t}};var I=function(e){var t;var n=e[H](j.srcsetAttr);if(t=j.customMedia[e[H]("data-media")||e[H]("media")]){e.setAttribute("media",t)}if(n){e.setAttribute("srcset",n)}};var a=te(function(t,e,n,r,i){var o,a,s,l,u,c;if(!(u=Q(t,"lazybeforeunveil",e)).defaultPrevented){if(r){if(n){W(t,j.autosizesClass)}else{t.setAttribute("sizes",r)}}a=t[H](j.srcsetAttr);o=t[H](j.srcAttr);if(i){s=t.parentNode;l=s&&Y.test(s.nodeName||"")}c=e.firesLoad||"src"in t&&(a||o||l);u={target:t};W(t,j.loadingClass);if(c){clearTimeout(f);f=G(O,2500);X(t,x,true)}if(l){z.call(s.getElementsByTagName("source"),I)}if(a){t.setAttribute("srcset",a)}else if(o&&!l){if(d.test(t.nodeName)){R(t,o)}else{t.src=o}}if(i&&(a||l)){J(t,{src:o})}}if(t._lazyRace){delete t._lazyRace}q(t,j.lazyClass);ee(function(){var e=t.complete&&t.naturalWidth>1;if(!c||e){if(e){W(t,j.fastLoadedClass)}D(u);t._lazyCache=true;G(function(){if("_lazyCache"in t){delete t._lazyCache}},9)}if(t.loading=="lazy"){A--}},true)});var M=function(e){if(e._lazyRace){return}var t;var n=o.test(e.nodeName);var r=n&&(e[H](j.sizesAttr)||e[H]("sizes"));var i=r=="auto";if((i||!p)&&n&&(e[H]("src")||e.srcset)&&!e.complete&&!K(e,j.errorClass)&&K(e,j.lazyClass)){return}t=Q(e,"lazyunveilread").detail;if(i){ie.updateElem(e,true,e.offsetWidth)}e._lazyRace=true;A++;a(e,t,i,r,n)};var i=re(function(){j.loadMode=3;n()});var s=function(){if(j.loadMode==3){j.loadMode=2}i()};var l=function(){if(p){return}if(c.now()-e<999){G(l,999);return}p=true;j.loadMode=3;n();$("scroll",s,true)};return{_:function(){e=c.now();N.elements=F.getElementsByClassName(j.lazyClass);h=F.getElementsByClassName(j.lazyClass+" "+j.preloadClass);$("scroll",n,true);$("resize",n,true);$("pageshow",function(e){if(e.persisted){var t=F.querySelectorAll("."+j.loadingClass);if(t.length&&t.forEach){V(function(){t.forEach(function(e){if(e.complete){M(e)}})})}}});if(u.MutationObserver){new MutationObserver(n).observe(U,{childList:true,subtree:true,attributes:true})}else{U[B]("DOMNodeInserted",n,true);U[B]("DOMAttrModified",n,true);setInterval(n,999)}$("hashchange",n,true);["focus","mouseover","click","load","transitionend","animationend"].forEach(function(e){F[B](e,n,true)});if(/d$|^c/.test(F.readyState)){l()}else{$("load",l);F[B]("DOMContentLoaded",n);G(l,2e4)}if(N.elements.length){t();ee._lsFlush()}else{n()}},checkElems:n,unveil:M,_aLSL:s}}(),ie=function(){var n;var o=te(function(e,t,n,r){var i,o,a;e._lazysizesWidth=r;r+="px";e.setAttribute("sizes",r);if(Y.test(t.nodeName||"")){i=t.getElementsByTagName("source");for(o=0,a=i.length;o<a;o++){i[o].setAttribute("sizes",r)}}if(!n.detail.dataAttr){J(e,n.detail)}});var r=function(e,t,n){var r;var i=e.parentNode;if(i){n=a(e,i,n);r=Q(e,"lazybeforesizes",{width:n,dataAttr:!!t});if(!r.defaultPrevented){n=r.detail.width;if(n&&n!==e._lazysizesWidth){o(e,i,r,n)}}}};var e=function(){var e;var t=n.length;if(t){e=0;for(;e<t;e++){r(n[e])}}};var t=re(e);return{_:function(){n=F.getElementsByClassName(j.autosizesClass);$("resize",t)},checkElems:t,updateElem:r}}(),t=function(){if(!t.i&&F.getElementsByClassName){t.i=true;ie._();e._()}};return G(function(){j.init&&t()}),N={cfg:j,autoSizer:ie,loader:e,init:t,uP:J,aC:W,rC:q,hC:K,fire:Q,gW:a,rAF:ee}}(e,e.document,Date);e.lazySizes=t,"object"==typeof module&&module.exports&&(module.exports=t)}("undefined"!=typeof window?window:{});!function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):"undefined"!=typeof exports?module.exports=e(require("jquery")):e(jQuery)}(function(u){"use strict";var a=window.Slick||{};(a=function(){var i=0;return function(e,t){var n,r=this;r.defaults={accessibility:!0,adaptiveHeight:!1,appendArrows:u(e),appendDots:u(e),arrows:!0,asNavFor:null,prevArrow:'<button class="slick-prev" aria-label="Previous" type="button">Previous</button>',nextArrow:'<button class="slick-next" aria-label="Next" type="button">Next</button>',autoplay:!1,autoplaySpeed:3e3,centerMode:!1,centerPadding:"50px",cssEase:"ease",customPaging:function(e,t){return u('<button type="button" />').text(t+1)},dots:!1,dotsClass:"slick-dots",draggable:!0,easing:"linear",edgeFriction:.35,fade:!1,focusOnSelect:!1,focusOnChange:!1,infinite:!0,initialSlide:0,lazyLoad:"ondemand",mobileFirst:!1,pauseOnHover:!0,pauseOnFocus:!0,pauseOnDotsHover:!1,respondTo:"window",responsive:null,rows:1,rtl:!1,slide:"",slidesPerRow:1,slidesToShow:1,slidesToScroll:1,speed:500,swipe:!0,swipeToSlide:!1,touchMove:!0,touchThreshold:5,useCSS:!0,useTransform:!0,variableWidth:!1,vertical:!1,verticalSwiping:!1,waitForAnimate:!0,zIndex:1e3},r.initials={animating:!1,dragging:!1,autoPlayTimer:null,currentDirection:0,currentLeft:null,currentSlide:0,direction:1,$dots:null,listWidth:null,listHeight:null,loadIndex:0,$nextArrow:null,$prevArrow:null,scrolling:!1,slideCount:null,slideWidth:null,$slideTrack:null,$slides:null,sliding:!1,slideOffset:0,swipeLeft:null,swiping:!1,$list:null,touchObject:{},transformsEnabled:!1,unslicked:!1},u.extend(r,r.initials),r.activeBreakpoint=null,r.animType=null,r.animProp=null,r.breakpoints=[],r.breakpointSettings=[],r.cssTransitions=!1,r.focussed=!1,r.interrupted=!1,r.hidden="hidden",r.paused=!0,r.positionProp=null,r.respondTo=null,r.rowCount=1,r.shouldClick=!0,r.$slider=u(e),r.$slidesCache=null,r.transformType=null,r.transitionType=null,r.visibilityChange="visibilitychange",r.windowWidth=0,r.windowTimer=null,n=u(e).data("slick")||{},r.options=u.extend({},r.defaults,t,n),r.currentSlide=r.options.initialSlide,r.originalSettings=r.options,void 0!==document.mozHidden?(r.hidden="mozHidden",r.visibilityChange="mozvisibilitychange"):void 0!==document.webkitHidden&&(r.hidden="webkitHidden",r.visibilityChange="webkitvisibilitychange"),r.autoPlay=u.proxy(r.autoPlay,r),r.autoPlayClear=u.proxy(r.autoPlayClear,r),r.autoPlayIterator=u.proxy(r.autoPlayIterator,r),r.changeSlide=u.proxy(r.changeSlide,r),r.clickHandler=u.proxy(r.clickHandler,r),r.selectHandler=u.proxy(r.selectHandler,r),r.setPosition=u.proxy(r.setPosition,r),r.swipeHandler=u.proxy(r.swipeHandler,r),r.dragHandler=u.proxy(r.dragHandler,r),r.keyHandler=u.proxy(r.keyHandler,r),r.instanceUid=i++,r.htmlExpr=/^(?:\s*(<[\w\W]+>)[^>]*)$/,r.registerBreakpoints(),r.init(!0)}}()).prototype.activateADA=function(){this.$slideTrack.find(".slick-active").attr({"aria-hidden":"false"}).find("a, input, button, select").attr({tabindex:"0"})},a.prototype.addSlide=a.prototype.slickAdd=function(e,t,n){var r=this;if("boolean"==typeof t)n=t,t=null;else if(t<0||t>=r.slideCount)return!1;r.unload(),"number"==typeof t?0===t&&0===r.$slides.length?u(e).appendTo(r.$slideTrack):n?u(e).insertBefore(r.$slides.eq(t)):u(e).insertAfter(r.$slides.eq(t)):!0===n?u(e).prependTo(r.$slideTrack):u(e).appendTo(r.$slideTrack),r.$slides=r.$slideTrack.children(this.options.slide),r.$slideTrack.children(this.options.slide).detach(),r.$slideTrack.append(r.$slides),r.$slides.each(function(e,t){u(t).attr("data-slick-index",e)}),r.$slidesCache=r.$slides,r.reinit()},a.prototype.animateHeight=function(){var e=this;if(1===e.options.slidesToShow&&!0===e.options.adaptiveHeight&&!1===e.options.vertical){var t=e.$slides.eq(e.currentSlide).outerHeight(!0);e.$list.animate({height:t},e.options.speed)}},a.prototype.animateSlide=function(e,t){var n={},r=this;r.animateHeight(),!0===r.options.rtl&&!1===r.options.vertical&&(e=-e),!1===r.transformsEnabled?!1===r.options.vertical?r.$slideTrack.animate({left:e},r.options.speed,r.options.easing,t):r.$slideTrack.animate({top:e},r.options.speed,r.options.easing,t):!1===r.cssTransitions?(!0===r.options.rtl&&(r.currentLeft=-r.currentLeft),u({animStart:r.currentLeft}).animate({animStart:e},{duration:r.options.speed,easing:r.options.easing,step:function(e){e=Math.ceil(e),!1===r.options.vertical?(n[r.animType]="translate("+e+"px, 0px)",r.$slideTrack.css(n)):(n[r.animType]="translate(0px,"+e+"px)",r.$slideTrack.css(n))},complete:function(){t&&t.call()}})):(r.applyTransition(),e=Math.ceil(e),!1===r.options.vertical?n[r.animType]="translate3d("+e+"px, 0px, 0px)":n[r.animType]="translate3d(0px,"+e+"px, 0px)",r.$slideTrack.css(n),t&&setTimeout(function(){r.disableTransition(),t.call()},r.options.speed))},a.prototype.getNavTarget=function(){var e=this,t=e.options.asNavFor;return t&&null!==t&&(t=u(t).not(e.$slider)),t},a.prototype.asNavFor=function(t){var e=this.getNavTarget();null!==e&&"object"==typeof e&&e.each(function(){var e=u(this).slick("getSlick");e.unslicked||e.slideHandler(t,!0)})},a.prototype.applyTransition=function(e){var t=this,n={};!1===t.options.fade?n[t.transitionType]=t.transformType+" "+t.options.speed+"ms "+t.options.cssEase:n[t.transitionType]="opacity "+t.options.speed+"ms "+t.options.cssEase,!1===t.options.fade?t.$slideTrack.css(n):t.$slides.eq(e).css(n)},a.prototype.autoPlay=function(){var e=this;e.autoPlayClear(),e.slideCount>e.options.slidesToShow&&(e.autoPlayTimer=setInterval(e.autoPlayIterator,e.options.autoplaySpeed))},a.prototype.autoPlayClear=function(){var e=this;e.autoPlayTimer&&clearInterval(e.autoPlayTimer)},a.prototype.autoPlayIterator=function(){var e=this,t=e.currentSlide+e.options.slidesToScroll;e.paused||e.interrupted||e.focussed||(!1===e.options.infinite&&(1===e.direction&&e.currentSlide+1===e.slideCount-1?e.direction=0:0===e.direction&&(t=e.currentSlide-e.options.slidesToScroll,e.currentSlide-1==0&&(e.direction=1))),e.slideHandler(t))},a.prototype.buildArrows=function(){var e=this;!0===e.options.arrows&&(e.$prevArrow=u(e.options.prevArrow).addClass("slick-arrow"),e.$nextArrow=u(e.options.nextArrow).addClass("slick-arrow"),e.slideCount>e.options.slidesToShow?(e.$prevArrow.removeClass("slick-hidden").removeAttr("aria-hidden tabindex"),e.$nextArrow.removeClass("slick-hidden").removeAttr("aria-hidden tabindex"),e.htmlExpr.test(e.options.prevArrow)&&e.$prevArrow.prependTo(e.options.appendArrows),e.htmlExpr.test(e.options.nextArrow)&&e.$nextArrow.appendTo(e.options.appendArrows),!0!==e.options.infinite&&e.$prevArrow.addClass("slick-disabled").attr("aria-disabled","true")):e.$prevArrow.add(e.$nextArrow).addClass("slick-hidden").attr({"aria-disabled":"true",tabindex:"-1"}))},a.prototype.buildDots=function(){var e,t,n=this;if(!0===n.options.dots){for(n.$slider.addClass("slick-dotted"),t=u("<ul />").addClass(n.options.dotsClass),e=0;e<=n.getDotCount();e+=1)t.append(u("<li />").append(n.options.customPaging.call(this,n,e)));n.$dots=t.appendTo(n.options.appendDots),n.$dots.find("li").first().addClass("slick-active")}},a.prototype.buildOut=function(){var e=this;e.$slides=e.$slider.children(e.options.slide+":not(.slick-cloned)").addClass("slick-slide"),e.slideCount=e.$slides.length,e.$slides.each(function(e,t){u(t).attr("data-slick-index",e).data("originalStyling",u(t).attr("style")||"")}),e.$slider.addClass("slick-slider"),e.$slideTrack=0===e.slideCount?u('<div class="slick-track"/>').appendTo(e.$slider):e.$slides.wrapAll('<div class="slick-track"/>').parent(),e.$list=e.$slideTrack.wrap('<div class="slick-list"/>').parent(),e.$slideTrack.css("opacity",0),!0!==e.options.centerMode&&!0!==e.options.swipeToSlide||(e.options.slidesToScroll=1),u("img[data-lazy]",e.$slider).not("[src]").addClass("slick-loading"),e.setupInfinite(),e.buildArrows(),e.buildDots(),e.updateDots(),e.setSlideClasses("number"==typeof e.currentSlide?e.currentSlide:0),!0===e.options.draggable&&e.$list.addClass("draggable")},a.prototype.buildRows=function(){var e,t,n,r,i,o,a,s=this;if(r=document.createDocumentFragment(),o=s.$slider.children(),s.options.rows>1){for(a=s.options.slidesPerRow*s.options.rows,i=Math.ceil(o.length/a),e=0;e<i;e++){var l=document.createElement("div");for(t=0;t<s.options.rows;t++){var u=document.createElement("div");for(n=0;n<s.options.slidesPerRow;n++){var c=e*a+(t*s.options.slidesPerRow+n);o.get(c)&&u.appendChild(o.get(c))}l.appendChild(u)}r.appendChild(l)}s.$slider.empty().append(r),s.$slider.children().children().children().css({width:100/s.options.slidesPerRow+"%",display:"inline-block"})}},a.prototype.checkResponsive=function(e,t){var n,r,i,o=this,a=!1,s=o.$slider.width(),l=window.innerWidth||u(window).width();if("window"===o.respondTo?i=l:"slider"===o.respondTo?i=s:"min"===o.respondTo&&(i=Math.min(l,s)),o.options.responsive&&o.options.responsive.length&&null!==o.options.responsive){r=null;for(n in o.breakpoints)o.breakpoints.hasOwnProperty(n)&&(!1===o.originalSettings.mobileFirst?i<o.breakpoints[n]&&(r=o.breakpoints[n]):i>o.breakpoints[n]&&(r=o.breakpoints[n]));null!==r?null!==o.activeBreakpoint?(r!==o.activeBreakpoint||t)&&(o.activeBreakpoint=r,"unslick"===o.breakpointSettings[r]?o.unslick(r):(o.options=u.extend({},o.originalSettings,o.breakpointSettings[r]),!0===e&&(o.currentSlide=o.options.initialSlide),o.refresh(e)),a=r):(o.activeBreakpoint=r,"unslick"===o.breakpointSettings[r]?o.unslick(r):(o.options=u.extend({},o.originalSettings,o.breakpointSettings[r]),!0===e&&(o.currentSlide=o.options.initialSlide),o.refresh(e)),a=r):null!==o.activeBreakpoint&&(o.activeBreakpoint=null,o.options=o.originalSettings,!0===e&&(o.currentSlide=o.options.initialSlide),o.refresh(e),a=r),e||!1===a||o.$slider.trigger("breakpoint",[o,a])}},a.prototype.changeSlide=function(e,t){var n,r,i,o=this,a=u(e.currentTarget);switch(a.is("a")&&e.preventDefault(),a.is("li")||(a=a.closest("li")),i=o.slideCount%o.options.slidesToScroll!=0,n=i?0:(o.slideCount-o.currentSlide)%o.options.slidesToScroll,e.data.message){case"previous":r=0===n?o.options.slidesToScroll:o.options.slidesToShow-n,o.slideCount>o.options.slidesToShow&&o.slideHandler(o.currentSlide-r,!1,t);break;case"next":r=0===n?o.options.slidesToScroll:n,o.slideCount>o.options.slidesToShow&&o.slideHandler(o.currentSlide+r,!1,t);break;case"index":var s=0===e.data.index?0:e.data.index||a.index()*o.options.slidesToScroll;o.slideHandler(o.checkNavigable(s),!1,t),a.children().trigger("focus");break;default:return}},a.prototype.checkNavigable=function(e){var t,n;if(t=this.getNavigableIndexes(),n=0,e>t[t.length-1])e=t[t.length-1];else for(var r in t){if(e<t[r]){e=n;break}n=t[r]}return e},a.prototype.cleanUpEvents=function(){var e=this;e.options.dots&&null!==e.$dots&&(u("li",e.$dots).off("click.slick",e.changeSlide).off("mouseenter.slick",u.proxy(e.interrupt,e,!0)).off("mouseleave.slick",u.proxy(e.interrupt,e,!1)),!0===e.options.accessibility&&e.$dots.off("keydown.slick",e.keyHandler)),e.$slider.off("focus.slick blur.slick"),!0===e.options.arrows&&e.slideCount>e.options.slidesToShow&&(e.$prevArrow&&e.$prevArrow.off("click.slick",e.changeSlide),e.$nextArrow&&e.$nextArrow.off("click.slick",e.changeSlide),!0===e.options.accessibility&&(e.$prevArrow&&e.$prevArrow.off("keydown.slick",e.keyHandler),e.$nextArrow&&e.$nextArrow.off("keydown.slick",e.keyHandler))),e.$list.off("touchstart.slick mousedown.slick",e.swipeHandler),e.$list.off("touchmove.slick mousemove.slick",e.swipeHandler),e.$list.off("touchend.slick mouseup.slick",e.swipeHandler),e.$list.off("touchcancel.slick mouseleave.slick",e.swipeHandler),e.$list.off("click.slick",e.clickHandler),u(document).off(e.visibilityChange,e.visibility),e.cleanUpSlideEvents(),!0===e.options.accessibility&&e.$list.off("keydown.slick",e.keyHandler),!0===e.options.focusOnSelect&&u(e.$slideTrack).children().off("click.slick",e.selectHandler),u(window).off("orientationchange.slick.slick-"+e.instanceUid,e.orientationChange),u(window).off("resize.slick.slick-"+e.instanceUid,e.resize),u("[draggable!=true]",e.$slideTrack).off("dragstart",e.preventDefault),u(window).off("load.slick.slick-"+e.instanceUid,e.setPosition)},a.prototype.cleanUpSlideEvents=function(){var e=this;e.$list.off("mouseenter.slick",u.proxy(e.interrupt,e,!0)),e.$list.off("mouseleave.slick",u.proxy(e.interrupt,e,!1))},a.prototype.cleanUpRows=function(){var e,t=this;t.options.rows>1&&((e=t.$slides.children().children()).removeAttr("style"),t.$slider.empty().append(e))},a.prototype.clickHandler=function(e){!1===this.shouldClick&&(e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault())},a.prototype.destroy=function(e){var t=this;t.autoPlayClear(),t.touchObject={},t.cleanUpEvents(),u(".slick-cloned",t.$slider).detach(),t.$dots&&t.$dots.remove(),t.$prevArrow&&t.$prevArrow.length&&(t.$prevArrow.removeClass("slick-disabled slick-arrow slick-hidden").removeAttr("aria-hidden aria-disabled tabindex").css("display",""),t.htmlExpr.test(t.options.prevArrow)&&t.$prevArrow.remove()),t.$nextArrow&&t.$nextArrow.length&&(t.$nextArrow.removeClass("slick-disabled slick-arrow slick-hidden").removeAttr("aria-hidden aria-disabled tabindex").css("display",""),t.htmlExpr.test(t.options.nextArrow)&&t.$nextArrow.remove()),t.$slides&&(t.$slides.removeClass("slick-slide slick-active slick-center slick-visible slick-current").removeAttr("aria-hidden").removeAttr("data-slick-index").each(function(){u(this).attr("style",u(this).data("originalStyling"))}),t.$slideTrack.children(this.options.slide).detach(),t.$slideTrack.detach(),t.$list.detach(),t.$slider.append(t.$slides)),t.cleanUpRows(),t.$slider.removeClass("slick-slider"),t.$slider.removeClass("slick-initialized"),t.$slider.removeClass("slick-dotted"),t.unslicked=!0,e||t.$slider.trigger("destroy",[t])},a.prototype.disableTransition=function(e){var t=this,n={};n[t.transitionType]="",!1===t.options.fade?t.$slideTrack.css(n):t.$slides.eq(e).css(n)},a.prototype.fadeSlide=function(e,t){var n=this;!1===n.cssTransitions?(n.$slides.eq(e).css({zIndex:n.options.zIndex}),n.$slides.eq(e).animate({opacity:1},n.options.speed,n.options.easing,t)):(n.applyTransition(e),n.$slides.eq(e).css({opacity:1,zIndex:n.options.zIndex}),t&&setTimeout(function(){n.disableTransition(e),t.call()},n.options.speed))},a.prototype.fadeSlideOut=function(e){var t=this;!1===t.cssTransitions?t.$slides.eq(e).animate({opacity:0,zIndex:t.options.zIndex-2},t.options.speed,t.options.easing):(t.applyTransition(e),t.$slides.eq(e).css({opacity:0,zIndex:t.options.zIndex-2}))},a.prototype.filterSlides=a.prototype.slickFilter=function(e){var t=this;null!==e&&(t.$slidesCache=t.$slides,t.unload(),t.$slideTrack.children(this.options.slide).detach(),t.$slidesCache.filter(e).appendTo(t.$slideTrack),t.reinit())},a.prototype.focusHandler=function(){var n=this;n.$slider.off("focus.slick blur.slick").on("focus.slick blur.slick","*",function(e){e.stopImmediatePropagation();var t=u(this);setTimeout(function(){n.options.pauseOnFocus&&(n.focussed=t.is(":focus"),n.autoPlay())},0)})},a.prototype.getCurrent=a.prototype.slickCurrentSlide=function(){return this.currentSlide},a.prototype.getDotCount=function(){var e=this,t=0,n=0,r=0;if(!0===e.options.infinite)if(e.slideCount<=e.options.slidesToShow)++r;else for(;t<e.slideCount;)++r,t=n+e.options.slidesToScroll,n+=e.options.slidesToScroll<=e.options.slidesToShow?e.options.slidesToScroll:e.options.slidesToShow;else if(!0===e.options.centerMode)r=e.slideCount;else if(e.options.asNavFor)for(;t<e.slideCount;)++r,t=n+e.options.slidesToScroll,n+=e.options.slidesToScroll<=e.options.slidesToShow?e.options.slidesToScroll:e.options.slidesToShow;else r=1+Math.ceil((e.slideCount-e.options.slidesToShow)/e.options.slidesToScroll);return r-1},a.prototype.getLeft=function(e){var t,n,r,i,o=this,a=0;return o.slideOffset=0,n=o.$slides.first().outerHeight(!0),!0===o.options.infinite?(o.slideCount>o.options.slidesToShow&&(o.slideOffset=o.slideWidth*o.options.slidesToShow*-1,i=-1,!0===o.options.vertical&&!0===o.options.centerMode&&(2===o.options.slidesToShow?i=-1.5:1===o.options.slidesToShow&&(i=-2)),a=n*o.options.slidesToShow*i),o.slideCount%o.options.slidesToScroll!=0&&e+o.options.slidesToScroll>o.slideCount&&o.slideCount>o.options.slidesToShow&&(e>o.slideCount?(o.slideOffset=(o.options.slidesToShow-(e-o.slideCount))*o.slideWidth*-1,a=(o.options.slidesToShow-(e-o.slideCount))*n*-1):(o.slideOffset=o.slideCount%o.options.slidesToScroll*o.slideWidth*-1,a=o.slideCount%o.options.slidesToScroll*n*-1))):e+o.options.slidesToShow>o.slideCount&&(o.slideOffset=(e+o.options.slidesToShow-o.slideCount)*o.slideWidth,a=(e+o.options.slidesToShow-o.slideCount)*n),o.slideCount<=o.options.slidesToShow&&(o.slideOffset=0,a=0),!0===o.options.centerMode&&o.slideCount<=o.options.slidesToShow?o.slideOffset=o.slideWidth*Math.floor(o.options.slidesToShow)/2-o.slideWidth*o.slideCount/2:!0===o.options.centerMode&&!0===o.options.infinite?o.slideOffset+=o.slideWidth*Math.floor(o.options.slidesToShow/2)-o.slideWidth:!0===o.options.centerMode&&(o.slideOffset=0,o.slideOffset+=o.slideWidth*Math.floor(o.options.slidesToShow/2)),t=!1===o.options.vertical?e*o.slideWidth*-1+o.slideOffset:e*n*-1+a,!0===o.options.variableWidth&&(r=o.slideCount<=o.options.slidesToShow||!1===o.options.infinite?o.$slideTrack.children(".slick-slide").eq(e):o.$slideTrack.children(".slick-slide").eq(e+o.options.slidesToShow),t=!0===o.options.rtl?r[0]?-1*(o.$slideTrack.width()-r[0].offsetLeft-r.width()):0:r[0]?-1*r[0].offsetLeft:0,!0===o.options.centerMode&&(r=o.slideCount<=o.options.slidesToShow||!1===o.options.infinite?o.$slideTrack.children(".slick-slide").eq(e):o.$slideTrack.children(".slick-slide").eq(e+o.options.slidesToShow+1),t=!0===o.options.rtl?r[0]?-1*(o.$slideTrack.width()-r[0].offsetLeft-r.width()):0:r[0]?-1*r[0].offsetLeft:0,t+=(o.$list.width()-r.outerWidth())/2)),t},a.prototype.getOption=a.prototype.slickGetOption=function(e){return this.options[e]},a.prototype.getNavigableIndexes=function(){var e,t=this,n=0,r=0,i=[];for(!1===t.options.infinite?e=t.slideCount:(n=-1*t.options.slidesToScroll,r=-1*t.options.slidesToScroll,e=2*t.slideCount);n<e;)i.push(n),n=r+t.options.slidesToScroll,r+=t.options.slidesToScroll<=t.options.slidesToShow?t.options.slidesToScroll:t.options.slidesToShow;return i},a.prototype.getSlick=function(){return this},a.prototype.getSlideCount=function(){var n,r,i=this;return r=!0===i.options.centerMode?i.slideWidth*Math.floor(i.options.slidesToShow/2):0,!0===i.options.swipeToSlide?(i.$slideTrack.find(".slick-slide").each(function(e,t){if(t.offsetLeft-r+u(t).outerWidth()/2>-1*i.swipeLeft)return n=t,!1}),Math.abs(u(n).attr("data-slick-index")-i.currentSlide)||1):i.options.slidesToScroll},a.prototype.goTo=a.prototype.slickGoTo=function(e,t){this.changeSlide({data:{message:"index",index:parseInt(e)}},t)},a.prototype.init=function(e){var t=this;u(t.$slider).hasClass("slick-initialized")||(u(t.$slider).addClass("slick-initialized"),t.buildRows(),t.buildOut(),t.setProps(),t.startLoad(),t.loadSlider(),t.initializeEvents(),t.updateArrows(),t.updateDots(),t.checkResponsive(!0),t.focusHandler()),e&&t.$slider.trigger("init",[t]),!0===t.options.accessibility&&t.initADA(),t.options.autoplay&&(t.paused=!1,t.autoPlay())},a.prototype.initADA=function(){var n=this,r=Math.ceil(n.slideCount/n.options.slidesToShow),i=n.getNavigableIndexes().filter(function(e){return e>=0&&e<n.slideCount});n.$slides.add(n.$slideTrack.find(".slick-cloned")).attr({"aria-hidden":"true",tabindex:"-1"}).find("a, input, button, select").attr({tabindex:"-1"}),null!==n.$dots&&(n.$slides.not(n.$slideTrack.find(".slick-cloned")).each(function(e){var t=i.indexOf(e);u(this).attr({role:"tabpanel",id:"slick-slide"+n.instanceUid+e,tabindex:-1}),-1!==t&&u(this).attr({"aria-describedby":"slick-slide-control"+n.instanceUid+t})}),n.$dots.attr("role","tablist").find("li").each(function(e){var t=i[e];u(this).attr({role:"presentation"}),u(this).find("button").first().attr({role:"tab",id:"slick-slide-control"+n.instanceUid+e,"aria-controls":"slick-slide"+n.instanceUid+t,"aria-label":e+1+" of "+r,"aria-selected":null,tabindex:"-1"})}).eq(n.currentSlide).find("button").attr({"aria-selected":"true",tabindex:"0"}).end());for(var e=n.currentSlide,t=e+n.options.slidesToShow;e<t;e++)n.$slides.eq(e).attr("tabindex",0);n.activateADA()},a.prototype.initArrowEvents=function(){var e=this;!0===e.options.arrows&&e.slideCount>e.options.slidesToShow&&(e.$prevArrow.off("click.slick").on("click.slick",{message:"previous"},e.changeSlide),e.$nextArrow.off("click.slick").on("click.slick",{message:"next"},e.changeSlide),!0===e.options.accessibility&&(e.$prevArrow.on("keydown.slick",e.keyHandler),e.$nextArrow.on("keydown.slick",e.keyHandler)))},a.prototype.initDotEvents=function(){var e=this;!0===e.options.dots&&(u("li",e.$dots).on("click.slick",{message:"index"},e.changeSlide),!0===e.options.accessibility&&e.$dots.on("keydown.slick",e.keyHandler)),!0===e.options.dots&&!0===e.options.pauseOnDotsHover&&u("li",e.$dots).on("mouseenter.slick",u.proxy(e.interrupt,e,!0)).on("mouseleave.slick",u.proxy(e.interrupt,e,!1))},a.prototype.initSlideEvents=function(){var e=this;e.options.pauseOnHover&&(e.$list.on("mouseenter.slick",u.proxy(e.interrupt,e,!0)),e.$list.on("mouseleave.slick",u.proxy(e.interrupt,e,!1)))},a.prototype.initializeEvents=function(){var e=this;e.initArrowEvents(),e.initDotEvents(),e.initSlideEvents(),e.$list.on("touchstart.slick mousedown.slick",{action:"start"},e.swipeHandler),e.$list.on("touchmove.slick mousemove.slick",{action:"move"},e.swipeHandler),e.$list.on("touchend.slick mouseup.slick",{action:"end"},e.swipeHandler),e.$list.on("touchcancel.slick mouseleave.slick",{action:"end"},e.swipeHandler),e.$list.on("click.slick",e.clickHandler),u(document).on(e.visibilityChange,u.proxy(e.visibility,e)),!0===e.options.accessibility&&e.$list.on("keydown.slick",e.keyHandler),!0===e.options.focusOnSelect&&u(e.$slideTrack).children().on("click.slick",e.selectHandler),u(window).on("orientationchange.slick.slick-"+e.instanceUid,u.proxy(e.orientationChange,e)),u(window).on("resize.slick.slick-"+e.instanceUid,u.proxy(e.resize,e)),u("[draggable!=true]",e.$slideTrack).on("dragstart",e.preventDefault),u(window).on("load.slick.slick-"+e.instanceUid,e.setPosition),u(e.setPosition)},a.prototype.initUI=function(){var e=this;!0===e.options.arrows&&e.slideCount>e.options.slidesToShow&&(e.$prevArrow.show(),e.$nextArrow.show()),!0===e.options.dots&&e.slideCount>e.options.slidesToShow&&e.$dots.show()},a.prototype.keyHandler=function(e){var t=this;e.target.tagName.match("TEXTAREA|INPUT|SELECT")||(37===e.keyCode&&!0===t.options.accessibility?t.changeSlide({data:{message:!0===t.options.rtl?"next":"previous"}}):39===e.keyCode&&!0===t.options.accessibility&&t.changeSlide({data:{message:!0===t.options.rtl?"previous":"next"}}))},a.prototype.lazyLoad=function(){function e(e){u("img[data-lazy]",e).each(function(){var e=u(this),t=u(this).attr("data-lazy"),n=u(this).attr("data-srcset"),r=u(this).attr("data-sizes")||o.$slider.attr("data-sizes"),i=document.createElement("img");i.onload=function(){e.animate({opacity:0},100,function(){n&&(e.attr("srcset",n),r&&e.attr("sizes",r)),e.attr("src",t).animate({opacity:1},200,function(){e.removeAttr("data-lazy data-srcset data-sizes").removeClass("slick-loading")}),o.$slider.trigger("lazyLoaded",[o,e,t])})},i.onerror=function(){e.removeAttr("data-lazy").removeClass("slick-loading").addClass("slick-lazyload-error"),o.$slider.trigger("lazyLoadError",[o,e,t])},i.src=t})}var t,n,r,o=this;if(!0===o.options.centerMode?!0===o.options.infinite?r=(n=o.currentSlide+(o.options.slidesToShow/2+1))+o.options.slidesToShow+2:(n=Math.max(0,o.currentSlide-(o.options.slidesToShow/2+1)),r=o.options.slidesToShow/2+1+2+o.currentSlide):(n=o.options.infinite?o.options.slidesToShow+o.currentSlide:o.currentSlide,r=Math.ceil(n+o.options.slidesToShow),!0===o.options.fade&&(n>0&&n--,r<=o.slideCount&&r++)),t=o.$slider.find(".slick-slide").slice(n,r),"anticipated"===o.options.lazyLoad)for(var i=n-1,a=r,s=o.$slider.find(".slick-slide"),l=0;l<o.options.slidesToScroll;l++)i<0&&(i=o.slideCount-1),t=(t=t.add(s.eq(i))).add(s.eq(a)),i--,a++;e(t),o.slideCount<=o.options.slidesToShow?e(o.$slider.find(".slick-slide")):o.currentSlide>=o.slideCount-o.options.slidesToShow?e(o.$slider.find(".slick-cloned").slice(0,o.options.slidesToShow)):0===o.currentSlide&&e(o.$slider.find(".slick-cloned").slice(-1*o.options.slidesToShow))},a.prototype.loadSlider=function(){var e=this;e.setPosition(),e.$slideTrack.css({opacity:1}),e.$slider.removeClass("slick-loading"),e.initUI(),"progressive"===e.options.lazyLoad&&e.progressiveLazyLoad()},a.prototype.next=a.prototype.slickNext=function(){this.changeSlide({data:{message:"next"}})},a.prototype.orientationChange=function(){var e=this;e.checkResponsive(),e.setPosition()},a.prototype.pause=a.prototype.slickPause=function(){var e=this;e.autoPlayClear(),e.paused=!0},a.prototype.play=a.prototype.slickPlay=function(){var e=this;e.autoPlay(),e.options.autoplay=!0,e.paused=!1,e.focussed=!1,e.interrupted=!1},a.prototype.postSlide=function(e){var t=this;t.unslicked||(t.$slider.trigger("afterChange",[t,e]),t.animating=!1,t.slideCount>t.options.slidesToShow&&t.setPosition(),t.swipeLeft=null,t.options.autoplay&&t.autoPlay(),!0===t.options.accessibility&&(t.initADA(),t.options.focusOnChange&&u(t.$slides.get(t.currentSlide)).attr("tabindex",0).focus()))},a.prototype.prev=a.prototype.slickPrev=function(){this.changeSlide({data:{message:"previous"}})},a.prototype.preventDefault=function(e){e.preventDefault()},a.prototype.progressiveLazyLoad=function(e){e=e||1;var t,n,r,i,o,a=this,s=u("img[data-lazy]",a.$slider);s.length?(t=s.first(),n=t.attr("data-lazy"),r=t.attr("data-srcset"),i=t.attr("data-sizes")||a.$slider.attr("data-sizes"),(o=document.createElement("img")).onload=function(){r&&(t.attr("srcset",r),i&&t.attr("sizes",i)),t.attr("src",n).removeAttr("data-lazy data-srcset data-sizes").removeClass("slick-loading"),!0===a.options.adaptiveHeight&&a.setPosition(),a.$slider.trigger("lazyLoaded",[a,t,n]),a.progressiveLazyLoad()},o.onerror=function(){e<3?setTimeout(function(){a.progressiveLazyLoad(e+1)},500):(t.removeAttr("data-lazy").removeClass("slick-loading").addClass("slick-lazyload-error"),a.$slider.trigger("lazyLoadError",[a,t,n]),a.progressiveLazyLoad())},o.src=n):a.$slider.trigger("allImagesLoaded",[a])},a.prototype.refresh=function(e){var t,n,r=this;n=r.slideCount-r.options.slidesToShow,!r.options.infinite&&r.currentSlide>n&&(r.currentSlide=n),r.slideCount<=r.options.slidesToShow&&(r.currentSlide=0),t=r.currentSlide,r.destroy(!0),u.extend(r,r.initials,{currentSlide:t}),r.init(),e||r.changeSlide({data:{message:"index",index:t}},!1)},a.prototype.registerBreakpoints=function(){var e,t,n,r=this,i=r.options.responsive||null;if("array"===u.type(i)&&i.length){r.respondTo=r.options.respondTo||"window";for(e in i)if(n=r.breakpoints.length-1,i.hasOwnProperty(e)){for(t=i[e].breakpoint;n>=0;)r.breakpoints[n]&&r.breakpoints[n]===t&&r.breakpoints.splice(n,1),n--;r.breakpoints.push(t),r.breakpointSettings[t]=i[e].settings}r.breakpoints.sort(function(e,t){return r.options.mobileFirst?e-t:t-e})}},a.prototype.reinit=function(){var e=this;e.$slides=e.$slideTrack.children(e.options.slide).addClass("slick-slide"),e.slideCount=e.$slides.length,e.currentSlide>=e.slideCount&&0!==e.currentSlide&&(e.currentSlide=e.currentSlide-e.options.slidesToScroll),e.slideCount<=e.options.slidesToShow&&(e.currentSlide=0),e.registerBreakpoints(),e.setProps(),e.setupInfinite(),e.buildArrows(),e.updateArrows(),e.initArrowEvents(),e.buildDots(),e.updateDots(),e.initDotEvents(),e.cleanUpSlideEvents(),e.initSlideEvents(),e.checkResponsive(!1,!0),!0===e.options.focusOnSelect&&u(e.$slideTrack).children().on("click.slick",e.selectHandler),e.setSlideClasses("number"==typeof e.currentSlide?e.currentSlide:0),e.setPosition(),e.focusHandler(),e.paused=!e.options.autoplay,e.autoPlay(),e.$slider.trigger("reInit",[e])},a.prototype.resize=function(){var e=this;u(window).width()!==e.windowWidth&&(clearTimeout(e.windowDelay),e.windowDelay=window.setTimeout(function(){e.windowWidth=u(window).width(),e.checkResponsive(),e.unslicked||e.setPosition()},50))},a.prototype.removeSlide=a.prototype.slickRemove=function(e,t,n){var r=this;if(e="boolean"==typeof e?!0===(t=e)?0:r.slideCount-1:!0===t?--e:e,r.slideCount<1||e<0||e>r.slideCount-1)return!1;r.unload(),!0===n?r.$slideTrack.children().remove():r.$slideTrack.children(this.options.slide).eq(e).remove(),r.$slides=r.$slideTrack.children(this.options.slide),r.$slideTrack.children(this.options.slide).detach(),r.$slideTrack.append(r.$slides),r.$slidesCache=r.$slides,r.reinit()},a.prototype.setCSS=function(e){var t,n,r=this,i={};!0===r.options.rtl&&(e=-e),t="left"==r.positionProp?Math.ceil(e)+"px":"0px",n="top"==r.positionProp?Math.ceil(e)+"px":"0px",i[r.positionProp]=e,!1===r.transformsEnabled?r.$slideTrack.css(i):(i={},!1===r.cssTransitions?(i[r.animType]="translate("+t+", "+n+")",r.$slideTrack.css(i)):(i[r.animType]="translate3d("+t+", "+n+", 0px)",r.$slideTrack.css(i)))},a.prototype.setDimensions=function(){var e=this;!1===e.options.vertical?!0===e.options.centerMode&&e.$list.css({padding:"0px "+e.options.centerPadding}):(e.$list.height(e.$slides.first().outerHeight(!0)*e.options.slidesToShow),!0===e.options.centerMode&&e.$list.css({padding:e.options.centerPadding+" 0px"})),e.listWidth=e.$list.width(),e.listHeight=e.$list.height(),!1===e.options.vertical&&!1===e.options.variableWidth?(e.slideWidth=Math.ceil(e.listWidth/e.options.slidesToShow),e.$slideTrack.width(Math.ceil(e.slideWidth*e.$slideTrack.children(".slick-slide").length))):!0===e.options.variableWidth?e.$slideTrack.width(5e3*e.slideCount):(e.slideWidth=Math.ceil(e.listWidth),e.$slideTrack.height(Math.ceil(e.$slides.first().outerHeight(!0)*e.$slideTrack.children(".slick-slide").length)));var t=e.$slides.first().outerWidth(!0)-e.$slides.first().width();!1===e.options.variableWidth&&e.$slideTrack.children(".slick-slide").width(e.slideWidth-t)},a.prototype.setFade=function(){var n,r=this;r.$slides.each(function(e,t){n=r.slideWidth*e*-1,!0===r.options.rtl?u(t).css({position:"relative",right:n,top:0,zIndex:r.options.zIndex-2,opacity:0}):u(t).css({position:"relative",left:n,top:0,zIndex:r.options.zIndex-2,opacity:0})}),r.$slides.eq(r.currentSlide).css({zIndex:r.options.zIndex-1,opacity:1})},a.prototype.setHeight=function(){var e=this;if(1===e.options.slidesToShow&&!0===e.options.adaptiveHeight&&!1===e.options.vertical){var t=e.$slides.eq(e.currentSlide).outerHeight(!0);e.$list.css("height",t)}},a.prototype.setOption=a.prototype.slickSetOption=function(){var e,t,n,r,i,o=this,a=!1;if("object"===u.type(arguments[0])?(n=arguments[0],a=arguments[1],i="multiple"):"string"===u.type(arguments[0])&&(n=arguments[0],r=arguments[1],a=arguments[2],"responsive"===arguments[0]&&"array"===u.type(arguments[1])?i="responsive":void 0!==arguments[1]&&(i="single")),"single"===i)o.options[n]=r;else if("multiple"===i)u.each(n,function(e,t){o.options[e]=t});else if("responsive"===i)for(t in r)if("array"!==u.type(o.options.responsive))o.options.responsive=[r[t]];else{for(e=o.options.responsive.length-1;e>=0;)o.options.responsive[e].breakpoint===r[t].breakpoint&&o.options.responsive.splice(e,1),e--;o.options.responsive.push(r[t])}a&&(o.unload(),o.reinit())},a.prototype.setPosition=function(){var e=this;e.setDimensions(),e.setHeight(),!1===e.options.fade?e.setCSS(e.getLeft(e.currentSlide)):e.setFade(),e.$slider.trigger("setPosition",[e])},a.prototype.setProps=function(){var e=this,t=document.body.style;e.positionProp=!0===e.options.vertical?"top":"left","top"===e.positionProp?e.$slider.addClass("slick-vertical"):e.$slider.removeClass("slick-vertical"),void 0===t.WebkitTransition&&void 0===t.MozTransition&&void 0===t.msTransition||!0===e.options.useCSS&&(e.cssTransitions=!0),e.options.fade&&("number"==typeof e.options.zIndex?e.options.zIndex<3&&(e.options.zIndex=3):e.options.zIndex=e.defaults.zIndex),void 0!==t.OTransform&&(e.animType="OTransform",e.transformType="-o-transform",e.transitionType="OTransition",void 0===t.perspectiveProperty&&void 0===t.webkitPerspective&&(e.animType=!1)),void 0!==t.MozTransform&&(e.animType="MozTransform",e.transformType="-moz-transform",e.transitionType="MozTransition",void 0===t.perspectiveProperty&&void 0===t.MozPerspective&&(e.animType=!1)),void 0!==t.webkitTransform&&(e.animType="webkitTransform",e.transformType="-webkit-transform",e.transitionType="webkitTransition",void 0===t.perspectiveProperty&&void 0===t.webkitPerspective&&(e.animType=!1)),void 0!==t.msTransform&&(e.animType="msTransform",e.transformType="-ms-transform",e.transitionType="msTransition",void 0===t.msTransform&&(e.animType=!1)),void 0!==t.transform&&!1!==e.animType&&(e.animType="transform",e.transformType="transform",e.transitionType="transition"),e.transformsEnabled=e.options.useTransform&&null!==e.animType&&!1!==e.animType},a.prototype.setSlideClasses=function(e){var t,n,r,i,o=this;if(n=o.$slider.find(".slick-slide").removeClass("slick-active slick-center slick-current").attr("aria-hidden","true"),o.$slides.eq(e).addClass("slick-current"),!0===o.options.centerMode){var a=o.options.slidesToShow%2==0?1:0;t=Math.floor(o.options.slidesToShow/2),!0===o.options.infinite&&(e>=t&&e<=o.slideCount-1-t?o.$slides.slice(e-t+a,e+t+1).addClass("slick-active").attr("aria-hidden","false"):(r=o.options.slidesToShow+e,n.slice(r-t+1+a,r+t+2).addClass("slick-active").attr("aria-hidden","false")),0===e?n.eq(n.length-1-o.options.slidesToShow).addClass("slick-center"):e===o.slideCount-1&&n.eq(o.options.slidesToShow).addClass("slick-center")),o.$slides.eq(e).addClass("slick-center")}else e>=0&&e<=o.slideCount-o.options.slidesToShow?o.$slides.slice(e,e+o.options.slidesToShow).addClass("slick-active").attr("aria-hidden","false"):n.length<=o.options.slidesToShow?n.addClass("slick-active").attr("aria-hidden","false"):(i=o.slideCount%o.options.slidesToShow,r=!0===o.options.infinite?o.options.slidesToShow+e:e,o.options.slidesToShow==o.options.slidesToScroll&&o.slideCount-e<o.options.slidesToShow?n.slice(r-(o.options.slidesToShow-i),r+i).addClass("slick-active").attr("aria-hidden","false"):n.slice(r,r+o.options.slidesToShow).addClass("slick-active").attr("aria-hidden","false"));"ondemand"!==o.options.lazyLoad&&"anticipated"!==o.options.lazyLoad||o.lazyLoad()},a.prototype.setupInfinite=function(){var e,t,n,r=this;if(!0===r.options.fade&&(r.options.centerMode=!1),!0===r.options.infinite&&!1===r.options.fade&&(t=null,r.slideCount>r.options.slidesToShow)){for(n=!0===r.options.centerMode?r.options.slidesToShow+1:r.options.slidesToShow,e=r.slideCount;e>r.slideCount-n;e-=1)t=e-1,u(r.$slides[t]).clone(!0).attr("id","").attr("data-slick-index",t-r.slideCount).prependTo(r.$slideTrack).addClass("slick-cloned");for(e=0;e<n+r.slideCount;e+=1)t=e,u(r.$slides[t]).clone(!0).attr("id","").attr("data-slick-index",t+r.slideCount).appendTo(r.$slideTrack).addClass("slick-cloned");r.$slideTrack.find(".slick-cloned").find("[id]").each(function(){u(this).attr("id","")})}},a.prototype.interrupt=function(e){var t=this;e||t.autoPlay(),t.interrupted=e},a.prototype.selectHandler=function(e){var t=this,n=u(e.target).is(".slick-slide")?u(e.target):u(e.target).parents(".slick-slide"),r=parseInt(n.attr("data-slick-index"));r||(r=0),t.slideCount<=t.options.slidesToShow?t.slideHandler(r,!1,!0):t.slideHandler(r)},a.prototype.slideHandler=function(e,t,n){var r,i,o,a,s,l=null,u=this;if(t=t||!1,!(!0===u.animating&&!0===u.options.waitForAnimate||!0===u.options.fade&&u.currentSlide===e))if(!1===t&&u.asNavFor(e),r=e,l=u.getLeft(r),a=u.getLeft(u.currentSlide),u.currentLeft=null===u.swipeLeft?a:u.swipeLeft,!1===u.options.infinite&&!1===u.options.centerMode&&(e<0||e>u.getDotCount()*u.options.slidesToScroll))!1===u.options.fade&&(r=u.currentSlide,!0!==n?u.animateSlide(a,function(){u.postSlide(r)}):u.postSlide(r));else if(!1===u.options.infinite&&!0===u.options.centerMode&&(e<0||e>u.slideCount-u.options.slidesToScroll))!1===u.options.fade&&(r=u.currentSlide,!0!==n?u.animateSlide(a,function(){u.postSlide(r)}):u.postSlide(r));else{if(u.options.autoplay&&clearInterval(u.autoPlayTimer),i=r<0?u.slideCount%u.options.slidesToScroll!=0?u.slideCount-u.slideCount%u.options.slidesToScroll:u.slideCount+r:r>=u.slideCount?u.slideCount%u.options.slidesToScroll!=0?0:r-u.slideCount:r,u.animating=!0,u.$slider.trigger("beforeChange",[u,u.currentSlide,i]),o=u.currentSlide,u.currentSlide=i,u.setSlideClasses(u.currentSlide),u.options.asNavFor&&(s=(s=u.getNavTarget()).slick("getSlick")).slideCount<=s.options.slidesToShow&&s.setSlideClasses(u.currentSlide),u.updateDots(),u.updateArrows(),!0===u.options.fade)return!0!==n?(u.fadeSlideOut(o),u.fadeSlide(i,function(){u.postSlide(i)})):u.postSlide(i),void u.animateHeight();!0!==n?u.animateSlide(l,function(){u.postSlide(i)}):u.postSlide(i)}},a.prototype.startLoad=function(){var e=this;!0===e.options.arrows&&e.slideCount>e.options.slidesToShow&&(e.$prevArrow.hide(),e.$nextArrow.hide()),!0===e.options.dots&&e.slideCount>e.options.slidesToShow&&e.$dots.hide(),e.$slider.addClass("slick-loading")},a.prototype.swipeDirection=function(){var e,t,n,r,i=this;return e=i.touchObject.startX-i.touchObject.curX,t=i.touchObject.startY-i.touchObject.curY,n=Math.atan2(t,e),(r=Math.round(180*n/Math.PI))<0&&(r=360-Math.abs(r)),r<=45&&r>=0?!1===i.options.rtl?"left":"right":r<=360&&r>=315?!1===i.options.rtl?"left":"right":r>=135&&r<=225?!1===i.options.rtl?"right":"left":!0===i.options.verticalSwiping?r>=35&&r<=135?"down":"up":"vertical"},a.prototype.swipeEnd=function(e){var t,n,r=this;if(r.dragging=!1,r.swiping=!1,r.scrolling)return r.scrolling=!1,!1;if(r.interrupted=!1,r.shouldClick=!(r.touchObject.swipeLength>10),void 0===r.touchObject.curX)return!1;if(!0===r.touchObject.edgeHit&&r.$slider.trigger("edge",[r,r.swipeDirection()]),r.touchObject.swipeLength>=r.touchObject.minSwipe){switch(n=r.swipeDirection()){case"left":case"down":t=r.options.swipeToSlide?r.checkNavigable(r.currentSlide+r.getSlideCount()):r.currentSlide+r.getSlideCount(),r.currentDirection=0;break;case"right":case"up":t=r.options.swipeToSlide?r.checkNavigable(r.currentSlide-r.getSlideCount()):r.currentSlide-r.getSlideCount(),r.currentDirection=1}"vertical"!=n&&(r.slideHandler(t),r.touchObject={},r.$slider.trigger("swipe",[r,n]))}else r.touchObject.startX!==r.touchObject.curX&&(r.slideHandler(r.currentSlide),r.touchObject={})},a.prototype.swipeHandler=function(e){var t=this;if(!(!1===t.options.swipe||"ontouchend"in document&&!1===t.options.swipe||!1===t.options.draggable&&-1!==e.type.indexOf("mouse")))switch(t.touchObject.fingerCount=e.originalEvent&&void 0!==e.originalEvent.touches?e.originalEvent.touches.length:1,t.touchObject.minSwipe=t.listWidth/t.options.touchThreshold,!0===t.options.verticalSwiping&&(t.touchObject.minSwipe=t.listHeight/t.options.touchThreshold),e.data.action){case"start":t.swipeStart(e);break;case"move":t.swipeMove(e);break;case"end":t.swipeEnd(e)}},a.prototype.swipeMove=function(e){var t,n,r,i,o,a,s=this;return o=void 0!==e.originalEvent?e.originalEvent.touches:null,!(!s.dragging||s.scrolling||o&&1!==o.length)&&(t=s.getLeft(s.currentSlide),s.touchObject.curX=void 0!==o?o[0].pageX:e.clientX,s.touchObject.curY=void 0!==o?o[0].pageY:e.clientY,s.touchObject.swipeLength=Math.round(Math.sqrt(Math.pow(s.touchObject.curX-s.touchObject.startX,2))),a=Math.round(Math.sqrt(Math.pow(s.touchObject.curY-s.touchObject.startY,2))),!s.options.verticalSwiping&&!s.swiping&&a>4?(s.scrolling=!0,!1):(!0===s.options.verticalSwiping&&(s.touchObject.swipeLength=a),n=s.swipeDirection(),void 0!==e.originalEvent&&s.touchObject.swipeLength>4&&(s.swiping=!0,e.preventDefault()),i=(!1===s.options.rtl?1:-1)*(s.touchObject.curX>s.touchObject.startX?1:-1),!0===s.options.verticalSwiping&&(i=s.touchObject.curY>s.touchObject.startY?1:-1),r=s.touchObject.swipeLength,s.touchObject.edgeHit=!1,!1===s.options.infinite&&(0===s.currentSlide&&"right"===n||s.currentSlide>=s.getDotCount()&&"left"===n)&&(r=s.touchObject.swipeLength*s.options.edgeFriction,s.touchObject.edgeHit=!0),!1===s.options.vertical?s.swipeLeft=t+r*i:s.swipeLeft=t+r*(s.$list.height()/s.listWidth)*i,!0===s.options.verticalSwiping&&(s.swipeLeft=t+r*i),!0!==s.options.fade&&!1!==s.options.touchMove&&(!0===s.animating?(s.swipeLeft=null,!1):void s.setCSS(s.swipeLeft))))},a.prototype.swipeStart=function(e){var t,n=this;if(n.interrupted=!0,1!==n.touchObject.fingerCount||n.slideCount<=n.options.slidesToShow)return n.touchObject={},!1;void 0!==e.originalEvent&&void 0!==e.originalEvent.touches&&(t=e.originalEvent.touches[0]),n.touchObject.startX=n.touchObject.curX=void 0!==t?t.pageX:e.clientX,n.touchObject.startY=n.touchObject.curY=void 0!==t?t.pageY:e.clientY,n.dragging=!0},a.prototype.unfilterSlides=a.prototype.slickUnfilter=function(){var e=this;null!==e.$slidesCache&&(e.unload(),e.$slideTrack.children(this.options.slide).detach(),e.$slidesCache.appendTo(e.$slideTrack),e.reinit())},a.prototype.unload=function(){var e=this;u(".slick-cloned",e.$slider).remove(),e.$dots&&e.$dots.remove(),e.$prevArrow&&e.htmlExpr.test(e.options.prevArrow)&&e.$prevArrow.remove(),e.$nextArrow&&e.htmlExpr.test(e.options.nextArrow)&&e.$nextArrow.remove(),e.$slides.removeClass("slick-slide slick-active slick-visible slick-current").attr("aria-hidden","true").css("width","")},a.prototype.unslick=function(e){var t=this;t.$slider.trigger("unslick",[t,e]),t.destroy()},a.prototype.updateArrows=function(){var e=this;Math.floor(e.options.slidesToShow/2),!0===e.options.arrows&&e.slideCount>e.options.slidesToShow&&!e.options.infinite&&(e.$prevArrow.removeClass("slick-disabled").attr("aria-disabled","false"),e.$nextArrow.removeClass("slick-disabled").attr("aria-disabled","false"),0===e.currentSlide?(e.$prevArrow.addClass("slick-disabled").attr("aria-disabled","true"),e.$nextArrow.removeClass("slick-disabled").attr("aria-disabled","false")):e.currentSlide>=e.slideCount-e.options.slidesToShow&&!1===e.options.centerMode?(e.$nextArrow.addClass("slick-disabled").attr("aria-disabled","true"),e.$prevArrow.removeClass("slick-disabled").attr("aria-disabled","false")):e.currentSlide>=e.slideCount-1&&!0===e.options.centerMode&&(e.$nextArrow.addClass("slick-disabled").attr("aria-disabled","true"),e.$prevArrow.removeClass("slick-disabled").attr("aria-disabled","false")))},a.prototype.updateDots=function(){var e=this;null!==e.$dots&&(e.$dots.find("li").removeClass("slick-active").end(),e.$dots.find("li").eq(Math.floor(e.currentSlide/e.options.slidesToScroll)).addClass("slick-active"))},a.prototype.visibility=function(){var e=this;e.options.autoplay&&(document[e.hidden]?e.interrupted=!0:e.interrupted=!1)},u.fn.slick=function(){var e,t,n=this,r=arguments[0],i=Array.prototype.slice.call(arguments,1),o=n.length;for(e=0;e<o;e++)if("object"==typeof r||void 0===r?n[e].slick=new a(n[e],r):t=n[e].slick[r].apply(n[e].slick,i),void 0!==t)return t;return n}});!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.zPlayer=t():e.zPlayer=t()}(window,function(){return function(s){function e(e){for(var t,n,r=e[0],i=e[1],o=0,a=[];o<r.length;o++)n=r[o],l[n]&&a.push(l[n][0]),l[n]=0;for(t in i)Object.prototype.hasOwnProperty.call(i,t)&&(s[t]=i[t]);for(c&&c(e);a.length;)a.shift()()}var n={},l={0:0};function u(e){if(n[e])return n[e].exports;var t=n[e]={i:e,l:!1,exports:{}};return s[e].call(t.exports,t,t.exports,u),t.l=!0,t.exports}u.e=function(o){var e=[],n=l[o];if(0!==n)if(n)e.push(n[2]);else{var t=new Promise(function(e,t){n=l[o]=[e,t]});e.push(n[2]=t);var r,i=document.getElementsByTagName("head")[0],a=document.createElement("script");a.charset="utf-8",a.timeout=120,u.nc&&a.setAttribute("nonce",u.nc),a.src=function(e){return u.p+""+({}[e]||e)+".min.js"}(o),r=function(e){a.onerror=a.onload=null,clearTimeout(s);var t=l[o];if(0!==t){if(t){var n=e&&("load"===e.type?"missing":e.type),r=e&&e.target&&e.target.src,i=new Error("Loading chunk "+o+" failed.\n("+n+": "+r+")");i.type=n,i.request=r,t[1](i)}l[o]=void 0}};var s=setTimeout(function(){r({type:"timeout",target:a})},12e4);a.onerror=a.onload=r,i.appendChild(a)}return Promise.all(e)},u.m=s,u.c=n,u.d=function(e,t,n){u.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},u.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},u.t=function(t,e){if(1&e&&(t=u(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(u.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)u.d(n,r,function(e){return t[e]}.bind(null,r));return n},u.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return u.d(t,"a",t),t},u.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},u.p="/",u.oe=function(e){throw console.error(e),e};var t=window.webpackJsonpzPlayer=window.webpackJsonpzPlayer||[],r=t.push.bind(t);t.push=e,t=t.slice();for(var i=0;i<t.length;i++)e(t[i]);var c=r;return u(u.s=32)}([function(e,t,n){var r;"undefined"!=typeof window&&(r=function(){return function(n){var r={};function i(e){if(r[e])return r[e].exports;var t=r[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,i),t.l=!0,t.exports}return i.m=n,i.c=r,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/dist/",i(i.s="./src/hls.ts")}({"./node_modules/eventemitter3/index.js":function(e,t,n){"use strict";var r=Object.prototype.hasOwnProperty,h="~";function i(){}function s(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function o(e,t,n,r,i){if("function"!=typeof n)throw new TypeError("The listener must be a function");var o=new s(n,r||e,i),a=h?h+t:t;return e._events[a]?e._events[a].fn?e._events[a]=[e._events[a],o]:e._events[a].push(o):(e._events[a]=o,e._eventsCount++),e}function u(e,t){0==--e._eventsCount?e._events=new i:delete e._events[t]}function a(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(h=!1)),a.prototype.eventNames=function(){var e,t,n=[];if(0===this._eventsCount)return n;for(t in e=this._events)r.call(e,t)&&n.push(h?t.slice(1):t);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(e)):n},a.prototype.listeners=function(e){var t=h?h+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var r=0,i=n.length,o=new Array(i);r<i;r++)o[r]=n[r].fn;return o},a.prototype.listenerCount=function(e){var t=h?h+e:e,n=this._events[t];return n?n.fn?1:n.length:0},a.prototype.emit=function(e,t,n,r,i,o){var a=h?h+e:e;if(!this._events[a])return!1;var s,l,u=this._events[a],c=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),c){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,n),!0;case 4:return u.fn.call(u.context,t,n,r),!0;case 5:return u.fn.call(u.context,t,n,r,i),!0;case 6:return u.fn.call(u.context,t,n,r,i,o),!0}for(l=1,s=new Array(c-1);l<c;l++)s[l-1]=arguments[l];u.fn.apply(u.context,s)}else{var f,d=u.length;for(l=0;l<d;l++)switch(u[l].once&&this.removeListener(e,u[l].fn,void 0,!0),c){case 1:u[l].fn.call(u[l].context);break;case 2:u[l].fn.call(u[l].context,t);break;case 3:u[l].fn.call(u[l].context,t,n);break;case 4:u[l].fn.call(u[l].context,t,n,r);break;default:if(!s)for(f=1,s=new Array(c-1);f<c;f++)s[f-1]=arguments[f];u[l].fn.apply(u[l].context,s)}}return!0},a.prototype.on=function(e,t,n){return o(this,e,t,n,!1)},a.prototype.once=function(e,t,n){return o(this,e,t,n,!0)},a.prototype.removeListener=function(e,t,n,r){var i=h?h+e:e;if(!this._events[i])return this;if(!t)return u(this,i),this;var o=this._events[i];if(o.fn)o.fn!==t||r&&!o.once||n&&o.context!==n||u(this,i);else{for(var a=0,s=[],l=o.length;a<l;a++)(o[a].fn!==t||r&&!o[a].once||n&&o[a].context!==n)&&s.push(o[a]);s.length?this._events[i]=1===s.length?s[0]:s:u(this,i)}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=h?h+e:e,this._events[t]&&u(this,t)):(this._events=new i,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=h,a.EventEmitter=a,e.exports=a},"./node_modules/url-toolkit/src/url-toolkit.js":function(e,t,n){var r,c,i,o,f;r=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,c=/^(?=([^\/?#]*))\1([^]*)$/,i=/(?:\/|^)\.(?=\/)/g,o=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,f={buildAbsoluteURL:function(e,t,n){if(n=n||{},e=e.trim(),!(t=t.trim())){if(!n.alwaysNormalize)return e;var r=f.parseURL(e);if(!r)throw new Error("Error trying to parse base URL.");return r.path=f.normalizePath(r.path),f.buildURLFromParts(r)}var i=f.parseURL(t);if(!i)throw new Error("Error trying to parse relative URL.");if(i.scheme)return n.alwaysNormalize?(i.path=f.normalizePath(i.path),f.buildURLFromParts(i)):t;var o=f.parseURL(e);if(!o)throw new Error("Error trying to parse base URL.");if(!o.netLoc&&o.path&&"/"!==o.path[0]){var a=c.exec(o.path);o.netLoc=a[1],o.path=a[2]}o.netLoc&&!o.path&&(o.path="/");var s={scheme:o.scheme,netLoc:i.netLoc,path:null,params:i.params,query:i.query,fragment:i.fragment};if(!i.netLoc&&(s.netLoc=o.netLoc,"/"!==i.path[0]))if(i.path){var l=o.path,u=l.substring(0,l.lastIndexOf("/")+1)+i.path;s.path=f.normalizePath(u)}else s.path=o.path,i.params||(s.params=o.params,i.query||(s.query=o.query));return null===s.path&&(s.path=n.alwaysNormalize?f.normalizePath(i.path):i.path),f.buildURLFromParts(s)},parseURL:function(e){var t=r.exec(e);return t?{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}:null},normalizePath:function(e){for(e=e.split("").reverse().join("").replace(i,"");e.length!==(e=e.replace(o,"")).length;);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}},e.exports=f},"./node_modules/webworkify-webpack/index.js":function(e,t,h){function l(n){var r={};function i(e){if(r[e])return r[e].exports;var t=r[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,i),t.l=!0,t.exports}i.m=n,i.c=r,i.i=function(e){return e},i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},i.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/",i.oe=function(e){throw console.error(e),e};var e=i(i.s=ENTRY_MODULE);return e.default||e}var p="[\\.|\\-|\\+|\\w|/|@]+",g="\\(\\s*(/\\*.*?\\*/)?\\s*.*?("+p+").*?\\)";function v(e){return(e+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function d(e,t,n){var r={};r[n]=[];var i=t.toString(),o=i.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!o)return r;for(var a,s=o[1],l=new RegExp("(\\\\n|\\W)"+v(s)+g,"g");a=l.exec(i);)"dll-reference"!==a[3]&&r[n].push(a[3]);for(l=new RegExp("\\("+v(s)+'\\("(dll-reference\\s('+p+'))"\\)\\)'+g,"g");a=l.exec(i);)e[a[2]]||(r[n].push(a[1]),e[a[2]]=h(a[1]).m),r[a[2]]=r[a[2]]||[],r[a[2]].push(a[4]);for(var u,c=Object.keys(r),f=0;f<c.length;f++)for(var d=0;d<r[c[f]].length;d++)u=r[c[f]][d],isNaN(1*u)||(r[c[f]][d]=1*r[c[f]][d]);return r}function y(n){return Object.keys(n).reduce(function(e,t){return e||n[t].length>0},!1)}e.exports=function(e,t){t=t||{};var n={main:h.m},r=t.all?{main:Object.keys(n.main)}:function(e,t){for(var n={main:[t]},r={main:[]},i={main:{}};y(n);)for(var o=Object.keys(n),a=0;a<o.length;a++){var s=o[a],l=n[s].pop();if(i[s]=i[s]||{},!i[s][l]&&e[s][l]){i[s][l]=!0,r[s]=r[s]||[],r[s].push(l);for(var u=d(e,e[s][l],s),c=Object.keys(u),f=0;f<c.length;f++)n[c[f]]=n[c[f]]||[],n[c[f]]=n[c[f]].concat(u[c[f]])}}return r}(n,e),i="";Object.keys(r).filter(function(e){return"main"!==e}).forEach(function(t){for(var e=0;r[t][e];)e++;r[t].push(e),n[t][e]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",i=i+"var "+t+" = ("+l.toString().replace("ENTRY_MODULE",JSON.stringify(e))+")({"+r[t].map(function(e){return JSON.stringify(e)+": "+n[t][e].toString()}).join(",")+"});\n"}),i=i+"new (("+l.toString().replace("ENTRY_MODULE",JSON.stringify(e))+")({"+r.main.map(function(e){return JSON.stringify(e)+": "+n.main[e].toString()}).join(",")+"}))(self);";var o=new window.Blob([i],{type:"text/javascript"});if(t.bare)return o;var a=(window.URL||window.webkitURL||window.mozURL||window.msURL).createObjectURL(o),s=new window.Worker(a);return s.objectURL=a,s}},"./src/config.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"hlsDefaultConfig",function(){return w}),n.d(t,"mergeConfig",function(){return _}),n.d(t,"enableStreamingMode",function(){return S});var r=n("./src/controller/abr-controller.ts"),i=n("./src/controller/audio-stream-controller.ts"),o=n("./src/controller/audio-track-controller.ts"),a=n("./src/controller/subtitle-stream-controller.ts"),s=n("./src/controller/subtitle-track-controller.ts"),l=n("./src/controller/buffer-controller.ts"),u=n("./src/controller/timeline-controller.ts"),c=n("./src/controller/cap-level-controller.ts"),f=n("./src/controller/fps-controller.ts"),d=n("./src/controller/eme-controller.ts"),h=n("./src/controller/cmcd-controller.ts"),p=n("./src/utils/xhr-loader.ts"),g=n("./src/utils/fetch-loader.ts"),v=n("./src/utils/cues.ts"),y=n("./src/utils/mediakeys-helper.ts"),m=n("./src/utils/logger.ts");function b(){return(b=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function E(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function T(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?E(Object(n),!0).forEach(function(e){k(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function k(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var w=T(T({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,maxBufferSize:6e7,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:p.default,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:r.default,bufferController:l.default,capLevelController:c.default,fpsController:f.default,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystemOptions:{},requestMediaKeySystemAccessFunc:y.requestMediaKeySystemAccess,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableID3MetadataCues:!0},{cueHandler:v.default,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}),{},{subtitleStreamController:a.SubtitleStreamController,subtitleTrackController:s.default,timelineController:u.TimelineController,audioStreamController:i.default,audioTrackController:o.default,emeController:d.default,cmcdController:h.default});function _(e,t){if((t.liveSyncDurationCount||t.liveMaxLatencyDurationCount)&&(t.liveSyncDuration||t.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(void 0!==t.liveMaxLatencyDurationCount&&(void 0===t.liveSyncDurationCount||t.liveMaxLatencyDurationCount<=t.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(void 0!==t.liveMaxLatencyDuration&&(void 0===t.liveSyncDuration||t.liveMaxLatencyDuration<=t.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');return b({},e,t)}function S(e){var t=e.loader;t!==g.default&&t!==p.default?(m.logger.log("[config]: Custom loader detected, cannot enable progressive streaming"),e.progressive=!1):Object(g.fetchSupported)()&&(e.loader=g.default,e.progressive=!0,e.enableSoftwareAES=!0,m.logger.log("[config]: Progressive streaming enabled, using FetchLoader"))}},"./src/controller/abr-controller.ts":function(e,t,n){"use strict";n.r(t);var k=n("./src/polyfills/number.ts"),o=n("./src/utils/ewma-bandwidth-estimator.ts"),w=n("./src/events.ts"),a=n("./src/errors.ts"),c=n("./src/types/loader.ts"),_=n("./src/utils/logger.ts");function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var r=function(){function e(e){this.hls=void 0,this.lastLoadedFragLevel=0,this._nextAutoLevel=-1,this.timer=void 0,this.onCheck=this._abandonRulesCheck.bind(this),this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this.hls=e;var t=e.config;this.bwEstimator=new o.default(t.abrEwmaSlowVoD,t.abrEwmaFastVoD,t.abrEwmaDefaultEstimate),this.registerListeners()}var t,n,r,i=e.prototype;return i.registerListeners=function(){var e=this.hls;e.on(w.Events.FRAG_LOADING,this.onFragLoading,this),e.on(w.Events.FRAG_LOADED,this.onFragLoaded,this),e.on(w.Events.FRAG_BUFFERED,this.onFragBuffered,this),e.on(w.Events.LEVEL_LOADED,this.onLevelLoaded,this),e.on(w.Events.ERROR,this.onError,this)},i.unregisterListeners=function(){var e=this.hls;e.off(w.Events.FRAG_LOADING,this.onFragLoading,this),e.off(w.Events.FRAG_LOADED,this.onFragLoaded,this),e.off(w.Events.FRAG_BUFFERED,this.onFragBuffered,this),e.off(w.Events.LEVEL_LOADED,this.onLevelLoaded,this),e.off(w.Events.ERROR,this.onError,this)},i.destroy=function(){this.unregisterListeners(),this.clearTimer(),this.hls=this.onCheck=null,this.fragCurrent=this.partCurrent=null},i.onFragLoading=function(e,t){var n,r=t.frag;r.type===c.PlaylistLevelType.MAIN&&(this.timer||(this.fragCurrent=r,this.partCurrent=null!=(n=t.part)?n:null,this.timer=self.setInterval(this.onCheck,100)))},i.onLevelLoaded=function(e,t){var n=this.hls.config;t.details.live?this.bwEstimator.update(n.abrEwmaSlowLive,n.abrEwmaFastLive):this.bwEstimator.update(n.abrEwmaSlowVoD,n.abrEwmaFastVoD)},i._abandonRulesCheck=function(){var e=this.fragCurrent,t=this.partCurrent,n=this.hls,r=n.autoLevelEnabled,i=(n.config,n.media);if(e&&i){var o=t?t.stats:e.stats,a=t?t.duration:e.duration;if(o.aborted||o.loaded&&o.loaded===o.total||0===e.level)return this.clearTimer(),void(this._nextAutoLevel=-1);if(r&&!i.paused&&i.playbackRate&&i.readyState){var s=n.mainForwardBufferInfo;if(null!==s){var l=performance.now()-o.loading.start,u=Math.abs(i.playbackRate);if(!(l<=500*a/u)){var c=o.loaded&&o.loading.first,f=this.bwEstimator.getEstimate(),d=n.levels,h=n.minAutoLevel,p=d[e.level],g=o.total||Math.max(o.loaded,Math.round(a*p.maxBitrate/8)),v=c?1e3*o.loaded/l:0,y=v?(g-o.loaded)/v:8*g/f,m=s.len/u;if(!(y<=m)){var b,E=Number.POSITIVE_INFINITY;for(b=e.level-1;b>h;b--){var T=d[b].maxBitrate;if((E=v?a*T/(6.4*v):a*T/f)<m)break}E>=y||(_.logger.warn("Fragment "+e.sn+(t?" part "+t.index:"")+" of level "+e.level+" is loading too slowly and will cause an underbuffer; aborting and switching to level "+b+"\n      Current BW estimate: "+(Object(k.isFiniteNumber)(f)?(f/1024).toFixed(3):"Unknown")+" Kb/s\n      Estimated load time for current fragment: "+y.toFixed(3)+" s\n      Estimated load time for the next fragment: "+E.toFixed(3)+" s\n      Time to underbuffer: "+m.toFixed(3)+" s"),n.nextLoadLevel=b,c&&this.bwEstimator.sample(l,o.loaded),this.clearTimer(),e.loader&&(this.fragCurrent=this.partCurrent=null,e.loader.abort()),n.trigger(w.Events.FRAG_LOAD_EMERGENCY_ABORTED,{frag:e,part:t,stats:o}))}}}}}},i.onFragLoaded=function(e,t){var n=t.frag,r=t.part;if(n.type===c.PlaylistLevelType.MAIN&&Object(k.isFiniteNumber)(n.sn)){var i=r?r.stats:n.stats,o=r?r.duration:n.duration;if(this.clearTimer(),this.lastLoadedFragLevel=n.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var a=this.hls.levels[n.level],s=(a.loaded?a.loaded.bytes:0)+i.loaded,l=(a.loaded?a.loaded.duration:0)+o;a.loaded={bytes:s,duration:l},a.realBitrate=Math.round(8*s/l)}if(n.bitrateTest){var u={stats:i,frag:n,part:r,id:n.type};this.onFragBuffered(w.Events.FRAG_BUFFERED,u)}}},i.onFragBuffered=function(e,t){var n=t.frag,r=t.part,i=r?r.stats:n.stats;if(!i.aborted&&n.type===c.PlaylistLevelType.MAIN&&"initSegment"!==n.sn){var o=i.parsing.end-i.loading.start;this.bwEstimator.sample(o,i.loaded),i.bwEstimate=this.bwEstimator.getEstimate(),n.bitrateTest?this.bitrateTestDelay=o/1e3:this.bitrateTestDelay=0}},i.onError=function(e,t){switch(t.details){case a.ErrorDetails.FRAG_LOAD_ERROR:case a.ErrorDetails.FRAG_LOAD_TIMEOUT:this.clearTimer()}},i.clearTimer=function(){self.clearInterval(this.timer),this.timer=void 0},i.getNextABRAutoLevel=function(){var e=this.fragCurrent,t=this.partCurrent,n=this.hls,r=n.maxAutoLevel,i=n.config,o=n.minAutoLevel,a=n.media,s=t?t.duration:e?e.duration:0,l=(a&&a.currentTime,a&&0!==a.playbackRate?Math.abs(a.playbackRate):1),u=this.bwEstimator?this.bwEstimator.getEstimate():i.abrEwmaDefaultEstimate,c=n.mainForwardBufferInfo,f=(c?c.len:0)/l,d=this.findBestLevel(u,o,r,f,i.abrBandWidthFactor,i.abrBandWidthUpFactor);if(d>=0)return d;_.logger.trace((f?"rebuffering expected":"buffer is empty")+", finding optimal quality level");var h=s?Math.min(s,i.maxStarvationDelay):i.maxStarvationDelay,p=i.abrBandWidthFactor,g=i.abrBandWidthUpFactor;if(!f){var v=this.bitrateTestDelay;if(v)h=(s?Math.min(s,i.maxLoadingDelay):i.maxLoadingDelay)-v,_.logger.trace("bitrate test took "+Math.round(1e3*v)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*h)+" ms"),p=g=1}return d=this.findBestLevel(u,o,r,f+h,p,g),Math.max(d,0)},i.findBestLevel=function(e,t,n,r,i,o){for(var a,s=this.fragCurrent,l=this.partCurrent,u=this.lastLoadedFragLevel,c=this.hls.levels,f=c[u],d=!(null==f||null===(a=f.details)||void 0===a||!a.live),h=null==f?void 0:f.codecSet,p=l?l.duration:s?s.duration:0,g=n;g>=t;g--){var v=c[g];if(v&&(!h||v.codecSet===h)){var y=v.details,m=(l?null==y?void 0:y.partTarget:null==y?void 0:y.averagetargetduration)||p,b=void 0;b=g<=u?i*e:o*e;var E=c[g].maxBitrate,T=E*m/b;if(_.logger.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+g+"/"+Math.round(b)+"/"+E+"/"+m+"/"+r+"/"+T),b>E&&(0===T||!Object(k.isFiniteNumber)(T)||d&&!this.bitrateTestDelay||T<r))return g}}return-1},t=e,(n=[{key:"nextAutoLevel",get:function(){var e=this._nextAutoLevel,t=this.bwEstimator;if(-1!==e&&!t.canEstimate())return e;var n=this.getNextABRAutoLevel();return-1!==e&&this.hls.levels[n].loadError?e:(-1!==e&&(n=Math.min(e,n)),n)},set:function(e){this._nextAutoLevel=e}}])&&s(t.prototype,n),r&&s(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.default=r},"./src/controller/audio-stream-controller.ts":function(e,t,n){"use strict";n.r(t);var i=n("./src/polyfills/number.ts"),E=n("./src/controller/base-stream-controller.ts"),T=n("./src/events.ts"),v=n("./src/utils/buffer-helper.ts"),o=n("./src/controller/fragment-tracker.ts"),a=n("./src/types/level.ts"),m=n("./src/types/loader.ts"),k=n("./src/loader/fragment.ts"),y=n("./src/demux/chunk-cache.ts"),b=n("./src/demux/transmuxer-interface.ts"),w=n("./src/types/transmuxer.ts"),_=n("./src/controller/fragment-finders.ts"),u=n("./src/utils/discontinuities.ts"),s=n("./src/errors.ts");function S(){return(S=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function l(e,t){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var r=function(g){var e,t;function n(e,t){var n;return(n=g.call(this,e,t,"[audio-stream-controller]")||this).videoBuffer=null,n.videoTrackCC=-1,n.waitingVideoCC=-1,n.audioSwitch=!1,n.trackId=-1,n.waitingData=null,n.mainDetails=null,n.bufferFlushed=!1,n.cachedTrackLoadedData=null,n._registerListeners(),n}t=g,(e=n).prototype=Object.create(t.prototype),e.prototype.constructor=e,l(e,t);var r=n.prototype;return r.onHandlerDestroying=function(){this._unregisterListeners(),this.mainDetails=null},r._registerListeners=function(){var e=this.hls;e.on(T.Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(T.Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(T.Events.MANIFEST_LOADING,this.onManifestLoading,this),e.on(T.Events.LEVEL_LOADED,this.onLevelLoaded,this),e.on(T.Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.on(T.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(T.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(T.Events.ERROR,this.onError,this),e.on(T.Events.BUFFER_RESET,this.onBufferReset,this),e.on(T.Events.BUFFER_CREATED,this.onBufferCreated,this),e.on(T.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(T.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(T.Events.FRAG_BUFFERED,this.onFragBuffered,this)},r._unregisterListeners=function(){var e=this.hls;e.off(T.Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(T.Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(T.Events.MANIFEST_LOADING,this.onManifestLoading,this),e.off(T.Events.LEVEL_LOADED,this.onLevelLoaded,this),e.off(T.Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.off(T.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(T.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(T.Events.ERROR,this.onError,this),e.off(T.Events.BUFFER_RESET,this.onBufferReset,this),e.off(T.Events.BUFFER_CREATED,this.onBufferCreated,this),e.off(T.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(T.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(T.Events.FRAG_BUFFERED,this.onFragBuffered,this)},r.onInitPtsFound=function(e,t){var n=t.frag,r=t.id,i=t.initPTS;if("main"===r){var o=n.cc;this.initPTS[n.cc]=i,this.log("InitPTS for cc: "+o+" found from main: "+i),this.videoTrackCC=o,this.state===E.State.WAITING_INIT_PTS&&this.tick()}},r.startLoad=function(e){if(!this.levels)return this.startPosition=e,void(this.state=E.State.STOPPED);var t=this.lastCurrentTime;this.stopLoad(),this.setInterval(100),this.fragLoadError=0,t>0&&-1===e?(this.log("Override startPosition with lastCurrentTime @"+t.toFixed(3)),e=t,this.state=E.State.IDLE):(this.loadedmetadata=!1,this.state=E.State.WAITING_TRACK),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()},r.doTick=function(){switch(this.state){case E.State.IDLE:this.doTickIdle();break;case E.State.WAITING_TRACK:var e,t=this.levels,n=this.trackId,r=null==t?void 0:null===(e=t[n])||void 0===e?void 0:e.details;if(r){if(this.waitForCdnTuneIn(r))break;this.state=E.State.WAITING_INIT_PTS}break;case E.State.FRAG_LOADING_WAITING_RETRY:var i,o=performance.now(),a=this.retryDate;(!a||o>=a||null!==(i=this.media)&&void 0!==i&&i.seeking)&&(this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded(this.trackId),this.state=E.State.IDLE);break;case E.State.WAITING_INIT_PTS:var s=this.waitingData;if(s){var l=s.frag,u=s.part,c=s.cache,f=s.complete;if(void 0!==this.initPTS[l.cc]){this.waitingData=null,this.waitingVideoCC=-1,this.state=E.State.FRAG_LOADING;var d={frag:l,part:u,payload:c.flush(),networkDetails:null};this._handleFragmentLoadProgress(d),f&&g.prototype._handleFragmentLoadComplete.call(this,d)}else if(this.videoTrackCC!==this.waitingVideoCC)this.log("Waiting fragment cc ("+l.cc+") cancelled because video is at cc "+this.videoTrackCC),this.clearWaitingFragment();else{var h=this.getLoadPosition(),p=v.BufferHelper.bufferInfo(this.mediaBuffer,h,this.config.maxBufferHole);Object(_.fragmentWithinToleranceTest)(p.end,this.config.maxFragLookUpTolerance,l)<0&&(this.log("Waiting fragment cc ("+l.cc+") @ "+l.start+" cancelled because another fragment at "+p.end+" is needed"),this.clearWaitingFragment())}}else this.state=E.State.IDLE}this.onTickEnd()},r.clearWaitingFragment=function(){var e=this.waitingData;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=E.State.IDLE)},r.resetLoadingState=function(){this.clearWaitingFragment(),g.prototype.resetLoadingState.call(this)},r.onTickEnd=function(){var e=this.media;if(e&&e.readyState){var t=(this.mediaBuffer?this.mediaBuffer:e).buffered;!this.loadedmetadata&&t.length&&(this.loadedmetadata=!0),this.lastCurrentTime=e.currentTime}},r.doTickIdle=function(){var e,t,n=this.hls,r=this.levels,i=this.media,o=this.trackId,a=n.config;if(r&&r[o]&&(i||!this.startFragRequested&&a.startFragPrefetch)){var s=r[o].details;if(!s||s.live&&this.levelLastLoaded!==o||this.waitForCdnTuneIn(s))this.state=E.State.WAITING_TRACK;else{var l=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&l&&(this.bufferFlushed=!1,this.afterBufferFlushed(l,k.ElementaryStreamTypes.AUDIO,m.PlaylistLevelType.AUDIO));var u=this.getFwdBufferInfo(l,m.PlaylistLevelType.AUDIO);if(null!==u){var c=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,m.PlaylistLevelType.MAIN),f=u.len,d=this.getMaxBufferLength(null==c?void 0:c.len),h=this.audioSwitch;if(!(f>=d)||h){if(!h&&this._streamEnded(u,s))return n.trigger(T.Events.BUFFER_EOS,{type:"audio"}),void(this.state=E.State.ENDED);var p=s.fragments[0].start,g=u.end;if(h&&i){var v=this.getLoadPosition();g=v,s.PTSKnown&&v<p&&(u.end>p||u.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),i.currentTime=p+.05)}if(!(c&&g>c.end+s.targetduration)&&(c&&c.len||!u.len)){var y=this.getNextFragment(g,s);y?"identity"!==(null===(e=y.decryptdata)||void 0===e?void 0:e.keyFormat)||null!==(t=y.decryptdata)&&void 0!==t&&t.key?this.loadFragment(y,s,g):this.loadKey(y,s):this.bufferFlushed=!0}}}}}},r.getMaxBufferLength=function(e){var t=g.prototype.getMaxBufferLength.call(this);return e?Math.max(t,e):t},r.onMediaDetaching=function(){this.videoBuffer=null,g.prototype.onMediaDetaching.call(this)},r.onAudioTracksUpdated=function(e,t){var n=t.audioTracks;this.resetTransmuxer(),this.levels=n.map(function(e){return new a.Level(e)})},r.onAudioTrackSwitching=function(e,t){var n=!!t.url;this.trackId=t.id;var r=this.fragCurrent;null!=r&&r.loader&&r.loader.abort(),this.fragCurrent=null,this.clearWaitingFragment(),n?this.setInterval(100):this.resetTransmuxer(),n?(this.audioSwitch=!0,this.state=E.State.IDLE):this.state=E.State.STOPPED,this.tick()},r.onManifestLoading=function(){this.mainDetails=null,this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=!1},r.onLevelLoaded=function(e,t){this.mainDetails=t.details,null!==this.cachedTrackLoadedData&&(this.hls.trigger(T.Events.AUDIO_TRACK_LOADED,this.cachedTrackLoadedData),this.cachedTrackLoadedData=null)},r.onAudioTrackLoaded=function(e,t){var n;if(null!=this.mainDetails){var r=this.levels,i=t.details,o=t.id;if(r){this.log("Track "+o+" loaded ["+i.startSN+","+i.endSN+"],duration:"+i.totalduration);var a=r[o],s=0;if(i.live||null!==(n=a.details)&&void 0!==n&&n.live){var l=this.mainDetails;if(i.fragments[0]||(i.deltaUpdateFailed=!0),i.deltaUpdateFailed||!l)return;!a.details&&i.hasProgramDateTime&&l.hasProgramDateTime?(Object(u.alignMediaPlaylistByPDT)(i,l),s=i.fragments[0].start):s=this.alignPlaylists(i,a.details)}a.details=i,this.levelLastLoaded=o,this.startFragRequested||!this.mainDetails&&i.live||this.setStartPosition(a.details,s),this.state!==E.State.WAITING_TRACK||this.waitForCdnTuneIn(i)||(this.state=E.State.IDLE),this.tick()}else this.warn("Audio tracks were reset while loading level "+o)}else this.cachedTrackLoadedData=t},r._handleFragmentLoadProgress=function(e){var t,n=e.frag,r=e.part,i=e.payload,o=this.config,a=this.trackId,s=this.levels;if(s){var l=s[a];console.assert(l,"Audio track is defined on fragment load progress");var u=l.details;console.assert(u,"Audio track details are defined on fragment load progress");var c=o.defaultAudioCodec||l.audioCodec||"mp4a.40.2",f=this.transmuxer;f||(f=this.transmuxer=new b.default(this.hls,m.PlaylistLevelType.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));var d=this.initPTS[n.cc],h=null===(t=n.initSegment)||void 0===t?void 0:t.data;if(void 0!==d){var p=r?r.index:-1,g=-1!==p,v=new w.ChunkMetadata(n.level,n.sn,n.stats.chunkCount,i.byteLength,p,g);f.push(i,h,c,"",n,r,u.totalduration,!1,v,d)}else{this.log("Unknown video PTS for cc "+n.cc+", waiting for video PTS before demuxing audio frag "+n.sn+" of ["+u.startSN+" ,"+u.endSN+"],track "+a),(this.waitingData=this.waitingData||{frag:n,part:r,cache:new y.default,complete:!1}).cache.push(new Uint8Array(i)),this.waitingVideoCC=this.videoTrackCC,this.state=E.State.WAITING_INIT_PTS}}else this.warn("Audio tracks were reset while fragment load was in progress. Fragment "+n.sn+" of level "+n.level+" will not be buffered")},r._handleFragmentLoadComplete=function(e){this.waitingData?this.waitingData.complete=!0:g.prototype._handleFragmentLoadComplete.call(this,e)},r.onBufferReset=function(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1},r.onBufferCreated=function(e,t){var n=t.tracks.audio;n&&(this.mediaBuffer=n.buffer||null),t.tracks.video&&(this.videoBuffer=t.tracks.video.buffer||null)},r.onFragBuffered=function(e,t){var n=t.frag,r=t.part;n.type===m.PlaylistLevelType.AUDIO&&(this.fragContextChanged(n)?this.warn("Fragment "+n.sn+(r?" p: "+r.index:"")+" of level "+n.level+" finished buffering, but was aborted. state: "+this.state+", audioSwitch: "+this.audioSwitch):("initSegment"!==n.sn&&(this.fragPrevious=n,this.audioSwitch&&(this.audioSwitch=!1,this.hls.trigger(T.Events.AUDIO_TRACK_SWITCHED,{id:this.trackId}))),this.fragBufferedComplete(n,r)))},r.onError=function(e,t){switch(t.details){case s.ErrorDetails.FRAG_LOAD_ERROR:case s.ErrorDetails.FRAG_LOAD_TIMEOUT:case s.ErrorDetails.KEY_LOAD_ERROR:case s.ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(m.PlaylistLevelType.AUDIO,t);break;case s.ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case s.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:this.state!==E.State.ERROR&&this.state!==E.State.STOPPED&&(this.state=t.fatal?E.State.ERROR:E.State.IDLE,this.warn(t.details+" while loading frag, switching to "+this.state+" state"));break;case s.ErrorDetails.BUFFER_FULL_ERROR:if("audio"===t.parent&&(this.state===E.State.PARSING||this.state===E.State.PARSED)){var n=!0,r=this.getFwdBufferInfo(this.mediaBuffer,m.PlaylistLevelType.AUDIO);r&&r.len>.5&&(n=!this.reduceMaxBufferLength(r.len)),n&&(this.warn("Buffer full error also media.currentTime is not buffered, flush audio buffer"),this.fragCurrent=null,g.prototype.flushMainBuffer.call(this,0,Number.POSITIVE_INFINITY,"audio")),this.resetLoadingState()}}},r.onBufferFlushed=function(e,t){t.type===k.ElementaryStreamTypes.AUDIO&&(this.bufferFlushed=!0)},r._handleTransmuxComplete=function(e){var t,n="audio",r=this.hls,i=e.remuxResult,o=e.chunkMeta,a=this.getCurrentContext(o);if(!a)return this.warn("The loading context changed while buffering fragment "+o.sn+" of level "+o.level+". This chunk will not be buffered."),void this.resetStartWhenNotLoaded(o.level);var s=a.frag,l=a.part,u=a.level.details,c=i.audio,f=i.text,d=i.id3,h=i.initSegment;if(!this.fragContextChanged(s)&&u){if(this.state=E.State.PARSING,this.audioSwitch&&c&&this.completeAudioSwitch(),null!=h&&h.tracks&&(this._bufferInitSegment(h.tracks,s,o),r.trigger(T.Events.FRAG_PARSING_INIT_SEGMENT,{frag:s,id:n,tracks:h.tracks})),c){var p=c.startPTS,g=c.endPTS,v=c.startDTS,y=c.endDTS;l&&(l.elementaryStreams[k.ElementaryStreamTypes.AUDIO]={startPTS:p,endPTS:g,startDTS:v,endDTS:y}),s.setElementaryStreamInfo(k.ElementaryStreamTypes.AUDIO,p,g,v,y),this.bufferFragmentData(c,s,l,o)}if(null!=d&&null!==(t=d.samples)&&void 0!==t&&t.length){var m=S({id:n,frag:s,details:u},d);r.trigger(T.Events.FRAG_PARSING_METADATA,m)}if(f){var b=S({id:n,frag:s,details:u},f);r.trigger(T.Events.FRAG_PARSING_USERDATA,b)}}},r._bufferInitSegment=function(e,t,n){if(this.state===E.State.PARSING){e.video&&delete e.video;var r=e.audio;if(r){r.levelCodec=r.codec,r.id="audio",this.log("Init audio buffer, container:"+r.container+", codecs[parsed]=["+r.codec+"]"),this.hls.trigger(T.Events.BUFFER_CODECS,e);var i=r.initSegment;if(null!=i&&i.byteLength){var o={type:"audio",frag:t,part:null,chunkMeta:n,parent:t.type,data:i};this.hls.trigger(T.Events.BUFFER_APPENDING,o)}this.tick()}}},r.loadFragment=function(e,t,n){var r=this.fragmentTracker.getState(e);this.fragCurrent=e,(this.audioSwitch||r===o.FragmentState.NOT_LOADED||r===o.FragmentState.PARTIAL)&&("initSegment"===e.sn?this._loadInitSegment(e):t.live&&!Object(i.isFiniteNumber)(this.initPTS[e.cc])?(this.log("Waiting for video PTS in continuity counter "+e.cc+" of live stream before loading audio fragment "+e.sn+" of level "+this.trackId),this.state=E.State.WAITING_INIT_PTS):(this.startFragRequested=!0,g.prototype.loadFragment.call(this,e,t,n)))},r.completeAudioSwitch=function(){var e=this.hls,t=this.media,n=this.trackId;t&&(this.log("Switching audio track : flushing all audio"),g.prototype.flushMainBuffer.call(this,0,Number.POSITIVE_INFINITY,"audio")),this.audioSwitch=!1,e.trigger(T.Events.AUDIO_TRACK_SWITCHED,{id:n})},n}(E.default);t.default=r},"./src/controller/audio-track-controller.ts":function(e,t,n){"use strict";n.r(t);var f=n("./src/events.ts"),l=n("./src/errors.ts"),r=n("./src/controller/base-playlist-controller.ts"),u=n("./src/types/loader.ts");function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(e,t){return(d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var i=function(n){var e,t;function r(e){var t;return(t=n.call(this,e,"[audio-track-controller]")||this).tracks=[],t.groupId=null,t.tracksInGroup=[],t.trackId=-1,t.trackName="",t.selectDefaultTrack=!0,t.registerListeners(),t}t=n,(e=r).prototype=Object.create(t.prototype),e.prototype.constructor=e,d(e,t);var i,o,a,s=r.prototype;return s.registerListeners=function(){var e=this.hls;e.on(f.Events.MANIFEST_LOADING,this.onManifestLoading,this),e.on(f.Events.MANIFEST_PARSED,this.onManifestParsed,this),e.on(f.Events.LEVEL_LOADING,this.onLevelLoading,this),e.on(f.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(f.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(f.Events.ERROR,this.onError,this)},s.unregisterListeners=function(){var e=this.hls;e.off(f.Events.MANIFEST_LOADING,this.onManifestLoading,this),e.off(f.Events.MANIFEST_PARSED,this.onManifestParsed,this),e.off(f.Events.LEVEL_LOADING,this.onLevelLoading,this),e.off(f.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(f.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(f.Events.ERROR,this.onError,this)},s.destroy=function(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,n.prototype.destroy.call(this)},s.onManifestLoading=function(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.trackName="",this.selectDefaultTrack=!0},s.onManifestParsed=function(e,t){this.tracks=t.audioTracks||[]},s.onAudioTrackLoaded=function(e,t){var n=t.id,r=t.details,i=this.tracksInGroup[n];if(i){var o=i.details;i.details=t.details,this.log("audioTrack "+n+" loaded ["+r.startSN+"-"+r.endSN+"]"),n===this.trackId&&(this.retryCount=0,this.playlistLoaded(n,t,o))}else this.warn("Invalid audio track id "+n)},s.onLevelLoading=function(e,t){this.switchLevel(t.level)},s.onLevelSwitching=function(e,t){this.switchLevel(t.level)},s.switchLevel=function(e){var t=this.hls.levels[e];if(null!=t&&t.audioGroupIds){var n=t.audioGroupIds[t.urlId];if(this.groupId!==n){this.groupId=n;var r=this.tracks.filter(function(e){return!n||e.groupId===n});this.selectDefaultTrack&&!r.some(function(e){return e.default})&&(this.selectDefaultTrack=!1),this.tracksInGroup=r;var i={audioTracks:r};this.log("Updating audio tracks, "+r.length+' track(s) found in "'+n+'" group-id'),this.hls.trigger(f.Events.AUDIO_TRACKS_UPDATED,i),this.selectInitialTrack()}}},s.onError=function(e,t){n.prototype.onError.call(this,e,t),!t.fatal&&t.context&&t.context.type===u.PlaylistContextType.AUDIO_TRACK&&t.context.id===this.trackId&&t.context.groupId===this.groupId&&this.retryLoadingOrFail(t)},s.setAudioTrack=function(e){var t=this.tracksInGroup;if(e<0||e>=t.length)this.warn("Invalid id passed to audio-track controller");else{this.clearTimer();var n=t[this.trackId];this.log("Now switching to audio-track index "+e);var r=t[e],i=r.id,o=r.groupId,a=void 0===o?"":o,s=r.name,l=r.type,u=r.url;if(this.trackId=e,this.trackName=s,this.selectDefaultTrack=!1,this.hls.trigger(f.Events.AUDIO_TRACK_SWITCHING,{id:i,groupId:a,name:s,type:l,url:u}),!r.details||r.details.live){var c=this.switchParams(r.url,null==n?void 0:n.details);this.loadPlaylist(c)}}},s.selectInitialTrack=function(){var e=this.tracksInGroup;console.assert(e.length,"Initial audio track should be selected when tracks are known");var t=this.trackName,n=this.findTrackId(t)||this.findTrackId();-1!==n?this.setAudioTrack(n):(this.warn("No track found for running audio group-ID: "+this.groupId),this.hls.trigger(f.Events.ERROR,{type:l.ErrorTypes.MEDIA_ERROR,details:l.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,fatal:!0}))},s.findTrackId=function(e){for(var t=this.tracksInGroup,n=0;n<t.length;n++){var r=t[n];if((!this.selectDefaultTrack||r.default)&&(!e||e===r.name))return r.id}return-1},s.loadPlaylist=function(e){var t=this.tracksInGroup[this.trackId];if(this.shouldLoadTrack(t)){var n=t.id,r=t.groupId,i=t.url;if(e)try{i=e.addDirectives(i)}catch(e){this.warn("Could not construct new URL with HLS Delivery Directives: "+e)}this.log("loading audio-track playlist for id: "+n),this.clearTimer(),this.hls.trigger(f.Events.AUDIO_TRACK_LOADING,{url:i,id:n,groupId:r,deliveryDirectives:e||null})}},i=r,(o=[{key:"audioTracks",get:function(){return this.tracksInGroup}},{key:"audioTrack",get:function(){return this.trackId},set:function(e){this.selectDefaultTrack=!1,this.setAudioTrack(e)}}])&&c(i.prototype,o),a&&c(i,a),Object.defineProperty(i,"prototype",{writable:!1}),r}(r.default);t.default=i},"./src/controller/base-playlist-controller.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return o});var u=n("./src/polyfills/number.ts"),c=n("./src/types/level.ts"),E=n("./src/controller/level-helper.ts"),r=n("./src/utils/logger.ts"),i=n("./src/errors.ts"),o=function(){function e(e,t){this.hls=void 0,this.timer=-1,this.canLoad=!1,this.retryCount=0,this.log=void 0,this.warn=void 0,this.log=r.logger.log.bind(r.logger,t+":"),this.warn=r.logger.warn.bind(r.logger,t+":"),this.hls=e}var t=e.prototype;return t.destroy=function(){this.clearTimer(),this.hls=this.log=this.warn=null},t.onError=function(e,t){t.fatal&&t.type===i.ErrorTypes.NETWORK_ERROR&&this.clearTimer()},t.clearTimer=function(){clearTimeout(this.timer),this.timer=-1},t.startLoad=function(){this.canLoad=!0,this.retryCount=0,this.loadPlaylist()},t.stopLoad=function(){this.canLoad=!1,this.clearTimer()},t.switchParams=function(e,t){var n=null==t?void 0:t.renditionReports;if(n)for(var r=0;r<n.length;r++){var i=n[r],o=""+i.URI;if(o===e.slice(-o.length)){var a=parseInt(i["LAST-MSN"]),s=parseInt(i["LAST-PART"]);if(t&&this.hls.config.lowLatencyMode){var l=Math.min(t.age-t.partTarget,t.targetduration);void 0!==s&&l>t.partTarget&&(s+=1)}if(Object(u.isFiniteNumber)(a))return new c.HlsUrlParameters(a,Object(u.isFiniteNumber)(s)?s:void 0,c.HlsSkip.No)}}},t.loadPlaylist=function(e){},t.shouldLoadTrack=function(e){return this.canLoad&&e&&!!e.url&&(!e.details||e.details.live)},t.playlistLoaded=function(e,t,n){var r=this,i=t.details,o=t.stats,a=o.loading.end?Math.max(0,self.performance.now()-o.loading.end):0;if(i.advancedDateTime=Date.now()-a,i.live||null!=n&&n.live){if(i.reloaded(n),n&&this.log("live playlist "+e+" "+(i.advanced?"REFRESHED "+i.lastPartSn+"-"+i.lastPartIndex:"MISSED")),n&&i.fragments.length>0&&Object(E.mergeDetails)(n,i),!this.canLoad||!i.live)return;var s,l=void 0,u=void 0;if(i.canBlockReload&&i.endSN&&i.advanced){var c=this.hls.config.lowLatencyMode,f=i.lastPartSn,d=i.endSN,h=i.lastPartIndex,p=f===d;-1!==h?(l=p?d+1:f,u=p?c?0:h:h+1):l=d+1;var g=i.age,v=g+i.ageHeader,y=Math.min(v-i.partTarget,1.5*i.targetduration);if(y>0){if(n&&y>n.tuneInGoal)this.warn("CDN Tune-in goal increased from: "+n.tuneInGoal+" to: "+y+" with playlist age: "+i.age),y=0;else{var m=Math.floor(y/i.targetduration);if(l+=m,void 0!==u)u+=Math.round(y%i.targetduration/i.partTarget);this.log("CDN Tune-in age: "+i.ageHeader+"s last advanced "+g.toFixed(2)+"s goal: "+y+" skip sn "+m+" to part "+u)}i.tuneInGoal=y}if(s=this.getDeliveryDirectives(i,t.deliveryDirectives,l,u),c||!p)return void this.loadPlaylist(s)}else s=this.getDeliveryDirectives(i,t.deliveryDirectives,l,u);var b=Object(E.computeReloadInterval)(i,o);void 0!==l&&i.canBlockReload&&(b-=i.partTarget||1),this.log("reload live playlist "+e+" in "+Math.round(b)+" ms"),this.timer=self.setTimeout(function(){return r.loadPlaylist(s)},b)}else this.clearTimer()},t.getDeliveryDirectives=function(e,t,n,r){var i=Object(c.getSkipValue)(e,n);return null!=t&&t.skip&&e.deltaUpdateFailed&&(n=t.msn,r=t.part,i=c.HlsSkip.No),new c.HlsUrlParameters(n,r,i)},t.retryLoadingOrFail=function(e){var t,n=this,r=this.hls.config,i=this.retryCount<r.levelLoadingMaxRetry;if(i)if(this.retryCount++,e.details.indexOf("LoadTimeOut")>-1&&null!==(t=e.context)&&void 0!==t&&t.deliveryDirectives)this.warn("retry playlist loading #"+this.retryCount+' after "'+e.details+'"'),this.loadPlaylist();else{var o=Math.min(Math.pow(2,this.retryCount)*r.levelLoadingRetryDelay,r.levelLoadingMaxRetryTimeout);this.timer=self.setTimeout(function(){return n.loadPlaylist()},o),this.warn("retry playlist loading #"+this.retryCount+" in "+o+' ms after "'+e.details+'"')}else this.warn('cannot recover from error "'+e.details+'"'),this.clearTimer(),e.fatal=!0;return i},e}()},"./src/controller/base-stream-controller.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"State",function(){return A}),n.d(t,"default",function(){return i});var f=n("./src/polyfills/number.ts"),r=n("./src/task-loop.ts"),p=n("./src/controller/fragment-tracker.ts"),c=n("./src/utils/buffer-helper.ts"),l=n("./src/utils/logger.ts"),d=n("./src/events.ts"),u=n("./src/errors.ts"),h=n("./src/types/transmuxer.ts"),g=n("./src/utils/mp4-tools.ts"),v=n("./src/utils/discontinuities.ts"),y=n("./src/controller/fragment-finders.ts"),m=n("./src/controller/level-helper.ts"),b=n("./src/loader/fragment-loader.ts"),E=n("./src/crypt/decrypter.ts"),T=n("./src/utils/time-ranges.ts"),k=n("./src/types/loader.ts");function w(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function S(e,t){return(S=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var A={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"},i=function(i){var e,t;function n(e,t,n){var r;return(r=i.call(this)||this).hls=void 0,r.fragPrevious=null,r.fragCurrent=null,r.fragmentTracker=void 0,r.transmuxer=null,r._state=A.STOPPED,r.media=null,r.mediaBuffer=null,r.config=void 0,r.bitrateTest=!1,r.lastCurrentTime=0,r.nextLoadPosition=0,r.startPosition=0,r.loadedmetadata=!1,r.fragLoadError=0,r.retryDate=0,r.levels=null,r.fragmentLoader=void 0,r.levelLastLoaded=null,r.startFragRequested=!1,r.decrypter=void 0,r.initPTS=[],r.onvseeking=null,r.onvended=null,r.logPrefix="",r.log=void 0,r.warn=void 0,r.logPrefix=n,r.log=l.logger.log.bind(l.logger,n+":"),r.warn=l.logger.warn.bind(l.logger,n+":"),r.hls=e,r.fragmentLoader=new b.default(e.config),r.fragmentTracker=t,r.config=e.config,r.decrypter=new E.default(e,e.config),e.on(d.Events.KEY_LOADED,r.onKeyLoaded,_(r)),e.on(d.Events.LEVEL_SWITCHING,r.onLevelSwitching,_(r)),r}t=i,(e=n).prototype=Object.create(t.prototype),e.prototype.constructor=e,S(e,t);var r,o,a,s=n.prototype;return s.doTick=function(){this.onTickEnd()},s.onTickEnd=function(){},s.startLoad=function(e){},s.stopLoad=function(){this.fragmentLoader.abort();var e=this.fragCurrent;e&&this.fragmentTracker.removeFragment(e),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=A.STOPPED},s._streamEnded=function(e,t){var n=this.fragCurrent,r=this.fragmentTracker;if(!t.live&&n&&this.media&&n.sn>=t.endSN&&!e.nextStart){var i=t.partList;if(null!=i&&i.length){var o=i[i.length-1];return c.BufferHelper.isBuffered(this.media,o.start+o.duration/2)}var a=r.getState(n);return a===p.FragmentState.PARTIAL||a===p.FragmentState.OK}return!1},s.onMediaAttached=function(e,t){var n=this.media=this.mediaBuffer=t.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),n.addEventListener("seeking",this.onvseeking),n.addEventListener("ended",this.onvended);var r=this.config;this.levels&&r.autoStartLoad&&this.state===A.STOPPED&&this.startLoad(r.startPosition)},s.onMediaDetaching=function(){var e=this.media;null!=e&&e.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),e&&this.onvseeking&&this.onvended&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()},s.onMediaSeeking=function(){var e=this.config,t=this.fragCurrent,n=this.media,r=this.mediaBuffer,i=this.state,o=n?n.currentTime:0,a=c.BufferHelper.bufferInfo(r||n,o,e.maxBufferHole);if(this.log("media seeking to "+(Object(f.isFiniteNumber)(o)?o.toFixed(3):o)+", state: "+i),i===A.ENDED)this.resetLoadingState();else if(t&&!a.len){var s=e.maxFragLookUpTolerance,l=t.start-s,u=o>t.start+t.duration+s;(o<l||u)&&(u&&t.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),t.loader.abort()),this.resetLoadingState())}n&&(this.lastCurrentTime=o),this.loadedmetadata||a.len||(this.nextLoadPosition=this.startPosition=o),this.tickImmediate()},s.onMediaEnded=function(){this.startPosition=this.lastCurrentTime=0},s.onKeyLoaded=function(e,t){if(this.state===A.KEY_LOADING&&t.frag===this.fragCurrent&&this.levels){this.state=A.IDLE;var n=this.levels[t.frag.level].details;n&&this.loadFragment(t.frag,n,t.frag.start)}},s.onLevelSwitching=function(e,t){this.fragLoadError=0},s.onHandlerDestroying=function(){this.stopLoad(),i.prototype.onHandlerDestroying.call(this)},s.onHandlerDestroyed=function(){this.state=A.STOPPED,this.hls.off(d.Events.KEY_LOADED,this.onKeyLoaded,this),this.hls.off(d.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),this.fragmentLoader&&this.fragmentLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.fragmentLoader=this.fragmentTracker=null,i.prototype.onHandlerDestroyed.call(this)},s.loadKey=function(e,t){this.log("Loading key for "+e.sn+" of ["+t.startSN+"-"+t.endSN+"], "+("[stream-controller]"===this.logPrefix?"level":"track")+" "+e.level),this.state=A.KEY_LOADING,this.fragCurrent=e,this.hls.trigger(d.Events.KEY_LOADING,{frag:e})},s.loadFragment=function(e,t,n){this._loadFragForPlayback(e,t,n)},s._loadFragForPlayback=function(n,e,t){var r=this;this._doFragLoad(n,e,t,function(e){if(r.fragContextChanged(n))return r.warn("Fragment "+n.sn+(e.part?" p: "+e.part.index:"")+" of level "+n.level+" was dropped during download."),void r.fragmentTracker.removeFragment(n);n.stats.chunkCount++,r._handleFragmentLoadProgress(e)}).then(function(e){if(e){r.fragLoadError=0;var t=r.state;r.fragContextChanged(n)?(t===A.FRAG_LOADING||!r.fragCurrent&&t===A.PARSING)&&(r.fragmentTracker.removeFragment(n),r.state=A.IDLE):("payload"in e&&(r.log("Loaded fragment "+n.sn+" of level "+n.level),r.hls.trigger(d.Events.FRAG_LOADED,e)),r._handleFragmentLoadComplete(e))}}).catch(function(e){r.state!==A.STOPPED&&r.state!==A.ERROR&&(r.warn(e),r.resetFragmentLoading(n))})},s.flushMainBuffer=function(e,t,n){if(void 0===n&&(n=null),e-t){var r={startOffset:e,endOffset:t,type:n};this.fragLoadError=0,this.hls.trigger(d.Events.BUFFER_FLUSHING,r)}},s._loadInitSegment=function(a){var s=this;this._doFragLoad(a).then(function(e){if(!e||s.fragContextChanged(a)||!s.levels)throw new Error("init load aborted");return e}).then(function(n){var r=s.hls,e=n.payload,t=a.decryptdata;if(e&&e.byteLength>0&&t&&t.key&&t.iv&&"AES-128"===t.method){var i=self.performance.now();return s.decrypter.webCryptoDecrypt(new Uint8Array(e),t.key.buffer,t.iv.buffer).then(function(e){var t=self.performance.now();return r.trigger(d.Events.FRAG_DECRYPTED,{frag:a,payload:e,stats:{tstart:i,tdecrypt:t}}),n.payload=e,n})}return n}).then(function(e){var t=s.fragCurrent,n=s.hls,r=s.levels;if(!r)throw new Error("init load aborted, missing levels");var i=r[a.level].details;console.assert(i,"Level details are defined when init segment is loaded");var o=a.stats;s.state=A.IDLE,s.fragLoadError=0,a.data=new Uint8Array(e.payload),o.parsing.start=o.buffering.start=self.performance.now(),o.parsing.end=o.buffering.end=self.performance.now(),e.frag===t&&n.trigger(d.Events.FRAG_BUFFERED,{stats:o,frag:t,part:null,id:a.type}),s.tick()}).catch(function(e){s.state!==A.STOPPED&&s.state!==A.ERROR&&(s.warn(e),s.resetFragmentLoading(a))})},s.fragContextChanged=function(e){var t=this.fragCurrent;return!e||!t||e.level!==t.level||e.sn!==t.sn||e.urlId!==t.urlId},s.fragBufferedComplete=function(e,t){var n=this.mediaBuffer?this.mediaBuffer:this.media;this.log("Buffered "+e.type+" sn: "+e.sn+(t?" part: "+t.index:"")+" of "+("[stream-controller]"===this.logPrefix?"level":"track")+" "+e.level+" "+(n?T.default.toString(c.BufferHelper.getBuffered(n)):"(detached)")),this.state=A.IDLE,n&&(!this.loadedmetadata&&n.buffered.length&&this.fragCurrent===this.fragPrevious&&(this.loadedmetadata=!0,this.seekToStartPos()),this.tick())},s.seekToStartPos=function(){},s._handleFragmentLoadComplete=function(e){var t=this.transmuxer;if(t){var n=e.frag,r=e.part,i=e.partsLoaded,o=!i||0===i.length||i.some(function(e){return!e}),a=new h.ChunkMetadata(n.level,n.sn,n.stats.chunkCount+1,0,r?r.index:-1,!o);t.flush(a)}},s._handleFragmentLoadProgress=function(e){},s._doFragLoad=function(e,t,n,r){var i=this;if(void 0===n&&(n=null),!this.levels)throw new Error("frag load aborted, missing levels");if(n=Math.max(e.start,n||0),this.config.lowLatencyMode&&t){var o=t.partList;if(o&&r){n>e.end&&t.fragmentHint&&(e=t.fragmentHint);var a=this.getNextPart(o,e,n);if(a>-1){var s=o[a];return this.log("Loading part sn: "+e.sn+" p: "+s.index+" cc: "+e.cc+" of playlist ["+t.startSN+"-"+t.endSN+"] parts [0-"+a+"-"+(o.length-1)+"] "+("[stream-controller]"===this.logPrefix?"level":"track")+": "+e.level+", target: "+parseFloat(n.toFixed(3))),this.nextLoadPosition=s.start+s.duration,this.state=A.FRAG_LOADING,this.hls.trigger(d.Events.FRAG_LOADING,{frag:e,part:o[a],targetBufferTime:n}),this.doFragPartsLoad(e,o,a,r).catch(function(e){return i.handleFragLoadError(e)})}if(!e.url||this.loadedEndOfParts(o,n))return Promise.resolve(null)}}return this.log("Loading fragment "+e.sn+" cc: "+e.cc+" "+(t?"of ["+t.startSN+"-"+t.endSN+"] ":"")+("[stream-controller]"===this.logPrefix?"level":"track")+": "+e.level+", target: "+parseFloat(n.toFixed(3))),Object(f.isFiniteNumber)(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=A.FRAG_LOADING,this.hls.trigger(d.Events.FRAG_LOADING,{frag:e,targetBufferTime:n}),this.fragmentLoader.load(e,r).catch(function(e){return i.handleFragLoadError(e)})},s.doFragPartsLoad=function(l,u,t,n){var c=this;return new Promise(function(a,e){var s=[];!function r(i){var o=u[i];c.fragmentLoader.loadPart(l,o,n).then(function(e){s[o.index]=e;var t=e.part;c.hls.trigger(d.Events.FRAG_LOADED,e);var n=u[i+1];if(!n||n.fragment!==l)return a({frag:l,part:t,partsLoaded:s});r(i+1)}).catch(e)}(t)})},s.handleFragLoadError=function(e){var t=e.data;return t&&t.details===u.ErrorDetails.INTERNAL_ABORTED?this.handleFragLoadAborted(t.frag,t.part):this.hls.trigger(d.Events.ERROR,t),null},s._handleTransmuxerFlush=function(e){var t=this.getCurrentContext(e);if(t&&this.state===A.PARSING){var n=t.frag,r=t.part,i=t.level,o=self.performance.now();n.stats.parsing.end=o,r&&(r.stats.parsing.end=o),this.updateLevelTiming(n,r,i,e.partial)}else this.fragCurrent||(this.state=A.IDLE)},s.getCurrentContext=function(e){var t=this.levels,n=e.level,r=e.sn,i=e.part;if(!t||!t[n])return this.warn("Levels object was unset while buffering fragment "+r+" of level "+n+". The current chunk will not be buffered."),null;var o=t[n],a=i>-1?Object(m.getPartWith)(o,r,i):null,s=a?a.fragment:Object(m.getFragmentWithSN)(o,r,this.fragCurrent);return s?{frag:s,part:a,level:o}:null},s.bufferFragmentData=function(e,t,n,r){if(e&&this.state===A.PARSING){var i=e.data1,o=e.data2,a=i;if(i&&o&&(a=Object(g.appendUint8Array)(i,o)),a&&a.length){var s={type:e.type,frag:t,part:n,chunkMeta:r,parent:t.type,data:a};this.hls.trigger(d.Events.BUFFER_APPENDING,s),e.dropped&&e.independent&&!n&&this.flushBufferGap(t)}}},s.flushBufferGap=function(e){var t=this.media;if(t)if(c.BufferHelper.isBuffered(t,t.currentTime)){var n=t.currentTime,r=c.BufferHelper.bufferInfo(t,n,0),i=e.duration,o=Math.min(2*this.config.maxFragLookUpTolerance,.25*i),a=Math.max(Math.min(e.start-o,r.end-o),n+o);e.start-a>o&&this.flushMainBuffer(a,e.start)}else this.flushMainBuffer(0,e.start)},s.getFwdBufferInfo=function(e,t){var n=this.config,r=this.getLoadPosition();if(!Object(f.isFiniteNumber)(r))return null;var i=c.BufferHelper.bufferInfo(e,r,n.maxBufferHole);if(0===i.len&&void 0!==i.nextStart){var o=this.fragmentTracker.getBufferedFrag(r,t);if(o&&i.nextStart<o.end)return c.BufferHelper.bufferInfo(e,r,Math.max(i.nextStart,n.maxBufferHole))}return i},s.getMaxBufferLength=function(e){var t,n=this.config;return t=e?Math.max(8*n.maxBufferSize/e,n.maxBufferLength):n.maxBufferLength,Math.min(t,n.maxMaxBufferLength)},s.reduceMaxBufferLength=function(e){var t=this.config,n=e||t.maxBufferLength;return t.maxMaxBufferLength>=n&&(t.maxMaxBufferLength/=2,this.warn("Reduce max buffer length to "+t.maxMaxBufferLength+"s"),!0)},s.getNextFragment=function(e,t){var n=t.fragments,r=n.length;if(!r)return null;var i,o=this.config,a=n[0].start;if(t.live){var s=o.initialLiveManifestSize;if(r<s)return this.warn("Not enough fragments to start playback (have: "+r+", need: "+s+")"),null;t.PTSKnown||this.startFragRequested||-1!==this.startPosition||(i=this.getInitialLiveFragment(t,n),this.startPosition=i?this.hls.liveSyncPosition||i.start:e)}else e<=a&&(i=n[0]);if(!i){var l=o.lowLatencyMode?t.partEnd:t.fragmentEnd;i=this.getFragmentAtPosition(e,l,t)}return this.mapToInitFragWhenRequired(i)},s.mapToInitFragWhenRequired=function(e){return null==e||!e.initSegment||null!=e&&e.initSegment.data||this.bitrateTest?e:e.initSegment},s.getNextPart=function(e,t,n){for(var r=-1,i=!1,o=!0,a=0,s=e.length;a<s;a++){var l=e[a];if(o=o&&!l.independent,r>-1&&n<l.start)break;var u=l.loaded;!u&&(i||l.independent||o)&&l.fragment===t&&(r=a),i=u}return r},s.loadedEndOfParts=function(e,t){var n=e[e.length-1];return n&&t>n.start&&n.loaded},s.getInitialLiveFragment=function(e,t){var n=this.fragPrevious,r=null;if(n){if(e.hasProgramDateTime&&(this.log("Live playlist, switching playlist, load frag with same PDT: "+n.programDateTime),r=Object(y.findFragmentByPDT)(t,n.endProgramDateTime,this.config.maxFragLookUpTolerance)),!r){var i=n.sn+1;if(i>=e.startSN&&i<=e.endSN){var o=t[i-e.startSN];n.cc===o.cc&&(r=o,this.log("Live playlist, switching playlist, load frag with next SN: "+r.sn))}r||(r=Object(y.findFragWithCC)(t,n.cc))&&this.log("Live playlist, switching playlist, load frag with same CC: "+r.sn)}}else{var a=this.hls.liveSyncPosition;null!==a&&(r=this.getFragmentAtPosition(a,this.bitrateTest?e.fragmentEnd:e.edge,e))}return r},s.getFragmentAtPosition=function(e,t,n){var r,i=this.config,o=this.fragPrevious,a=n.fragments,s=n.endSN,l=n.fragmentHint,u=i.maxFragLookUpTolerance,c=!!(i.lowLatencyMode&&n.partList&&l);if(c&&l&&!this.bitrateTest&&(a=a.concat(l),s=l.sn),e<t){var f=e>t-u?0:u;r=Object(y.findFragmentByPTS)(o,a,e,f)}else r=a[a.length-1];if(r){var d=r.sn-n.startSN;if(o&&r.sn===o.sn&&!c)if(o&&r.level===o.level){var h=a[d+1];r.sn<s&&this.fragmentTracker.getState(h)!==p.FragmentState.OK?(this.log("SN "+r.sn+" just loaded, load next one: "+h.sn),r=h):r=null}}return r},s.synchronizeToLiveEdge=function(e){var t=this.config,n=this.media;if(n){var r=this.hls.liveSyncPosition,i=n.currentTime,o=e.fragments[0].start,a=e.edge,s=i>=o-t.maxFragLookUpTolerance&&i<=a;if(null!==r&&n.duration>r&&(i<r||!s)){var l=void 0!==t.liveMaxLatencyDuration?t.liveMaxLatencyDuration:t.liveMaxLatencyDurationCount*e.targetduration;(!s&&n.readyState<4||i<a-l)&&(this.loadedmetadata||(this.nextLoadPosition=r),n.readyState&&(this.warn("Playback: "+i.toFixed(3)+" is located too far from the end of live sliding playlist: "+a+", reset currentTime to : "+r.toFixed(3)),n.currentTime=r))}}},s.alignPlaylists=function(e,t){var n=this.levels,r=this.levelLastLoaded,i=this.fragPrevious,o=null!==r?n[r]:null,a=e.fragments.length;if(!a)return this.warn("No fragments in live playlist"),0;var s=e.fragments[0].start,l=!t,u=e.alignedSliding&&Object(f.isFiniteNumber)(s);if(l||!u&&!s){Object(v.alignStream)(i,o,e);var c=e.fragments[0].start;return this.log("Live playlist sliding: "+c.toFixed(2)+" start-sn: "+(t?t.startSN:"na")+"->"+e.startSN+" prev-sn: "+(i?i.sn:"na")+" fragments: "+a),c}return s},s.waitForCdnTuneIn=function(e){return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,3*e.partTarget)},s.setStartPosition=function(e,t){var n=this.startPosition;if(n<t&&(n=-1),-1===n||-1===this.lastCurrentTime){var r=e.startTimeOffset;Object(f.isFiniteNumber)(r)?(n=t+r,r<0&&(n+=e.totalduration),n=Math.min(Math.max(t,n),t+e.totalduration),this.log("Start time offset "+r+" found in playlist, adjust startPosition to "+n),this.startPosition=n):e.live?n=this.hls.liveSyncPosition||t:this.startPosition=n=0,this.lastCurrentTime=n}this.nextLoadPosition=n},s.getLoadPosition=function(){var e=this.media,t=0;return this.loadedmetadata&&e?t=e.currentTime:this.nextLoadPosition&&(t=this.nextLoadPosition),t},s.handleFragLoadAborted=function(e,t){this.transmuxer&&"initSegment"!==e.sn&&e.stats.aborted&&(this.warn("Fragment "+e.sn+(t?" part"+t.index:"")+" of level "+e.level+" was aborted"),this.resetFragmentLoading(e))},s.resetFragmentLoading=function(e){this.fragCurrent&&(this.fragContextChanged(e)||this.state===A.FRAG_LOADING_WAITING_RETRY)||(this.state=A.IDLE)},s.onFragmentOrKeyLoadError=function(e,t){if(!t.fatal){var n=t.frag;if(n&&n.type===e){var r=this.fragCurrent;console.assert(r&&n.sn===r.sn&&n.level===r.level&&n.urlId===r.urlId,"Frag load error must match current frag to retry");var i=this.config;if(this.fragLoadError+1<=i.fragLoadingMaxRetry){this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition);var o=Math.min(Math.pow(2,this.fragLoadError)*i.fragLoadingRetryDelay,i.fragLoadingMaxRetryTimeout);this.warn("Fragment "+n.sn+" of "+e+" "+n.level+" failed to load, retrying in "+o+"ms"),this.retryDate=self.performance.now()+o,this.fragLoadError++,this.state=A.FRAG_LOADING_WAITING_RETRY}else t.levelRetry?(e===k.PlaylistLevelType.AUDIO&&(this.fragCurrent=null),this.fragLoadError=0,this.state=A.IDLE):(l.logger.error(t.details+" reaches max retry, redispatch as fatal ..."),t.fatal=!0,this.hls.stopLoad(),this.state=A.ERROR)}}},s.afterBufferFlushed=function(e,t,n){if(e){var r=c.BufferHelper.getBuffered(e);this.fragmentTracker.detectEvictedFragments(t,r,n),this.state===A.ENDED&&this.resetLoadingState()}},s.resetLoadingState=function(){this.fragCurrent=null,this.fragPrevious=null,this.state=A.IDLE},s.resetStartWhenNotLoaded=function(e){if(!this.loadedmetadata){this.startFragRequested=!1;var t=this.levels?this.levels[e].details:null;null!=t&&t.live?(this.startPosition=-1,this.setStartPosition(t,0),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}},s.updateLevelTiming=function(o,e,a,s){var l=this,u=a.details;console.assert(!!u,"level.details must be defined"),Object.keys(o.elementaryStreams).reduce(function(e,t){var n=o.elementaryStreams[t];if(n){var r=n.endPTS-n.startPTS;if(r<=0)return l.warn("Could not parse fragment "+o.sn+" "+t+" duration reliably ("+r+")"),e||!1;var i=s?0:Object(m.updateFragPTSDTS)(u,o,n.startPTS,n.endPTS,n.startDTS,n.endDTS);return l.hls.trigger(d.Events.LEVEL_PTS_UPDATED,{details:u,level:a,drift:i,type:t,frag:o,start:n.startPTS,end:n.endPTS}),!0}return e},!1)||(this.warn("Found no media in fragment "+o.sn+" of level "+a.id+" resetting transmuxer to fallback to playlist timing"),this.resetTransmuxer()),this.state=A.PARSED,this.hls.trigger(d.Events.FRAG_PARSED,{frag:o,part:e})},s.resetTransmuxer=function(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)},r=n,(o=[{key:"state",get:function(){return this._state},set:function(e){var t=this._state;t!==e&&(this._state=e,this.log(t+"->"+e))}}])&&w(r.prototype,o),a&&w(r,a),Object.defineProperty(r,"prototype",{writable:!1}),n}(r.default)},"./src/controller/buffer-controller.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return a});var f=n("./src/polyfills/number.ts"),m=n("./src/events.ts"),b=n("./src/utils/logger.ts"),E=n("./src/errors.ts"),T=n("./src/utils/buffer-helper.ts"),r=n("./src/utils/mediasource-helper.ts"),s=n("./src/loader/fragment.ts"),i=n("./src/controller/buffer-operation-queue.ts"),o=Object(r.getMediaSource)(),p=/([ha]vc.)(?:\.[^.,]+)+/,a=function(){function e(e){var r=this;this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.appendError=0,this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this._onMediaSourceOpen=function(){var e=r.hls,t=r.media,n=r.mediaSource;b.logger.log("[buffer-controller]: Media source opened"),t&&(r.updateMediaElementDuration(),e.trigger(m.Events.MEDIA_ATTACHED,{media:t})),n&&n.removeEventListener("sourceopen",r._onMediaSourceOpen),r.checkPendingTracks()},this._onMediaSourceClose=function(){b.logger.log("[buffer-controller]: Media source closed")},this._onMediaSourceEnded=function(){b.logger.log("[buffer-controller]: Media source ended")},this.hls=e,this._initSourceBuffer(),this.registerListeners()}var t=e.prototype;return t.hasSourceTypes=function(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0},t.destroy=function(){this.unregisterListeners(),this.details=null},t.registerListeners=function(){var e=this.hls;e.on(m.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(m.Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(m.Events.MANIFEST_PARSED,this.onManifestParsed,this),e.on(m.Events.BUFFER_RESET,this.onBufferReset,this),e.on(m.Events.BUFFER_APPENDING,this.onBufferAppending,this),e.on(m.Events.BUFFER_CODECS,this.onBufferCodecs,this),e.on(m.Events.BUFFER_EOS,this.onBufferEos,this),e.on(m.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(m.Events.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(m.Events.FRAG_PARSED,this.onFragParsed,this),e.on(m.Events.FRAG_CHANGED,this.onFragChanged,this)},t.unregisterListeners=function(){var e=this.hls;e.off(m.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(m.Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(m.Events.MANIFEST_PARSED,this.onManifestParsed,this),e.off(m.Events.BUFFER_RESET,this.onBufferReset,this),e.off(m.Events.BUFFER_APPENDING,this.onBufferAppending,this),e.off(m.Events.BUFFER_CODECS,this.onBufferCodecs,this),e.off(m.Events.BUFFER_EOS,this.onBufferEos,this),e.off(m.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(m.Events.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(m.Events.FRAG_PARSED,this.onFragParsed,this),e.off(m.Events.FRAG_CHANGED,this.onFragChanged,this)},t._initSourceBuffer=function(){this.sourceBuffer={},this.operationQueue=new i.default(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]}},t.onManifestParsed=function(e,t){var n=2;(t.audio&&!t.video||!t.altAudio)&&(n=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=n,this.details=null,b.logger.log(this.bufferCodecEventsExpected+" bufferCodec event(s) expected")},t.onMediaAttaching=function(e,t){var n=this.media=t.media;if(n&&o){var r=this.mediaSource=new o;r.addEventListener("sourceopen",this._onMediaSourceOpen),r.addEventListener("sourceended",this._onMediaSourceEnded),r.addEventListener("sourceclose",this._onMediaSourceClose),n.src=self.URL.createObjectURL(r),this._objectUrl=n.src}},t.onMediaDetaching=function(){var e=this.media,t=this.mediaSource,n=this._objectUrl;if(t){if(b.logger.log("[buffer-controller]: media source detaching"),"open"===t.readyState)try{t.endOfStream()}catch(e){b.logger.warn("[buffer-controller]: onMediaDetaching: "+e.message+" while calling endOfStream")}this.onBufferReset(),t.removeEventListener("sourceopen",this._onMediaSourceOpen),t.removeEventListener("sourceended",this._onMediaSourceEnded),t.removeEventListener("sourceclose",this._onMediaSourceClose),e&&(n&&self.URL.revokeObjectURL(n),e.src===n?(e.removeAttribute("src"),e.load()):b.logger.warn("[buffer-controller]: media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(m.Events.MEDIA_DETACHED,void 0)},t.onBufferReset=function(){var n=this;this.getSourceBufferTypes().forEach(function(t){var e=n.sourceBuffer[t];try{e&&(n.removeBufferListeners(t),n.mediaSource&&n.mediaSource.removeSourceBuffer(e),n.sourceBuffer[t]=void 0)}catch(e){b.logger.warn("[buffer-controller]: Failed to reset the "+t+" buffer",e)}}),this._initSourceBuffer()},t.onBufferCodecs=function(e,f){var d=this,h=this.getSourceBufferTypes().length;Object.keys(f).forEach(function(e){if(h){var t=d.tracks[e];if(t&&"function"==typeof t.buffer.changeType){var n=f[e],r=n.id,i=n.codec,o=n.levelCodec,a=n.container,s=n.metadata,l=(t.levelCodec||t.codec).replace(p,"$1"),u=(o||i).replace(p,"$1");if(l!==u){var c=a+";codecs="+(o||i);d.appendChangeType(e,c),b.logger.log("[buffer-controller]: switching codec "+l+" to "+u),d.tracks[e]={buffer:t.buffer,codec:i,container:a,levelCodec:o,metadata:s,id:r}}}}else d.pendingTracks[e]=f[e]}),h||(this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&"open"===this.mediaSource.readyState&&this.checkPendingTracks())},t.appendChangeType=function(t,n){var r=this,i=this.operationQueue,e={execute:function(){var e=r.sourceBuffer[t];e&&(b.logger.log("[buffer-controller]: changing "+t+" sourceBuffer type to "+n),e.changeType(n)),i.shiftAndExecuteNext(t)},onStart:function(){},onComplete:function(){},onError:function(e){b.logger.warn("[buffer-controller]: Failed to change "+t+" SourceBuffer type",e)}};i.append(e,t)},t.onBufferAppending=function(e,t){var i=this,n=this.hls,r=this.operationQueue,o=this.tracks,a=t.data,s=t.type,l=t.frag,u=t.part,c=t.chunkMeta,f=c.buffering[s],d=self.performance.now();f.start=d;var h=l.stats.buffering,p=u?u.stats.buffering:null;0===h.start&&(h.start=d),p&&0===p.start&&(p.start=d);var g=o.audio,v="audio"===s&&1===c.id&&"audio/mpeg"===(null==g?void 0:g.container),y={execute:function(){if(f.executeStart=self.performance.now(),v){var e=i.sourceBuffer[s];if(e){var t=l.start-e.timestampOffset;Math.abs(t)>=.1&&(b.logger.log("[buffer-controller]: Updating audio SourceBuffer timestampOffset to "+l.start+" (delta: "+t+") sn: "+l.sn+")"),e.timestampOffset=l.start)}}i.appendExecutor(a,s)},onStart:function(){},onComplete:function(){var e=self.performance.now();f.executeEnd=f.end=e,0===h.first&&(h.first=e),p&&0===p.first&&(p.first=e);var t=i.sourceBuffer,n={};for(var r in t)n[r]=T.BufferHelper.getBuffered(t[r]);i.appendError=0,i.hls.trigger(m.Events.BUFFER_APPENDED,{type:s,frag:l,part:u,chunkMeta:c,parent:l.type,timeRanges:n})},onError:function(e){b.logger.error("[buffer-controller]: Error encountered while trying to append to the "+s+" SourceBuffer",e);var t={type:E.ErrorTypes.MEDIA_ERROR,parent:l.type,details:E.ErrorDetails.BUFFER_APPEND_ERROR,err:e,fatal:!1};e.code===DOMException.QUOTA_EXCEEDED_ERR?t.details=E.ErrorDetails.BUFFER_FULL_ERROR:(i.appendError++,t.details=E.ErrorDetails.BUFFER_APPEND_ERROR,i.appendError>n.config.appendErrorMaxRetry&&(b.logger.error("[buffer-controller]: Failed "+n.config.appendErrorMaxRetry+" times to append segment in sourceBuffer"),t.fatal=!0,n.stopLoad())),n.trigger(m.Events.ERROR,t)}};r.append(y,s)},t.onBufferFlushing=function(e,n){var r=this,t=this.operationQueue,i=function(t){return{execute:r.removeExecutor.bind(r,t,n.startOffset,n.endOffset),onStart:function(){},onComplete:function(){r.hls.trigger(m.Events.BUFFER_FLUSHED,{type:t})},onError:function(e){b.logger.warn("[buffer-controller]: Failed to remove from "+t+" SourceBuffer",e)}}};n.type?t.append(i(n.type),n.type):this.getSourceBufferTypes().forEach(function(e){t.append(i(e),e)})},t.onFragParsed=function(e,t){var n=this,r=t.frag,i=t.part,o=[],a=i?i.elementaryStreams:r.elementaryStreams;a[s.ElementaryStreamTypes.AUDIOVIDEO]?o.push("audiovideo"):(a[s.ElementaryStreamTypes.AUDIO]&&o.push("audio"),a[s.ElementaryStreamTypes.VIDEO]&&o.push("video"));0===o.length&&b.logger.warn("Fragments must have at least one ElementaryStreamType set. type: "+r.type+" level: "+r.level+" sn: "+r.sn),this.blockBuffers(function(){var e=self.performance.now();r.stats.buffering.end=e,i&&(i.stats.buffering.end=e);var t=i?i.stats:r.stats;n.hls.trigger(m.Events.FRAG_BUFFERED,{frag:r,part:i,stats:t,id:r.type})},o)},t.onFragChanged=function(e,t){this.flushBackBuffer()},t.onBufferEos=function(e,r){var i=this;this.getSourceBufferTypes().reduce(function(e,t){var n=i.sourceBuffer[t];return r.type&&r.type!==t||n&&!n.ended&&(n.ended=!0,b.logger.log("[buffer-controller]: "+t+" sourceBuffer now EOS")),e&&!(n&&!n.ended)},!0)&&this.blockBuffers(function(){var e=i.mediaSource;e&&"open"===e.readyState&&e.endOfStream()})},t.onLevelUpdated=function(e,t){var n=t.details;n.fragments.length&&(this.details=n,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())},t.flushBackBuffer=function(){var r=this.hls,i=this.details,e=this.media,o=this.sourceBuffer;if(e&&null!==i){var t=this.getSourceBufferTypes();if(t.length){var n=i.live&&null!==r.config.liveBackBufferLength?r.config.liveBackBufferLength:r.config.backBufferLength;if(Object(f.isFiniteNumber)(n)&&!(n<0)){var a=e.currentTime,s=i.levelTargetDuration,l=Math.max(n,s),u=Math.floor(a/s)*s-l;t.forEach(function(e){var t=o[e];if(t){var n=T.BufferHelper.getBuffered(t);n.length>0&&u>n.start(0)&&(r.trigger(m.Events.BACK_BUFFER_REACHED,{bufferEnd:u}),i.live&&r.trigger(m.Events.LIVE_BACK_BUFFER_REACHED,{bufferEnd:u}),r.trigger(m.Events.BUFFER_FLUSHING,{startOffset:0,endOffset:u,type:e}))}})}}}},t.updateMediaElementDuration=function(){if(this.details&&this.media&&this.mediaSource&&"open"===this.mediaSource.readyState){var e=this.details,t=this.hls,n=this.media,r=this.mediaSource,i=e.fragments[0].start+e.totalduration,o=n.duration,a=Object(f.isFiniteNumber)(r.duration)?r.duration:0;e.live&&t.config.liveDurationInfinity?(b.logger.log("[buffer-controller]: Media Source duration is set to Infinity"),r.duration=1/0,this.updateSeekableRange(e)):(i>a&&i>o||!Object(f.isFiniteNumber)(o))&&(b.logger.log("[buffer-controller]: Updating Media Source duration to "+i.toFixed(3)),r.duration=i)}},t.updateSeekableRange=function(e){var t=this.mediaSource,n=e.fragments;if(n.length&&e.live&&null!=t&&t.setLiveSeekableRange){var r=Math.max(0,n[0].start),i=Math.max(r,r+e.totalduration);t.setLiveSeekableRange(r,i)}},t.checkPendingTracks=function(){var e=this.bufferCodecEventsExpected,t=this.operationQueue,n=this.pendingTracks,r=Object.keys(n).length;if(r&&!e||2===r){this.createSourceBuffers(n),this.pendingTracks={};var i=this.getSourceBufferTypes();if(0===i.length)return void this.hls.trigger(m.Events.ERROR,{type:E.ErrorTypes.MEDIA_ERROR,details:E.ErrorDetails.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,reason:"could not create source buffer for media codec(s)"});i.forEach(function(e){t.executeNext(e)})}},t.createSourceBuffers=function(e){var t=this.sourceBuffer,n=this.mediaSource;if(!n)throw Error("createSourceBuffers called when mediaSource was null");var r=0;for(var i in e)if(!t[i]){var o=e[i];if(!o)throw Error("source buffer exists for track "+i+", however track does not");var a=o.levelCodec||o.codec,s=o.container+";codecs="+a;b.logger.log("[buffer-controller]: creating sourceBuffer("+s+")");try{var l=t[i]=n.addSourceBuffer(s),u=i;this.addBufferListener(u,"updatestart",this._onSBUpdateStart),this.addBufferListener(u,"updateend",this._onSBUpdateEnd),this.addBufferListener(u,"error",this._onSBUpdateError),this.tracks[i]={buffer:l,codec:a,container:o.container,levelCodec:o.levelCodec,metadata:o.metadata,id:o.id},r++}catch(e){b.logger.error("[buffer-controller]: error while trying to add sourceBuffer: "+e.message),this.hls.trigger(m.Events.ERROR,{type:E.ErrorTypes.MEDIA_ERROR,details:E.ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:e,mimeType:s})}}r&&this.hls.trigger(m.Events.BUFFER_CREATED,{tracks:this.tracks})},t._onSBUpdateStart=function(e){this.operationQueue.current(e).onStart()},t._onSBUpdateEnd=function(e){var t=this.operationQueue;t.current(e).onComplete(),t.shiftAndExecuteNext(e)},t._onSBUpdateError=function(e,t){b.logger.error("[buffer-controller]: "+e+" SourceBuffer error",t),this.hls.trigger(m.Events.ERROR,{type:E.ErrorTypes.MEDIA_ERROR,details:E.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1});var n=this.operationQueue.current(e);n&&n.onError(t)},t.removeExecutor=function(e,t,n){var r=this.media,i=this.mediaSource,o=this.operationQueue,a=this.sourceBuffer[e];if(!r||!i||!a)return b.logger.warn("[buffer-controller]: Attempting to remove from the "+e+" SourceBuffer, but it does not exist"),void o.shiftAndExecuteNext(e);var s=Object(f.isFiniteNumber)(r.duration)?r.duration:1/0,l=Object(f.isFiniteNumber)(i.duration)?i.duration:1/0,u=Math.max(0,t),c=Math.min(n,s,l);c>u?(b.logger.log("[buffer-controller]: Removing ["+u+","+c+"] from the "+e+" SourceBuffer"),console.assert(!a.updating,e+" sourceBuffer must not be updating"),a.remove(u,c)):o.shiftAndExecuteNext(e)},t.appendExecutor=function(e,t){var n=this.operationQueue,r=this.sourceBuffer[t];if(!r)return b.logger.warn("[buffer-controller]: Attempting to append to the "+t+" SourceBuffer, but it does not exist"),void n.shiftAndExecuteNext(t);r.ended=!1,console.assert(!r.updating,t+" sourceBuffer must not be updating"),r.appendBuffer(e)},t.blockBuffers=function(e,t){var n=this;if(void 0===t&&(t=this.getSourceBufferTypes()),!t.length)return b.logger.log("[buffer-controller]: Blocking operation requested, but no SourceBuffers exist"),void Promise.resolve().then(e);var r=this.operationQueue,i=t.map(function(e){return r.appendBlocker(e)});Promise.all(i).then(function(){e(),t.forEach(function(e){var t=n.sourceBuffer[e];t&&t.updating||r.shiftAndExecuteNext(e)})})},t.getSourceBufferTypes=function(){return Object.keys(this.sourceBuffer)},t.addBufferListener=function(e,t,n){var r=this.sourceBuffer[e];if(r){var i=n.bind(this,e);this.listeners[e].push({event:t,listener:i}),r.addEventListener(t,i)}},t.removeBufferListeners=function(e){var t=this.sourceBuffer[e];t&&this.listeners[e].forEach(function(e){t.removeEventListener(e.event,e.listener)})},e}()},"./src/controller/buffer-operation-queue.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return r});var a=n("./src/utils/logger.ts"),r=function(){function e(e){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=e}var t=e.prototype;return t.append=function(e,t){var n=this.queues[t];n.push(e),1===n.length&&this.buffers[t]&&this.executeNext(t)},t.insertAbort=function(e,t){this.queues[t].unshift(e),this.executeNext(t)},t.appendBlocker=function(e){var t,n=new Promise(function(e){t=e}),r={execute:t,onStart:function(){},onComplete:function(){},onError:function(){}};return this.append(r,e),n},t.executeNext=function(e){var t=this.buffers,n=this.queues,r=t[e],i=n[e];if(i.length){var o=i[0];try{o.execute()}catch(t){a.logger.warn("[buffer-operation-queue]: Unhandled exception executing the current operation"),o.onError(t),r&&r.updating||(i.shift(),this.executeNext(e))}}},t.shiftAndExecuteNext=function(e){this.queues[e].shift(),this.executeNext(e)},t.current=function(e){return this.queues[e][0]},e}()},"./src/controller/cap-level-controller.ts":function(e,t,n){"use strict";n.r(t);var o=n("./src/events.ts");function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var r=function(){function i(e){this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.hls=void 0,this.streamController=void 0,this.clientRect=void 0,this.hls=e,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}var e,t,n,r=i.prototype;return r.setStreamController=function(e){this.streamController=e},r.destroy=function(){this.unregisterListener(),this.hls.config.capLevelToPlayerSize&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null},r.registerListeners=function(){var e=this.hls;e.on(o.Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on(o.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(o.Events.MANIFEST_PARSED,this.onManifestParsed,this),e.on(o.Events.BUFFER_CODECS,this.onBufferCodecs,this),e.on(o.Events.MEDIA_DETACHING,this.onMediaDetaching,this)},r.unregisterListener=function(){var e=this.hls;e.off(o.Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off(o.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(o.Events.MANIFEST_PARSED,this.onManifestParsed,this),e.off(o.Events.BUFFER_CODECS,this.onBufferCodecs,this),e.off(o.Events.MEDIA_DETACHING,this.onMediaDetaching,this)},r.onFpsDropLevelCapping=function(e,t){i.isLevelAllowed(t.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(t.droppedLevel)},r.onMediaAttaching=function(e,t){this.media=t.media instanceof HTMLVideoElement?t.media:null},r.onManifestParsed=function(e,t){var n=this.hls;this.restrictedLevels=[],this.firstLevel=t.firstLevel,n.config.capLevelToPlayerSize&&t.video&&this.startCapping()},r.onBufferCodecs=function(e,t){this.hls.config.capLevelToPlayerSize&&t.video&&this.startCapping()},r.onMediaDetaching=function(){this.stopCapping()},r.detectPlayerSize=function(){if(this.media&&this.mediaHeight>0&&this.mediaWidth>0){var e=this.hls.levels;if(e.length){var t=this.hls;t.autoLevelCapping=this.getMaxLevel(e.length-1),t.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}},r.getMaxLevel=function(n){var r=this,e=this.hls.levels;if(!e.length)return-1;var t=e.filter(function(e,t){return i.isLevelAllowed(t,r.restrictedLevels)&&t<=n});return this.clientRect=null,i.getMaxLevelByMediaSize(t,this.mediaWidth,this.mediaHeight)},r.startCapping=function(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())},r.stopCapping=function(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)},r.getDimensions=function(){if(this.clientRect)return this.clientRect;var e=this.media,t={width:0,height:0};if(e){var n=e.getBoundingClientRect();t.width=n.width,t.height=n.height,t.width||t.height||(t.width=n.right-n.left||e.width||0,t.height=n.bottom-n.top||e.height||0)}return this.clientRect=t,t},i.isLevelAllowed=function(e,t){return void 0===t&&(t=[]),-1===t.indexOf(e)},i.getMaxLevelByMediaSize=function(e,t,n){if(!e||!e.length)return-1;for(var r,i,o=e.length-1,a=0;a<e.length;a+=1){var s=e[a];if((s.width>=t||s.height>=n)&&(r=s,!(i=e[a+1])||r.width!==i.width||r.height!==i.height)){o=a;break}}return o},e=i,(t=[{key:"mediaWidth",get:function(){return this.getDimensions().width*this.contentScaleFactor}},{key:"mediaHeight",get:function(){return this.getDimensions().height*this.contentScaleFactor}},{key:"contentScaleFactor",get:function(){var e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=self.devicePixelRatio}catch(e){}return e}}])&&a(e.prototype,t),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),i}();t.default=r},"./src/controller/cmcd-controller.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return c});var r=n("./src/events.ts"),u=n("./src/types/cmcd.ts"),i=n("./src/utils/buffer-helper.ts"),a=n("./src/utils/logger.ts");function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function h(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function f(){return(f=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var c=function(){function c(e){var o=this;this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=function(){o.initialized&&(o.starved=!0),o.buffering=!0},this.onPlaying=function(){o.initialized||(o.initialized=!0),o.buffering=!1},this.applyPlaylistData=function(e){try{o.apply(e,{ot:u.CMCDObjectType.MANIFEST,su:!o.initialized})}catch(e){a.logger.warn("Could not generate manifest CMCD data.",e)}},this.applyFragmentData=function(e){try{var t=e.frag,n=o.hls.levels[t.level],r=o.getObjectType(t),i={d:1e3*t.duration,ot:r};r!==u.CMCDObjectType.VIDEO&&r!==u.CMCDObjectType.AUDIO&&r!=u.CMCDObjectType.MUXED||(i.br=n.bitrate/1e3,i.tb=o.getTopBandwidth(r)/1e3,i.bl=o.getBufferLength(r)),o.apply(e,i)}catch(e){a.logger.warn("Could not generate segment CMCD data.",e)}},this.hls=e;var t=this.config=e.config,n=t.cmcd;null!=n&&(t.pLoader=this.createPlaylistLoader(),t.fLoader=this.createFragmentLoader(),this.sid=n.sessionId||c.uuid(),this.cid=n.contentId,this.useHeaders=!0===n.useHeaders,this.registerListeners())}var e=c.prototype;return e.registerListeners=function(){var e=this.hls;e.on(r.Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(r.Events.MEDIA_DETACHED,this.onMediaDetached,this),e.on(r.Events.BUFFER_CREATED,this.onBufferCreated,this)},e.unregisterListeners=function(){var e=this.hls;e.off(r.Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(r.Events.MEDIA_DETACHED,this.onMediaDetached,this),e.off(r.Events.BUFFER_CREATED,this.onBufferCreated,this),this.onMediaDetached()},e.destroy=function(){this.unregisterListeners(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null},e.onMediaAttached=function(e,t){this.media=t.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)},e.onMediaDetached=function(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)},e.onBufferCreated=function(e,t){var n,r;this.audioBuffer=null===(n=t.tracks.audio)||void 0===n?void 0:n.buffer,this.videoBuffer=null===(r=t.tracks.video)||void 0===r?void 0:r.buffer},e.createData=function(){var e;return{v:u.CMCDVersion,sf:u.CMCDStreamingFormat.HLS,sid:this.sid,cid:this.cid,pr:null===(e=this.media)||void 0===e?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}},e.apply=function(e,t){void 0===t&&(t={}),f(t,this.createData());var n=t.ot===u.CMCDObjectType.INIT||t.ot===u.CMCDObjectType.VIDEO||t.ot===u.CMCDObjectType.MUXED;if(this.starved&&n&&(t.bs=!0,t.su=!0,this.starved=!1),null==t.su&&(t.su=this.buffering),this.useHeaders){var r=c.toHeaders(t);if(!Object.keys(r).length)return;e.headers||(e.headers={}),f(e.headers,r)}else{var i=c.toQuery(t);if(!i)return;e.url=c.appendQueryToUri(e.url,i)}},e.getObjectType=function(e){var t=e.type;return"subtitle"===t?u.CMCDObjectType.TIMED_TEXT:"initSegment"===e.sn?u.CMCDObjectType.INIT:"audio"===t?u.CMCDObjectType.AUDIO:"main"===t?this.hls.audioTracks.length?u.CMCDObjectType.VIDEO:u.CMCDObjectType.MUXED:void 0},e.getTopBandwidth=function(e){var t,n=0,r=this.hls;if(e===u.CMCDObjectType.AUDIO)t=r.audioTracks;else{var i=r.maxAutoLevel,o=i>-1?i+1:r.levels.length;t=r.levels.slice(0,o)}for(var a,s=h(t);!(a=s()).done;){var l=a.value;l.bitrate>n&&(n=l.bitrate)}return n>0?n:NaN},e.getBufferLength=function(e){var t=this.hls.media,n=e===u.CMCDObjectType.AUDIO?this.audioBuffer:this.videoBuffer;return n&&t?1e3*i.BufferHelper.bufferInfo(n,t.currentTime,this.config.maxBufferHole).len:NaN},e.createPlaylistLoader=function(){var e=this.config.pLoader,r=this.applyPlaylistData,n=e||this.config.loader;return function(){function e(e){this.loader=void 0,this.loader=new n(e)}var t=e.prototype;return t.destroy=function(){this.loader.destroy()},t.abort=function(){this.loader.abort()},t.load=function(e,t,n){r(e),this.loader.load(e,t,n)},s(e,[{key:"stats",get:function(){return this.loader.stats}},{key:"context",get:function(){return this.loader.context}}]),e}()},e.createFragmentLoader=function(){var e=this.config.fLoader,r=this.applyFragmentData,n=e||this.config.loader;return function(){function e(e){this.loader=void 0,this.loader=new n(e)}var t=e.prototype;return t.destroy=function(){this.loader.destroy()},t.abort=function(){this.loader.abort()},t.load=function(e,t,n){r(e),this.loader.load(e,t,n)},s(e,[{key:"stats",get:function(){return this.loader.stats}},{key:"context",get:function(){return this.loader.context}}]),e}()},c.uuid=function(){var e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.slice(t.lastIndexOf("/")+1)},c.serialize=function(e){for(var t,n=[],r=function(e){return!Number.isNaN(e)&&null!=e&&""!==e&&!1!==e},i=function(e){return Math.round(e)},o=function(e){return 100*i(e/100)},a={br:i,d:i,bl:o,dl:o,mtp:o,nor:function(e){return encodeURIComponent(e)},rtp:o,tb:i},s=h(Object.keys(e||{}).sort());!(t=s()).done;){var l=t.value,u=e[l];if(r(u)&&!("v"===l&&1===u||"pr"==l&&1===u)){var c=a[l];c&&(u=c(u));var f=typeof u,d=void 0;d="ot"===l||"sf"===l||"st"===l?l+"="+u:"boolean"===f?l:"number"===f?l+"="+u:l+"="+JSON.stringify(u),n.push(d)}}return n.join(",")},c.toHeaders=function(e){for(var t={},n=["Object","Request","Session","Status"],r=[{},{},{},{}],i={br:0,d:0,ot:0,tb:0,bl:1,dl:1,mtp:1,nor:1,nrr:1,su:1,cid:2,pr:2,sf:2,sid:2,st:2,v:2,bs:3,rtp:3},o=0,a=Object.keys(e);o<a.length;o++){var s=a[o];r[null!=i[s]?i[s]:1][s]=e[s]}for(var l=0;l<r.length;l++){var u=c.serialize(r[l]);u&&(t["CMCD-"+n[l]]=u)}return t},c.toQuery=function(e){return"CMCD="+encodeURIComponent(c.serialize(e))},c.appendQueryToUri=function(e,t){if(!t)return e;var n=e.includes("?")?"&":"?";return""+e+n+t},c}()},"./src/controller/eme-controller.ts":function(e,t,n){"use strict";n.r(t);var s=n("./src/events.ts"),l=n("./src/errors.ts"),u=n("./src/utils/logger.ts"),a=n("./src/utils/mediakeys-helper.ts");function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var r=function(){function e(e){this.hls=void 0,this._widevineLicenseUrl=void 0,this._licenseXhrSetup=void 0,this._licenseResponseCallback=void 0,this._emeEnabled=void 0,this._requestMediaKeySystemAccess=void 0,this._drmSystemOptions=void 0,this._config=void 0,this._mediaKeysList=[],this._media=null,this._hasSetMediaKeys=!1,this._requestLicenseFailureCount=0,this.mediaKeysPromise=null,this._onMediaEncrypted=this.onMediaEncrypted.bind(this),this.hls=e,this._config=e.config,this._widevineLicenseUrl=this._config.widevineLicenseUrl,this._licenseXhrSetup=this._config.licenseXhrSetup,this._licenseResponseCallback=this._config.licenseResponseCallback,this._emeEnabled=this._config.emeEnabled,this._requestMediaKeySystemAccess=this._config.requestMediaKeySystemAccessFunc,this._drmSystemOptions=this._config.drmSystemOptions,this._registerListeners()}var t,n,r,i=e.prototype;return i.destroy=function(){this._unregisterListeners(),this.hls=this._onMediaEncrypted=null,this._requestMediaKeySystemAccess=null},i._registerListeners=function(){this.hls.on(s.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(s.Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(s.Events.MANIFEST_PARSED,this.onManifestParsed,this)},i._unregisterListeners=function(){this.hls.off(s.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(s.Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(s.Events.MANIFEST_PARSED,this.onManifestParsed,this)},i.getLicenseServerUrl=function(e){switch(e){case a.KeySystems.WIDEVINE:if(!this._widevineLicenseUrl)break;return this._widevineLicenseUrl}throw new Error('no license server URL configured for key-system "'+e+'"')},i._attemptKeySystemAccess=function(t,e,n){var r=this,i=function(e,t,n,r){switch(e){case a.KeySystems.WIDEVINE:return function(e,t,n){var r={audioCapabilities:[],videoCapabilities:[]};return e.forEach(function(e){r.audioCapabilities.push({contentType:'audio/mp4; codecs="'+e+'"',robustness:n.audioRobustness||""})}),t.forEach(function(e){r.videoCapabilities.push({contentType:'video/mp4; codecs="'+e+'"',robustness:n.videoRobustness||""})}),[r]}(t,n,r);default:throw new Error("Unknown key-system: "+e)}}(t,e,n,this._drmSystemOptions);u.logger.log("Requesting encrypted media key-system access");var o=this.requestMediaKeySystemAccess(t,i);this.mediaKeysPromise=o.then(function(e){return r._onMediaKeySystemAccessObtained(t,e)}),o.catch(function(e){u.logger.error('Failed to obtain key-system "'+t+'" access:',e)})},i._onMediaKeySystemAccessObtained=function(t,e){var n=this;u.logger.log('Access for key-system "'+t+'" obtained');var r={mediaKeysSessionInitialized:!1,mediaKeySystemAccess:e,mediaKeySystemDomain:t};this._mediaKeysList.push(r);var i=Promise.resolve().then(function(){return e.createMediaKeys()}).then(function(e){return r.mediaKeys=e,u.logger.log('Media-keys created for key-system "'+t+'"'),n._onMediaKeysCreated(),e});return i.catch(function(e){u.logger.error("Failed to create media-keys:",e)}),i},i._onMediaKeysCreated=function(){var t=this;this._mediaKeysList.forEach(function(e){e.mediaKeysSession||(e.mediaKeysSession=e.mediaKeys.createSession(),t._onNewMediaKeySession(e.mediaKeysSession))})},i._onNewMediaKeySession=function(t){var n=this;u.logger.log("New key-system session "+t.sessionId),t.addEventListener("message",function(e){n._onKeySessionMessage(t,e.message)},!1)},i._onKeySessionMessage=function(t,e){u.logger.log("Got EME message event, creating license request"),this._requestLicense(e,function(e){u.logger.log("Received license data (length: "+(e?e.byteLength:e)+"), updating key-session"),t.update(e).catch(function(e){u.logger.warn("Updating key-session failed: "+e)})})},i.onMediaEncrypted=function(t){var n=this;if(u.logger.log('Media is encrypted using "'+t.initDataType+'" init data type'),!this.mediaKeysPromise)return u.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been requested"),void this.hls.trigger(s.Events.ERROR,{type:l.ErrorTypes.KEY_SYSTEM_ERROR,details:l.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});var e=function(e){n._media&&(n._attemptSetMediaKeys(e),n._generateRequestWithPreferredKeySession(t.initDataType,t.initData))};this.mediaKeysPromise.then(e).catch(e)},i._attemptSetMediaKeys=function(e){if(!this._media)throw new Error("Attempted to set mediaKeys without first attaching a media element");if(!this._hasSetMediaKeys){var t=this._mediaKeysList[0];if(!t||!t.mediaKeys)return u.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been obtained yet"),void this.hls.trigger(s.Events.ERROR,{type:l.ErrorTypes.KEY_SYSTEM_ERROR,details:l.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});u.logger.log("Setting keys for encrypted media"),this._media.setMediaKeys(t.mediaKeys),this._hasSetMediaKeys=!0}},i._generateRequestWithPreferredKeySession=function(e,t){var n=this,r=this._mediaKeysList[0];if(!r)return u.logger.error("Fatal: Media is encrypted but not any key-system access has been obtained yet"),void this.hls.trigger(s.Events.ERROR,{type:l.ErrorTypes.KEY_SYSTEM_ERROR,details:l.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});if(r.mediaKeysSessionInitialized)u.logger.warn("Key-Session already initialized but requested again");else{var i=r.mediaKeysSession;if(!i)return u.logger.error("Fatal: Media is encrypted but no key-session existing"),void this.hls.trigger(s.Events.ERROR,{type:l.ErrorTypes.KEY_SYSTEM_ERROR,details:l.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!0});if(!t)return u.logger.warn("Fatal: initData required for generating a key session is null"),void this.hls.trigger(s.Events.ERROR,{type:l.ErrorTypes.KEY_SYSTEM_ERROR,details:l.ErrorDetails.KEY_SYSTEM_NO_INIT_DATA,fatal:!0});u.logger.log('Generating key-session request for "'+e+'" init data type'),r.mediaKeysSessionInitialized=!0,i.generateRequest(e,t).then(function(){u.logger.debug("Key-session generation succeeded")}).catch(function(e){u.logger.error("Error generating key-session request:",e),n.hls.trigger(s.Events.ERROR,{type:l.ErrorTypes.KEY_SYSTEM_ERROR,details:l.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!1})})}},i._createLicenseXhr=function(e,t,n){var r=new XMLHttpRequest;r.responseType="arraybuffer",r.onreadystatechange=this._onLicenseRequestReadyStageChange.bind(this,r,e,t,n);var i=this._licenseXhrSetup;if(i)try{i.call(this.hls,r,e),i=void 0}catch(e){u.logger.error(e)}try{r.readyState||r.open("POST",e,!0),i&&i.call(this.hls,r,e)}catch(e){throw new Error("issue setting up KeySystem license XHR "+e)}return r},i._onLicenseRequestReadyStageChange=function(e,t,n,r){switch(e.readyState){case 4:if(200===e.status){this._requestLicenseFailureCount=0,u.logger.log("License request succeeded");var i=e.response,o=this._licenseResponseCallback;if(o)try{i=o.call(this.hls,e,t)}catch(e){u.logger.error(e)}r(i)}else{if(u.logger.error("License Request XHR failed ("+t+"). Status: "+e.status+" ("+e.statusText+")"),this._requestLicenseFailureCount++,this._requestLicenseFailureCount>3)return void this.hls.trigger(s.Events.ERROR,{type:l.ErrorTypes.KEY_SYSTEM_ERROR,details:l.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0});var a=3-this._requestLicenseFailureCount+1;u.logger.warn("Retrying license request, "+a+" attempts left"),this._requestLicense(n,r)}}},i._generateLicenseRequestChallenge=function(e,t){switch(e.mediaKeySystemDomain){case a.KeySystems.WIDEVINE:return t}throw new Error("unsupported key-system: "+e.mediaKeySystemDomain)},i._requestLicense=function(e,t){u.logger.log("Requesting content license for key-system");var n=this._mediaKeysList[0];if(!n)return u.logger.error("Fatal error: Media is encrypted but no key-system access has been obtained yet"),void this.hls.trigger(s.Events.ERROR,{type:l.ErrorTypes.KEY_SYSTEM_ERROR,details:l.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});try{var r=this.getLicenseServerUrl(n.mediaKeySystemDomain),i=this._createLicenseXhr(r,e,t);u.logger.log("Sending license request to URL: "+r);var o=this._generateLicenseRequestChallenge(n,e);i.send(o)}catch(e){u.logger.error("Failure requesting DRM license: "+e),this.hls.trigger(s.Events.ERROR,{type:l.ErrorTypes.KEY_SYSTEM_ERROR,details:l.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})}},i.onMediaAttached=function(e,t){if(this._emeEnabled){var n=t.media;this._media=n,n.addEventListener("encrypted",this._onMediaEncrypted)}},i.onMediaDetached=function(){var e=this._media,t=this._mediaKeysList;e&&(e.removeEventListener("encrypted",this._onMediaEncrypted),this._media=null,this._mediaKeysList=[],Promise.all(t.map(function(e){if(e.mediaKeysSession)return e.mediaKeysSession.close().catch(function(){})})).then(function(){return e.setMediaKeys(null)}).catch(function(){}))},i.onManifestParsed=function(e,t){if(this._emeEnabled){var n=t.levels.map(function(e){return e.audioCodec}).filter(function(e){return!!e}),r=t.levels.map(function(e){return e.videoCodec}).filter(function(e){return!!e});this._attemptKeySystemAccess(a.KeySystems.WIDEVINE,n,r)}},t=e,(n=[{key:"requestMediaKeySystemAccess",get:function(){if(!this._requestMediaKeySystemAccess)throw new Error("No requestMediaKeySystemAccess function configured");return this._requestMediaKeySystemAccess}}])&&o(t.prototype,n),r&&o(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.default=r},"./src/controller/fps-controller.ts":function(e,t,n){"use strict";n.r(t);var c=n("./src/events.ts"),f=n("./src/utils/logger.ts"),r=function(){function e(e){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=e,this.registerListeners()}var t=e.prototype;return t.setStreamController=function(e){this.streamController=e},t.registerListeners=function(){this.hls.on(c.Events.MEDIA_ATTACHING,this.onMediaAttaching,this)},t.unregisterListeners=function(){this.hls.off(c.Events.MEDIA_ATTACHING,this.onMediaAttaching)},t.destroy=function(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null},t.onMediaAttaching=function(e,t){var n=this.hls.config;if(n.capLevelOnFPSDrop){var r=t.media instanceof self.HTMLVideoElement?t.media:null;this.media=r,r&&"function"==typeof r.getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),n.fpsDroppedMonitoringPeriod)}},t.checkFPS=function(e,t,n){var r=performance.now();if(t){if(this.lastTime){var i=r-this.lastTime,o=n-this.lastDroppedFrames,a=t-this.lastDecodedFrames,s=1e3*o/i,l=this.hls;if(l.trigger(c.Events.FPS_DROP,{currentDropped:o,currentDecoded:a,totalDroppedFrames:n}),s>0&&o>l.config.fpsDroppedMonitoringThreshold*a){var u=l.currentLevel;f.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+u),u>0&&(-1===l.autoLevelCapping||l.autoLevelCapping>=u)&&(u-=1,l.trigger(c.Events.FPS_DROP_LEVEL_CAPPING,{level:u,droppedLevel:l.currentLevel}),l.autoLevelCapping=u,this.streamController.nextLevelSwitch())}}this.lastTime=r,this.lastDroppedFrames=n,this.lastDecodedFrames=t}},t.checkFPSInterval=function(){var e=this.media;if(e)if(this.isVideoPlaybackQualityAvailable){var t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)},e}();t.default=r},"./src/controller/fragment-finders.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"findFragmentByPDT",function(){return r}),n.d(t,"findFragmentByPTS",function(){return i}),n.d(t,"fragmentWithinToleranceTest",function(){return s}),n.d(t,"pdtWithinToleranceTest",function(){return l}),n.d(t,"findFragWithCC",function(){return u});var o=n("./src/polyfills/number.ts"),a=n("./src/utils/binary-search.ts");function r(e,t,n){if(null===t||!Array.isArray(e)||!e.length||!Object(o.isFiniteNumber)(t))return null;if(t<(e[0].programDateTime||0))return null;if(t>=(e[e.length-1].endProgramDateTime||0))return null;n=n||0;for(var r=0;r<e.length;++r){var i=e[r];if(l(t,n,i))return i}return null}function i(e,t,n,r){void 0===n&&(n=0),void 0===r&&(r=0);var i=null;if(e?i=t[e.sn-t[0].sn+1]||null:0===n&&0===t[0].start&&(i=t[0]),i&&0===s(n,r,i))return i;var o=a.default.search(t,s.bind(null,n,r));return o||i}function s(e,t,n){void 0===e&&(e=0),void 0===t&&(t=0);var r=Math.min(t,n.duration+(n.deltaPTS?n.deltaPTS:0));return n.start+n.duration-r<=e?1:n.start-r>e&&n.start?-1:0}function l(e,t,n){var r=1e3*Math.min(t,n.duration+(n.deltaPTS?n.deltaPTS:0));return(n.endProgramDateTime||0)-r>e}function u(e,t){return a.default.search(e,function(e){return e.cc<t?1:e.cc>t?-1:0})}},"./src/controller/fragment-tracker.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"FragmentState",function(){return r}),n.d(t,"FragmentTracker",function(){return o});var r,i=n("./src/events.ts"),s=n("./src/types/loader.ts");!function(e){e.NOT_LOADED="NOT_LOADED",e.APPENDING="APPENDING",e.PARTIAL="PARTIAL",e.OK="OK"}(r||(r={}));var o=function(){function e(e){this.activeFragment=null,this.activeParts=null,this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hls=e,this._registerListeners()}var t=e.prototype;return t._registerListeners=function(){var e=this.hls;e.on(i.Events.BUFFER_APPENDED,this.onBufferAppended,this),e.on(i.Events.FRAG_BUFFERED,this.onFragBuffered,this),e.on(i.Events.FRAG_LOADED,this.onFragLoaded,this)},t._unregisterListeners=function(){var e=this.hls;e.off(i.Events.BUFFER_APPENDED,this.onBufferAppended,this),e.off(i.Events.FRAG_BUFFERED,this.onFragBuffered,this),e.off(i.Events.FRAG_LOADED,this.onFragLoaded,this)},t.destroy=function(){this._unregisterListeners(),this.fragments=this.timeRanges=null},t.getAppendedFrag=function(e,t){if(t===s.PlaylistLevelType.MAIN){var n=this.activeFragment,r=this.activeParts;if(!n)return null;if(r)for(var i=r.length;i--;){var o=r[i],a=o?o.end:n.appendedPTS;if(o.start<=e&&void 0!==a&&e<=a)return i>9&&(this.activeParts=r.slice(i-9)),o}else if(n.start<=e&&void 0!==n.appendedPTS&&e<=n.appendedPTS)return n}return this.getBufferedFrag(e,t)},t.getBufferedFrag=function(e,t){for(var n=this.fragments,r=Object.keys(n),i=r.length;i--;){var o=n[r[i]];if((null==o?void 0:o.body.type)===t&&o.buffered){var a=o.body;if(a.start<=e&&e<=a.end)return a}}return null},t.detectEvictedFragments=function(r,i,o){var a=this;Object.keys(this.fragments).forEach(function(e){var n=a.fragments[e];if(n)if(n.buffered){var t=n.range[r];t&&t.time.some(function(e){var t=!a.isTimeBuffered(e.startPTS,e.endPTS,i);return t&&a.removeFragment(n.body),t})}else n.body.type===o&&a.removeFragment(n.body)})},t.detectPartialFragments=function(e){var i=this,o=this.timeRanges,a=e.frag,s=e.part;if(o&&"initSegment"!==a.sn){var t=u(a),l=this.fragments[t];l&&(Object.keys(o).forEach(function(e){var t=a.elementaryStreams[e];if(t){var n=o[e],r=null!==s||!0===t.partial;l.range[e]=i.getBufferedTimes(a,s,r,n)}}),l.loaded=null,Object.keys(l.range).length?l.buffered=!0:this.removeFragment(l.body))}},t.fragBuffered=function(e){var t=u(e),n=this.fragments[t];n&&(n.loaded=null,n.buffered=!0)},t.getBufferedTimes=function(e,t,n,r){for(var i={time:[],partial:n},o=t?t.start:e.start,a=t?t.end:e.end,s=e.minEndPTS||a,l=e.maxStartPTS||o,u=0;u<r.length;u++){var c=r.start(u)-this.bufferPadding,f=r.end(u)+this.bufferPadding;if(l>=c&&s<=f){i.time.push({startPTS:Math.max(o,r.start(u)),endPTS:Math.min(a,r.end(u))});break}if(o<f&&a>c)i.partial=!0,i.time.push({startPTS:Math.max(o,r.start(u)),endPTS:Math.min(a,r.end(u))});else if(a<=c)break}return i},t.getPartialFragment=function(n){var r,i,o,a=null,s=0,l=this.bufferPadding,u=this.fragments;return Object.keys(u).forEach(function(e){var t=u[e];t&&c(t)&&(i=t.body.start-l,o=t.body.end+l,n>=i&&n<=o&&(r=Math.min(n-i,o-n),s<=r&&(a=t.body,s=r)))}),a},t.getState=function(e){var t=u(e),n=this.fragments[t];return n?n.buffered?c(n)?r.PARTIAL:r.OK:r.APPENDING:r.NOT_LOADED},t.isTimeBuffered=function(e,t,n){for(var r,i,o=0;o<n.length;o++){if(r=n.start(o)-this.bufferPadding,i=n.end(o)+this.bufferPadding,e>=r&&t<=i)return!0;if(t<=r)return!1}return!1},t.onFragLoaded=function(e,t){var n=t.frag,r=t.part;if("initSegment"!==n.sn&&!n.bitrateTest&&!r){var i=u(n);this.fragments[i]={body:n,loaded:t,buffered:!1,range:Object.create(null)}}},t.onBufferAppended=function(e,t){var r=this,i=t.frag,o=t.part,a=t.timeRanges;if(i.type===s.PlaylistLevelType.MAIN)if(this.activeFragment=i,o){var n=this.activeParts;n||(this.activeParts=n=[]),n.push(o)}else this.activeParts=null;this.timeRanges=a,Object.keys(a).forEach(function(e){var t=a[e];if(r.detectEvictedFragments(e,t),!o)for(var n=0;n<t.length;n++)i.appendedPTS=Math.max(t.end(n),i.appendedPTS||0)})},t.onFragBuffered=function(e,t){this.detectPartialFragments(t)},t.hasFragment=function(e){var t=u(e);return!!this.fragments[t]},t.removeFragmentsInRange=function(r,i,o){var a=this;Object.keys(this.fragments).forEach(function(e){var t=a.fragments[e];if(t&&t.buffered){var n=t.body;n.type===o&&n.start<i&&n.end>r&&a.removeFragment(n)}})},t.removeFragment=function(e){var t=u(e);e.stats.loaded=0,e.clearElementaryStreamInfo(),delete this.fragments[t]},t.removeAllFragments=function(){this.fragments=Object.create(null),this.activeFragment=null,this.activeParts=null},e}();function c(e){var t,n;return e.buffered&&((null===(t=e.range.video)||void 0===t?void 0:t.partial)||(null===(n=e.range.audio)||void 0===n?void 0:n.partial))}function u(e){return e.type+"_"+e.level+"_"+e.urlId+"_"+e.sn}},"./src/controller/gap-controller.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"STALL_MINIMUM_DURATION_MS",function(){return _}),n.d(t,"MAX_START_GAP_JUMP",function(){return S}),n.d(t,"SKIP_BUFFER_HOLE_STEP_SECONDS",function(){return d}),n.d(t,"SKIP_BUFFER_RANGE_START",function(){return h}),n.d(t,"default",function(){return r});var k=n("./src/utils/buffer-helper.ts"),c=n("./src/errors.ts"),f=n("./src/events.ts"),w=n("./src/utils/logger.ts"),_=250,S=2,d=.1,h=.05,r=function(){function e(e,t,n,r){this.config=void 0,this.media=null,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=e,this.media=t,this.fragmentTracker=n,this.hls=r}var t=e.prototype;return t.destroy=function(){this.media=null,this.hls=this.fragmentTracker=null},t.poll=function(e,t){var n=this.config,r=this.media,i=this.stalled;if(null!==r){var o=r.currentTime,a=r.seeking,s=this.seeking&&!a,l=!this.seeking&&a;if(this.seeking=a,o===e){if((l||s)&&(this.stalled=null),!(r.paused&&!a||r.ended||0===r.playbackRate)&&k.BufferHelper.getBuffered(r).length){var u=k.BufferHelper.bufferInfo(r,o,0),c=u.len>0,f=u.nextStart||0;if(c||f){if(a){var d=u.len>S,h=!f||t&&t.start<=o||f-o>S&&!this.fragmentTracker.getPartialFragment(o);if(d||h)return;this.moved=!1}if(!this.moved&&null!==this.stalled){var p,g=Math.max(f,u.start||0)-o,v=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,y=(null==v?void 0:null===(p=v.details)||void 0===p?void 0:p.live)?2*v.details.targetduration:S;if(g>0&&g<=y)return void this._trySkipBufferHole(null)}var m=self.performance.now();if(null!==i){var b=m-i;if(a||!(b>=_)||(this._reportStall(u),this.media)){var E=k.BufferHelper.bufferInfo(r,o,n.maxBufferHole);this._tryFixBufferStall(E,b)}}else this.stalled=m}}}else if(this.moved=!0,null!==i){if(this.stallReported){var T=self.performance.now()-i;w.logger.warn("playback not stuck anymore @"+o+", after "+Math.round(T)+"ms"),this.stallReported=!1}this.stalled=null,this.nudgeRetry=0}}},t._tryFixBufferStall=function(e,t){var n=this.config,r=this.fragmentTracker,i=this.media;if(null!==i){var o=i.currentTime,a=r.getPartialFragment(o);if(a)if(this._trySkipBufferHole(a)||!this.media)return;e.len>n.maxBufferHole&&t>1e3*n.highBufferWatchdogPeriod&&(w.logger.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())}},t._reportStall=function(e){var t=this.hls,n=this.media;!this.stallReported&&n&&(this.stallReported=!0,w.logger.warn("Playback stalling at @"+n.currentTime+" due to low buffer ("+JSON.stringify(e)+")"),t.trigger(f.Events.ERROR,{type:c.ErrorTypes.MEDIA_ERROR,details:c.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:e.len}))},t._trySkipBufferHole=function(e){var t=this.config,n=this.hls,r=this.media;if(null===r)return 0;for(var i=r.currentTime,o=0,a=k.BufferHelper.getBuffered(r),s=0;s<a.length;s++){var l=a.start(s);if(i+t.maxBufferHole>=o&&i<l){var u=Math.max(l+h,r.currentTime+d);return w.logger.warn("skipping hole, adjusting currentTime from "+i+" to "+u),this.moved=!0,this.stalled=null,r.currentTime=u,e&&n.trigger(f.Events.ERROR,{type:c.ErrorTypes.MEDIA_ERROR,details:c.ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,reason:"fragment loaded with buffer holes, seeking from "+i+" to "+u,frag:e}),u}o=a.end(s)}return 0},t._tryNudgeBuffer=function(){var e=this.config,t=this.hls,n=this.media,r=this.nudgeRetry;if(null!==n){var i=n.currentTime;if(this.nudgeRetry++,r<e.nudgeMaxRetry){var o=i+(r+1)*e.nudgeOffset;w.logger.warn("Nudging 'currentTime' from "+i+" to "+o),n.currentTime=o,t.trigger(f.Events.ERROR,{type:c.ErrorTypes.MEDIA_ERROR,details:c.ErrorDetails.BUFFER_NUDGE_ON_STALL,fatal:!1})}else w.logger.error("Playhead still not moving while enough data buffered @"+i+" after "+e.nudgeMaxRetry+" nudges"),t.trigger(f.Events.ERROR,{type:c.ErrorTypes.MEDIA_ERROR,details:c.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!0})}},e}()},"./src/controller/id3-track-controller.ts":function(e,t,n){"use strict";n.r(t);var c=n("./src/polyfills/number.ts"),r=n("./src/events.ts"),f=n("./src/utils/texttrack-utils.ts"),E=n("./src/demux/id3.ts"),w=n("./src/loader/date-range.ts"),_=n("./src/types/demuxer.ts");function S(){return self.WebKitDataCue||self.VTTCue||self.TextTrackCue}function A(e,t){return e.getTime()/1e3-t}var i=function(){function e(e){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=e,this._registerListeners()}var t=e.prototype;return t.destroy=function(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=null},t._registerListeners=function(){var e=this.hls;e.on(r.Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(r.Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(r.Events.MANIFEST_LOADING,this.onManifestLoading,this),e.on(r.Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(r.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(r.Events.LEVEL_UPDATED,this.onLevelUpdated,this)},t._unregisterListeners=function(){var e=this.hls;e.off(r.Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(r.Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(r.Events.MANIFEST_LOADING,this.onManifestLoading,this),e.off(r.Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off(r.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(r.Events.LEVEL_UPDATED,this.onLevelUpdated,this)},t.onMediaAttached=function(e,t){this.media=t.media},t.onMediaDetaching=function(){this.id3Track&&(Object(f.clearCurrentCues)(this.id3Track),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={})},t.onManifestLoading=function(){this.dateRangeCuesAppended={}},t.createTrack=function(e){var t=this.getID3Track(e.textTracks);return t.mode="hidden",t},t.getID3Track=function(e){if(this.media){for(var t=0;t<e.length;t++){var n=e[t];if("metadata"===n.kind&&"id3"===n.label)return Object(f.sendAddTrackEvent)(n,this.media),n}return this.media.addTextTrack("metadata","id3")}},t.onFragParsingMetadata=function(e,t){if(this.media){var n=this.hls.config,r=n.enableEmsgMetadataCues,i=n.enableID3MetadataCues;if(r||i){var o=t.frag,a=t.samples,s=t.details;this.id3Track||(this.id3Track=this.createTrack(this.media));for(var l=s.edge||o.end,u=S(),c=!1,f={},d=0;d<a.length;d++){var h=a[d].type;if((h!==_.MetadataSchema.emsg||r)&&i){var p=E.getID3Frames(a[d].data);if(p){var g=a[d].pts,v=l;v-g<=0&&(v=g+.25);for(var y=0;y<p.length;y++){var m=p[y];if(!E.isTimeStampFrame(m)){var b=new u(g,v,"");b.value=m,h&&(b.type=h),this.id3Track.addCue(b),f[m.key]=null,c=!0}}}}}c&&this.updateId3CueEnds(f)}}},t.updateId3CueEnds=function(e){var t,n=null===(t=this.id3Track)||void 0===t?void 0:t.cues;if(n)for(var r=n.length;r--;){var i,o=n[r],a=null===(i=o.value)||void 0===i?void 0:i.key;if(a&&a in e){var s=e[a];s&&o.endTime!==s&&(o.endTime=s),e[a]=o.startTime}}},t.onBufferFlushing=function(e,t){var n=t.startOffset,r=t.endOffset,i=t.type,o=this.id3Track,a=this.hls;if(a){var s,l=a.config,u=l.enableEmsgMetadataCues,c=l.enableID3MetadataCues;if(o&&(u||c))s="audio"===i?function(e){return e.type===_.MetadataSchema.audioId3&&c}:"video"===i?function(e){return e.type===_.MetadataSchema.emsg&&u}:function(e){return e.type===_.MetadataSchema.audioId3&&c||e.type===_.MetadataSchema.emsg&&u},Object(f.removeCuesInRange)(o,n,r,s)}},t.onLevelUpdated=function(e,t){var v=this,n=t.details;if(this.media&&n.hasProgramDateTime&&this.hls.config.enableDateRangeMetadataCues){var y=this.dateRangeCuesAppended,r=this.id3Track,m=n.dateRanges,b=Object.keys(m);if(r)for(var i=Object.keys(y).filter(function(e){return!b.includes(e)}),o=function(e){var t=i[e];Object.keys(y[t].cues).forEach(function(e){r.removeCue(y[t].cues[e])}),delete y[t]},a=i.length;a--;)o(a);var s=n.fragments[n.fragments.length-1];if(0!==b.length&&Object(c.isFiniteNumber)(null==s?void 0:s.programDateTime)){this.id3Track||(this.id3Track=this.createTrack(this.media));for(var E=s.programDateTime/1e3-s.start,T=n.edge||s.end,k=S(),l=function(e){var t=b[e],r=m[t],n=y[t],i=(null==n?void 0:n.cues)||{},o=(null==n?void 0:n.durationKnown)||!1,a=A(r.startDate,E),s=T,l=r.endDate;if(l)s=A(l,E),o=!0;else if(r.endOnNext&&!o){var u=b.reduce(function(e,t){var n=m[t];return n.class===r.class&&n.id!==t&&n.startDate>r.startDate&&e.push(n),e},[]).sort(function(e,t){return e.startDate.getTime()-t.startDate.getTime()})[0];u&&(s=A(u.startDate,E),o=!0)}for(var c,f=Object.keys(r.attr),d=0;d<f.length;d++){var h=f[d];if(h!==w.DateRangeAttribute.ID&&h!==w.DateRangeAttribute.CLASS&&h!==w.DateRangeAttribute.START_DATE&&h!==w.DateRangeAttribute.DURATION&&h!==w.DateRangeAttribute.END_DATE&&h!==w.DateRangeAttribute.END_ON_NEXT){var p=i[h];if(p)o&&!n.durationKnown&&(p.endTime=s);else{var g=r.attr[h];p=new k(a,s,""),h!==w.DateRangeAttribute.SCTE35_OUT&&h!==w.DateRangeAttribute.SCTE35_IN||(c=g,g=Uint8Array.from(c.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer),p.value={key:h,data:g},p.type=_.MetadataSchema.dateRange,v.id3Track.addCue(p),i[h]=p}}}y[t]={cues:i,dateRange:r,durationKnown:o}},u=0;u<b.length;u++)l(u)}}},e}();t.default=i},"./src/controller/latency-controller.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return r});var o=n("./src/errors.ts"),a=n("./src/events.ts"),s=n("./src/utils/logger.ts");function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var r=function(){function e(e){var t=this;this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=function(){return t.timeupdate()},this.hls=e,this.config=e.config,this.registerListeners()}var t,n,r,i=e.prototype;return i.destroy=function(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null},i.registerListeners=function(){this.hls.on(a.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(a.Events.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(a.Events.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(a.Events.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(a.Events.ERROR,this.onError,this)},i.unregisterListeners=function(){this.hls.off(a.Events.MEDIA_ATTACHED,this.onMediaAttached),this.hls.off(a.Events.MEDIA_DETACHING,this.onMediaDetaching),this.hls.off(a.Events.MANIFEST_LOADING,this.onManifestLoading),this.hls.off(a.Events.LEVEL_UPDATED,this.onLevelUpdated),this.hls.off(a.Events.ERROR,this.onError)},i.onMediaAttached=function(e,t){this.media=t.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)},i.onMediaDetaching=function(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)},i.onManifestLoading=function(){this.levelDetails=null,this._latency=null,this.stallCount=0},i.onLevelUpdated=function(e,t){var n=t.details;this.levelDetails=n,n.advanced&&this.timeupdate(),!n.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)},i.onError=function(e,t){t.details===o.ErrorDetails.BUFFER_STALLED_ERROR&&(this.stallCount++,s.logger.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))},i.timeupdate=function(){var e=this.media,t=this.levelDetails;if(e&&t){this.currentTime=e.currentTime;var n=this.computeLatency();if(null!==n){this._latency=n;var r=this.config,i=r.lowLatencyMode,o=r.maxLiveSyncPlaybackRate;if(i&&1!==o){var a=this.targetLatency;if(null!==a){var s=n-a,l=s<Math.min(this.maxLatency,a+t.targetduration);if(t.live&&l&&s>.05&&this.forwardBufferLength>1){var u=Math.min(2,Math.max(1,o)),c=Math.round(2/(1+Math.exp(-.75*s-this.edgeStalled))*20)/20;e.playbackRate=Math.min(u,Math.max(1,c))}else 1!==e.playbackRate&&0!==e.playbackRate&&(e.playbackRate=1)}}}}},i.estimateLiveEdge=function(){var e=this.levelDetails;return null===e?null:e.edge+e.age},i.computeLatency=function(){var e=this.estimateLiveEdge();return null===e?null:e-this.currentTime},t=e,(n=[{key:"latency",get:function(){return this._latency||0}},{key:"maxLatency",get:function(){var e=this.config,t=this.levelDetails;return void 0!==e.liveMaxLatencyDuration?e.liveMaxLatencyDuration:t?e.liveMaxLatencyDurationCount*t.targetduration:0}},{key:"targetLatency",get:function(){var e=this.levelDetails;if(null===e)return null;var t=e.holdBack,n=e.partHoldBack,r=e.targetduration,i=this.config,o=i.liveSyncDuration,a=i.liveSyncDurationCount,s=i.lowLatencyMode,l=this.hls.userConfig,u=s&&n||t;(l.liveSyncDuration||l.liveSyncDurationCount||0===u)&&(u=void 0!==o?o:a*r);var c=r;return u+Math.min(1*this.stallCount,c)}},{key:"liveSyncPosition",get:function(){var e=this.estimateLiveEdge(),t=this.targetLatency,n=this.levelDetails;if(null===e||null===t||null===n)return null;var r=n.edge,i=e-t-this.edgeStalled,o=r-n.totalduration,a=r-(this.config.lowLatencyMode&&n.partTarget||n.targetduration);return Math.min(Math.max(o,i),a)}},{key:"drift",get:function(){var e=this.levelDetails;return null===e?1:e.drift}},{key:"edgeStalled",get:function(){var e=this.levelDetails;if(null===e)return 0;var t=3*(this.config.lowLatencyMode&&e.partTarget||e.targetduration);return Math.max(e.age-t,0)}},{key:"forwardBufferLength",get:function(){var e=this.media,t=this.levelDetails;if(!e||!t)return 0;var n=e.buffered.length;return(n?e.buffered.end(n-1):t.edge)-this.currentTime}}])&&l(t.prototype,n),r&&l(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}()},"./src/controller/level-controller.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return i});var p=n("./src/types/level.ts"),g=n("./src/events.ts"),v=n("./src/errors.ts"),y=n("./src/utils/codecs.ts"),m=n("./src/controller/level-helper.ts"),r=n("./src/controller/base-playlist-controller.ts"),f=n("./src/types/loader.ts");function d(){return(d=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var b=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),i=function(c){var e,t;function n(e){var t;return(t=c.call(this,e,"[level-controller]")||this)._levels=[],t._firstLevel=-1,t._startLevel=void 0,t.currentLevelIndex=-1,t.manualLevelIndex=-1,t.onParsedComplete=void 0,t._registerListeners(),t}t=c,(e=n).prototype=Object.create(t.prototype),e.prototype.constructor=e,l(e,t);var r,i,o,a=n.prototype;return a._registerListeners=function(){var e=this.hls;e.on(g.Events.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(g.Events.LEVEL_LOADED,this.onLevelLoaded,this),e.on(g.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(g.Events.FRAG_LOADED,this.onFragLoaded,this),e.on(g.Events.ERROR,this.onError,this)},a._unregisterListeners=function(){var e=this.hls;e.off(g.Events.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(g.Events.LEVEL_LOADED,this.onLevelLoaded,this),e.off(g.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(g.Events.FRAG_LOADED,this.onFragLoaded,this),e.off(g.Events.ERROR,this.onError,this)},a.destroy=function(){this._unregisterListeners(),this.manualLevelIndex=-1,this._levels.length=0,c.prototype.destroy.call(this)},a.startLoad=function(){this._levels.forEach(function(e){e.loadError=0}),c.prototype.startLoad.call(this)},a.onManifestLoaded=function(e,t){var n,r,i=[],o=[],a=[],s={},l=!1,u=!1,c=!1;if(t.levels.forEach(function(e){var t=e.attrs;l=l||!(!e.width||!e.height),u=u||!!e.videoCodec,c=c||!!e.audioCodec,b&&e.audioCodec&&-1!==e.audioCodec.indexOf("mp4a.40.34")&&(e.audioCodec=void 0);var n=e.bitrate+"-"+e.attrs.RESOLUTION+"-"+e.attrs.CODECS;(r=s[n])?r.url.push(e.url):(r=new p.Level(e),s[n]=r,i.push(r)),t&&(t.AUDIO&&Object(m.addGroupId)(r,"audio",t.AUDIO),t.SUBTITLES&&Object(m.addGroupId)(r,"text",t.SUBTITLES))}),(l||u)&&c&&(i=i.filter(function(e){var t=e.videoCodec,n=e.width,r=e.height;return!!t||!(!n||!r)})),i=i.filter(function(e){var t=e.audioCodec,n=e.videoCodec;return(!t||Object(y.isCodecSupportedInMp4)(t,"audio"))&&(!n||Object(y.isCodecSupportedInMp4)(n,"video"))}),t.audioTracks&&(o=t.audioTracks.filter(function(e){return!e.audioCodec||Object(y.isCodecSupportedInMp4)(e.audioCodec,"audio")}),Object(m.assignTrackIdsByGroup)(o)),t.subtitles&&(a=t.subtitles,Object(m.assignTrackIdsByGroup)(a)),i.length>0){n=i[0].bitrate,i.sort(function(e,t){return e.bitrate-t.bitrate}),this._levels=i;for(var f=0;f<i.length;f++)if(i[f].bitrate===n){this._firstLevel=f,this.log("manifest loaded, "+i.length+" level(s) found, first bitrate: "+n);break}var d=c&&!u,h={levels:i,audioTracks:o,subtitleTracks:a,firstLevel:this._firstLevel,stats:t.stats,audio:c,video:u,altAudio:!d&&o.some(function(e){return!!e.url})};this.hls.trigger(g.Events.MANIFEST_PARSED,h),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}else this.hls.trigger(g.Events.ERROR,{type:v.ErrorTypes.MEDIA_ERROR,details:v.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:t.url,reason:"no level with compatible codecs found in manifest"})},a.onError=function(e,t){var n;if(c.prototype.onError.call(this,e,t),!t.fatal){var r=t.context,i=this._levels[this.currentLevelIndex];if(r&&(r.type===f.PlaylistContextType.AUDIO_TRACK&&i.audioGroupIds&&r.groupId===i.audioGroupIds[i.urlId]||r.type===f.PlaylistContextType.SUBTITLE_TRACK&&i.textGroupIds&&r.groupId===i.textGroupIds[i.urlId]))this.redundantFailover(this.currentLevelIndex);else{var o,a=!1,s=!0;switch(t.details){case v.ErrorDetails.FRAG_LOAD_ERROR:case v.ErrorDetails.FRAG_LOAD_TIMEOUT:case v.ErrorDetails.KEY_LOAD_ERROR:case v.ErrorDetails.KEY_LOAD_TIMEOUT:if(t.frag){var l=t.frag.type===f.PlaylistLevelType.MAIN?t.frag.level:this.currentLevelIndex,u=this._levels[l];u?(u.fragmentError++,u.fragmentError>this.hls.config.fragLoadingMaxRetry&&(o=l)):o=l}break;case v.ErrorDetails.LEVEL_LOAD_ERROR:case v.ErrorDetails.LEVEL_LOAD_TIMEOUT:r&&(r.deliveryDirectives&&(s=!1),o=r.level),a=!0;break;case v.ErrorDetails.REMUX_ALLOC_ERROR:o=null!=(n=t.level)?n:this.currentLevelIndex,a=!0}void 0!==o&&this.recoverLevel(t,o,a,s)}}},a.recoverLevel=function(e,t,n,r){var i=e.details,o=this._levels[t];if(o.loadError++,n){if(!this.retryLoadingOrFail(e))return void(this.currentLevelIndex=-1);e.levelRetry=!0}if(r){var a=o.url.length;if(a>1&&o.loadError<a)e.levelRetry=!0,this.redundantFailover(t);else if(-1===this.manualLevelIndex){for(var s=-1,l=this._levels,u=l.length;u--;){var c=(u+this.currentLevelIndex)%l.length;if(c!==this.currentLevelIndex&&0===l[c].loadError){s=c;break}}s>-1&&this.currentLevelIndex!==s&&(this.warn(i+": switch to "+s),e.levelRetry=!0,this.hls.nextAutoLevel=s)}}},a.redundantFailover=function(e){var t=this._levels[e],n=t.url.length;if(n>1){var r=(t.urlId+1)%n;this.warn("Switching to redundant URL-id "+r),this._levels.forEach(function(e){e.urlId=r}),this.level=e}},a.onFragLoaded=function(e,t){var n=t.frag;if(void 0!==n&&n.type===f.PlaylistLevelType.MAIN){var r=this._levels[n.level];void 0!==r&&(r.fragmentError=0,r.loadError=0)}},a.onLevelLoaded=function(e,t){var n,r,i=t.level,o=t.details,a=this._levels[i];if(!a)return this.warn("Invalid level index "+i),void(null!==(r=t.deliveryDirectives)&&void 0!==r&&r.skip&&(o.deltaUpdateFailed=!0));i===this.currentLevelIndex?(0===a.fragmentError&&(a.loadError=0,this.retryCount=0),this.playlistLoaded(i,t,a.details)):null!==(n=t.deliveryDirectives)&&void 0!==n&&n.skip&&(o.deltaUpdateFailed=!0)},a.onAudioTrackSwitched=function(e,t){var n=this.hls.levels[this.currentLevelIndex];if(n&&n.audioGroupIds){for(var r=-1,i=this.hls.audioTracks[t.id].groupId,o=0;o<n.audioGroupIds.length;o++)if(n.audioGroupIds[o]===i){r=o;break}r!==n.urlId&&(n.urlId=r,this.startLoad())}},a.loadPlaylist=function(e){var t=this.currentLevelIndex,n=this._levels[t];if(this.canLoad&&n&&n.url.length>0){var r=n.urlId,i=n.url[r];if(e)try{i=e.addDirectives(i)}catch(e){this.warn("Could not construct new URL with HLS Delivery Directives: "+e)}this.log("Attempt loading level index "+t+(e?" at sn "+e.msn+" part "+e.part:"")+" with URL-id "+r+" "+i),this.clearTimer(),this.hls.trigger(g.Events.LEVEL_LOADING,{url:i,level:t,id:r,deliveryDirectives:e||null})}},a.removeLevel=function(n,r){var i=function(e,t){return t!==r},e=this._levels.filter(function(e,t){return t!==n||e.url.length>1&&void 0!==r&&(e.url=e.url.filter(i),e.audioGroupIds&&(e.audioGroupIds=e.audioGroupIds.filter(i)),e.textGroupIds&&(e.textGroupIds=e.textGroupIds.filter(i)),e.urlId=0,!0)}).map(function(e,t){var n=e.details;return null!=n&&n.fragments&&n.fragments.forEach(function(e){e.level=t}),e});this._levels=e,this.hls.trigger(g.Events.LEVELS_UPDATED,{levels:e})},r=n,(i=[{key:"levels",get:function(){return 0===this._levels.length?null:this._levels}},{key:"level",get:function(){return this.currentLevelIndex},set:function(e){var t,n=this._levels;if(0!==n.length&&(this.currentLevelIndex!==e||null===(t=n[e])||void 0===t||!t.details)){if(e<0||e>=n.length){var r=e<0;if(this.hls.trigger(g.Events.ERROR,{type:v.ErrorTypes.OTHER_ERROR,details:v.ErrorDetails.LEVEL_SWITCH_ERROR,level:e,fatal:r,reason:"invalid level idx"}),r)return;e=Math.min(e,n.length-1)}this.clearTimer();var i=this.currentLevelIndex,o=n[i],a=n[e];this.log("switching to level "+e+" from "+i),this.currentLevelIndex=e;var s=d({},a,{level:e,maxBitrate:a.maxBitrate,uri:a.uri,urlId:a.urlId});delete s._urlId,this.hls.trigger(g.Events.LEVEL_SWITCHING,s);var l=a.details;if(!l||l.live){var u=this.switchParams(a.uri,null==o?void 0:o.details);this.loadPlaylist(u)}}}},{key:"manualLevel",get:function(){return this.manualLevelIndex},set:function(e){this.manualLevelIndex=e,void 0===this._startLevel&&(this._startLevel=e),-1!==e&&(this.level=e)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(e){this._firstLevel=e}},{key:"startLevel",get:function(){if(void 0===this._startLevel){var e=this.hls.config.startLevel;return void 0!==e?e:this._firstLevel}return this._startLevel},set:function(e){this._startLevel=e}},{key:"nextLoadLevel",get:function(){return-1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(e){this.level=e,-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=e)}}])&&s(r.prototype,i),o&&s(r,o),Object.defineProperty(r,"prototype",{writable:!1}),n}(r.default)},"./src/controller/level-helper.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"addGroupId",function(){return r}),n.d(t,"assignTrackIdsByGroup",function(){return i}),n.d(t,"updatePTS",function(){return o}),n.d(t,"updateFragPTSDTS",function(){return g}),n.d(t,"mergeDetails",function(){return a}),n.d(t,"mapPartIntersection",function(){return b}),n.d(t,"mapFragmentIntersection",function(){return E}),n.d(t,"adjustSliding",function(){return T}),n.d(t,"addSliding",function(){return s}),n.d(t,"computeReloadInterval",function(){return l}),n.d(t,"getFragmentWithSN",function(){return u}),n.d(t,"getPartWith",function(){return c});var v=n("./src/polyfills/number.ts"),y=n("./src/utils/logger.ts"),h=n("./src/loader/date-range.ts");function p(){return(p=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function r(e,t,n){switch(t){case"audio":e.audioGroupIds||(e.audioGroupIds=[]),e.audioGroupIds.push(n);break;case"text":e.textGroupIds||(e.textGroupIds=[]),e.textGroupIds.push(n)}}function i(e){var n={};e.forEach(function(e){var t=e.groupId||"";e.id=n[t]=n[t]||0,n[t]++})}function o(e,t,n){m(e[t],e[n])}function m(e,t){var n=t.startPTS;if(Object(v.isFiniteNumber)(n)){var r,i=0;t.sn>e.sn?(i=n-e.start,r=e):(i=e.start-n,r=t),r.duration!==i&&(r.duration=i)}else if(t.sn>e.sn){e.cc===t.cc&&e.minEndPTS?t.start=e.start+(e.minEndPTS-e.start):t.start=e.start+e.duration}else t.start=Math.max(e.start-t.duration,0)}function g(e,t,n,r,i,o){r-n<=0&&(y.logger.warn("Fragment should have a positive duration",t),r=n+t.duration,o=i+t.duration);var a=n,s=r,l=t.startPTS,u=t.endPTS;if(Object(v.isFiniteNumber)(l)){var c=Math.abs(l-n);Object(v.isFiniteNumber)(t.deltaPTS)?t.deltaPTS=Math.max(c,t.deltaPTS):t.deltaPTS=c,a=Math.max(n,l),n=Math.min(n,l),i=Math.min(i,t.startDTS),s=Math.min(r,u),r=Math.max(r,u),o=Math.max(o,t.endDTS)}t.duration=r-n;var f=n-t.start;t.appendedPTS=r,t.start=t.startPTS=n,t.maxStartPTS=a,t.startDTS=i,t.endPTS=r,t.minEndPTS=s,t.endDTS=o;var d,h=t.sn;if(!e||h<e.startSN||h>e.endSN)return 0;var p=h-e.startSN,g=e.fragments;for(g[p]=t,d=p;d>0;d--)m(g[d],g[d-1]);for(d=p;d<g.length-1;d++)m(g[d],g[d+1]);return e.fragmentHint&&m(g[g.length-1],e.fragmentHint),e.PTSKnown=e.alignedSliding=!0,f}function a(e,n){for(var r=null,t=e.fragments,i=t.length-1;i>=0;i--){var o=t[i].initSegment;if(o){r=o;break}}e.fragmentHint&&delete e.fragmentHint.endPTS;var a,s=0;(E(e,n,function(e,t){e.relurl&&(s=e.cc-t.cc),Object(v.isFiniteNumber)(e.startPTS)&&Object(v.isFiniteNumber)(e.endPTS)&&(t.start=t.startPTS=e.startPTS,t.startDTS=e.startDTS,t.appendedPTS=e.appendedPTS,t.maxStartPTS=e.maxStartPTS,t.endPTS=e.endPTS,t.endDTS=e.endDTS,t.minEndPTS=e.minEndPTS,t.duration=e.endPTS-e.startPTS,t.duration&&(a=t),n.PTSKnown=n.alignedSliding=!0),t.elementaryStreams=e.elementaryStreams,t.loader=e.loader,t.stats=e.stats,t.urlId=e.urlId,e.initSegment&&(t.initSegment=e.initSegment,r=e.initSegment)}),r)&&(n.fragmentHint?n.fragments.concat(n.fragmentHint):n.fragments).forEach(function(e){var t;e.initSegment&&e.initSegment.relurl!==(null===(t=r)||void 0===t?void 0:t.relurl)||(e.initSegment=r)});if(n.skippedSegments)if(n.deltaUpdateFailed=n.fragments.some(function(e){return!e}),n.deltaUpdateFailed){y.logger.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(var l=n.skippedSegments;l--;)n.fragments.shift();n.startSN=n.fragments[0].sn,n.startCC=n.fragments[0].cc}else n.canSkipDateRanges&&(n.dateRanges=function(e,n,t){var r=p({},e);t&&t.forEach(function(e){delete r[e]});return Object.keys(n).forEach(function(e){var t=new h.DateRange(n[e].attr,r[e]);t.isValid?r[e]=t:y.logger.warn('Ignoring invalid Playlist Delta Update DATERANGE tag: "'+JSON.stringify(n[e].attr)+'"')}),r}(e.dateRanges,n.dateRanges,n.recentlyRemovedDateranges));var u=n.fragments;if(s){y.logger.warn("discontinuity sliding from playlist, take drift into account");for(var c=0;c<u.length;c++)u[c].cc+=s}n.skippedSegments&&(n.startCC=n.fragments[0].cc),b(e.partList,n.partList,function(e,t){t.elementaryStreams=e.elementaryStreams,t.stats=e.stats}),a?g(n,a,a.startPTS,a.endPTS,a.startDTS,a.endDTS):T(e,n),u.length&&(n.totalduration=n.edge-u[0].start),n.driftStartTime=e.driftStartTime,n.driftStart=e.driftStart;var f=n.advancedDateTime;if(n.advanced&&f){var d=n.edge;n.driftStart||(n.driftStartTime=f,n.driftStart=d),n.driftEndTime=f,n.driftEnd=d}else n.driftEndTime=e.driftEndTime,n.driftEnd=e.driftEnd,n.advancedDateTime=e.advancedDateTime}function b(e,t,n){if(e&&t)for(var r=0,i=0,o=e.length;i<=o;i++){var a=e[i],s=t[i+r];a&&s&&a.index===s.index&&a.fragment.sn===s.fragment.sn?n(a,s):r--}}function E(e,t,n){for(var r=t.skippedSegments,i=Math.max(e.startSN,t.startSN)-t.startSN,o=(e.fragmentHint?1:0)+(r?t.endSN:Math.min(e.endSN,t.endSN))-t.startSN,a=t.startSN-e.startSN,s=t.fragmentHint?t.fragments.concat(t.fragmentHint):t.fragments,l=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments,u=i;u<=o;u++){var c=l[a+u],f=s[u];r&&!f&&u<r&&(f=t.fragments[u]=c),c&&f&&n(c,f)}}function T(e,t){var n=t.startSN+t.skippedSegments-e.startSN,r=e.fragments;n<0||n>=r.length||s(t,r[n].start)}function s(e,t){if(t){for(var n=e.fragments,r=e.skippedSegments;r<n.length;r++)n[r].start+=t;e.fragmentHint&&(e.fragmentHint.start+=t)}}function l(e,t){var n,r=1e3*e.levelTargetDuration,i=r/2,o=e.age,a=o>0&&o<3*r,s=t.loading.end-t.loading.start,l=e.availabilityDelay;if(!1===e.updated)if(a){var u=333*e.misses;n=Math.max(Math.min(i,2*s),u),e.availabilityDelay=(e.availabilityDelay||0)+n}else n=i;else a?(l=Math.min(l||r/2,o),e.availabilityDelay=l,n=l+r-o):n=r-s;return Math.round(n)}function u(e,t,n){if(!e||!e.details)return null;var r=e.details,i=r.fragments[t-r.startSN];return i||((i=r.fragmentHint)&&i.sn===t?i:t<r.startSN&&n&&n.sn===t?n:null)}function c(e,t,n){if(!e||!e.details)return null;var r=e.details.partList;if(r)for(var i=r.length;i--;){var o=r[i];if(o.index===n&&o.fragment.sn===t)return o}return null}},"./src/controller/stream-controller.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return r});var C=n("./src/polyfills/number.ts"),L=n("./src/controller/base-stream-controller.ts"),l=n("./src/is-supported.ts"),D=n("./src/events.ts"),u=n("./src/utils/buffer-helper.ts"),m=n("./src/controller/fragment-tracker.ts"),b=n("./src/types/loader.ts"),x=n("./src/loader/fragment.ts"),y=n("./src/demux/transmuxer-interface.ts"),E=n("./src/types/transmuxer.ts"),c=n("./src/controller/gap-controller.ts"),f=n("./src/errors.ts");function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function h(e,t){return(h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var r=function(o){var e,t;function n(e,t){var n;return(n=o.call(this,e,t,"[stream-controller]")||this).audioCodecSwap=!1,n.gapController=null,n.level=-1,n._forceStartLoad=!1,n.altAudio=!1,n.audioOnly=!1,n.fragPlaying=null,n.onvplaying=null,n.onvseeked=null,n.fragLastKbps=0,n.couldBacktrack=!1,n.backtrackFragment=null,n.audioCodecSwitch=!1,n.videoBuffer=null,n._registerListeners(),n}t=o,(e=n).prototype=Object.create(t.prototype),e.prototype.constructor=e,h(e,t);var r,i,a,s=n.prototype;return s._registerListeners=function(){var e=this.hls;e.on(D.Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(D.Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(D.Events.MANIFEST_LOADING,this.onManifestLoading,this),e.on(D.Events.MANIFEST_PARSED,this.onManifestParsed,this),e.on(D.Events.LEVEL_LOADING,this.onLevelLoading,this),e.on(D.Events.LEVEL_LOADED,this.onLevelLoaded,this),e.on(D.Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.on(D.Events.ERROR,this.onError,this),e.on(D.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(D.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(D.Events.BUFFER_CREATED,this.onBufferCreated,this),e.on(D.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(D.Events.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(D.Events.FRAG_BUFFERED,this.onFragBuffered,this)},s._unregisterListeners=function(){var e=this.hls;e.off(D.Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(D.Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(D.Events.MANIFEST_LOADING,this.onManifestLoading,this),e.off(D.Events.MANIFEST_PARSED,this.onManifestParsed,this),e.off(D.Events.LEVEL_LOADED,this.onLevelLoaded,this),e.off(D.Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.off(D.Events.ERROR,this.onError,this),e.off(D.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(D.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(D.Events.BUFFER_CREATED,this.onBufferCreated,this),e.off(D.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(D.Events.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(D.Events.FRAG_BUFFERED,this.onFragBuffered,this)},s.onHandlerDestroying=function(){this._unregisterListeners(),this.onMediaDetaching()},s.startLoad=function(e){if(this.levels){var t=this.lastCurrentTime,n=this.hls;if(this.stopLoad(),this.setInterval(100),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var r=n.startLevel;-1===r&&(n.config.testBandwidth&&this.levels.length>1?(r=0,this.bitrateTest=!0):r=n.nextAutoLevel),this.level=n.nextLoadLevel=r,this.loadedmetadata=!1}t>0&&-1===e&&(this.log("Override startPosition with lastCurrentTime @"+t.toFixed(3)),e=t),this.state=L.State.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}else this._forceStartLoad=!0,this.state=L.State.STOPPED},s.stopLoad=function(){this._forceStartLoad=!1,o.prototype.stopLoad.call(this)},s.doTick=function(){switch(this.state){case L.State.IDLE:this.doTickIdle();break;case L.State.WAITING_LEVEL:var e,t=this.levels,n=this.level,r=null==t?void 0:null===(e=t[n])||void 0===e?void 0:e.details;if(r&&(!r.live||this.levelLastLoaded===this.level)){if(this.waitForCdnTuneIn(r))break;this.state=L.State.IDLE;break}break;case L.State.FRAG_LOADING_WAITING_RETRY:var i,o=self.performance.now(),a=this.retryDate;(!a||o>=a||null!==(i=this.media)&&void 0!==i&&i.seeking)&&(this.log("retryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded(this.level),this.state=L.State.IDLE)}this.onTickEnd()},s.onTickEnd=function(){o.prototype.onTickEnd.call(this),this.checkBuffer(),this.checkFragmentChanged()},s.doTickIdle=function(){var e,t,n=this.hls,r=this.levelLastLoaded,i=this.levels,o=this.media,a=n.config,s=n.nextLoadLevel;if(null!==r&&(o||!this.startFragRequested&&a.startFragPrefetch)&&(!this.altAudio||!this.audioOnly)&&i&&i[s]){var l=i[s];this.level=n.nextLoadLevel=s;var u=l.details;if(!u||this.state===L.State.WAITING_LEVEL||u.live&&this.levelLastLoaded!==s)this.state=L.State.WAITING_LEVEL;else{var c=this.getMainFwdBufferInfo();if(null!==c)if(!(c.len>=this.getMaxBufferLength(l.maxBitrate))){if(this._streamEnded(c,u)){var f={};return this.altAudio&&(f.type="video"),this.hls.trigger(D.Events.BUFFER_EOS,f),void(this.state=L.State.ENDED)}this.backtrackFragment&&this.backtrackFragment.start>c.end&&(this.backtrackFragment=null);var d=this.backtrackFragment?this.backtrackFragment.start:c.end,h=this.getNextFragment(d,u);if(this.couldBacktrack&&!this.fragPrevious&&h&&"initSegment"!==h.sn&&this.fragmentTracker.getState(h)!==m.FragmentState.OK){var p,g=(null!=(p=this.backtrackFragment)?p:h).sn-u.startSN,v=u.fragments[g-1];v&&h.cc===v.cc&&(h=v,this.fragmentTracker.removeFragment(v))}else this.backtrackFragment&&c.len&&(this.backtrackFragment=null);if(h&&this.fragmentTracker.getState(h)===m.FragmentState.OK&&this.nextLoadPosition>d){var y=this.audioOnly&&!this.altAudio?x.ElementaryStreamTypes.AUDIO:x.ElementaryStreamTypes.VIDEO;o&&this.afterBufferFlushed(o,y,b.PlaylistLevelType.MAIN),h=this.getNextFragment(this.nextLoadPosition,u)}h&&(!h.initSegment||h.initSegment.data||this.bitrateTest||(h=h.initSegment),"identity"!==(null===(e=h.decryptdata)||void 0===e?void 0:e.keyFormat)||null!==(t=h.decryptdata)&&void 0!==t&&t.key?this.loadFragment(h,u,d):this.loadKey(h,u))}}}},s.loadFragment=function(e,t,n){var r,i=this.fragmentTracker.getState(e);this.fragCurrent=e,i===m.FragmentState.NOT_LOADED?"initSegment"===e.sn?this._loadInitSegment(e):this.bitrateTest?(this.log("Fragment "+e.sn+" of level "+e.level+" is being downloaded to test bitrate and will not be buffered"),this._loadBitrateTestFrag(e)):(this.startFragRequested=!0,o.prototype.loadFragment.call(this,e,t,n)):i===m.FragmentState.APPENDING?this.reduceMaxBufferLength(e.duration)&&this.fragmentTracker.removeFragment(e):0===(null===(r=this.media)||void 0===r?void 0:r.buffered.length)&&this.fragmentTracker.removeAllFragments()},s.getAppendedFrag=function(e){var t=this.fragmentTracker.getAppendedFrag(e,b.PlaylistLevelType.MAIN);return t&&"fragment"in t?t.fragment:t},s.getBufferedFrag=function(e){return this.fragmentTracker.getBufferedFrag(e,b.PlaylistLevelType.MAIN)},s.followingBufferedFrag=function(e){return e?this.getBufferedFrag(e.end+.5):null},s.immediateLevelSwitch=function(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)},s.nextLevelSwitch=function(){var e=this.levels,t=this.media;if(null!=t&&t.readyState){var n,r=this.getAppendedFrag(t.currentTime);if(r&&r.start>1&&this.flushMainBuffer(0,r.start-1),!t.paused&&e){var i=e[this.hls.nextLoadLevel],o=this.fragLastKbps;n=o&&this.fragCurrent?this.fragCurrent.duration*i.maxBitrate/(1e3*o)+1:0}else n=0;var a=this.getBufferedFrag(t.currentTime+n);if(a){var s=this.followingBufferedFrag(a);if(s){this.abortCurrentFrag();var l=s.maxStartPTS?s.maxStartPTS:s.start,u=s.duration,c=Math.max(a.end,l+Math.min(Math.max(u-this.config.maxFragLookUpTolerance,.5*u),.75*u));this.flushMainBuffer(c,Number.POSITIVE_INFINITY)}}}},s.abortCurrentFrag=function(){var e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,null!=e&&e.loader&&e.loader.abort(),this.state){case L.State.KEY_LOADING:case L.State.FRAG_LOADING:case L.State.FRAG_LOADING_WAITING_RETRY:case L.State.PARSING:case L.State.PARSED:this.state=L.State.IDLE}this.nextLoadPosition=this.getLoadPosition()},s.flushMainBuffer=function(e,t){o.prototype.flushMainBuffer.call(this,e,t,this.altAudio?"video":null)},s.onMediaAttached=function(e,t){o.prototype.onMediaAttached.call(this,e,t);var n=t.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),n.addEventListener("playing",this.onvplaying),n.addEventListener("seeked",this.onvseeked),this.gapController=new c.default(this.config,n,this.fragmentTracker,this.hls)},s.onMediaDetaching=function(){var e=this.media;e&&this.onvplaying&&this.onvseeked&&(e.removeEventListener("playing",this.onvplaying),e.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),o.prototype.onMediaDetaching.call(this)},s.onMediaPlaying=function(){this.tick()},s.onMediaSeeked=function(){var e=this.media,t=e?e.currentTime:null;Object(C.isFiniteNumber)(t)&&this.log("Media seeked to "+t.toFixed(3)),this.tick()},s.onManifestLoading=function(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(D.Events.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=!1,this.startPosition=this.lastCurrentTime=0,this.fragPlaying=null,this.backtrackFragment=null},s.onManifestParsed=function(e,t){var n,r=!1,i=!1;t.levels.forEach(function(e){(n=e.audioCodec)&&(-1!==n.indexOf("mp4a.40.2")&&(r=!0),-1!==n.indexOf("mp4a.40.5")&&(i=!0))}),this.audioCodecSwitch=r&&i&&!Object(l.changeTypeSupported)(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=t.levels,this.startFragRequested=!1},s.onLevelLoading=function(e,t){var n=this.levels;if(n&&this.state===L.State.IDLE){var r=n[t.level];(!r.details||r.details.live&&this.levelLastLoaded!==t.level||this.waitForCdnTuneIn(r.details))&&(this.state=L.State.WAITING_LEVEL)}},s.onLevelLoaded=function(e,t){var n,r=this.levels,i=t.level,o=t.details,a=o.totalduration;if(r){this.log("Level "+i+" loaded ["+o.startSN+","+o.endSN+"], cc ["+o.startCC+", "+o.endCC+"] duration:"+a);var s=this.fragCurrent;!s||this.state!==L.State.FRAG_LOADING&&this.state!==L.State.FRAG_LOADING_WAITING_RETRY||s.level!==t.level&&s.loader&&(this.state=L.State.IDLE,this.backtrackFragment=null,s.loader.abort());var l=r[i],u=0;if(o.live||null!==(n=l.details)&&void 0!==n&&n.live){if(o.fragments[0]||(o.deltaUpdateFailed=!0),o.deltaUpdateFailed)return;u=this.alignPlaylists(o,l.details)}if(l.details=o,this.levelLastLoaded=i,this.hls.trigger(D.Events.LEVEL_UPDATED,{details:o,level:i}),this.state===L.State.WAITING_LEVEL){if(this.waitForCdnTuneIn(o))return;this.state=L.State.IDLE}this.startFragRequested?o.live&&this.synchronizeToLiveEdge(o):this.setStartPosition(o,u),this.tick()}else this.warn("Levels were reset while loading level "+i)},s._handleFragmentLoadProgress=function(e){var t,n=e.frag,r=e.part,i=e.payload,o=this.levels;if(o){var a=o[n.level],s=a.details;if(s){var l=a.videoCodec,u=s.PTSKnown||!s.live,c=null===(t=n.initSegment)||void 0===t?void 0:t.data,f=this._getAudioCodec(a),d=this.transmuxer=this.transmuxer||new y.default(this.hls,b.PlaylistLevelType.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),h=r?r.index:-1,p=-1!==h,g=new E.ChunkMetadata(n.level,n.sn,n.stats.chunkCount,i.byteLength,h,p),v=this.initPTS[n.cc];d.push(i,c,f,l,n,r,s.totalduration,u,g,v)}else this.warn("Dropping fragment "+n.sn+" of level "+n.level+" after level details were reset")}else this.warn("Levels were reset while fragment load was in progress. Fragment "+n.sn+" of level "+n.level+" will not be buffered")},s.onAudioTrackSwitching=function(e,t){var n=this.altAudio,r=!!t.url,i=t.id;if(!r){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var o=this.fragCurrent;null!=o&&o.loader&&(this.log("Switching to main audio track, cancel main fragment load"),o.loader.abort()),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();var a=this.hls;n&&a.trigger(D.Events.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),a.trigger(D.Events.AUDIO_TRACK_SWITCHED,{id:i})}},s.onAudioTrackSwitched=function(e,t){var n=t.id,r=!!this.hls.audioTracks[n].url;if(r){var i=this.videoBuffer;i&&this.mediaBuffer!==i&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=i)}this.altAudio=r,this.tick()},s.onBufferCreated=function(e,t){var n,r,i=t.tracks,o=!1;for(var a in i){var s=i[a];if("main"===s.id){if(r=a,n=s,"video"===a){var l=i[a];l&&(this.videoBuffer=l.buffer)}}else o=!0}o&&n?(this.log("Alternate track found, use "+r+".buffered to schedule main fragment loading"),this.mediaBuffer=n.buffer):this.mediaBuffer=this.media},s.onFragBuffered=function(e,t){var n=t.frag,r=t.part;if(!n||n.type===b.PlaylistLevelType.MAIN){if(this.fragContextChanged(n))return this.warn("Fragment "+n.sn+(r?" p: "+r.index:"")+" of level "+n.level+" finished buffering, but was aborted. state: "+this.state),void(this.state===L.State.PARSED&&(this.state=L.State.IDLE));var i=r?r.stats:n.stats;this.fragLastKbps=Math.round(8*i.total/(i.buffering.end-i.loading.first)),"initSegment"!==n.sn&&(this.fragPrevious=n),this.fragBufferedComplete(n,r)}},s.onError=function(e,t){switch(t.details){case f.ErrorDetails.FRAG_LOAD_ERROR:case f.ErrorDetails.FRAG_LOAD_TIMEOUT:case f.ErrorDetails.KEY_LOAD_ERROR:case f.ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(b.PlaylistLevelType.MAIN,t);break;case f.ErrorDetails.LEVEL_LOAD_ERROR:case f.ErrorDetails.LEVEL_LOAD_TIMEOUT:this.state!==L.State.ERROR&&(t.fatal?(this.warn(""+t.details),this.state=L.State.ERROR):t.levelRetry||this.state!==L.State.WAITING_LEVEL||(this.state=L.State.IDLE));break;case f.ErrorDetails.BUFFER_FULL_ERROR:if("main"===t.parent&&(this.state===L.State.PARSING||this.state===L.State.PARSED)){var n=!0,r=this.getFwdBufferInfo(this.media,b.PlaylistLevelType.MAIN);r&&r.len>.5&&(n=!this.reduceMaxBufferLength(r.len)),n&&(this.warn("buffer full error also media.currentTime is not buffered, flush main"),this.immediateLevelSwitch()),this.resetLoadingState()}}},s.checkBuffer=function(){var e=this.media,t=this.gapController;if(e&&t&&e.readyState){if(this.loadedmetadata||!u.BufferHelper.getBuffered(e).length){var n=this.state!==L.State.IDLE?this.fragCurrent:null;t.poll(this.lastCurrentTime,n)}this.lastCurrentTime=e.currentTime}},s.onFragLoadEmergencyAborted=function(){this.state=L.State.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()},s.onBufferFlushed=function(e,t){var n=t.type;if(n!==x.ElementaryStreamTypes.AUDIO||this.audioOnly&&!this.altAudio){var r=(n===x.ElementaryStreamTypes.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(r,n,b.PlaylistLevelType.MAIN)}},s.onLevelsUpdated=function(e,t){this.levels=t.levels},s.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap},s.seekToStartPos=function(){var e=this.media;if(e){var t=e.currentTime,n=this.startPosition;if(n>=0&&t<n){if(e.seeking)return void this.log("could not seek to "+n+", already seeking at "+t);var r=u.BufferHelper.getBuffered(e),i=(r.length?r.start(0):0)-n;i>0&&(i<this.config.maxBufferHole||i<this.config.maxFragLookUpTolerance)&&(this.log("adjusting start position by "+i+" to match buffer start"),n+=i,this.startPosition=n),this.log("seek to target start position "+n+" from current time "+t),e.currentTime=n}}},s._getAudioCodec=function(e){var t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&t&&(this.log("Swapping audio codec"),t=-1!==t.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),t},s._loadBitrateTestFrag=function(r){var i=this;r.bitrateTest=!0,this._doFragLoad(r).then(function(e){var t=i.hls;if(e&&!t.nextLoadLevel&&!i.fragContextChanged(r)){i.fragLoadError=0,i.state=L.State.IDLE,i.startFragRequested=!1,i.bitrateTest=!1;var n=r.stats;n.parsing.start=n.parsing.end=n.buffering.start=n.buffering.end=self.performance.now(),t.trigger(D.Events.FRAG_LOADED,e),r.bitrateTest=!1}})},s._handleTransmuxComplete=function(e){var t,n="main",r=this.hls,i=e.remuxResult,o=e.chunkMeta,a=this.getCurrentContext(o);if(!a)return this.warn("The loading context changed while buffering fragment "+o.sn+" of level "+o.level+". This chunk will not be buffered."),void this.resetStartWhenNotLoaded(o.level);var s=a.frag,l=a.part,u=a.level,c=i.video,f=i.text,d=i.id3,h=i.initSegment,p=u.details,g=this.altAudio?void 0:i.audio;if(!this.fragContextChanged(s)){if(this.state=L.State.PARSING,h){h.tracks&&(this._bufferInitSegment(u,h.tracks,s,o),r.trigger(D.Events.FRAG_PARSING_INIT_SEGMENT,{frag:s,id:n,tracks:h.tracks}));var v=h.initPTS,y=h.timescale;Object(C.isFiniteNumber)(v)&&(this.initPTS[s.cc]=v,r.trigger(D.Events.INIT_PTS_FOUND,{frag:s,id:n,initPTS:v,timescale:y}))}if(c&&!1!==i.independent){if(p){var m=c.startPTS,b=c.endPTS,E=c.startDTS,T=c.endDTS;if(l)l.elementaryStreams[c.type]={startPTS:m,endPTS:b,startDTS:E,endDTS:T};else if(c.firstKeyFrame&&c.independent&&(this.couldBacktrack=!0),c.dropped&&c.independent){var k=this.getMainFwdBufferInfo();if((k?k.end:this.getLoadPosition())+this.config.maxBufferHole<(c.firstKeyFramePTS?c.firstKeyFramePTS:m)-this.config.maxBufferHole)return void this.backtrack(s);s.setElementaryStreamInfo(c.type,s.start,b,s.start,T,!0)}s.setElementaryStreamInfo(c.type,m,b,E,T),this.backtrackFragment&&(this.backtrackFragment=s),this.bufferFragmentData(c,s,l,o)}}else if(!1===i.independent)return void this.backtrack(s);if(g){var w=g.startPTS,_=g.endPTS,S=g.startDTS,A=g.endDTS;l&&(l.elementaryStreams[x.ElementaryStreamTypes.AUDIO]={startPTS:w,endPTS:_,startDTS:S,endDTS:A}),s.setElementaryStreamInfo(x.ElementaryStreamTypes.AUDIO,w,_,S,A),this.bufferFragmentData(g,s,l,o)}if(p&&null!=d&&null!==(t=d.samples)&&void 0!==t&&t.length){var P={id:n,frag:s,details:p,samples:d.samples};r.trigger(D.Events.FRAG_PARSING_METADATA,P)}if(p&&f){var O={id:n,frag:s,details:p,samples:f.samples};r.trigger(D.Events.FRAG_PARSING_USERDATA,O)}}},s._bufferInitSegment=function(e,n,r,i){var o=this;if(this.state===L.State.PARSING){this.audioOnly=!!n.audio&&!n.video,this.altAudio&&!this.audioOnly&&delete n.audio;var t=n.audio,a=n.video,s=n.audiovideo;if(t){var l=e.audioCodec,u=navigator.userAgent.toLowerCase();this.audioCodecSwitch&&(l&&(l=-1!==l.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),1!==t.metadata.channelCount&&-1===u.indexOf("firefox")&&(l="mp4a.40.5")),-1!==u.indexOf("android")&&"audio/mpeg"!==t.container&&(l="mp4a.40.2",this.log("Android: force audio codec to "+l)),e.audioCodec&&e.audioCodec!==l&&this.log('Swapping manifest audio codec "'+e.audioCodec+'" for "'+l+'"'),t.levelCodec=l,t.id="main",this.log("Init audio buffer, container:"+t.container+", codecs[selected/level/parsed]=["+(l||"")+"/"+(e.audioCodec||"")+"/"+t.codec+"]")}a&&(a.levelCodec=e.videoCodec,a.id="main",this.log("Init video buffer, container:"+a.container+", codecs[level/parsed]=["+(e.videoCodec||"")+"/"+a.codec+"]")),s&&this.log("Init audiovideo buffer, container:"+s.container+", codecs[level/parsed]=["+(e.attrs.CODECS||"")+"/"+s.codec+"]"),this.hls.trigger(D.Events.BUFFER_CODECS,n),Object.keys(n).forEach(function(e){var t=n[e].initSegment;null!=t&&t.byteLength&&o.hls.trigger(D.Events.BUFFER_APPENDING,{type:e,data:t,frag:r,part:null,chunkMeta:i,parent:r.type})}),this.tick()}},s.getMainFwdBufferInfo=function(){return this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,b.PlaylistLevelType.MAIN)},s.backtrack=function(e){this.couldBacktrack=!0,this.backtrackFragment=e,this.resetTransmuxer(),this.flushBufferGap(e),this.fragmentTracker.removeFragment(e),this.fragPrevious=null,this.nextLoadPosition=e.start,this.state=L.State.IDLE},s.checkFragmentChanged=function(){var e=this.media,t=null;if(e&&e.readyState>1&&!1===e.seeking){var n=e.currentTime;if(u.BufferHelper.isBuffered(e,n)?t=this.getAppendedFrag(n):u.BufferHelper.isBuffered(e,n+.1)&&(t=this.getAppendedFrag(n+.1)),t){this.backtrackFragment=null;var r=this.fragPlaying,i=t.level;r&&t.sn===r.sn&&r.level===i&&t.urlId===r.urlId||(this.hls.trigger(D.Events.FRAG_CHANGED,{frag:t}),r&&r.level===i||this.hls.trigger(D.Events.LEVEL_SWITCHED,{level:i}),this.fragPlaying=t)}}},r=n,(i=[{key:"nextLevel",get:function(){var e=this.nextBufferedFrag;return e?e.level:-1}},{key:"currentFrag",get:function(){var e=this.media;return e?this.fragPlaying||this.getAppendedFrag(e.currentTime):null}},{key:"currentProgramDateTime",get:function(){var e=this.media;if(e){var t=e.currentTime,n=this.currentFrag;if(n&&Object(C.isFiniteNumber)(t)&&Object(C.isFiniteNumber)(n.programDateTime)){var r=n.programDateTime+1e3*(t-n.start);return new Date(r)}}return null}},{key:"currentLevel",get:function(){var e=this.currentFrag;return e?e.level:-1}},{key:"nextBufferedFrag",get:function(){var e=this.currentFrag;return e?this.followingBufferedFrag(e):null}},{key:"forceStartLoad",get:function(){return this._forceStartLoad}}])&&d(r.prototype,i),a&&d(r,a),Object.defineProperty(r,"prototype",{writable:!1}),n}(L.default)},"./src/controller/subtitle-stream-controller.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"SubtitleStreamController",function(){return r});var l=n("./src/events.ts"),p=n("./src/utils/buffer-helper.ts"),g=n("./src/controller/fragment-finders.ts"),c=n("./src/utils/discontinuities.ts"),f=n("./src/controller/level-helper.ts"),v=n("./src/controller/fragment-tracker.ts"),y=n("./src/controller/base-stream-controller.ts"),u=n("./src/types/loader.ts"),d=n("./src/types/level.ts");function h(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function m(e,t){return(m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var r=function(r){var e,t;function n(e,t){var n;return(n=r.call(this,e,t,"[subtitle-stream-controller]")||this).levels=[],n.currentTrackId=-1,n.tracksBuffered=[],n.mainDetails=null,n._registerListeners(),n}t=r,(e=n).prototype=Object.create(t.prototype),e.prototype.constructor=e,m(e,t);var i,o,a,s=n.prototype;return s.onHandlerDestroying=function(){this._unregisterListeners(),this.mainDetails=null},s._registerListeners=function(){var e=this.hls;e.on(l.Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(l.Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(l.Events.MANIFEST_LOADING,this.onManifestLoading,this),e.on(l.Events.LEVEL_LOADED,this.onLevelLoaded,this),e.on(l.Events.ERROR,this.onError,this),e.on(l.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(l.Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(l.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(l.Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.on(l.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)},s._unregisterListeners=function(){var e=this.hls;e.off(l.Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(l.Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(l.Events.MANIFEST_LOADING,this.onManifestLoading,this),e.off(l.Events.LEVEL_LOADED,this.onLevelLoaded,this),e.off(l.Events.ERROR,this.onError,this),e.off(l.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(l.Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(l.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(l.Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.off(l.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)},s.startLoad=function(){this.stopLoad(),this.state=y.State.IDLE,this.setInterval(500),this.tick()},s.onManifestLoading=function(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()},s.onLevelLoaded=function(e,t){this.mainDetails=t.details},s.onSubtitleFragProcessed=function(e,t){var n=t.frag,r=t.success;if(this.fragPrevious=n,this.state=y.State.IDLE,r){var i=this.tracksBuffered[this.currentTrackId];if(i){for(var o,a=n.start,s=0;s<i.length;s++)if(a>=i[s].start&&a<=i[s].end){o=i[s];break}var l=n.start+n.duration;o?o.end=l:(o={start:a,end:l},i.push(o)),this.fragmentTracker.fragBuffered(n)}}},s.onBufferFlushing=function(e,t){var n=t.startOffset,r=t.endOffset;if(0===n&&r!==Number.POSITIVE_INFINITY){var i=this.currentTrackId,o=this.levels;if(!o.length||!o[i]||!o[i].details)return;var a=r-o[i].details.targetduration;if(a<=0)return;t.endOffsetSubtitles=Math.max(0,a),this.tracksBuffered.forEach(function(e){for(var t=0;t<e.length;)if(e[t].end<=a)e.shift();else{if(!(e[t].start<a))break;e[t].start=a,t++}}),this.fragmentTracker.removeFragmentsInRange(n,a,u.PlaylistLevelType.SUBTITLE)}},s.onError=function(e,t){var n,r=t.frag;r&&r.type===u.PlaylistLevelType.SUBTITLE&&(null!==(n=this.fragCurrent)&&void 0!==n&&n.loader&&this.fragCurrent.loader.abort(),this.state=y.State.IDLE)},s.onSubtitleTracksUpdated=function(e,t){var n=this,r=t.subtitleTracks;this.tracksBuffered=[],this.levels=r.map(function(e){return new d.Level(e)}),this.fragmentTracker.removeAllFragments(),this.fragPrevious=null,this.levels.forEach(function(e){n.tracksBuffered[e.id]=[]}),this.mediaBuffer=null},s.onSubtitleTrackSwitch=function(e,t){if(this.currentTrackId=t.id,this.levels.length&&-1!==this.currentTrackId){var n=this.levels[this.currentTrackId];null!=n&&n.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,n&&this.setInterval(500)}else this.clearInterval()},s.onSubtitleTrackLoaded=function(e,t){var n,r=t.details,i=t.id,o=this.currentTrackId,a=this.levels;if(a.length){var s=a[o];if(!(i>=a.length||i!==o)&&s){if(this.mediaBuffer=this.mediaBufferTimeRanges,r.live||null!==(n=s.details)&&void 0!==n&&n.live){var l=this.mainDetails;if(r.deltaUpdateFailed||!l)return;var u=l.fragments[0];if(s.details)0===this.alignPlaylists(r,s.details)&&u&&Object(f.addSliding)(r,u.start);else r.hasProgramDateTime&&l.hasProgramDateTime?Object(c.alignMediaPlaylistByPDT)(r,l):u&&Object(f.addSliding)(r,u.start)}if(s.details=r,this.levelLastLoaded=i,this.tick(),r.live&&!this.fragCurrent&&this.media&&this.state===y.State.IDLE)Object(g.findFragmentByPTS)(null,r.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),s.details=void 0)}}},s._handleFragmentLoadComplete=function(e){var n=e.frag,t=e.payload,r=n.decryptdata,i=this.hls;if(!this.fragContextChanged(n)&&t&&t.byteLength>0&&r&&r.key&&r.iv&&"AES-128"===r.method){var o=performance.now();this.decrypter.webCryptoDecrypt(new Uint8Array(t),r.key.buffer,r.iv.buffer).then(function(e){var t=performance.now();i.trigger(l.Events.FRAG_DECRYPTED,{frag:n,payload:e,stats:{tstart:o,tdecrypt:t}})})}},s.doTick=function(){if(this.media){if(this.state===y.State.IDLE){var e=this.currentTrackId,t=this.levels;if(!t.length||!t[e]||!t[e].details)return;var n=t[e].details,r=n.targetduration,i=this.config,o=this.media,a=p.BufferHelper.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],o.currentTime-r,i.maxBufferHole),s=a.end;if(a.len>this.getMaxBufferLength()+r)return;console.assert(n,"Subtitle track details are defined on idle subtitle stream controller tick");var l,u=n.fragments,c=u.length,f=n.edge,d=this.fragPrevious;if(s<f){var h=i.maxFragLookUpTolerance;!(l=Object(g.findFragmentByPTS)(d,u,Math.max(u[0].start,s),h))&&d&&d.start<u[0].start&&(l=u[0])}else l=u[c-1];if(!(l=this.mapToInitFragWhenRequired(l)))return;if(this.fragmentTracker.getState(l)!==v.FragmentState.NOT_LOADED)return;l.encrypted?this.loadKey(l,n):this.loadFragment(l,n,s)}}else this.state=y.State.IDLE},s.loadFragment=function(e,t,n){this.fragCurrent=e,"initSegment"===e.sn?this._loadInitSegment(e):r.prototype.loadFragment.call(this,e,t,n)},i=n,(o=[{key:"mediaBufferTimeRanges",get:function(){return new b(this.tracksBuffered[this.currentTrackId]||[])}}])&&h(i.prototype,o),a&&h(i,a),Object.defineProperty(i,"prototype",{writable:!1}),n}(y.default),b=function(r){this.buffered=void 0;var t=function(e,t,n){if((t>>>=0)>n-1)throw new DOMException("Failed to execute '"+e+"' on 'TimeRanges': The index provided ("+t+") is greater than the maximum bound ("+n+")");return r[t][e]};this.buffered={get length(){return r.length},end:function(e){return t("end",e,r.length)},start:function(e){return t("start",e,r.length)}}}},"./src/controller/subtitle-track-controller.ts":function(e,t,n){"use strict";n.r(t);var d=n("./src/events.ts"),l=n("./src/utils/texttrack-utils.ts"),r=n("./src/controller/base-playlist-controller.ts"),u=n("./src/types/loader.ts");function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t){return(f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var i=function(n){var e,t;function r(e){var t;return(t=n.call(this,e,"[subtitle-track-controller]")||this).media=null,t.tracks=[],t.groupId=null,t.tracksInGroup=[],t.trackId=-1,t.selectDefaultTrack=!0,t.queuedDefaultTrack=-1,t.trackChangeListener=function(){return t.onTextTracksChanged()},t.asyncPollTrackChange=function(){return t.pollTrackChange(0)},t.useTextTrackPolling=!1,t.subtitlePollingInterval=-1,t._subtitleDisplay=!0,t.registerListeners(),t}t=n,(e=r).prototype=Object.create(t.prototype),e.prototype.constructor=e,f(e,t);var i,o,a,s=r.prototype;return s.destroy=function(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.trackChangeListener=this.asyncPollTrackChange=null,n.prototype.destroy.call(this)},s.registerListeners=function(){var e=this.hls;e.on(d.Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(d.Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(d.Events.MANIFEST_LOADING,this.onManifestLoading,this),e.on(d.Events.MANIFEST_PARSED,this.onManifestParsed,this),e.on(d.Events.LEVEL_LOADING,this.onLevelLoading,this),e.on(d.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(d.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(d.Events.ERROR,this.onError,this)},s.unregisterListeners=function(){var e=this.hls;e.off(d.Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(d.Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(d.Events.MANIFEST_LOADING,this.onManifestLoading,this),e.off(d.Events.MANIFEST_PARSED,this.onManifestParsed,this),e.off(d.Events.LEVEL_LOADING,this.onLevelLoading,this),e.off(d.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(d.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(d.Events.ERROR,this.onError,this)},s.onMediaAttached=function(e,t){this.media=t.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))},s.pollTrackChange=function(e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.trackChangeListener,e)},s.onMediaDetaching=function(){this.media&&(self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),h(this.media.textTracks).forEach(function(e){Object(l.clearCurrentCues)(e)}),this.subtitleTrack=-1,this.media=null)},s.onManifestLoading=function(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.selectDefaultTrack=!0},s.onManifestParsed=function(e,t){this.tracks=t.subtitleTracks},s.onSubtitleTrackLoaded=function(e,t){var n=t.id,r=t.details,i=this.trackId,o=this.tracksInGroup[i];if(o){var a=o.details;o.details=t.details,this.log("subtitle track "+n+" loaded ["+r.startSN+"-"+r.endSN+"]"),n===this.trackId&&(this.retryCount=0,this.playlistLoaded(n,t,a))}else this.warn("Invalid subtitle track id "+n)},s.onLevelLoading=function(e,t){this.switchLevel(t.level)},s.onLevelSwitching=function(e,t){this.switchLevel(t.level)},s.switchLevel=function(e){var t=this.hls.levels[e];if(null!=t&&t.textGroupIds){var n=t.textGroupIds[t.urlId];if(this.groupId!==n){var r=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0,i=this.tracks.filter(function(e){return!n||e.groupId===n});this.tracksInGroup=i;var o=this.findTrackId(null==r?void 0:r.name)||this.findTrackId();this.groupId=n;var a={subtitleTracks:i};this.log("Updating subtitle tracks, "+i.length+' track(s) found in "'+n+'" group-id'),this.hls.trigger(d.Events.SUBTITLE_TRACKS_UPDATED,a),-1!==o&&this.setSubtitleTrack(o,r)}}},s.findTrackId=function(e){for(var t=this.tracksInGroup,n=0;n<t.length;n++){var r=t[n];if((!this.selectDefaultTrack||r.default)&&(!e||e===r.name))return r.id}return-1},s.onError=function(e,t){n.prototype.onError.call(this,e,t),!t.fatal&&t.context&&t.context.type===u.PlaylistContextType.SUBTITLE_TRACK&&t.context.id===this.trackId&&t.context.groupId===this.groupId&&this.retryLoadingOrFail(t)},s.loadPlaylist=function(e){var t=this.tracksInGroup[this.trackId];if(this.shouldLoadTrack(t)){var n=t.id,r=t.groupId,i=t.url;if(e)try{i=e.addDirectives(i)}catch(e){this.warn("Could not construct new URL with HLS Delivery Directives: "+e)}this.log("Loading subtitle playlist for id "+n),this.hls.trigger(d.Events.SUBTITLE_TRACK_LOADING,{url:i,id:n,groupId:r,deliveryDirectives:e||null})}},s.toggleTrackModes=function(e){var t=this,n=this.media,r=this.trackId;if(n){var i=h(n.textTracks),o=i.filter(function(e){return e.groupId===t.groupId});if(-1===e)[].slice.call(i).forEach(function(e){e.mode="disabled"});else{var a=o[r];a&&(a.mode="disabled")}var s=o[e];s&&(s.mode=this.subtitleDisplay?"showing":"hidden")}},s.setSubtitleTrack=function(e,t){var n,r=this.tracksInGroup;if(this.media){if(this.trackId!==e&&this.toggleTrackModes(e),!(this.trackId===e&&(-1===e||null!==(n=r[e])&&void 0!==n&&n.details)||e<-1||e>=r.length)){this.clearTimer();var i=r[e];if(this.log("Switching to subtitle track "+e),this.trackId=e,i){var o=i.id,a=i.groupId,s=void 0===a?"":a,l=i.name,u=i.type,c=i.url;this.hls.trigger(d.Events.SUBTITLE_TRACK_SWITCH,{id:o,groupId:s,name:l,type:u,url:c});var f=this.switchParams(i.url,null==t?void 0:t.details);this.loadPlaylist(f)}else this.hls.trigger(d.Events.SUBTITLE_TRACK_SWITCH,{id:e})}}else this.queuedDefaultTrack=e},s.onTextTracksChanged=function(){if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),this.media&&this.hls.config.renderTextTracksNatively){for(var e=-1,t=h(this.media.textTracks),n=0;n<t.length;n++)if("hidden"===t[n].mode)e=n;else if("showing"===t[n].mode){e=n;break}this.subtitleTrack!==e&&(this.subtitleTrack=e)}},i=r,(o=[{key:"subtitleDisplay",get:function(){return this._subtitleDisplay},set:function(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes(this.trackId)}},{key:"subtitleTracks",get:function(){return this.tracksInGroup}},{key:"subtitleTrack",get:function(){return this.trackId},set:function(e){this.selectDefaultTrack=!1;var t=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0;this.setSubtitleTrack(e,t)}}])&&c(i.prototype,o),a&&c(i,a),Object.defineProperty(i,"prototype",{writable:!1}),r}(r.default);function h(e){for(var t=[],n=0;n<e.length;n++){var r=e[n];"subtitles"===r.kind&&r.label&&t.push(e[n])}return t}t.default=i},"./src/controller/timeline-controller.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"TimelineController",function(){return r});var c=n("./src/polyfills/number.ts"),g=n("./src/events.ts"),o=n("./src/utils/cea-608-parser.ts"),a=n("./src/utils/output-filter.ts"),s=n("./src/utils/webvtt-parser.ts"),u=n("./src/utils/texttrack-utils.ts"),f=n("./src/utils/imsc1-ttml-parser.ts"),l=n("./src/utils/mp4-tools.ts"),d=n("./src/types/loader.ts"),h=n("./src/utils/logger.ts"),r=function(){function e(e){if(this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.timescale=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}},this.captionsProperties=void 0,this.hls=e,this.config=e.config,this.Cues=e.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},this.config.enableCEA708Captions){var t=new a.default(this,"textTrack1"),n=new a.default(this,"textTrack2"),r=new a.default(this,"textTrack3"),i=new a.default(this,"textTrack4");this.cea608Parser1=new o.default(1,t,n),this.cea608Parser2=new o.default(3,r,i)}e.on(g.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(g.Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(g.Events.MANIFEST_LOADING,this.onManifestLoading,this),e.on(g.Events.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(g.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(g.Events.FRAG_LOADING,this.onFragLoading,this),e.on(g.Events.FRAG_LOADED,this.onFragLoaded,this),e.on(g.Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.on(g.Events.FRAG_DECRYPTED,this.onFragDecrypted,this),e.on(g.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(g.Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.on(g.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)}var t=e.prototype;return t.destroy=function(){var e=this.hls;e.off(g.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(g.Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(g.Events.MANIFEST_LOADING,this.onManifestLoading,this),e.off(g.Events.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(g.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(g.Events.FRAG_LOADING,this.onFragLoading,this),e.off(g.Events.FRAG_LOADED,this.onFragLoaded,this),e.off(g.Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(g.Events.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(g.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(g.Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(g.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.cea608Parser1=this.cea608Parser2=null},t.addCues=function(e,t,n,r,i){for(var o,a,s,l,u=!1,c=i.length;c--;){var f=i[c],d=(o=f[0],a=f[1],s=t,l=n,Math.min(a,l)-Math.max(o,s));if(d>=0&&(f[0]=Math.min(f[0],t),f[1]=Math.max(f[1],n),u=!0,d/(n-t)>.5))return}if(u||i.push([t,n]),this.config.renderTextTracksNatively){var h=this.captionsTracks[e];this.Cues.newCue(h,t,n,r)}else{var p=this.Cues.newCue(null,t,n,r);this.hls.trigger(g.Events.CUES_PARSED,{type:"captions",cues:p,track:e})}},t.onInitPtsFound=function(e,t){var n=this,r=t.frag,i=t.id,o=t.initPTS,a=t.timescale,s=this.unparsedVttFrags;"main"===i&&(this.initPTS[r.cc]=o,this.timescale[r.cc]=a),s.length&&(this.unparsedVttFrags=[],s.forEach(function(e){n.onFragLoaded(g.Events.FRAG_LOADED,e)}))},t.getExistingTrack=function(e){var t=this.media;if(t)for(var n=0;n<t.textTracks.length;n++){var r=t.textTracks[n];if(r[e])return r}return null},t.createCaptionsTrack=function(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)},t.createNativeTrack=function(e){if(!this.captionsTracks[e]){var t=this.captionsProperties,n=this.captionsTracks,r=this.media,i=t[e],o=i.label,a=i.languageCode,s=this.getExistingTrack(e);if(s)n[e]=s,Object(u.clearCurrentCues)(n[e]),Object(u.sendAddTrackEvent)(n[e],r);else{var l=this.createTextTrack("captions",o,a);l&&(l[e]=!0,n[e]=l)}}},t.createNonNativeTrack=function(e){if(!this.nonNativeCaptionsTracks[e]){var t=this.captionsProperties[e];if(t){var n={_id:e,label:t.label,kind:"captions",default:!!t.media&&!!t.media.default,closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=n,this.hls.trigger(g.Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[n]})}}},t.createTextTrack=function(e,t,n){var r=this.media;if(r)return r.addTextTrack(e,t,n)},t.onMediaAttaching=function(e,t){this.media=t.media,this._cleanTracks()},t.onMediaDetaching=function(){var t=this.captionsTracks;Object.keys(t).forEach(function(e){Object(u.clearCurrentCues)(t[e]),delete t[e]}),this.nonNativeCaptionsTracks={}},t.onManifestLoading=function(){this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}},this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=[],this.timescale=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())},t._cleanTracks=function(){var e=this.media;if(e){var t=e.textTracks;if(t)for(var n=0;n<t.length;n++)Object(u.clearCurrentCues)(t[n])}},t.onSubtitleTracksUpdated=function(e,t){var a=this;this.textTracks=[];var n=t.subtitleTracks||[],r=n.some(function(e){return e.textCodec===f.IMSC1_CODEC});if(this.config.enableWebVTT||r&&this.config.enableIMSC1){var i=this.tracks&&n&&this.tracks.length===n.length;if(this.tracks=n||[],this.config.renderTextTracksNatively){var s=this.media?this.media.textTracks:[];this.tracks.forEach(function(e,t){var n;if(t<s.length){for(var r=null,i=0;i<s.length;i++)if(p(s[i],e)){r=s[i];break}r&&(n=r)}if(n)Object(u.clearCurrentCues)(n);else{var o=a._captionsOrSubtitlesFromCharacteristics(e);(n=a.createTextTrack(o,e.name,e.lang))&&(n.mode="disabled")}n&&(n.groupId=e.groupId,a.textTracks.push(n))})}else if(!i&&this.tracks&&this.tracks.length){var o=this.tracks.map(function(e){return{label:e.name,kind:e.type.toLowerCase(),default:e.default,subtitleTrack:e}});this.hls.trigger(g.Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:o})}}},t._captionsOrSubtitlesFromCharacteristics=function(e){var t;if(null!==(t=e.attrs)&&void 0!==t&&t.CHARACTERISTICS){var n=/transcribes-spoken-dialog/gi.test(e.attrs.CHARACTERISTICS),r=/describes-music-and-sound/gi.test(e.attrs.CHARACTERISTICS);if(n&&r)return"captions"}return"subtitles"},t.onManifestLoaded=function(e,t){var i=this;this.config.enableCEA708Captions&&t.captions&&t.captions.forEach(function(e){var t=/(?:CC|SERVICE)([1-4])/.exec(e.instreamId);if(t){var n="textTrack"+t[1],r=i.captionsProperties[n];r&&(r.label=e.name,e.lang&&(r.languageCode=e.lang),r.media=e)}})},t.closedCaptionsForLevel=function(e){var t=this.hls.levels[e.level];return null==t?void 0:t.attrs["CLOSED-CAPTIONS"]},t.onFragLoading=function(e,t){var n=this.cea608Parser1,r=this.cea608Parser2,i=this.lastSn,o=this.lastPartIndex;if(this.enabled&&n&&r&&t.frag.type===d.PlaylistLevelType.MAIN){var a,s,l=t.frag.sn,u=null!=(a=null==t?void 0:null===(s=t.part)||void 0===s?void 0:s.index)?a:-1;l===i+1||l===i&&u===o+1||(n.reset(),r.reset()),this.lastSn=l,this.lastPartIndex=u}},t.onFragLoaded=function(e,t){var n=t.frag,r=t.payload,i=this.initPTS,o=this.unparsedVttFrags;if(n.type===d.PlaylistLevelType.SUBTITLE)if(r.byteLength){if(!Object(c.isFiniteNumber)(i[n.cc]))return o.push(t),void(i.length&&this.hls.trigger(g.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:new Error("Missing initial subtitle PTS")}));var a=n.decryptdata,s="stats"in t;if(null==a||null==a.key||"AES-128"!==a.method||s){var l=this.tracks[n.level],u=this.vttCCs;u[n.cc]||(u[n.cc]={start:n.start,prevCC:this.prevCC,new:!0},this.prevCC=n.cc),l&&l.textCodec===f.IMSC1_CODEC?this._parseIMSC1(n,r):this._parseVTTs(n,r,u)}}else this.hls.trigger(g.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:new Error("Empty subtitle payload")})},t._parseIMSC1=function(t,e){var n=this,r=this.hls;Object(f.parseIMSC1)(e,this.initPTS[t.cc],this.timescale[t.cc],function(e){n._appendCues(e,t.level),r.trigger(g.Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:t})},function(e){h.logger.log("Failed to parse IMSC1: "+e),r.trigger(g.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t,error:e})})},t._parseVTTs=function(t,n,e){var r,i=this,o=this.hls,a=null!==(r=t.initSegment)&&void 0!==r&&r.data?Object(l.appendUint8Array)(t.initSegment.data,new Uint8Array(n)):n;Object(s.parseWebVTT)(a,this.initPTS[t.cc],this.timescale[t.cc],e,t.cc,t.start,function(e){i._appendCues(e,t.level),o.trigger(g.Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:t})},function(e){i._fallbackToIMSC1(t,n),h.logger.log("Failed to parse VTT cue: "+e),o.trigger(g.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t,error:e})})},t._fallbackToIMSC1=function(e,t){var n=this,r=this.tracks[e.level];r.textCodec||Object(f.parseIMSC1)(t,this.initPTS[e.cc],this.timescale[e.cc],function(){r.textCodec=f.IMSC1_CODEC,n._parseIMSC1(e,t)},function(){r.textCodec="wvtt"})},t._appendCues=function(e,t){var n=this.hls;if(this.config.renderTextTracksNatively){var r=this.textTracks[t];if(!r||"disabled"===r.mode)return;e.forEach(function(e){return Object(u.addCueToTrack)(r,e)})}else{var i=this.tracks[t];if(!i)return;var o=i.default?"default":"subtitles"+t;n.trigger(g.Events.CUES_PARSED,{type:"subtitles",cues:e,track:o})}},t.onFragDecrypted=function(e,t){var n=t.frag;if(n.type===d.PlaylistLevelType.SUBTITLE){if(!Object(c.isFiniteNumber)(this.initPTS[n.cc]))return void this.unparsedVttFrags.push(t);this.onFragLoaded(g.Events.FRAG_LOADED,t)}},t.onSubtitleTracksCleared=function(){this.tracks=[],this.captionsTracks={}},t.onFragParsingUserdata=function(e,t){var n=this.cea608Parser1,r=this.cea608Parser2;if(this.enabled&&n&&r){var i=t.frag,o=t.samples;if(i.type!==d.PlaylistLevelType.MAIN||"NONE"!==this.closedCaptionsForLevel(i))for(var a=0;a<o.length;a++){var s=o[a].bytes;if(s){var l=this.extractCea608Data(s);n.addData(o[a].pts,l[0]),r.addData(o[a].pts,l[1])}}}},t.onBufferFlushing=function(e,t){var n=t.startOffset,r=t.endOffset,i=t.endOffsetSubtitles,o=t.type,a=this.media;if(a&&!(a.currentTime<r)){if(!o||"video"===o){var s=this.captionsTracks;Object.keys(s).forEach(function(e){return Object(u.removeCuesInRange)(s[e],n,r)})}if(this.config.renderTextTracksNatively&&0===n&&void 0!==i){var l=this.textTracks;Object.keys(l).forEach(function(e){return Object(u.removeCuesInRange)(l[e],n,i)})}}},t.extractCea608Data=function(e){for(var t=[[],[]],n=31&e[0],r=2,i=0;i<n;i++){var o=e[r++],a=127&e[r++],s=127&e[r++];if(0!==a||0!==s)if(0!=(4&o)){var l=3&o;0!==l&&1!==l||(t[l].push(a),t[l].push(s))}}return t},e}();function p(e,t){return e&&e.label===t.name&&!(e.textTrack1||e.textTrack2)}},"./src/crypt/aes-crypto.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return r});var r=function(){function e(e,t){this.subtle=void 0,this.aesIV=void 0,this.subtle=e,this.aesIV=t}return e.prototype.decrypt=function(e,t){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e)},e}()},"./src/crypt/aes-decryptor.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"removePadding",function(){return i}),n.d(t,"default",function(){return o});var r=n("./src/utils/typed-array.ts");function i(e){var t=e.byteLength,n=t&&new DataView(e.buffer).getUint8(t-1);return n?Object(r.sliceUint8)(e,0,t-n):e}var o=function(){function e(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}var t=e.prototype;return t.uint8ArrayToUint32Array_=function(e){for(var t=new DataView(e),n=new Uint32Array(4),r=0;r<4;r++)n[r]=t.getUint32(4*r);return n},t.initTable=function(){var e=this.sBox,t=this.invSBox,n=this.subMix,r=n[0],i=n[1],o=n[2],a=n[3],s=this.invSubMix,l=s[0],u=s[1],c=s[2],f=s[3],d=new Uint32Array(256),h=0,p=0,g=0;for(g=0;g<256;g++)d[g]=g<128?g<<1:g<<1^283;for(g=0;g<256;g++){var v=p^p<<1^p<<2^p<<3^p<<4;v=v>>>8^255&v^99,e[h]=v,t[v]=h;var y=d[h],m=d[y],b=d[m],E=257*d[v]^16843008*v;r[h]=E<<24|E>>>8,i[h]=E<<16|E>>>16,o[h]=E<<8|E>>>24,a[h]=E,E=16843009*b^65537*m^257*y^16843008*h,l[v]=E<<24|E>>>8,u[v]=E<<16|E>>>16,c[v]=E<<8|E>>>24,f[v]=E,h?(h=y^d[d[d[b^y]]],p^=d[d[p]]):h=p=1}},t.expandKey=function(e){for(var t=this.uint8ArrayToUint32Array_(e),n=!0,r=0;r<t.length&&n;)n=t[r]===this.key[r],r++;if(!n){this.key=t;var i=this.keySize=t.length;if(4!==i&&6!==i&&8!==i)throw new Error("Invalid aes key size="+i);var o,a,s,l,u=this.ksRows=4*(i+6+1),c=this.keySchedule=new Uint32Array(u),f=this.invKeySchedule=new Uint32Array(u),d=this.sBox,h=this.rcon,p=this.invSubMix,g=p[0],v=p[1],y=p[2],m=p[3];for(o=0;o<u;o++)o<i?s=c[o]=t[o]:(l=s,o%i==0?(l=d[(l=l<<8|l>>>24)>>>24]<<24|d[l>>>16&255]<<16|d[l>>>8&255]<<8|d[255&l],l^=h[o/i|0]<<24):i>6&&o%i==4&&(l=d[l>>>24]<<24|d[l>>>16&255]<<16|d[l>>>8&255]<<8|d[255&l]),c[o]=s=(c[o-i]^l)>>>0);for(a=0;a<u;a++)o=u-a,l=3&a?c[o]:c[o-4],f[a]=a<4||o<=4?l:g[d[l>>>24]]^v[d[l>>>16&255]]^y[d[l>>>8&255]]^m[d[255&l]],f[a]=f[a]>>>0}},t.networkToHostOrderSwap=function(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24},t.decrypt=function(e,t,n){for(var r,i,o,a,s,l,u,c,f,d,h,p,g,v,y=this.keySize+6,m=this.invKeySchedule,b=this.invSBox,E=this.invSubMix,T=E[0],k=E[1],w=E[2],_=E[3],S=this.uint8ArrayToUint32Array_(n),A=S[0],P=S[1],O=S[2],C=S[3],L=new Int32Array(e),D=new Int32Array(L.length),x=this.networkToHostOrderSwap;t<L.length;){for(f=x(L[t]),d=x(L[t+1]),h=x(L[t+2]),p=x(L[t+3]),s=f^m[0],l=p^m[1],u=h^m[2],c=d^m[3],g=4,v=1;v<y;v++)r=T[s>>>24]^k[l>>16&255]^w[u>>8&255]^_[255&c]^m[g],i=T[l>>>24]^k[u>>16&255]^w[c>>8&255]^_[255&s]^m[g+1],o=T[u>>>24]^k[c>>16&255]^w[s>>8&255]^_[255&l]^m[g+2],a=T[c>>>24]^k[s>>16&255]^w[l>>8&255]^_[255&u]^m[g+3],s=r,l=i,u=o,c=a,g+=4;r=b[s>>>24]<<24^b[l>>16&255]<<16^b[u>>8&255]<<8^b[255&c]^m[g],i=b[l>>>24]<<24^b[u>>16&255]<<16^b[c>>8&255]<<8^b[255&s]^m[g+1],o=b[u>>>24]<<24^b[c>>16&255]<<16^b[s>>8&255]<<8^b[255&l]^m[g+2],a=b[c>>>24]<<24^b[s>>16&255]<<16^b[l>>8&255]<<8^b[255&u]^m[g+3],D[t]=x(r^A),D[t+1]=x(a^P),D[t+2]=x(o^O),D[t+3]=x(i^C),A=f,P=d,O=h,C=p,t+=4}return D.buffer},e}()},"./src/crypt/decrypter.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return r});var a=n("./src/crypt/aes-crypto.ts"),s=n("./src/crypt/fast-aes-key.ts"),u=n("./src/crypt/aes-decryptor.ts"),i=n("./src/utils/logger.ts"),c=n("./src/utils/mp4-tools.ts"),f=n("./src/utils/typed-array.ts"),r=function(){function e(e,t,n){var r=(void 0===n?{}:n).removePKCS7Padding,i=void 0===r||r;if(this.logEnabled=!0,this.observer=void 0,this.config=void 0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.observer=e,this.config=t,this.removePKCS7Padding=i,i)try{var o=self.crypto;o&&(this.subtle=o.subtle||o.webkitSubtle)}catch(e){}null===this.subtle&&(this.config.enableSoftwareAES=!0)}var t=e.prototype;return t.destroy=function(){this.observer=null},t.isSync=function(){return this.config.enableSoftwareAES},t.flush=function(){var e=this.currentResult;if(e){var t=new Uint8Array(e);return this.reset(),this.removePKCS7Padding?Object(u.removePadding)(t):t}this.reset()},t.reset=function(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)},t.decrypt=function(e,t,n,r){if(this.config.enableSoftwareAES){this.softwareDecrypt(new Uint8Array(e),t,n);var i=this.flush();i&&r(i.buffer)}else this.webCryptoDecrypt(new Uint8Array(e),t,n).then(r)},t.softwareDecrypt=function(e,t,n){var r=this.currentIV,i=this.currentResult,o=this.remainderData;this.logOnce("JS AES decrypt"),o&&(e=Object(c.appendUint8Array)(o,e),this.remainderData=null);var a=this.getValidChunk(e);if(!a.length)return null;r&&(n=r);var s=this.softwareDecrypter;s||(s=this.softwareDecrypter=new u.default),s.expandKey(t);var l=i;return this.currentResult=s.decrypt(a.buffer,0,n),this.currentIV=Object(f.sliceUint8)(a,-16).buffer,l||null},t.webCryptoDecrypt=function(t,n,r){var i=this,o=this.subtle;return this.key===n&&this.fastAesKey||(this.key=n,this.fastAesKey=new s.default(o,n)),this.fastAesKey.expandKey().then(function(e){return o?new a.default(o,r).decrypt(t.buffer,e):Promise.reject(new Error("web crypto not initialized"))}).catch(function(e){return i.onWebCryptoError(e,t,n,r)})},t.onWebCryptoError=function(e,t,n,r){return i.logger.warn("[decrypter.ts]: WebCrypto Error, disable WebCrypto API:",e),this.config.enableSoftwareAES=!0,this.logEnabled=!0,this.softwareDecrypt(t,n,r)},t.getValidChunk=function(e){var t=e,n=e.length-e.length%16;return n!==e.length&&(t=Object(f.sliceUint8)(e,0,n),this.remainderData=Object(f.sliceUint8)(e,n)),t},t.logOnce=function(e){this.logEnabled&&(i.logger.log("[decrypter.ts]: "+e),this.logEnabled=!1)},e}()},"./src/crypt/fast-aes-key.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return r});var r=function(){function e(e,t){this.subtle=void 0,this.key=void 0,this.subtle=e,this.key=t}return e.prototype.expandKey=function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])},e}()},"./src/demux/aacdemuxer.ts":function(e,t,n){"use strict";n.r(t);var r=n("./src/demux/base-audio-demuxer.ts"),o=n("./src/demux/adts.ts"),a=n("./src/utils/logger.ts"),s=n("./src/demux/id3.ts");function l(e,t){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var i=function(i){var e,t;function n(e,t){var n;return(n=i.call(this)||this).observer=void 0,n.config=void 0,n.observer=e,n.config=t,n}t=i,(e=n).prototype=Object.create(t.prototype),e.prototype.constructor=e,l(e,t);var r=n.prototype;return r.resetInitSegment=function(e,t,n,r){i.prototype.resetInitSegment.call(this,e,t,n,r),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:t,duration:r,inputTimeScale:9e4,dropped:0}},n.probe=function(e){if(!e)return!1;for(var t=(s.getID3Data(e,0)||[]).length,n=e.length;t<n;t++)if(o.probe(e,t))return a.logger.log("ADTS sync word found !"),!0;return!1},r.canParse=function(e,t){return o.canParse(e,t)},r.appendFrame=function(e,t,n){o.initTrackConfig(e,this.observer,t,n,e.manifestCodec);var r=o.appendFrame(e,t,n,this.basePTS,this.frameIndex);if(r&&0===r.missing)return r},n}(r.default);t.default=i},"./src/demux/adts.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"getAudioConfig",function(){return a}),n.d(t,"isHeaderPattern",function(){return r}),n.d(t,"getHeaderLength",function(){return o}),n.d(t,"getFullFrameLength",function(){return s}),n.d(t,"canGetFrameLength",function(){return i}),n.d(t,"isHeader",function(){return l}),n.d(t,"canParse",function(){return u}),n.d(t,"probe",function(){return c}),n.d(t,"initTrackConfig",function(){return f}),n.d(t,"getFrameDuration",function(){return g}),n.d(t,"parseFrameHeader",function(){return v}),n.d(t,"appendFrame",function(){return y});var d=n("./src/utils/logger.ts"),h=n("./src/errors.ts"),p=n("./src/events.ts");function a(e,t,n,r){var i,o,a,s,l=navigator.userAgent.toLowerCase(),u=r,c=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];i=1+((192&t[n+2])>>>6);var f=(60&t[n+2])>>>2;if(!(f>c.length-1))return a=(1&t[n+2])<<2,a|=(192&t[n+3])>>>6,d.logger.log("manifest codec:"+r+", ADTS type:"+i+", samplingIndex:"+f),/firefox/i.test(l)?f>=6?(i=5,s=new Array(4),o=f-3):(i=2,s=new Array(2),o=f):-1!==l.indexOf("android")?(i=2,s=new Array(2),o=f):(i=5,s=new Array(4),r&&(-1!==r.indexOf("mp4a.40.29")||-1!==r.indexOf("mp4a.40.5"))||!r&&f>=6?o=f-3:((r&&-1!==r.indexOf("mp4a.40.2")&&(f>=6&&1===a||/vivaldi/i.test(l))||!r&&1===a)&&(i=2,s=new Array(2)),o=f)),s[0]=i<<3,s[0]|=(14&f)>>1,s[1]|=(1&f)<<7,s[1]|=a<<3,5===i&&(s[1]|=(14&o)>>1,s[2]=(1&o)<<7,s[2]|=8,s[3]=0),{config:s,samplerate:c[f],channelCount:a,codec:"mp4a.40."+i,manifestCodec:u};e.trigger(p.Events.ERROR,{type:h.ErrorTypes.MEDIA_ERROR,details:h.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+f})}function r(e,t){return 255===e[t]&&240==(246&e[t+1])}function o(e,t){return 1&e[t+1]?7:9}function s(e,t){return(3&e[t+3])<<11|e[t+4]<<3|(224&e[t+5])>>>5}function i(e,t){return t+5<e.length}function l(e,t){return t+1<e.length&&r(e,t)}function u(e,t){return i(e,t)&&r(e,t)&&s(e,t)<=e.length-t}function c(e,t){if(l(e,t)){var n=o(e,t);if(t+n>=e.length)return!1;var r=s(e,t);if(r<=n)return!1;var i=t+r;return i===e.length||l(e,i)}return!1}function f(e,t,n,r,i){if(!e.samplerate){var o=a(t,n,r,i);if(!o)return;e.config=o.config,e.samplerate=o.samplerate,e.channelCount=o.channelCount,e.codec=o.codec,e.manifestCodec=o.manifestCodec,d.logger.log("parsed codec:"+e.codec+", rate:"+o.samplerate+", channels:"+o.channelCount)}}function g(e){return 9216e4/e}function v(e,t){var n=o(e,t);if(t+n<=e.length){var r=s(e,t)-n;if(r>0)return{headerLength:n,frameLength:r}}}function y(e,t,n,r,i){var o,a=r+i*g(e.samplerate),s=v(t,n);if(s){var l=s.frameLength,u=s.headerLength,c=u+l,f=Math.max(0,n+c-t.length);f?(o=new Uint8Array(c-u)).set(t.subarray(n+u,t.length),0):o=t.subarray(n+u,n+c);var d={unit:o,pts:a};return f||e.samples.push(d),{sample:d,length:c,missing:f}}var h=t.length-n;return(o=new Uint8Array(h)).set(t.subarray(n,t.length),0),{sample:{unit:o,pts:a},length:h,missing:-1}}},"./src/demux/base-audio-demuxer.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"initPTSFn",function(){return m});var d=n("./src/polyfills/number.ts"),h=n("./src/demux/id3.ts"),p=n("./src/types/demuxer.ts"),g=n("./src/demux/dummy-demuxed-track.ts"),v=n("./src/utils/mp4-tools.ts"),y=n("./src/utils/typed-array.ts"),r=function(){function e(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null}var t=e.prototype;return t.resetInitSegment=function(e,t,n,r){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}},t.resetTimeStamp=function(e){this.initPTS=e,this.resetContiguity()},t.resetContiguity=function(){this.basePTS=null,this.frameIndex=0},t.canParse=function(e,t){return!1},t.appendFrame=function(e,t,n){},t.demux=function(e,t){this.cachedData&&(e=Object(v.appendUint8Array)(this.cachedData,e),this.cachedData=null);var n,r,i=h.getID3Data(e,0),o=i?i.length:0,a=this._audioTrack,s=this._id3Track,l=i?h.getTimeStamp(i):void 0,u=e.length;for((null===this.basePTS||0===this.frameIndex&&Object(d.isFiniteNumber)(l))&&(this.basePTS=m(l,t,this.initPTS)),i&&i.length>0&&s.samples.push({pts:this.basePTS,dts:this.basePTS,data:i,type:p.MetadataSchema.audioId3}),r=this.basePTS;o<u;){if(this.canParse(e,o)){var c=this.appendFrame(a,e,o);c?(this.frameIndex++,r=c.sample.pts,n=o+=c.length):o=u}else h.canParse(e,o)?(i=h.getID3Data(e,o),s.samples.push({pts:r,dts:r,data:i,type:p.MetadataSchema.audioId3}),n=o+=i.length):o++;if(o===u&&n!==u){var f=Object(y.sliceUint8)(e,n);this.cachedData?this.cachedData=Object(v.appendUint8Array)(this.cachedData,f):this.cachedData=f}}return{audioTrack:a,videoTrack:Object(g.dummyTrack)(),id3Track:s,textTrack:Object(g.dummyTrack)()}},t.demuxSampleAes=function(e,t,n){return Promise.reject(new Error("["+this+"] This demuxer does not support Sample-AES decryption"))},t.flush=function(e){var t=this.cachedData;return t&&(this.cachedData=null,this.demux(t,0)),{audioTrack:this._audioTrack,videoTrack:Object(g.dummyTrack)(),id3Track:this._id3Track,textTrack:Object(g.dummyTrack)()}},t.destroy=function(){},e}(),m=function(e,t,n){return Object(d.isFiniteNumber)(e)?90*e:9e4*t+(n||0)};t.default=r},"./src/demux/chunk-cache.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return r});var r=function(){function e(){this.chunks=[],this.dataLength=0}var t=e.prototype;return t.push=function(e){this.chunks.push(e),this.dataLength+=e.length},t.flush=function(){var e,t=this.chunks,n=this.dataLength;return t.length?(e=1===t.length?t[0]:function(e,t){for(var n=new Uint8Array(t),r=0,i=0;i<e.length;i++){var o=e[i];n.set(o,r),r+=o.length}return n}(t,n),this.reset(),e):new Uint8Array(0)},t.reset=function(){this.chunks.length=0,this.dataLength=0},e}()},"./src/demux/dummy-demuxed-track.ts":function(e,t,n){"use strict";function r(e,t){return void 0===e&&(e=""),void 0===t&&(t=9e4),{type:e,id:-1,pid:-1,inputTimeScale:t,sequenceNumber:-1,samples:[],dropped:0}}n.r(t),n.d(t,"dummyTrack",function(){return r})},"./src/demux/exp-golomb.ts":function(e,t,n){"use strict";n.r(t);var r=n("./src/utils/logger.ts"),i=function(){function e(e){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}var t=e.prototype;return t.loadWord=function(){var e=this.data,t=this.bytesAvailable,n=e.byteLength-t,r=new Uint8Array(4),i=Math.min(4,t);if(0===i)throw new Error("no bytes available");r.set(e.subarray(n,n+i)),this.word=new DataView(r.buffer).getUint32(0),this.bitsAvailable=8*i,this.bytesAvailable-=i},t.skipBits=function(e){var t;this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,e-=(t=e>>3)>>3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)},t.readBits=function(e){var t=Math.min(this.bitsAvailable,e),n=this.word>>>32-t;return e>32&&r.logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0?this.word<<=t:this.bytesAvailable>0&&this.loadWord(),(t=e-t)>0&&this.bitsAvailable?n<<t|this.readBits(t):n},t.skipLZ=function(){var e;for(e=0;e<this.bitsAvailable;++e)if(0!=(this.word&2147483648>>>e))return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()},t.skipUEG=function(){this.skipBits(1+this.skipLZ())},t.skipEG=function(){this.skipBits(1+this.skipLZ())},t.readUEG=function(){var e=this.skipLZ();return this.readBits(e+1)-1},t.readEG=function(){var e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)},t.readBoolean=function(){return 1===this.readBits(1)},t.readUByte=function(){return this.readBits(8)},t.readUShort=function(){return this.readBits(16)},t.readUInt=function(){return this.readBits(32)},t.skipScalingList=function(e){for(var t=8,n=8,r=0;r<e;r++)0!==n&&(n=(t+this.readEG()+256)%256),t=0===n?t:n},t.readSPS=function(){var e,t,n,r=0,i=0,o=0,a=0,s=this.readUByte.bind(this),l=this.readBits.bind(this),u=this.readUEG.bind(this),c=this.readBoolean.bind(this),f=this.skipBits.bind(this),d=this.skipEG.bind(this),h=this.skipUEG.bind(this),p=this.skipScalingList.bind(this);s();var g=s();if(l(5),f(3),s(),h(),100===g||110===g||122===g||244===g||44===g||83===g||86===g||118===g||128===g){var v=u();if(3===v&&f(1),h(),h(),f(1),c())for(t=3!==v?8:12,n=0;n<t;n++)c()&&p(n<6?16:64)}h();var y=u();if(0===y)u();else if(1===y)for(f(1),d(),d(),e=u(),n=0;n<e;n++)d();h(),f(1);var m=u(),b=u(),E=l(1);0===E&&f(1),f(1),c()&&(r=u(),i=u(),o=u(),a=u());var T=[1,1];if(c()&&c())switch(s()){case 1:T=[1,1];break;case 2:T=[12,11];break;case 3:T=[10,11];break;case 4:T=[16,11];break;case 5:T=[40,33];break;case 6:T=[24,11];break;case 7:T=[20,11];break;case 8:T=[32,11];break;case 9:T=[80,33];break;case 10:T=[18,11];break;case 11:T=[15,11];break;case 12:T=[64,33];break;case 13:T=[160,99];break;case 14:T=[4,3];break;case 15:T=[3,2];break;case 16:T=[2,1];break;case 255:T=[s()<<8|s(),s()<<8|s()]}return{width:Math.ceil(16*(m+1)-2*r-2*i),height:(2-E)*(b+1)*16-(E?2:4)*(o+a),pixelRatio:T}},t.readSliceType=function(){return this.readUByte(),this.readUEG(),this.readUEG()},e}();t.default=i},"./src/demux/id3.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"isHeader",function(){return s}),n.d(t,"isFooter",function(){return l}),n.d(t,"getID3Data",function(){return i}),n.d(t,"canParse",function(){return o}),n.d(t,"getTimeStamp",function(){return a}),n.d(t,"isTimeStampFrame",function(){return c}),n.d(t,"getID3Frames",function(){return d}),n.d(t,"decodeFrame",function(){return h}),n.d(t,"utf8ArrayToStr",function(){return m}),n.d(t,"testables",function(){return b});var r,s=function(e,t){return t+10<=e.length&&73===e[t]&&68===e[t+1]&&51===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128},l=function(e,t){return t+10<=e.length&&51===e[t]&&68===e[t+1]&&73===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128},i=function(e,t){for(var n=t,r=0;s(e,t);){r+=10,r+=u(e,t+6),l(e,t+10)&&(r+=10),t+=r}if(r>0)return e.subarray(n,n+r)},u=function(e,t){var n=0;return n=(127&e[t])<<21,n|=(127&e[t+1])<<14,n|=(127&e[t+2])<<7,n|=127&e[t+3]},o=function(e,t){return s(e,t)&&u(e,t+6)+10<=e.length-t},a=function(e){for(var t=d(e),n=0;n<t.length;n++){var r=t[n];if(c(r))return y(r)}},c=function(e){return e&&"PRIV"===e.key&&"com.apple.streaming.transportStreamTimestamp"===e.info},f=function(e){var t=String.fromCharCode(e[0],e[1],e[2],e[3]),n=u(e,4);return{type:t,size:n,data:e.subarray(10,10+n)}},d=function(e){for(var t=0,n=[];s(e,t);){for(var r=u(e,t+6),i=(t+=10)+r;t+8<i;){var o=f(e.subarray(t)),a=h(o);a&&n.push(a),t+=o.size+10}l(e,t)&&(t+=10)}return n},h=function(e){return"PRIV"===e.type?p(e):"W"===e.type[0]?v(e):g(e)},p=function(e){if(!(e.size<2)){var t=m(e.data,!0),n=new Uint8Array(e.data.subarray(t.length+1));return{key:e.type,info:t,data:n.buffer}}},g=function(e){if(!(e.size<2)){if("TXXX"===e.type){var t=1,n=m(e.data.subarray(t),!0);t+=n.length+1;var r=m(e.data.subarray(t));return{key:e.type,info:n,data:r}}var i=m(e.data.subarray(1));return{key:e.type,data:i}}},v=function(e){if("WXXX"===e.type){if(e.size<2)return;var t=1,n=m(e.data.subarray(t),!0);t+=n.length+1;var r=m(e.data.subarray(t));return{key:e.type,info:n,data:r}}var i=m(e.data);return{key:e.type,data:i}},y=function(e){if(8===e.data.byteLength){var t=new Uint8Array(e.data),n=1&t[3],r=(t[4]<<23)+(t[5]<<15)+(t[6]<<7)+t[7];return r/=45,n&&(r+=47721858.84),Math.round(r)}},m=function(e,t){void 0===t&&(t=!1);var n=E();if(n){var r=n.decode(e);if(t){var i=r.indexOf("\0");return-1!==i?r.substring(0,i):r}return r.replace(/\0/g,"")}for(var o,a,s,l=e.length,u="",c=0;c<l;){if(0===(o=e[c++])&&t)return u;if(0!==o&&3!==o)switch(o>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:u+=String.fromCharCode(o);break;case 12:case 13:a=e[c++],u+=String.fromCharCode((31&o)<<6|63&a);break;case 14:a=e[c++],s=e[c++],u+=String.fromCharCode((15&o)<<12|(63&a)<<6|(63&s)<<0)}}return u},b={decodeTextFrame:g};function E(){return r||void 0===self.TextDecoder||(r=new self.TextDecoder("utf-8")),r}},"./src/demux/mp3demuxer.ts":function(e,t,n){"use strict";n.r(t);var r=n("./src/demux/base-audio-demuxer.ts"),o=n("./src/demux/id3.ts"),a=n("./src/utils/logger.ts"),s=n("./src/demux/mpegaudio.ts");function l(e,t){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var i=function(i){var e,t;function n(){return i.apply(this,arguments)||this}t=i,(e=n).prototype=Object.create(t.prototype),e.prototype.constructor=e,l(e,t);var r=n.prototype;return r.resetInitSegment=function(e,t,n,r){i.prototype.resetInitSegment.call(this,e,t,n,r),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:t,duration:r,inputTimeScale:9e4,dropped:0}},n.probe=function(e){if(!e)return!1;for(var t=(o.getID3Data(e,0)||[]).length,n=e.length;t<n;t++)if(s.probe(e,t))return a.logger.log("MPEG Audio sync word found !"),!0;return!1},r.canParse=function(e,t){return s.canParse(e,t)},r.appendFrame=function(e,t,n){if(null!==this.basePTS)return s.appendFrame(e,t,n,this.basePTS,this.frameIndex)},n}(r.default);t.default=i},"./src/demux/mp4demuxer.ts":function(e,t,n){"use strict";n.r(t);var a=n("./src/polyfills/number.ts"),s=n("./src/types/demuxer.ts"),v=n("./src/utils/mp4-tools.ts"),y=n("./src/demux/dummy-demuxed-track.ts"),l=/\/emsg[-\/]ID3/i,r=function(){function e(e,t){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=t}var t=e.prototype;return t.resetTimeStamp=function(){},t.resetInitSegment=function(e,t,n,r){var i=Object(v.parseInitSegment)(e),o=this.videoTrack=Object(y.dummyTrack)("video",1),a=this.audioTrack=Object(y.dummyTrack)("audio",1),s=this.txtTrack=Object(y.dummyTrack)("text",1);if(this.id3Track=Object(y.dummyTrack)("id3",1),this.timeOffset=0,i.video){var l=i.video,u=l.id,c=l.timescale,f=l.codec;o.id=u,o.timescale=s.timescale=c,o.codec=f}if(i.audio){var d=i.audio,h=d.id,p=d.timescale,g=d.codec;a.id=h,a.timescale=p,a.codec=g}s.id=v.RemuxerTrackIdConfig.text,o.sampleDuration=0,o.duration=a.duration=r},t.resetContiguity=function(){},e.probe=function(e){return e=e.length>16384?e.subarray(0,16384):e,Object(v.findBox)(e,["moof"]).length>0},t.demux=function(e,t){this.timeOffset=t;var n=e,r=this.videoTrack,i=this.txtTrack;if(this.config.progressive){this.remainderData&&(n=Object(v.appendUint8Array)(this.remainderData,e));var o=Object(v.segmentValidRange)(n);this.remainderData=o.remainder,r.samples=o.valid||new Uint8Array}else r.samples=n;var a=this.extractID3Track(r,t);return i.samples=Object(v.parseSamples)(t,r),{videoTrack:r,audioTrack:this.audioTrack,id3Track:a,textTrack:this.txtTrack}},t.flush=function(){var e=this.timeOffset,t=this.videoTrack,n=this.txtTrack;t.samples=this.remainderData||new Uint8Array,this.remainderData=null;var r=this.extractID3Track(t,this.timeOffset);return n.samples=Object(v.parseSamples)(e,t),{videoTrack:t,audioTrack:Object(y.dummyTrack)(),id3Track:r,textTrack:Object(y.dummyTrack)()}},t.extractID3Track=function(e,i){var o=this.id3Track;if(e.samples.length){var t=Object(v.findBox)(e.samples,["emsg"]);t&&t.forEach(function(e){var t=Object(v.parseEmsg)(e);if(l.test(t.schemeIdUri)){var n=Object(a.isFiniteNumber)(t.presentationTime)?t.presentationTime/t.timeScale:i+t.presentationTimeDelta/t.timeScale,r=t.payload;o.samples.push({data:r,len:r.byteLength,dts:n,pts:n,type:s.MetadataSchema.emsg})}})}return o},t.demuxSampleAes=function(e,t,n){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))},t.destroy=function(){},e}();t.default=r},"./src/demux/mpegaudio.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"appendFrame",function(){return r}),n.d(t,"parseHeader",function(){return l}),n.d(t,"isHeaderPattern",function(){return o}),n.d(t,"isHeader",function(){return a}),n.d(t,"canParse",function(){return i}),n.d(t,"probe",function(){return s});var v=null,y=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],m=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],b=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],E=[0,1,1,4];function r(e,t,n,r,i){if(!(n+24>t.length)){var o=l(t,n);if(o&&n+o.frameLength<=t.length){var a=r+i*(9e4*o.samplesPerFrame/o.sampleRate),s={unit:t.subarray(n,n+o.frameLength),pts:a,dts:a};return e.config=[],e.channelCount=o.channelCount,e.samplerate=o.sampleRate,e.samples.push(s),{sample:s,length:o.frameLength,missing:0}}}}function l(e,t){var n=e[t+1]>>3&3,r=e[t+1]>>1&3,i=e[t+2]>>4&15,o=e[t+2]>>2&3;if(1!==n&&0!==i&&15!==i&&3!==o){var a=e[t+2]>>1&1,s=e[t+3]>>6,l=1e3*y[14*(3===n?3-r:3===r?3:4)+i-1],u=m[3*(3===n?0:2===n?1:2)+o],c=3===s?1:2,f=b[n][r],d=E[r],h=8*f*d,p=Math.floor(f*l/u+a)*d;if(null===v){var g=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);v=g?parseInt(g[1]):0}return!!v&&v<=87&&2===r&&l>=224e3&&0===s&&(e[t+3]=128|e[t+3]),{sampleRate:u,channelCount:c,frameLength:p,samplesPerFrame:h}}}function o(e,t){return 255===e[t]&&224==(224&e[t+1])&&0!=(6&e[t+1])}function a(e,t){return t+1<e.length&&o(e,t)}function i(e,t){return o(e,t)&&4<=e.length-t}function s(e,t){if(t+1<e.length&&o(e,t)){var n=l(e,t),r=4;null!=n&&n.frameLength&&(r=n.frameLength);var i=t+r;return i===e.length||a(e,i)}return!1}},"./src/demux/sample-aes.ts":function(e,t,n){"use strict";n.r(t);var r=n("./src/crypt/decrypter.ts"),u=n("./src/demux/tsdemuxer.ts"),i=function(){function e(e,t,n){this.keyData=void 0,this.decrypter=void 0,this.keyData=n,this.decrypter=new r.default(e,t,{removePKCS7Padding:!1})}var t=e.prototype;return t.decryptBuffer=function(e,t){this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer,t)},t.decryptAacSample=function(n,r,i,o){var a=n[r].unit;if(!(a.length<=16)){var e=a.subarray(16,a.length-a.length%16),t=e.buffer.slice(e.byteOffset,e.byteOffset+e.length),s=this;this.decryptBuffer(t,function(e){var t=new Uint8Array(e);a.set(t,16),o||s.decryptAacSamples(n,r+1,i)})}},t.decryptAacSamples=function(e,t,n){for(;;t++){if(t>=e.length)return void n();if(!(e[t].unit.length<32)){var r=this.decrypter.isSync();if(this.decryptAacSample(e,t,n,r),!r)return}}},t.getAvcEncryptedData=function(e){for(var t=16*Math.floor((e.length-48)/160)+16,n=new Int8Array(t),r=0,i=32;i<e.length-16;i+=160,r+=16)n.set(e.subarray(i,i+16),r);return n},t.getAvcDecryptedUnit=function(e,t){for(var n=new Uint8Array(t),r=0,i=32;i<e.length-16;i+=160,r+=16)e.set(n.subarray(r,r+16),i);return e},t.decryptAvcSample=function(t,n,r,i,o,a){var s=Object(u.discardEPB)(o.data),e=this.getAvcEncryptedData(s),l=this;this.decryptBuffer(e.buffer,function(e){o.data=l.getAvcDecryptedUnit(s,e),a||l.decryptAvcSamples(t,n,r+1,i)})},t.decryptAvcSamples=function(e,t,n,r){if(e instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;t++,n=0){if(t>=e.length)return void r();for(var i=e[t].units;!(n>=i.length);n++){var o=i[n];if(!(o.data.length<=48||1!==o.type&&5!==o.type)){var a=this.decrypter.isSync();if(this.decryptAvcSample(e,t,n,r,o,a),!a)return}}}},e}();t.default=i},"./src/demux/transmuxer-interface.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return i});var c=n("./node_modules/webworkify-webpack/index.js"),f=n("./src/events.ts"),C=n("./src/demux/transmuxer.ts"),L=n("./src/utils/logger.ts"),d=n("./src/errors.ts"),r=n("./src/utils/mediasource-helper.ts"),h=n("./node_modules/eventemitter3/index.js"),p=Object(r.getMediaSource)()||{isTypeSupported:function(){return!1}},i=function(){function e(n,e,t,r){var i=this;this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.worker=void 0,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0,this.hls=n,this.id=e,this.onTransmuxComplete=t,this.onFlush=r;var o=n.config,a=function(e,t){(t=t||{}).frag=i.frag,t.id=i.id,n.trigger(e,t)};this.observer=new h.EventEmitter,this.observer.on(f.Events.FRAG_DECRYPTED,a),this.observer.on(f.Events.ERROR,a);var s={mp4:p.isTypeSupported("video/mp4"),mpeg:p.isTypeSupported("audio/mpeg"),mp3:p.isTypeSupported('audio/mp4; codecs="mp3"')},l=navigator.vendor;if(o.enableWorker&&"undefined"!=typeof Worker){var u;L.logger.log("demuxing in webworker");try{u=this.worker=c("./src/demux/transmuxer-worker.ts"),this.onwmsg=this.onWorkerMessage.bind(this),u.addEventListener("message",this.onwmsg),u.onerror=function(e){n.trigger(f.Events.ERROR,{type:d.ErrorTypes.OTHER_ERROR,details:d.ErrorDetails.INTERNAL_EXCEPTION,fatal:!0,event:"demuxerWorker",error:new Error(e.message+"  ("+e.filename+":"+e.lineno+")")})},u.postMessage({cmd:"init",typeSupported:s,vendor:l,id:e,config:JSON.stringify(o)})}catch(n){L.logger.warn("Error in worker:",n),L.logger.error("Error while initializing DemuxerWorker, fallback to inline"),u&&self.URL.revokeObjectURL(u.objectURL),this.transmuxer=new C.default(this.observer,s,o,l,e),this.worker=null}}else this.transmuxer=new C.default(this.observer,s,o,l,e)}var t=e.prototype;return t.destroy=function(){var e=this.worker;if(e)e.removeEventListener("message",this.onwmsg),e.terminate(),this.worker=null,this.onwmsg=void 0;else{var t=this.transmuxer;t&&(t.destroy(),this.transmuxer=null)}var n=this.observer;n&&n.removeAllListeners(),this.frag=null,this.observer=null,this.hls=null},t.push=function(e,t,n,r,i,o,a,s,l,u){var c,f,d=this;l.transmuxing.start=self.performance.now();var h=this.transmuxer,p=this.worker,g=o?o.start:i.start,v=i.decryptdata,y=this.frag,m=!(y&&i.cc===y.cc),b=!(y&&l.level===y.level),E=y?l.sn-y.sn:-1,T=this.part?l.part-this.part.index:-1,k=0===E&&l.id>1&&l.id===(null==y?void 0:y.stats.chunkCount),w=!b&&(1===E||0===E&&(1===T||k&&T<=0)),_=self.performance.now();(b||E||0===i.stats.parsing.start)&&(i.stats.parsing.start=_),!o||!T&&w||(o.stats.parsing.start=_);var S=!(y&&(null===(c=i.initSegment)||void 0===c?void 0:c.url)===(null===(f=y.initSegment)||void 0===f?void 0:f.url)),A=new C.TransmuxState(m,w,s,b,g,S);if(!w||m||S){L.logger.log("[transmuxer-interface, "+i.type+"]: Starting new transmux session for sn: "+l.sn+" p: "+l.part+" level: "+l.level+" id: "+l.id+"\n        discontinuity: "+m+"\n        trackSwitch: "+b+"\n        contiguous: "+w+"\n        accurateTimeOffset: "+s+"\n        timeOffset: "+g+"\n        initSegmentChange: "+S);var P=new C.TransmuxConfig(n,r,t,a,u);this.configureTransmuxer(P)}if(this.frag=i,this.part=o,p)p.postMessage({cmd:"demux",data:e,decryptdata:v,chunkMeta:l,state:A},e instanceof ArrayBuffer?[e]:[]);else if(h){var O=h.push(e,v,l,A);Object(C.isPromise)(O)?O.then(function(e){d.handleTransmuxComplete(e)}):this.handleTransmuxComplete(O)}},t.flush=function(t){var n=this;t.transmuxing.start=self.performance.now();var e=this.transmuxer,r=this.worker;if(r)r.postMessage({cmd:"flush",chunkMeta:t});else if(e){var i=e.flush(t);Object(C.isPromise)(i)?i.then(function(e){n.handleFlushResult(e,t)}):this.handleFlushResult(i,t)}},t.handleFlushResult=function(e,t){var n=this;e.forEach(function(e){n.handleTransmuxComplete(e)}),this.onFlush(t)},t.onWorkerMessage=function(e){var t=e.data,n=this.hls;switch(t.event){case"init":self.URL.revokeObjectURL(this.worker.objectURL);break;case"transmuxComplete":this.handleTransmuxComplete(t.data);break;case"flush":this.onFlush(t.data);break;case"workerLog":L.logger[t.data.logType]&&L.logger[t.data.logType](t.data.message);break;default:t.data=t.data||{},t.data.frag=this.frag,t.data.id=this.id,n.trigger(t.event,t.data)}},t.configureTransmuxer=function(e){var t=this.worker,n=this.transmuxer;t?t.postMessage({cmd:"configure",config:e}):n&&n.configure(e)},t.handleTransmuxComplete=function(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e)},e}()},"./src/demux/transmuxer-worker.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return o});var u=n("./src/demux/transmuxer.ts"),r=n("./src/events.ts"),c=n("./src/utils/logger.ts"),i=n("./node_modules/eventemitter3/index.js");function o(a){var s=new i.EventEmitter,l=function(e,t){a.postMessage({event:e,data:t})};s.on(r.Events.FRAG_DECRYPTED,l),s.on(r.Events.ERROR,l);a.addEventListener("message",function(e){var t=e.data;switch(t.cmd){case"init":var n=JSON.parse(t.config);a.transmuxer=new u.default(s,t.typeSupported,n,t.vendor,t.id),Object(c.enableLogs)(n.debug),function(){var e=function(t){c.logger[t]=function(e){l("workerLog",{logType:t,message:e})}};for(var t in c.logger)e(t)}(),l("init",null);break;case"configure":a.transmuxer.configure(t.config);break;case"demux":var r=a.transmuxer.push(t.data,t.decryptdata,t.chunkMeta,t.state);Object(u.isPromise)(r)?r.then(function(e){f(a,e)}):f(a,r);break;case"flush":var i=t.chunkMeta,o=a.transmuxer.flush(i);Object(u.isPromise)(o)?o.then(function(e){d(a,e,i)}):d(a,o,i)}})}function f(e,t){if(!((n=t.remuxResult).audio||n.video||n.text||n.id3||n.initSegment))return!1;var n,r=[],i=t.remuxResult,o=i.audio,a=i.video;return o&&s(r,o),a&&s(r,a),e.postMessage({event:"transmuxComplete",data:t},r),!0}function s(e,t){t.data1&&e.push(t.data1.buffer),t.data2&&e.push(t.data2.buffer)}function d(n,e,t){e.reduce(function(e,t){return f(n,t)||e},!1)||n.postMessage({event:"transmuxComplete",data:e[0]}),n.postMessage({event:"flush",data:t})}},"./src/demux/transmuxer.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return l}),n.d(t,"isPromise",function(){return p}),n.d(t,"TransmuxConfig",function(){return u}),n.d(t,"TransmuxState",function(){return c});var P,d=n("./src/events.ts"),h=n("./src/errors.ts"),r=n("./src/crypt/decrypter.ts"),i=n("./src/demux/aacdemuxer.ts"),m=n("./src/demux/mp4demuxer.ts"),o=n("./src/demux/tsdemuxer.ts"),a=n("./src/demux/mp3demuxer.ts"),s=n("./src/remux/mp4-remuxer.ts"),b=n("./src/remux/passthrough-remuxer.ts"),E=n("./src/utils/logger.ts");try{P=self.performance.now.bind(self.performance)}catch(e){E.logger.debug("Unable to use Performance API on this environment"),P=self.Date.now}var T=[{demux:o.default,remux:s.default},{demux:m.default,remux:b.default},{demux:i.default,remux:s.default},{demux:a.default,remux:s.default}],l=function(){function e(e,t,n,r,i){this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=e,this.typeSupported=t,this.config=n,this.vendor=r,this.id=i}var t=e.prototype;return t.configure=function(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()},t.push=function(e,t,n,r){var i=this,o=n.transmuxing;o.executeStart=P();var a=new Uint8Array(e),s=this.config,l=this.currentTransmuxState,u=this.transmuxConfig;r&&(this.currentTransmuxState=r);var c=r||l,f=c.contiguous,d=c.discontinuity,h=c.trackSwitch,p=c.accurateTimeOffset,g=c.timeOffset,v=c.initSegmentChange,y=u.audioCodec,m=u.videoCodec,b=u.defaultInitPts,E=u.duration,T=u.initSegmentData;(d||h||v)&&this.resetInitSegment(T,y,m,E),(d||v)&&this.resetInitialTimestamp(b),f||this.resetContiguity();var k=function(e,t){var n=null;e.byteLength>0&&null!=t&&null!=t.key&&null!==t.iv&&null!=t.method&&(n=t);return n}(a,t);if(k&&"AES-128"===k.method){var w=this.getDecrypter();if(!s.enableSoftwareAES)return this.decryptionPromise=w.webCryptoDecrypt(a,k.key.buffer,k.iv.buffer).then(function(e){var t=i.push(e,null,n);return i.decryptionPromise=null,t}),this.decryptionPromise;var _=w.softwareDecrypt(a,k.key.buffer,k.iv.buffer);if(!_)return o.executeEnd=P(),O(n);a=new Uint8Array(_)}this.needsProbing(a,d,h)&&this.configureTransmuxer(a,u);var S=this.transmux(a,k,g,p,n),A=this.currentTransmuxState;return A.contiguous=!0,A.discontinuity=!1,A.trackSwitch=!1,o.executeEnd=P(),S},t.flush=function(t){var n=this,e=t.transmuxing;e.executeStart=P();var r=this.decrypter,i=this.currentTransmuxState,o=this.decryptionPromise;if(o)return o.then(function(){return n.flush(t)});var a=[],s=i.timeOffset;if(r){var l=r.flush();l&&a.push(this.push(l,null,t))}var u=this.demuxer,c=this.remuxer;if(!u||!c)return this.observer.emit(d.Events.ERROR,d.Events.ERROR,{type:h.ErrorTypes.MEDIA_ERROR,details:h.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"}),e.executeEnd=P(),[O(t)];var f=u.flush(s);return p(f)?f.then(function(e){return n.flushRemux(a,e,t),a}):(this.flushRemux(a,f,t),a)},t.flushRemux=function(e,t,n){var r=t.audioTrack,i=t.videoTrack,o=t.id3Track,a=t.textTrack,s=this.currentTransmuxState,l=s.accurateTimeOffset,u=s.timeOffset;E.logger.log("[transmuxer.ts]: Flushed fragment "+n.sn+(n.part>-1?" p: "+n.part:"")+" of level "+n.level);var c=this.remuxer.remux(r,i,o,a,u,l,!0,this.id);e.push({remuxResult:c,chunkMeta:n}),n.transmuxing.executeEnd=P()},t.resetInitialTimestamp=function(e){var t=this.demuxer,n=this.remuxer;t&&n&&(t.resetTimeStamp(e),n.resetTimeStamp(e))},t.resetContiguity=function(){var e=this.demuxer,t=this.remuxer;e&&t&&(e.resetContiguity(),t.resetNextTimestamp())},t.resetInitSegment=function(e,t,n,r){var i=this.demuxer,o=this.remuxer;i&&o&&(i.resetInitSegment(e,t,n,r),o.resetInitSegment(e,t,n))},t.destroy=function(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)},t.transmux=function(e,t,n,r,i){return t&&"SAMPLE-AES"===t.method?this.transmuxSampleAes(e,t,n,r,i):this.transmuxUnencrypted(e,n,r,i)},t.transmuxUnencrypted=function(e,t,n,r){var i=this.demuxer.demux(e,t,!1,!this.config.progressive),o=i.audioTrack,a=i.videoTrack,s=i.id3Track,l=i.textTrack;return{remuxResult:this.remuxer.remux(o,a,s,l,t,n,!1,this.id),chunkMeta:r}},t.transmuxSampleAes=function(e,t,n,r,i){var o=this;return this.demuxer.demuxSampleAes(e,t,n).then(function(e){return{remuxResult:o.remuxer.remux(e.audioTrack,e.videoTrack,e.id3Track,e.textTrack,n,r,!1,o.id),chunkMeta:i}})},t.configureTransmuxer=function(e,t){for(var n,r=this.config,i=this.observer,o=this.typeSupported,a=this.vendor,s=t.audioCodec,l=t.defaultInitPts,u=t.duration,c=t.initSegmentData,f=t.videoCodec,d=0,h=T.length;d<h;d++)if(T[d].demux.probe(e)){n=T[d];break}n||(E.logger.warn("Failed to find demuxer by probing frag, treating as mp4 passthrough"),n={demux:m.default,remux:b.default});var p=this.demuxer,g=this.remuxer,v=n.remux,y=n.demux;g&&g instanceof v||(this.remuxer=new v(i,r,o,a)),p&&p instanceof y||(this.demuxer=new y(i,r,o),this.probe=y.probe),this.resetInitSegment(c,s,f,u),this.resetInitialTimestamp(l)},t.needsProbing=function(e,t,n){return!this.demuxer||!this.remuxer||t||n},t.getDecrypter=function(){var e=this.decrypter;return e||(e=this.decrypter=new r.default(this.observer,this.config)),e},e}();var O=function(e){return{remuxResult:{},chunkMeta:e}};function p(e){return"then"in e&&e.then instanceof Function}var u=function(e,t,n,r,i){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=e,this.videoCodec=t,this.initSegmentData=n,this.duration=r,this.defaultInitPts=i},c=function(e,t,n,r,i,o){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=e,this.contiguous=t,this.accurateTimeOffset=n,this.trackSwitch=r,this.timeOffset=i,this.initSegmentChange=o}},"./src/demux/tsdemuxer.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"discardEPB",function(){return b});var y=n("./src/demux/adts.ts"),l=n("./src/demux/mpegaudio.ts"),g=n("./src/demux/exp-golomb.ts"),o=n("./src/demux/sample-aes.ts"),A=n("./src/events.ts"),P=n("./src/utils/mp4-tools.ts"),O=n("./src/utils/logger.ts"),C=n("./src/errors.ts"),r=n("./src/types/demuxer.ts");function a(){return(a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var i=function(){function i(e,t,n){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this._pmtId=-1,this._avcTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.observer=e,this.config=t,this.typeSupported=n}i.probe=function(e){return 71===e[0]&&71===e[188]},i.createTrack=function(e,t){return{container:"video"===e||"audio"===e?"video/mp2t":void 0,type:e,id:P.RemuxerTrackIdConfig[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:"audio"===e?t:void 0}};var e=i.prototype;return e.resetInitSegment=function(e,t,n,r){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack=i.createTrack("video"),this._audioTrack=i.createTrack("audio",r),this._id3Track=i.createTrack("id3"),this._txtTrack=i.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.audioCodec=t,this.videoCodec=n,this._duration=r},e.resetTimeStamp=function(){},e.resetContiguity=function(){var e=this._audioTrack,t=this._avcTrack,n=this._id3Track;e&&(e.pesData=null),t&&(t.pesData=null),n&&(n.pesData=null),this.aacOverFlow=null},e.demux=function(e,t,n,r){var i;void 0===n&&(n=!1),void 0===r&&(r=!1),n||(this.sampleAes=null);var o=this._avcTrack,a=this._audioTrack,s=this._id3Track,l=this._txtTrack,u=o.pid,c=o.pesData,f=a.pid,d=s.pid,h=a.pesData,p=s.pesData,g=null,v=this.pmtParsed,y=this._pmtId,m=e.length;if(this.remainderData&&(m=(e=Object(P.appendUint8Array)(this.remainderData,e)).length,this.remainderData=null),m<188&&!r)return this.remainderData=e,{audioTrack:a,videoTrack:o,id3Track:s,textTrack:l};(m-=m%188)<e.byteLength&&!r&&(this.remainderData=new Uint8Array(e.buffer,m,e.buffer.byteLength-m));for(var b=0,E=0;E<m;E+=188)if(71===e[E]){var T=!!(64&e[E+1]),k=((31&e[E+1])<<8)+e[E+2],w=void 0;if((48&e[E+3])>>4>1){if((w=E+5+e[E+4])===E+188)continue}else w=E+4;switch(k){case u:T&&(c&&(i=x(c))&&this.parseAVCPES(o,l,i,!1),c={data:[],size:0}),c&&(c.data.push(e.subarray(w,E+188)),c.size+=E+188-w);break;case f:if(T){if(h&&(i=x(h)))switch(a.segmentCodec){case"aac":this.parseAACPES(a,i);break;case"mp3":this.parseMPEGPES(a,i)}h={data:[],size:0}}h&&(h.data.push(e.subarray(w,E+188)),h.size+=E+188-w);break;case d:T&&(p&&(i=x(p))&&this.parseID3PES(s,i),p={data:[],size:0}),p&&(p.data.push(e.subarray(w,E+188)),p.size+=E+188-w);break;case 0:T&&(w+=e[w]+1),y=this._pmtId=L(e,w);break;case y:T&&(w+=e[w]+1);var _=D(e,w,this.typeSupported,n);(u=_.avc)>0&&(o.pid=u),(f=_.audio)>0&&(a.pid=f,a.segmentCodec=_.segmentCodec),(d=_.id3)>0&&(s.pid=d),null===g||v||(O.logger.log("unknown PID '"+g+"' in TS found"),g=null),v=this.pmtParsed=!0;break;case 17:case 8191:break;default:g=k}}else b++;b>0&&this.observer.emit(A.Events.ERROR,A.Events.ERROR,{type:C.ErrorTypes.MEDIA_ERROR,details:C.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"Found "+b+" TS packet/s that do not start with 0x47"}),o.pesData=c,a.pesData=h,s.pesData=p;var S={audioTrack:a,videoTrack:o,id3Track:s,textTrack:l};return r&&this.extractRemainingSamples(S),S},e.flush=function(){var e,t=this.remainderData;return this.remainderData=null,e=t?this.demux(t,-1,!1,!0):{videoTrack:this._avcTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(e),this.sampleAes?this.decrypt(e,this.sampleAes):e},e.extractRemainingSamples=function(e){var t,n=e.audioTrack,r=e.videoTrack,i=e.id3Track,o=e.textTrack,a=r.pesData,s=n.pesData,l=i.pesData;if(a&&(t=x(a))?(this.parseAVCPES(r,o,t,!0),r.pesData=null):r.pesData=a,s&&(t=x(s))){switch(n.segmentCodec){case"aac":this.parseAACPES(n,t);break;case"mp3":this.parseMPEGPES(n,t)}n.pesData=null}else null!=s&&s.size&&O.logger.log("last AAC PES packet truncated,might overlap between fragments"),n.pesData=s;l&&(t=x(l))?(this.parseID3PES(i,t),i.pesData=null):i.pesData=l},e.demuxSampleAes=function(e,t,n){var r=this.demux(e,n,!0,!this.config.progressive),i=this.sampleAes=new o.default(this.observer,this.config,t);return this.decrypt(r,i)},e.decrypt=function(r,i){return new Promise(function(e){var t=r.audioTrack,n=r.videoTrack;t.samples&&"aac"===t.segmentCodec?i.decryptAacSamples(t.samples,0,function(){n.samples?i.decryptAvcSamples(n.samples,0,0,function(){e(r)}):e(r)}):n.samples&&i.decryptAvcSamples(n.samples,0,0,function(){e(r)})})},e.destroy=function(){this._duration=0},e.parseAVCPES=function(l,u,c,e){var f,d=this,t=this.parseAVCNALu(l,c.data),h=this.avcSample,p=!1;c.data=null,h&&t.length&&!l.audFound&&(m(h,l),h=this.avcSample=v(!1,c.pts,c.dts,"")),t.forEach(function(e){switch(e.type){case 1:f=!0,h||(h=d.avcSample=v(!0,c.pts,c.dts,"")),h.frame=!0;var t=e.data;if(p&&t.length>4){var n=new g.default(t).readSliceType();2!==n&&4!==n&&7!==n&&9!==n||(h.key=!0)}break;case 5:f=!0,h||(h=d.avcSample=v(!0,c.pts,c.dts,"")),h.key=!0,h.frame=!0;break;case 6:f=!0,Object(P.parseSEIMessageFromNALu)(b(e.data),c.pts,u.samples);break;case 7:if(f=!0,p=!0,!l.sps){var r=new g.default(e.data).readSPS();l.width=r.width,l.height=r.height,l.pixelRatio=r.pixelRatio,l.sps=[e.data],l.duration=d._duration;for(var i=e.data.subarray(1,4),o="avc1.",a=0;a<3;a++){var s=i[a].toString(16);s.length<2&&(s="0"+s),o+=s}l.codec=o}break;case 8:f=!0,l.pps||(l.pps=[e.data]);break;case 9:f=!1,l.audFound=!0,h&&m(h,l),h=d.avcSample=v(!1,c.pts,c.dts,"");break;case 12:f=!0;break;default:f=!1,h&&(h.debug+="unknown NAL "+e.type+" ")}h&&f&&h.units.push(e)}),e&&h&&(m(h,l),this.avcSample=null)},e.getLastNalUnit=function(e){var t,n,r=this.avcSample;if(r&&0!==r.units.length||(r=e[e.length-1]),null!==(t=r)&&void 0!==t&&t.units){var i=r.units;n=i[i.length-1]}return n},e.parseAVCNALu=function(e,t){var n,r,i=t.byteLength,o=e.naluState||0,a=o,s=[],l=0,u=-1,c=0;for(-1===o&&(u=0,c=31&t[0],o=0,l=1);l<i;)if(n=t[l++],o)if(1!==o)if(n)if(1===n){if(u>=0){var f={data:t.subarray(u,l-o-1),type:c};s.push(f)}else{var d=this.getLastNalUnit(e.samples);if(d&&(a&&l<=4-a&&d.state&&(d.data=d.data.subarray(0,d.data.byteLength-a)),(r=l-o-1)>0)){var h=new Uint8Array(d.data.byteLength+r);h.set(d.data,0),h.set(t.subarray(0,r),d.data.byteLength),d.data=h,d.state=0}}l<i?(u=l,c=31&t[l],o=0):o=-1}else o=0;else o=3;else o=n?0:2;else o=n?0:1;if(u>=0&&o>=0){var p={data:t.subarray(u,i),type:c,state:o};s.push(p)}if(0===s.length){var g=this.getLastNalUnit(e.samples);if(g){var v=new Uint8Array(g.data.byteLength+t.byteLength);v.set(g.data,0),v.set(t,g.data.byteLength),g.data=v}}return e.naluState=o,s},e.parseAACPES=function(e,t){var n,r,i,o,a,s=0,l=this.aacOverFlow,u=t.data;if(l){this.aacOverFlow=null;var c=l.missing,f=l.sample.unit.byteLength;if(-1===c){var d=new Uint8Array(f+u.byteLength);d.set(l.sample.unit,0),d.set(u,f),u=d}else{var h=f-c;l.sample.unit.set(u.subarray(0,c),h),e.samples.push(l.sample),s=l.missing}}for(n=s,r=u.length;n<r-1&&!y.isHeader(u,n);n++);if(n!==s&&(n<r-1?(i="AAC PES did not start with ADTS header,offset:"+n,o=!1):(i="no ADTS header found in AAC PES",o=!0),O.logger.warn("parsing error:"+i),this.observer.emit(A.Events.ERROR,A.Events.ERROR,{type:C.ErrorTypes.MEDIA_ERROR,details:C.ErrorDetails.FRAG_PARSING_ERROR,fatal:o,reason:i}),o))return;if(y.initTrackConfig(e,this.observer,u,n,this.audioCodec),void 0!==t.pts)a=t.pts;else{if(!l)return void O.logger.warn("[tsdemuxer]: AAC PES unknown PTS");var p=y.getFrameDuration(e.samplerate);a=l.sample.pts+p}for(var g,v=0;n<r;){if(n+=(g=y.appendFrame(e,u,n,a,v)).length,g.missing){this.aacOverFlow=g;break}for(v++;n<r-1&&!y.isHeader(u,n);n++);}},e.parseMPEGPES=function(e,t){var n=t.data,r=n.length,i=0,o=0,a=t.pts;if(void 0!==a)for(;o<r;)if(l.isHeader(n,o)){var s=l.appendFrame(e,n,o,a,i);if(!s)break;o+=s.length,i++}else o++;else O.logger.warn("[tsdemuxer]: MPEG PES unknown PTS")},e.parseID3PES=function(e,t){if(void 0!==t.pts){var n=a({},t,{type:this._avcTrack?r.MetadataSchema.emsg:r.MetadataSchema.audioId3});e.samples.push(n)}else O.logger.warn("[tsdemuxer]: ID3 PES unknown PTS")},i}();function v(e,t,n,r){return{key:e,frame:!1,pts:t,dts:n,units:[],debug:r,length:0}}function L(e,t){return(31&e[t+10])<<8|e[t+11]}function D(e,t,n,r){var i={audio:-1,avc:-1,id3:-1,segmentCodec:"aac"},o=t+3+((15&e[t+1])<<8|e[t+2])-4;for(t+=12+((15&e[t+10])<<8|e[t+11]);t<o;){var a=(31&e[t+1])<<8|e[t+2];switch(e[t]){case 207:if(!r){O.logger.log("ADTS AAC with AES-128-CBC frame encryption found in unencrypted stream");break}case 15:-1===i.audio&&(i.audio=a);break;case 21:-1===i.id3&&(i.id3=a);break;case 219:if(!r){O.logger.log("H.264 with AES-128-CBC slice encryption found in unencrypted stream");break}case 27:-1===i.avc&&(i.avc=a);break;case 3:case 4:!0!==n.mpeg&&!0!==n.mp3?O.logger.log("MPEG audio found, not supported in this browser"):-1===i.audio&&(i.audio=a,i.segmentCodec="mp3");break;case 36:O.logger.warn("Unsupported HEVC stream type found")}t+=5+((15&e[t+3])<<8|e[t+4])}return i}function x(e){var t,n,r,i,o,a=0,s=e.data;if(!e||0===e.size)return null;for(;s[0].length<19&&s.length>1;){var l=new Uint8Array(s[0].length+s[1].length);l.set(s[0]),l.set(s[1],s[0].length),s[0]=l,s.splice(1,1)}if(1===((t=s[0])[0]<<16)+(t[1]<<8)+t[2]){if((n=(t[4]<<8)+t[5])&&n>e.size-6)return null;var u=t[7];192&u&&(i=536870912*(14&t[9])+4194304*(255&t[10])+16384*(254&t[11])+128*(255&t[12])+(254&t[13])/2,64&u?i-(o=536870912*(14&t[14])+4194304*(255&t[15])+16384*(254&t[16])+128*(255&t[17])+(254&t[18])/2)>54e5&&(O.logger.warn(Math.round((i-o)/9e4)+"s delta between PTS and DTS, align them"),i=o):o=i);var c=(r=t[8])+9;if(e.size<=c)return null;e.size-=c;for(var f=new Uint8Array(e.size),d=0,h=s.length;d<h;d++){var p=(t=s[d]).byteLength;if(c){if(c>p){c-=p;continue}t=t.subarray(c),p-=c,c=0}f.set(t,a),a+=p}return n&&(n-=r+3),{data:f,pts:i,dts:o,len:n}}return null}function m(e,t){if(e.units.length&&e.frame){if(void 0===e.pts){var n=t.samples,r=n.length;if(!r)return void t.dropped++;var i=n[r-1];e.pts=i.pts,e.dts=i.dts}t.samples.push(e)}e.debug.length&&O.logger.log(e.pts+"/"+e.dts+":"+e.debug)}function b(e){for(var t=e.byteLength,n=[],r=1;r<t-2;)0===e[r]&&0===e[r+1]&&3===e[r+2]?(n.push(r+2),r+=2):r++;if(0===n.length)return e;var i=t-n.length,o=new Uint8Array(i),a=0;for(r=0;r<i;a++,r++)a===n[0]&&(a++,n.shift()),o[r]=e[a];return o}t.default=i},"./src/errors.ts":function(e,t,n){"use strict";var r,i;n.r(t),n.d(t,"ErrorTypes",function(){return r}),n.d(t,"ErrorDetails",function(){return i}),function(e){e.NETWORK_ERROR="networkError",e.MEDIA_ERROR="mediaError",e.KEY_SYSTEM_ERROR="keySystemError",e.MUX_ERROR="muxError",e.OTHER_ERROR="otherError"}(r||(r={})),function(e){e.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",e.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",e.KEY_SYSTEM_NO_SESSION="keySystemNoSession",e.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",e.KEY_SYSTEM_NO_INIT_DATA="keySystemNoInitData",e.MANIFEST_LOAD_ERROR="manifestLoadError",e.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",e.MANIFEST_PARSING_ERROR="manifestParsingError",e.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",e.LEVEL_EMPTY_ERROR="levelEmptyError",e.LEVEL_LOAD_ERROR="levelLoadError",e.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",e.LEVEL_SWITCH_ERROR="levelSwitchError",e.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",e.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",e.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",e.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",e.FRAG_LOAD_ERROR="fragLoadError",e.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",e.FRAG_DECRYPT_ERROR="fragDecryptError",e.FRAG_PARSING_ERROR="fragParsingError",e.REMUX_ALLOC_ERROR="remuxAllocError",e.KEY_LOAD_ERROR="keyLoadError",e.KEY_LOAD_TIMEOUT="keyLoadTimeOut",e.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",e.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",e.BUFFER_APPEND_ERROR="bufferAppendError",e.BUFFER_APPENDING_ERROR="bufferAppendingError",e.BUFFER_STALLED_ERROR="bufferStalledError",e.BUFFER_FULL_ERROR="bufferFullError",e.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",e.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",e.INTERNAL_EXCEPTION="internalException",e.INTERNAL_ABORTED="aborted",e.UNKNOWN="unknown"}(i||(i={}))},"./src/events.ts":function(e,t,n){"use strict";var r;n.r(t),n.d(t,"Events",function(){return r}),function(e){e.MEDIA_ATTACHING="hlsMediaAttaching",e.MEDIA_ATTACHED="hlsMediaAttached",e.MEDIA_DETACHING="hlsMediaDetaching",e.MEDIA_DETACHED="hlsMediaDetached",e.BUFFER_RESET="hlsBufferReset",e.BUFFER_CODECS="hlsBufferCodecs",e.BUFFER_CREATED="hlsBufferCreated",e.BUFFER_APPENDING="hlsBufferAppending",e.BUFFER_APPENDED="hlsBufferAppended",e.BUFFER_EOS="hlsBufferEos",e.BUFFER_FLUSHING="hlsBufferFlushing",e.BUFFER_FLUSHED="hlsBufferFlushed",e.MANIFEST_LOADING="hlsManifestLoading",e.MANIFEST_LOADED="hlsManifestLoaded",e.MANIFEST_PARSED="hlsManifestParsed",e.LEVEL_SWITCHING="hlsLevelSwitching",e.LEVEL_SWITCHED="hlsLevelSwitched",e.LEVEL_LOADING="hlsLevelLoading",e.LEVEL_LOADED="hlsLevelLoaded",e.LEVEL_UPDATED="hlsLevelUpdated",e.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",e.LEVELS_UPDATED="hlsLevelsUpdated",e.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",e.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",e.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",e.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",e.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",e.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",e.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",e.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",e.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",e.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",e.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",e.CUES_PARSED="hlsCuesParsed",e.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",e.INIT_PTS_FOUND="hlsInitPtsFound",e.FRAG_LOADING="hlsFragLoading",e.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",e.FRAG_LOADED="hlsFragLoaded",e.FRAG_DECRYPTED="hlsFragDecrypted",e.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",e.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",e.FRAG_PARSING_METADATA="hlsFragParsingMetadata",e.FRAG_PARSED="hlsFragParsed",e.FRAG_BUFFERED="hlsFragBuffered",e.FRAG_CHANGED="hlsFragChanged",e.FPS_DROP="hlsFpsDrop",e.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",e.ERROR="hlsError",e.DESTROYING="hlsDestroying",e.KEY_LOADING="hlsKeyLoading",e.KEY_LOADED="hlsKeyLoaded",e.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",e.BACK_BUFFER_REACHED="hlsBackBufferReached"}(r||(r={}))},"./src/hls.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return r});var i=n("./node_modules/url-toolkit/src/url-toolkit.js"),b=n("./src/loader/playlist-loader.ts"),E=n("./src/loader/key-loader.ts"),T=n("./src/controller/id3-track-controller.ts"),k=n("./src/controller/latency-controller.ts"),w=n("./src/controller/level-controller.ts"),_=n("./src/controller/fragment-tracker.ts"),S=n("./src/controller/stream-controller.ts"),o=n("./src/is-supported.ts"),A=n("./src/utils/logger.ts"),P=n("./src/config.ts"),O=n("./node_modules/eventemitter3/index.js"),a=n("./src/events.ts"),s=n("./src/errors.ts");function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var r=function(){function m(e){void 0===e&&(e={}),this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new O.EventEmitter,this._autoLevelCapping=void 0,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this.url=null;var t=this.config=Object(P.mergeConfig)(m.DefaultConfig,e);this.userConfig=e,Object(A.enableLogs)(t.debug),this._autoLevelCapping=-1,t.progressive&&Object(P.enableStreamingMode)(t);var n=t.abrController,r=t.bufferController,i=t.capLevelController,o=t.fpsController,a=this.abrController=new n(this),s=this.bufferController=new r(this),l=this.capLevelController=new i(this),u=new o(this),c=new b.default(this),f=new E.default(this),d=new T.default(this),h=this.levelController=new w.default(this),p=new _.FragmentTracker(this),g=this.streamController=new S.default(this,p);l.setStreamController(g),u.setStreamController(g);var v=[c,f,h,g];this.networkControllers=v;var y=[a,s,l,u,d,p];this.audioTrackController=this.createController(t.audioTrackController,null,v),this.createController(t.audioStreamController,p,v),this.subtitleTrackController=this.createController(t.subtitleTrackController,null,v),this.createController(t.subtitleStreamController,p,v),this.createController(t.timelineController,null,y),this.emeController=this.createController(t.emeController,null,y),this.cmcdController=this.createController(t.cmcdController,null,y),this.latencyController=this.createController(k.default,null,y),this.coreComponents=y}m.isSupported=function(){return Object(o.isSupported)()};var e,t,n,r=m.prototype;return r.createController=function(e,t,n){if(e){var r=t?new e(this,t):new e(this);return n&&n.push(r),r}return null},r.on=function(e,t,n){void 0===n&&(n=this),this._emitter.on(e,t,n)},r.once=function(e,t,n){void 0===n&&(n=this),this._emitter.once(e,t,n)},r.removeAllListeners=function(e){this._emitter.removeAllListeners(e)},r.off=function(e,t,n,r){void 0===n&&(n=this),this._emitter.off(e,t,n,r)},r.listeners=function(e){return this._emitter.listeners(e)},r.emit=function(e,t,n){return this._emitter.emit(e,t,n)},r.trigger=function(e,t){if(this.config.debug)return this.emit(e,e,t);try{return this.emit(e,e,t)}catch(t){A.logger.error("An internal error happened while handling event "+e+'. Error message: "'+t.message+'". Here is a stacktrace:',t),this.trigger(a.Events.ERROR,{type:s.ErrorTypes.OTHER_ERROR,details:s.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:e,error:t})}return!1},r.listenerCount=function(e){return this._emitter.listenerCount(e)},r.destroy=function(){A.logger.log("destroy"),this.trigger(a.Events.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach(function(e){return e.destroy()}),this.networkControllers.length=0,this.coreComponents.forEach(function(e){return e.destroy()}),this.coreComponents.length=0},r.attachMedia=function(e){A.logger.log("attachMedia"),this._media=e,this.trigger(a.Events.MEDIA_ATTACHING,{media:e})},r.detachMedia=function(){A.logger.log("detachMedia"),this.trigger(a.Events.MEDIA_DETACHING,void 0),this._media=null},r.loadSource=function(e){this.stopLoad();var t=this.media,n=this.url,r=this.url=i.buildAbsoluteURL(self.location.href,e,{alwaysNormalize:!0});A.logger.log("loadSource:"+r),t&&n&&n!==r&&this.bufferController.hasSourceTypes()&&(this.detachMedia(),this.attachMedia(t)),this.trigger(a.Events.MANIFEST_LOADING,{url:e})},r.startLoad=function(t){void 0===t&&(t=-1),A.logger.log("startLoad("+t+")"),this.networkControllers.forEach(function(e){e.startLoad(t)})},r.stopLoad=function(){A.logger.log("stopLoad"),this.networkControllers.forEach(function(e){e.stopLoad()})},r.swapAudioCodec=function(){A.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()},r.recoverMediaError=function(){A.logger.log("recoverMediaError");var e=this._media;this.detachMedia(),e&&this.attachMedia(e)},r.removeLevel=function(e,t){void 0===t&&(t=0),this.levelController.removeLevel(e,t)},e=m,n=[{key:"version",get:function(){return"1.2.4"}},{key:"Events",get:function(){return a.Events}},{key:"ErrorTypes",get:function(){return s.ErrorTypes}},{key:"ErrorDetails",get:function(){return s.ErrorDetails}},{key:"DefaultConfig",get:function(){return m.defaultConfig?m.defaultConfig:P.hlsDefaultConfig},set:function(e){m.defaultConfig=e}}],(t=[{key:"levels",get:function(){var e=this.levelController.levels;return e||[]}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(e){A.logger.log("set currentLevel:"+e),this.loadLevel=e,this.abrController.clearTimer(),this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(e){A.logger.log("set nextLevel:"+e),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(e){A.logger.log("set loadLevel:"+e),this.levelController.manualLevel=e}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(e){this.levelController.nextLoadLevel=e}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(e){A.logger.log("set firstLevel:"+e),this.levelController.firstLevel=e}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(e){A.logger.log("set startLevel:"+e),-1!==e&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}},{key:"capLevelToPlayerSize",get:function(){return this.config.capLevelToPlayerSize},set:function(e){var t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(e){this._autoLevelCapping!==e&&(A.logger.log("set autoLevelCapping:"+e),this._autoLevelCapping=e)}},{key:"bandwidthEstimate",get:function(){var e=this.abrController.bwEstimator;return e?e.getEstimate():NaN}},{key:"autoLevelEnabled",get:function(){return-1===this.levelController.manualLevel}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){var e=this.levels,t=this.config.minAutoBitrate;if(!e)return 0;for(var n=e.length,r=0;r<n;r++)if(e[r].maxBitrate>=t)return r;return 0}},{key:"maxAutoLevel",get:function(){var e=this.levels,t=this.autoLevelCapping;return-1===t&&e&&e.length?e.length-1:t}},{key:"nextAutoLevel",get:function(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)},set:function(e){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,e)}},{key:"playingDate",get:function(){return this.streamController.currentProgramDateTime}},{key:"mainForwardBufferInfo",get:function(){return this.streamController.getMainFwdBufferInfo()}},{key:"audioTracks",get:function(){var e=this.audioTrackController;return e?e.audioTracks:[]}},{key:"audioTrack",get:function(){var e=this.audioTrackController;return e?e.audioTrack:-1},set:function(e){var t=this.audioTrackController;t&&(t.audioTrack=e)}},{key:"subtitleTracks",get:function(){var e=this.subtitleTrackController;return e?e.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var e=this.subtitleTrackController;return e?e.subtitleTrack:-1},set:function(e){var t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}},{key:"media",get:function(){return this._media}},{key:"subtitleDisplay",get:function(){var e=this.subtitleTrackController;return!!e&&e.subtitleDisplay},set:function(e){var t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}},{key:"lowLatencyMode",get:function(){return this.config.lowLatencyMode},set:function(e){this.config.lowLatencyMode=e}},{key:"liveSyncPosition",get:function(){return this.latencyController.liveSyncPosition}},{key:"latency",get:function(){return this.latencyController.latency}},{key:"maxLatency",get:function(){return this.latencyController.maxLatency}},{key:"targetLatency",get:function(){return this.latencyController.targetLatency}},{key:"drift",get:function(){return this.latencyController.drift}},{key:"forceStartLoad",get:function(){return this.streamController.forceStartLoad}}])&&l(e.prototype,t),n&&l(e,n),Object.defineProperty(e,"prototype",{writable:!1}),m}();r.defaultConfig=void 0},"./src/is-supported.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"isSupported",function(){return r}),n.d(t,"changeTypeSupported",function(){return a});var i=n("./src/utils/mediasource-helper.ts");function o(){return self.SourceBuffer||self.WebKitSourceBuffer}function r(){var e=Object(i.getMediaSource)();if(!e)return!1;var t=o(),n=e&&"function"==typeof e.isTypeSupported&&e.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),r=!t||t.prototype&&"function"==typeof t.prototype.appendBuffer&&"function"==typeof t.prototype.remove;return!!n&&!!r}function a(){var e,t=o();return"function"==typeof(null==t?void 0:null===(e=t.prototype)||void 0===e?void 0:e.changeType)}},"./src/loader/date-range.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"DateRangeAttribute",function(){return o}),n.d(t,"DateRange",function(){return r});var o,a=n("./src/polyfills/number.ts"),s=n("./src/utils/attr-list.ts"),l=n("./src/utils/logger.ts");function u(){return(u=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}!function(e){e.ID="ID",e.CLASS="CLASS",e.START_DATE="START-DATE",e.DURATION="DURATION",e.END_DATE="END-DATE",e.END_ON_NEXT="END-ON-NEXT",e.PLANNED_DURATION="PLANNED-DURATION",e.SCTE35_OUT="SCTE35-OUT",e.SCTE35_IN="SCTE35-IN"}(o||(o={}));var r=function(){function e(e,t){if(this.attr=void 0,this._startDate=void 0,this._endDate=void 0,this._badValueForSameId=void 0,t){var n=t.attr;for(var r in n)if(Object.prototype.hasOwnProperty.call(e,r)&&e[r]!==n[r]){l.logger.warn('DATERANGE tag attribute: "'+r+'" does not match for tags with ID: "'+e.ID+'"'),this._badValueForSameId=r;break}e=u(new s.AttrList({}),n,e)}if(this.attr=e,this._startDate=new Date(e[o.START_DATE]),o.END_DATE in this.attr){var i=new Date(this.attr[o.END_DATE]);Object(a.isFiniteNumber)(i.getTime())&&(this._endDate=i)}}var t,n,r;return t=e,(n=[{key:"id",get:function(){return this.attr.ID}},{key:"class",get:function(){return this.attr.CLASS}},{key:"startDate",get:function(){return this._startDate}},{key:"endDate",get:function(){if(this._endDate)return this._endDate;var e=this.duration;return null!==e?new Date(this._startDate.getTime()+1e3*e):null}},{key:"duration",get:function(){if(o.DURATION in this.attr){var e=this.attr.decimalFloatingPoint(o.DURATION);if(Object(a.isFiniteNumber)(e))return e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}},{key:"plannedDuration",get:function(){return o.PLANNED_DURATION in this.attr?this.attr.decimalFloatingPoint(o.PLANNED_DURATION):null}},{key:"endOnNext",get:function(){return this.attr.bool(o.END_ON_NEXT)}},{key:"isValid",get:function(){return!!this.id&&!this._badValueForSameId&&Object(a.isFiniteNumber)(this.startDate.getTime())&&(null===this.duration||this.duration>=0)&&(!this.endOnNext||!!this.class)}}])&&i(t.prototype,n),r&&i(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}()},"./src/loader/fragment-loader.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return r}),n.d(t,"LoadError",function(){return g});var a=n("./src/polyfills/number.ts"),d=n("./src/errors.ts");function i(e){var r="function"==typeof Map?new Map:void 0;return(i=function(e){if(null===e||(t=e,-1===Function.toString.call(t).indexOf("[native code]")))return e;var t;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==r){if(r.has(e))return r.get(e);r.set(e,n)}function n(){return o(e,arguments,l(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),s(n,e)})(e)}function o(e,t,n){return(o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&s(i,n.prototype),i}).apply(null,arguments)}function s(e,t){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var h=Math.pow(2,17),r=function(){function e(e){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=e}var t=e.prototype;return t.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)},t.abort=function(){this.loader&&this.loader.abort()},t.load=function(a,s){var l=this,e=a.url;if(!e)return Promise.reject(new g({type:d.ErrorTypes.NETWORK_ERROR,details:d.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:a,networkDetails:null},"Fragment does not have a "+(e?"part list":"url")));this.abort();var n=this.config,u=n.fLoader,c=n.loader;return new Promise(function(i,r){l.loader&&l.loader.destroy();var o=l.loader=a.loader=u?new u(n):new c(n),e=p(a),t={timeout:n.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:n.fragLoadingMaxRetryTimeout,highWaterMark:"initSegment"===a.sn?1/0:h};a.stats=o.stats,o.load(e,t,{onSuccess:function(e,t,n,r){l.resetLoader(a,o),i({frag:a,part:null,payload:e.data,networkDetails:r})},onError:function(e,t,n){l.resetLoader(a,o),r(new g({type:d.ErrorTypes.NETWORK_ERROR,details:d.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:a,response:e,networkDetails:n}))},onAbort:function(e,t,n){l.resetLoader(a,o),r(new g({type:d.ErrorTypes.NETWORK_ERROR,details:d.ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:a,networkDetails:n}))},onTimeout:function(e,t,n){l.resetLoader(a,o),r(new g({type:d.ErrorTypes.NETWORK_ERROR,details:d.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:a,networkDetails:n}))},onProgress:function(e,t,n,r){s&&s({frag:a,part:null,payload:n,networkDetails:r})}})})},t.loadPart=function(s,l,u){var c=this;this.abort();var n=this.config,i=n.fLoader,f=n.loader;return new Promise(function(o,r){c.loader&&c.loader.destroy();var a=c.loader=s.loader=i?new i(n):new f(n),e=p(s,l),t={timeout:n.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:n.fragLoadingMaxRetryTimeout,highWaterMark:h};l.stats=a.stats,a.load(e,t,{onSuccess:function(e,t,n,r){c.resetLoader(s,a),c.updateStatsFromPart(s,l);var i={frag:s,part:l,payload:e.data,networkDetails:r};u(i),o(i)},onError:function(e,t,n){c.resetLoader(s,a),r(new g({type:d.ErrorTypes.NETWORK_ERROR,details:d.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:s,part:l,response:e,networkDetails:n}))},onAbort:function(e,t,n){s.stats.aborted=l.stats.aborted,c.resetLoader(s,a),r(new g({type:d.ErrorTypes.NETWORK_ERROR,details:d.ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:s,part:l,networkDetails:n}))},onTimeout:function(e,t,n){c.resetLoader(s,a),r(new g({type:d.ErrorTypes.NETWORK_ERROR,details:d.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:s,part:l,networkDetails:n}))}})})},t.updateStatsFromPart=function(e,t){var n=e.stats,r=t.stats,i=r.total;if(n.loaded+=r.loaded,i){var o=Math.round(e.duration/t.duration),a=Math.min(Math.round(n.loaded/i),o),s=(o-a)*Math.round(n.loaded/a);n.total=n.loaded+s}else n.total=Math.max(n.loaded,n.total);var l=n.loading,u=r.loading;l.start?l.first+=u.first-u.start:(l.start=u.start,l.first=u.first),l.end=u.end},t.resetLoader=function(e,t){e.loader=null,this.loader===t&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),t.destroy()},e}();function p(e,t){void 0===t&&(t=null);var n=t||e,r={frag:e,part:t,responseType:"arraybuffer",url:n.url,headers:{},rangeStart:0,rangeEnd:0},i=n.byteRangeStartOffset,o=n.byteRangeEndOffset;return Object(a.isFiniteNumber)(i)&&Object(a.isFiniteNumber)(o)&&(r.rangeStart=i,r.rangeEnd=o),r}var g=function(o){var e,t;function n(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return(t=o.call.apply(o,[this].concat(r))||this).data=void 0,t.data=e,t}return t=o,(e=n).prototype=Object.create(t.prototype),e.prototype.constructor=e,s(e,t),n}(i(Error))},"./src/loader/fragment.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"ElementaryStreamTypes",function(){return i}),n.d(t,"BaseSegment",function(){return h}),n.d(t,"Fragment",function(){return p}),n.d(t,"Part",function(){return g});var i,o=n("./src/polyfills/number.ts"),r=n("./node_modules/url-toolkit/src/url-toolkit.js"),a=n("./src/utils/logger.ts"),s=n("./src/loader/level-key.ts"),l=n("./src/loader/load-stats.ts");function u(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,c(e,t)}function c(e,t){return(c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(e,t,n){return t&&f(e.prototype,t),n&&f(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}!function(e){e.AUDIO="audio",e.VIDEO="video",e.AUDIOVIDEO="audiovideo"}(i||(i={}));var h=function(){function e(e){var t;this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams=((t={})[i.AUDIO]=null,t[i.VIDEO]=null,t[i.AUDIOVIDEO]=null,t),this.baseurl=e}return e.prototype.setByteRange=function(e,t){var n=e.split("@",2),r=[];1===n.length?r[0]=t?t.byteRangeEndOffset:0:r[0]=parseInt(n[1]),r[1]=parseInt(n[0])+r[0],this._byteRange=r},d(e,[{key:"byteRange",get:function(){return this._byteRange?this._byteRange:[]}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"url",get:function(){return!this._url&&this.baseurl&&this.relurl&&(this._url=Object(r.buildAbsoluteURL)(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""},set:function(e){this._url=e}}]),e}(),p=function(r){function e(e,t){var n;return(n=r.call(this,t)||this)._decryptdata=null,n.rawProgramDateTime=null,n.programDateTime=null,n.tagList=[],n.duration=0,n.sn=0,n.levelkey=void 0,n.type=void 0,n.loader=null,n.level=-1,n.cc=0,n.startPTS=void 0,n.endPTS=void 0,n.appendedPTS=void 0,n.startDTS=void 0,n.endDTS=void 0,n.start=0,n.deltaPTS=void 0,n.maxStartPTS=void 0,n.minEndPTS=void 0,n.stats=new l.LoadStats,n.urlId=0,n.data=void 0,n.bitrateTest=!1,n.title=null,n.initSegment=null,n.type=e,n}u(e,r);var t=e.prototype;return t.createInitializationVector=function(e){for(var t=new Uint8Array(16),n=12;n<16;n++)t[n]=e>>8*(15-n)&255;return t},t.setDecryptDataFromLevelKey=function(e,t){var n=e;return"AES-128"===(null==e?void 0:e.method)&&e.uri&&!e.iv&&((n=s.LevelKey.fromURI(e.uri)).method=e.method,n.iv=this.createInitializationVector(t),n.keyFormat="identity"),n},t.setElementaryStreamInfo=function(e,t,n,r,i,o){void 0===o&&(o=!1);var a=this.elementaryStreams,s=a[e];s?(s.startPTS=Math.min(s.startPTS,t),s.endPTS=Math.max(s.endPTS,n),s.startDTS=Math.min(s.startDTS,r),s.endDTS=Math.max(s.endDTS,i)):a[e]={startPTS:t,endPTS:n,startDTS:r,endDTS:i,partial:o}},t.clearElementaryStreamInfo=function(){var e=this.elementaryStreams;e[i.AUDIO]=null,e[i.VIDEO]=null,e[i.AUDIOVIDEO]=null},d(e,[{key:"decryptdata",get:function(){if(!this.levelkey&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkey){var e=this.sn;"number"!=typeof e&&(this.levelkey&&"AES-128"===this.levelkey.method&&!this.levelkey.iv&&a.logger.warn('missing IV for initialization segment with method="'+this.levelkey.method+'" - compliance issue'),e=0),this._decryptdata=this.setDecryptDataFromLevelKey(this.levelkey,e)}return this._decryptdata}},{key:"end",get:function(){return this.start+this.duration}},{key:"endProgramDateTime",get:function(){if(null===this.programDateTime)return null;if(!Object(o.isFiniteNumber)(this.programDateTime))return null;var e=Object(o.isFiniteNumber)(this.duration)?this.duration:0;return this.programDateTime+1e3*e}},{key:"encrypted",get:function(){var e;return!(null===(e=this.decryptdata)||void 0===e||!e.keyFormat||!this.decryptdata.uri)}}]),e}(h),g=function(s){function e(e,t,n,r,i){var o;(o=s.call(this,n)||this).fragOffset=0,o.duration=0,o.gap=!1,o.independent=!1,o.relurl=void 0,o.fragment=void 0,o.index=void 0,o.stats=new l.LoadStats,o.duration=e.decimalFloatingPoint("DURATION"),o.gap=e.bool("GAP"),o.independent=e.bool("INDEPENDENT"),o.relurl=e.enumeratedString("URI"),o.fragment=t,o.index=r;var a=e.enumeratedString("BYTERANGE");return a&&o.setByteRange(a,i),i&&(o.fragOffset=i.fragOffset+i.duration),o}return u(e,s),d(e,[{key:"start",get:function(){return this.fragment.start+this.fragOffset}},{key:"end",get:function(){return this.start+this.duration}},{key:"loaded",get:function(){var e=this.elementaryStreams;return!!(e.audio||e.video||e.audiovideo)}}]),e}(h)},"./src/loader/key-loader.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return r});var d=n("./src/events.ts"),i=n("./src/errors.ts"),h=n("./src/utils/logger.ts"),r=function(){function e(e){this.hls=void 0,this.loaders={},this.decryptkey=null,this.decrypturl=null,this.hls=e,this.registerListeners()}var t=e.prototype;return t.startLoad=function(e){},t.stopLoad=function(){this.destroyInternalLoaders()},t.registerListeners=function(){this.hls.on(d.Events.KEY_LOADING,this.onKeyLoading,this)},t.unregisterListeners=function(){this.hls.off(d.Events.KEY_LOADING,this.onKeyLoading)},t.destroyInternalLoaders=function(){for(var e in this.loaders){var t=this.loaders[e];t&&t.destroy()}this.loaders={}},t.destroy=function(){this.unregisterListeners(),this.destroyInternalLoaders()},t.onKeyLoading=function(e,t){var n=t.frag,r=n.type,i=this.loaders[r];if(n.decryptdata){var o=n.decryptdata.uri;if(o!==this.decrypturl||null===this.decryptkey){var a=this.hls.config;if(i&&(h.logger.warn("abort previous key loader for type:"+r),i.abort()),!o)return void h.logger.warn("key uri is falsy");var s=a.loader,l=n.loader=this.loaders[r]=new s(a);this.decrypturl=o,this.decryptkey=null;var u={url:o,frag:n,responseType:"arraybuffer"},c={timeout:a.fragLoadingTimeOut,maxRetry:0,retryDelay:a.fragLoadingRetryDelay,maxRetryDelay:a.fragLoadingMaxRetryTimeout,highWaterMark:0},f={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};l.load(u,c,f)}else this.decryptkey&&(n.decryptdata.key=this.decryptkey,this.hls.trigger(d.Events.KEY_LOADED,{frag:n}))}else h.logger.warn("Missing decryption data on fragment in onKeyLoading")},t.loadsuccess=function(e,t,n){var r=n.frag;r.decryptdata?(this.decryptkey=r.decryptdata.key=new Uint8Array(e.data),r.loader=null,delete this.loaders[r.type],this.hls.trigger(d.Events.KEY_LOADED,{frag:r})):h.logger.error("after key load, decryptdata unset")},t.loaderror=function(e,t){var n=t.frag,r=n.loader;r&&r.abort(),delete this.loaders[n.type],this.hls.trigger(d.Events.ERROR,{type:i.ErrorTypes.NETWORK_ERROR,details:i.ErrorDetails.KEY_LOAD_ERROR,fatal:!1,frag:n,response:e})},t.loadtimeout=function(e,t){var n=t.frag,r=n.loader;r&&r.abort(),delete this.loaders[n.type],this.hls.trigger(d.Events.ERROR,{type:i.ErrorTypes.NETWORK_ERROR,details:i.ErrorDetails.KEY_LOAD_TIMEOUT,fatal:!1,frag:n})},e}()},"./src/loader/level-details.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"LevelDetails",function(){return r});var i=n("./src/polyfills/number.ts");function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var r=function(){function e(e){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.needSidxRanges=!1,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.fragments=[],this.dateRanges={},this.url=e}var t,n,r;return e.prototype.reloaded=function(e){if(!e)return this.advanced=!0,void(this.updated=!0);var t=this.lastPartSn-e.lastPartSn,n=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!n||!!t,this.advanced=this.endSN>e.endSN||t>0||0===t&&n>0,this.updated||this.advanced?this.misses=Math.floor(.6*e.misses):this.misses=e.misses+1,this.availabilityDelay=e.availabilityDelay},t=e,(n=[{key:"hasProgramDateTime",get:function(){return!!this.fragments.length&&Object(i.isFiniteNumber)(this.fragments[this.fragments.length-1].programDateTime)}},{key:"levelTargetDuration",get:function(){return this.averagetargetduration||this.targetduration||10}},{key:"drift",get:function(){var e=this.driftEndTime-this.driftStartTime;return e>0?1e3*(this.driftEnd-this.driftStart)/e:1}},{key:"edge",get:function(){return this.partEnd||this.fragmentEnd}},{key:"partEnd",get:function(){var e;return null!==(e=this.partList)&&void 0!==e&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}},{key:"fragmentEnd",get:function(){var e;return null!==(e=this.fragments)&&void 0!==e&&e.length?this.fragments[this.fragments.length-1].end:0}},{key:"age",get:function(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}},{key:"lastPartIndex",get:function(){var e;return null!==(e=this.partList)&&void 0!==e&&e.length?this.partList[this.partList.length-1].index:-1}},{key:"lastPartSn",get:function(){var e;return null!==(e=this.partList)&&void 0!==e&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}])&&o(t.prototype,n),r&&o(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}()},"./src/loader/level-key.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"LevelKey",function(){return r});var i=n("./node_modules/url-toolkit/src/url-toolkit.js");function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var r=function(){function n(e,t){this._uri=null,this.method=null,this.keyFormat=null,this.keyFormatVersions=null,this.keyID=null,this.key=null,this.iv=null,this._uri=t?Object(i.buildAbsoluteURL)(e,t,{alwaysNormalize:!0}):e}var e,t,r;return n.fromURL=function(e,t){return new n(e,t)},n.fromURI=function(e){return new n(e)},e=n,(t=[{key:"uri",get:function(){return this._uri}}])&&o(e.prototype,t),r&&o(e,r),Object.defineProperty(e,"prototype",{writable:!1}),n}()},"./src/loader/load-stats.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"LoadStats",function(){return r});var r=function(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}},"./src/loader/m3u8-parser.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return r});var ee=n("./src/polyfills/number.ts"),te=n("./node_modules/url-toolkit/src/url-toolkit.js"),ne=n("./src/loader/date-range.ts"),re=n("./src/loader/fragment.ts"),ie=n("./src/loader/level-details.ts"),oe=n("./src/loader/level-key.ts"),ae=n("./src/utils/attr-list.ts"),se=n("./src/utils/logger.ts"),o=n("./src/utils/codecs.ts"),h=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-SESSION-DATA:([^\r\n]*)[\r\n]+/g,c=/#EXT-X-MEDIA:(.*)/g,le=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[\S ]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),ue=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(DATERANGE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|")),ce=/\.(mp4|m4s|m4v|m4a)$/i;var r=function(){function d(){}return d.findGroup=function(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(r.id===t)return r}},d.convertAVC1ToAVCOTI=function(e){var t=e.split(".");if(t.length>2){var n=t.shift()+".";return n+=parseInt(t.shift()).toString(16),n+=("000"+parseInt(t.shift()).toString(16)).slice(-4)}return e},d.resolve=function(e,t){return te.buildAbsoluteURL(t,e,{alwaysNormalize:!0})},d.parseMasterPlaylist=function(e,t){var n,r=[],i=[],o={},a=!1;for(h.lastIndex=0;null!=(n=h.exec(e));)if(n[1]){var s,l=new ae.AttrList(n[1]),u={attrs:l,bitrate:l.decimalInteger("AVERAGE-BANDWIDTH")||l.decimalInteger("BANDWIDTH"),name:l.NAME,url:d.resolve(n[2],t)},c=l.decimalResolution("RESOLUTION");c&&(u.width=c.width,u.height=c.height),p((l.CODECS||"").split(/[ ,]+/).filter(function(e){return e}),u),u.videoCodec&&-1!==u.videoCodec.indexOf("avc1")&&(u.videoCodec=d.convertAVC1ToAVCOTI(u.videoCodec)),null!==(s=u.unknownCodecs)&&void 0!==s&&s.length||i.push(u),r.push(u)}else if(n[3]){var f=new ae.AttrList(n[3]);f["DATA-ID"]&&(a=!0,o[f["DATA-ID"]]=f)}return{levels:i.length>0&&i.length<r.length?i:r,sessionData:a?o:null}},d.parseMasterPlaylistMedia=function(e,t,n,r){var i;void 0===r&&(r=[]);var o=[],a=0;for(c.lastIndex=0;null!==(i=c.exec(e));){var s=new ae.AttrList(i[1]);if(s.TYPE===n){var l={attrs:s,bitrate:0,id:a++,groupId:s["GROUP-ID"],instreamId:s["INSTREAM-ID"],name:s.NAME||s.LANGUAGE||"",type:n,default:s.bool("DEFAULT"),autoselect:s.bool("AUTOSELECT"),forced:s.bool("FORCED"),lang:s.LANGUAGE,url:s.URI?d.resolve(s.URI,t):""};if(r.length){var u=d.findGroup(r,l.groupId)||r[0];f(l,u,"audioCodec"),f(l,u,"textCodec")}o.push(l)}}return o},d.parseLevelPlaylist=function(e,t,n,r,F){var i,o,a,s=new ie.LevelDetails(t),l=s.fragments,u=null,c=0,f=0,d=0,h=0,p=null,g=new re.Fragment(r,t),v=-1,y=!1;for(le.lastIndex=0,s.m3u8=e;null!==(i=le.exec(e));){y&&(y=!1,(g=new re.Fragment(r,t)).start=d,g.sn=c,g.cc=h,g.level=n,u&&(g.initSegment=u,g.rawProgramDateTime=u.rawProgramDateTime,u.rawProgramDateTime=null));var m=i[1];if(m){g.duration=parseFloat(m);var b=(" "+i[2]).slice(1);g.title=b||null,g.tagList.push(b?["INF",m,b]:["INF",m])}else if(i[3])Object(ee.isFiniteNumber)(g.duration)&&(g.start=d,a&&(g.levelkey=a),g.sn=c,g.level=n,g.cc=h,g.urlId=F,l.push(g),g.relurl=(" "+i[3]).slice(1),fe(g,p),p=g,d+=g.duration,c++,f=0,y=!0);else if(i[4]){var E=(" "+i[4]).slice(1);p?g.setByteRange(E,p):g.setByteRange(E)}else if(i[5])g.rawProgramDateTime=(" "+i[5]).slice(1),g.tagList.push(["PROGRAM-DATE-TIME",g.rawProgramDateTime]),-1===v&&(v=l.length);else{if(!(i=i[0].match(ue))){se.logger.warn("No matches on slow regex match for level playlist!");continue}for(o=1;o<i.length&&void 0===i[o];o++);var T=(" "+i[o]).slice(1),k=(" "+i[o+1]).slice(1),w=i[o+2]?(" "+i[o+2]).slice(1):"";switch(T){case"PLAYLIST-TYPE":s.type=k.toUpperCase();break;case"MEDIA-SEQUENCE":c=s.startSN=parseInt(k);break;case"SKIP":var _=new ae.AttrList(k),S=_.decimalInteger("SKIPPED-SEGMENTS");if(Object(ee.isFiniteNumber)(S)){s.skippedSegments=S;for(var N=S;N--;)l.unshift(null);c+=S}var A=_.enumeratedString("RECENTLY-REMOVED-DATERANGES");A&&(s.recentlyRemovedDateranges=A.split("\t"));break;case"TARGETDURATION":s.targetduration=parseFloat(k);break;case"VERSION":s.version=parseInt(k);break;case"EXTM3U":break;case"ENDLIST":s.live=!1;break;case"#":(k||w)&&g.tagList.push(w?[k,w]:[k]);break;case"DISCONTINUITY":h++,g.tagList.push(["DIS"]);break;case"GAP":g.tagList.push([T]);break;case"BITRATE":g.tagList.push([T,k]);break;case"DATERANGE":var j=new ae.AttrList(k),P=new ne.DateRange(j,s.dateRanges[j.ID]);P.isValid||s.skippedSegments?s.dateRanges[P.id]=P:se.logger.warn('Ignoring invalid DATERANGE tag: "'+k+'"'),g.tagList.push(["EXT-X-DATERANGE",k]);break;case"DISCONTINUITY-SEQUENCE":h=parseInt(k);break;case"KEY":var U,O=new ae.AttrList(k),C=O.enumeratedString("METHOD"),B=O.URI,H=O.hexadecimalInteger("IV"),$=O.enumeratedString("KEYFORMATVERSIONS"),G=O.enumeratedString("KEYID"),L=null!=(U=O.enumeratedString("KEYFORMAT"))?U:"identity";if(["com.apple.streamingkeydelivery","com.microsoft.playready","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed","com.widevine"].indexOf(L)>-1){se.logger.warn("Keyformat "+L+" is not supported from the manifest");continue}if("identity"!==L)continue;C&&(a=oe.LevelKey.fromURL(t,B),B&&["AES-128","SAMPLE-AES","SAMPLE-AES-CENC"].indexOf(C)>=0&&(a.method=C,a.keyFormat=L,G&&(a.keyID=G),$&&(a.keyFormatVersions=$),a.iv=H));break;case"START":var V=new ae.AttrList(k).decimalFloatingPoint("TIME-OFFSET");Object(ee.isFiniteNumber)(V)&&(s.startTimeOffset=V);break;case"MAP":var Y=new ae.AttrList(k);if(g.duration){var z=new re.Fragment(r,t);de(z,Y,n,a),u=z,g.initSegment=u,u.rawProgramDateTime&&!g.rawProgramDateTime&&(g.rawProgramDateTime=u.rawProgramDateTime)}else de(g,Y,n,a),u=g,y=!0;break;case"SERVER-CONTROL":var D=new ae.AttrList(k);s.canBlockReload=D.bool("CAN-BLOCK-RELOAD"),s.canSkipUntil=D.optionalFloat("CAN-SKIP-UNTIL",0),s.canSkipDateRanges=s.canSkipUntil>0&&D.bool("CAN-SKIP-DATERANGES"),s.partHoldBack=D.optionalFloat("PART-HOLD-BACK",0),s.holdBack=D.optionalFloat("HOLD-BACK",0);break;case"PART-INF":var K=new ae.AttrList(k);s.partTarget=K.decimalFloatingPoint("PART-TARGET");break;case"PART":var x=s.partList;x||(x=s.partList=[]);var W=f>0?x[x.length-1]:void 0,q=f++,X=new re.Part(new ae.AttrList(k),g,t,q,W);x.push(X),g.duration+=X.duration;break;case"PRELOAD-HINT":var Q=new ae.AttrList(k);s.preloadHint=Q;break;case"RENDITION-REPORT":var J=new ae.AttrList(k);s.renditionReports=s.renditionReports||[],s.renditionReports.push(J);break;default:se.logger.warn("line parsed but not handled: "+i)}}}p&&!p.relurl?(l.pop(),d-=p.duration,s.partList&&(s.fragmentHint=p)):s.partList&&(fe(g,p),g.cc=h,s.fragmentHint=g);var R=l.length,I=l[0],M=l[R-1];if((d+=s.skippedSegments*s.targetduration)>0&&R&&M){s.averagetargetduration=d/R;var Z=M.sn;s.endSN="initSegment"!==Z?Z:0,I&&(s.startCC=I.cc,I.initSegment||s.fragments.every(function(e){return e.relurl&&(t=e.relurl,ce.test(null!=(n=null===(r=te.parseURL(t))||void 0===r?void 0:r.path)?n:""));var t,n,r})&&(se.logger.warn("MP4 fragments found but no init segment (probably no MAP, incomplete M3U8), trying to fetch SIDX"),(g=new re.Fragment(r,t)).relurl=M.relurl,g.level=n,g.sn="initSegment",I.initSegment=g,s.needSidxRanges=!0))}else s.endSN=0,s.startCC=0;return s.fragmentHint&&(d+=s.fragmentHint.duration),s.totalduration=d,s.endCC=h,v>0&&function(e,t){for(var n=e[t],r=t;r--;){var i=e[r];if(!i)return;i.programDateTime=n.programDateTime-1e3*i.duration,n=i}}(l,v),s},d}();function p(r,i){["video","audio","text"].forEach(function(t){var n=r.filter(function(e){return Object(o.isCodecType)(e,t)});if(n.length){var e=n.filter(function(e){return 0===e.lastIndexOf("avc1",0)||0===e.lastIndexOf("mp4a",0)});i[t+"Codec"]=e.length>0?e[0]:n[0],r=r.filter(function(e){return-1===n.indexOf(e)})}}),i.unknownCodecs=r}function f(e,t,n){var r=t[n];r&&(e[n]=r)}function fe(e,t){e.rawProgramDateTime?e.programDateTime=Date.parse(e.rawProgramDateTime):null!=t&&t.programDateTime&&(e.programDateTime=t.endProgramDateTime),Object(ee.isFiniteNumber)(e.programDateTime)||(e.programDateTime=null,e.rawProgramDateTime=null)}function de(e,t,n,r){e.relurl=t.URI,t.BYTERANGE&&e.setByteRange(t.BYTERANGE),e.level=n,e.sn="initSegment",r&&(e.levelkey=r),e.initSegment=null}},"./src/loader/playlist-loader.ts":function(e,t,n){"use strict";n.r(t);var v=n("./src/polyfills/number.ts"),y=n("./src/events.ts"),m=n("./src/errors.ts"),g=n("./src/utils/logger.ts"),l=n("./src/utils/mp4-tools.ts"),b=n("./src/loader/m3u8-parser.ts"),E=n("./src/types/loader.ts"),T=n("./src/utils/attr-list.ts");function k(e,t){var n=e.url;return void 0!==n&&0!==n.indexOf("data:")||(n=t.url),n}var r=function(){function e(e){this.hls=void 0,this.loaders=Object.create(null),this.hls=e,this.registerListeners()}var t=e.prototype;return t.startLoad=function(e){},t.stopLoad=function(){this.destroyInternalLoaders()},t.registerListeners=function(){var e=this.hls;e.on(y.Events.MANIFEST_LOADING,this.onManifestLoading,this),e.on(y.Events.LEVEL_LOADING,this.onLevelLoading,this),e.on(y.Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on(y.Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},t.unregisterListeners=function(){var e=this.hls;e.off(y.Events.MANIFEST_LOADING,this.onManifestLoading,this),e.off(y.Events.LEVEL_LOADING,this.onLevelLoading,this),e.off(y.Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off(y.Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},t.createInternalLoader=function(e){var t=this.hls.config,n=t.pLoader,r=t.loader,i=new(n||r)(t);return e.loader=i,this.loaders[e.type]=i,i},t.getInternalLoader=function(e){return this.loaders[e.type]},t.resetInternalLoader=function(e){this.loaders[e]&&delete this.loaders[e]},t.destroyInternalLoaders=function(){for(var e in this.loaders){var t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}},t.destroy=function(){this.unregisterListeners(),this.destroyInternalLoaders()},t.onManifestLoading=function(e,t){var n=t.url;this.load({id:null,groupId:null,level:0,responseType:"text",type:E.PlaylistContextType.MANIFEST,url:n,deliveryDirectives:null})},t.onLevelLoading=function(e,t){var n=t.id,r=t.level,i=t.url,o=t.deliveryDirectives;this.load({id:n,groupId:null,level:r,responseType:"text",type:E.PlaylistContextType.LEVEL,url:i,deliveryDirectives:o})},t.onAudioTrackLoading=function(e,t){var n=t.id,r=t.groupId,i=t.url,o=t.deliveryDirectives;this.load({id:n,groupId:r,level:null,responseType:"text",type:E.PlaylistContextType.AUDIO_TRACK,url:i,deliveryDirectives:o})},t.onSubtitleTrackLoading=function(e,t){var n=t.id,r=t.groupId,i=t.url,o=t.deliveryDirectives;this.load({id:n,groupId:r,level:null,responseType:"text",type:E.PlaylistContextType.SUBTITLE_TRACK,url:i,deliveryDirectives:o})},t.load=function(e){var t,n,r,i,o,a,s=this.hls.config,l=this.getInternalLoader(e);if(l){var u=l.context;if(u&&u.url===e.url)return void g.logger.trace("[playlist-loader]: playlist request ongoing");g.logger.log("[playlist-loader]: aborting previous loader for type: "+e.type),l.abort()}switch(e.type){case E.PlaylistContextType.MANIFEST:n=s.manifestLoadingMaxRetry,r=s.manifestLoadingTimeOut,i=s.manifestLoadingRetryDelay,o=s.manifestLoadingMaxRetryTimeout;break;case E.PlaylistContextType.LEVEL:case E.PlaylistContextType.AUDIO_TRACK:case E.PlaylistContextType.SUBTITLE_TRACK:n=0,r=s.levelLoadingTimeOut;break;default:n=s.levelLoadingMaxRetry,r=s.levelLoadingTimeOut,i=s.levelLoadingRetryDelay,o=s.levelLoadingMaxRetryTimeout}if((l=this.createInternalLoader(e),null!==(t=e.deliveryDirectives)&&void 0!==t&&t.part)&&(e.type===E.PlaylistContextType.LEVEL&&null!==e.level?a=this.hls.levels[e.level].details:e.type===E.PlaylistContextType.AUDIO_TRACK&&null!==e.id?a=this.hls.audioTracks[e.id].details:e.type===E.PlaylistContextType.SUBTITLE_TRACK&&null!==e.id&&(a=this.hls.subtitleTracks[e.id].details),a)){var c=a.partTarget,f=a.targetduration;c&&f&&(r=Math.min(1e3*Math.max(3*c,.8*f),r))}var d={timeout:r,maxRetry:n,retryDelay:i,maxRetryDelay:o,highWaterMark:0},h={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};l.load(e,d,h)},t.loadsuccess=function(e,t,n,r){if(void 0===r&&(r=null),n.isSidxRequest)return this.handleSidxRequest(e,n),void this.handlePlaylistLoaded(e,t,n,r);this.resetInternalLoader(n.type);var i=e.data;0===i.indexOf("#EXTM3U")?(t.parsing.start=performance.now(),i.indexOf("#EXTINF:")>0||i.indexOf("#EXT-X-TARGETDURATION:")>0?this.handleTrackOrLevelPlaylist(e,t,n,r):this.handleMasterPlaylist(e,t,n,r)):this.handleManifestParsingError(e,n,"no EXTM3U delimiter",r)},t.loaderror=function(e,t,n){void 0===n&&(n=null),this.handleNetworkError(t,n,!1,e)},t.loadtimeout=function(e,t,n){void 0===n&&(n=null),this.handleNetworkError(t,n,!0)},t.handleMasterPlaylist=function(e,t,n,r){var i=this.hls,o=e.data,a=k(e,n),s=b.default.parseMasterPlaylist(o,a),l=s.levels,u=s.sessionData;if(l.length){var c=l.map(function(e){return{id:e.attrs.AUDIO,audioCodec:e.audioCodec}}),f=l.map(function(e){return{id:e.attrs.SUBTITLES,textCodec:e.textCodec}}),d=b.default.parseMasterPlaylistMedia(o,a,"AUDIO",c),h=b.default.parseMasterPlaylistMedia(o,a,"SUBTITLES",f),p=b.default.parseMasterPlaylistMedia(o,a,"CLOSED-CAPTIONS");if(d.length)d.some(function(e){return!e.url})||!l[0].audioCodec||l[0].attrs.AUDIO||(g.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),d.unshift({type:"main",name:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new T.AttrList({}),bitrate:0,url:""}));i.trigger(y.Events.MANIFEST_LOADED,{levels:l,audioTracks:d,subtitles:h,captions:p,url:a,stats:t,networkDetails:r,sessionData:u})}else this.handleManifestParsingError(e,n,"no level found in manifest",r)},t.handleTrackOrLevelPlaylist=function(e,t,n,r){var i=this.hls,o=n.id,a=n.level,s=n.type,l=k(e,n),u=Object(v.isFiniteNumber)(o)?o:0,c=Object(v.isFiniteNumber)(a)?a:u,f=function(e){switch(e.type){case E.PlaylistContextType.AUDIO_TRACK:return E.PlaylistLevelType.AUDIO;case E.PlaylistContextType.SUBTITLE_TRACK:return E.PlaylistLevelType.SUBTITLE;default:return E.PlaylistLevelType.MAIN}}(n),d=b.default.parseLevelPlaylist(e.data,l,c,f,u);if(d.fragments.length){if(s===E.PlaylistContextType.MANIFEST){var h={attrs:new T.AttrList({}),bitrate:0,details:d,name:"",url:l};i.trigger(y.Events.MANIFEST_LOADED,{levels:[h],audioTracks:[],url:l,stats:t,networkDetails:r,sessionData:null})}if(t.parsing.end=performance.now(),d.needSidxRanges){var p,g=null===(p=d.fragments[0].initSegment)||void 0===p?void 0:p.url;this.load({url:g,isSidxRequest:!0,type:s,level:a,levelDetails:d,id:o,groupId:null,rangeStart:0,rangeEnd:2048,responseType:"arraybuffer",deliveryDirectives:null})}else n.levelDetails=d,this.handlePlaylistLoaded(e,t,n,r)}else i.trigger(y.Events.ERROR,{type:m.ErrorTypes.NETWORK_ERROR,details:m.ErrorDetails.LEVEL_EMPTY_ERROR,fatal:!1,url:l,reason:"no fragments found in level",level:"number"==typeof n.level?n.level:void 0})},t.handleSidxRequest=function(e,t){var a=new Uint8Array(e.data),n=Object(l.findBox)(a,["sidx"])[0];if(n){var r=Object(l.parseSegmentIndex)(n);if(r){var i=r.references,s=t.levelDetails;i.forEach(function(e,t){var n=e.info,r=s.fragments[t];if(0===r.byteRange.length&&r.setByteRange(String(1+n.end-n.start)+"@"+String(n.start)),r.initSegment){var i=Object(l.findBox)(a,["moov"])[0],o=i?i.length:null;r.initSegment.setByteRange(String(o)+"@0")}})}}},t.handleManifestParsingError=function(e,t,n,r){this.hls.trigger(y.Events.ERROR,{type:m.ErrorTypes.NETWORK_ERROR,details:m.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:t.type===E.PlaylistContextType.MANIFEST,url:e.url,reason:n,response:e,context:t,networkDetails:r})},t.handleNetworkError=function(e,t,n,r){void 0===n&&(n=!1),g.logger.warn("[playlist-loader]: A network "+(n?"timeout":"error")+" occurred while loading "+e.type+" level: "+e.level+" id: "+e.id+' group-id: "'+e.groupId+'"');var i=m.ErrorDetails.UNKNOWN,o=!1,a=this.getInternalLoader(e);switch(e.type){case E.PlaylistContextType.MANIFEST:i=n?m.ErrorDetails.MANIFEST_LOAD_TIMEOUT:m.ErrorDetails.MANIFEST_LOAD_ERROR,o=!0;break;case E.PlaylistContextType.LEVEL:i=n?m.ErrorDetails.LEVEL_LOAD_TIMEOUT:m.ErrorDetails.LEVEL_LOAD_ERROR,o=!1;break;case E.PlaylistContextType.AUDIO_TRACK:i=n?m.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:m.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,o=!1;break;case E.PlaylistContextType.SUBTITLE_TRACK:i=n?m.ErrorDetails.SUBTITLE_TRACK_LOAD_TIMEOUT:m.ErrorDetails.SUBTITLE_LOAD_ERROR,o=!1}a&&this.resetInternalLoader(e.type);var s={type:m.ErrorTypes.NETWORK_ERROR,details:i,fatal:o,url:e.url,loader:a,context:e,networkDetails:t};r&&(s.response=r),this.hls.trigger(y.Events.ERROR,s)},t.handlePlaylistLoaded=function(e,t,n,r){var i=n.type,o=n.level,a=n.id,s=n.groupId,l=n.loader,u=n.levelDetails,c=n.deliveryDirectives;if(null!=u&&u.targetduration){if(l)switch(u.live&&(l.getCacheAge&&(u.ageHeader=l.getCacheAge()||0),l.getCacheAge&&!isNaN(u.ageHeader)||(u.ageHeader=0)),i){case E.PlaylistContextType.MANIFEST:case E.PlaylistContextType.LEVEL:this.hls.trigger(y.Events.LEVEL_LOADED,{details:u,level:o||0,id:a||0,stats:t,networkDetails:r,deliveryDirectives:c});break;case E.PlaylistContextType.AUDIO_TRACK:this.hls.trigger(y.Events.AUDIO_TRACK_LOADED,{details:u,id:a||0,groupId:s||"",stats:t,networkDetails:r,deliveryDirectives:c});break;case E.PlaylistContextType.SUBTITLE_TRACK:this.hls.trigger(y.Events.SUBTITLE_TRACK_LOADED,{details:u,id:a||0,groupId:s||"",stats:t,networkDetails:r,deliveryDirectives:c})}}else this.handleManifestParsingError(e,n,"invalid target duration",r)},e}();t.default=r},"./src/polyfills/number.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"isFiniteNumber",function(){return r}),n.d(t,"MAX_SAFE_INTEGER",function(){return i});var r=Number.isFinite||function(e){return"number"==typeof e&&isFinite(e)},i=Number.MAX_SAFE_INTEGER||9007199254740991},"./src/remux/aac-helper.ts":function(e,t,n){"use strict";n.r(t);var r=function(){function e(){}return e.getSilentFrame=function(e,t){switch(e){case"mp4a.40.2":if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}},e}();t.default=r},"./src/remux/mp4-generator.ts":function(e,t,n){"use strict";n.r(t);var s=Math.pow(2,32)-1,r=function(){function d(){}return d.init=function(){var e;for(e in d.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]},d.types)d.types.hasOwnProperty(e)&&(d.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);var t=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),n=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);d.HDLR_TYPES={video:t,audio:n};var r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),i=new Uint8Array([0,0,0,0,0,0,0,0]);d.STTS=d.STSC=d.STCO=i,d.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),d.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),d.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),d.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var o=new Uint8Array([105,115,111,109]),a=new Uint8Array([97,118,99,49]),s=new Uint8Array([0,0,0,1]);d.FTYP=d.box(d.types.ftyp,o,s,o,a),d.DINF=d.box(d.types.dinf,d.box(d.types.dref,r))},d.box=function(e){for(var t=8,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];for(var o=r.length,a=o;o--;)t+=r[o].byteLength;var s=new Uint8Array(t);for(s[0]=t>>24&255,s[1]=t>>16&255,s[2]=t>>8&255,s[3]=255&t,s.set(e,4),o=0,t=8;o<a;o++)s.set(r[o],t),t+=r[o].byteLength;return s},d.hdlr=function(e){return d.box(d.types.hdlr,d.HDLR_TYPES[e])},d.mdat=function(e){return d.box(d.types.mdat,e)},d.mdhd=function(e,t){t*=e;var n=Math.floor(t/(s+1)),r=Math.floor(t%(s+1));return d.box(d.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,n>>24,n>>16&255,n>>8&255,255&n,r>>24,r>>16&255,r>>8&255,255&r,85,196,0,0]))},d.mdia=function(e){return d.box(d.types.mdia,d.mdhd(e.timescale,e.duration),d.hdlr(e.type),d.minf(e))},d.mfhd=function(e){return d.box(d.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,255&e]))},d.minf=function(e){return"audio"===e.type?d.box(d.types.minf,d.box(d.types.smhd,d.SMHD),d.DINF,d.stbl(e)):d.box(d.types.minf,d.box(d.types.vmhd,d.VMHD),d.DINF,d.stbl(e))},d.moof=function(e,t,n){return d.box(d.types.moof,d.mfhd(e),d.traf(n,t))},d.moov=function(e){for(var t=e.length,n=[];t--;)n[t]=d.trak(e[t]);return d.box.apply(null,[d.types.moov,d.mvhd(e[0].timescale,e[0].duration)].concat(n).concat(d.mvex(e)))},d.mvex=function(e){for(var t=e.length,n=[];t--;)n[t]=d.trex(e[t]);return d.box.apply(null,[d.types.mvex].concat(n))},d.mvhd=function(e,t){t*=e;var n=Math.floor(t/(s+1)),r=Math.floor(t%(s+1)),i=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,n>>24,n>>16&255,n>>8&255,255&n,r>>24,r>>16&255,r>>8&255,255&r,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return d.box(d.types.mvhd,i)},d.sdtp=function(e){var t,n,r=e.samples||[],i=new Uint8Array(4+r.length);for(t=0;t<r.length;t++)n=r[t].flags,i[t+4]=n.dependsOn<<4|n.isDependedOn<<2|n.hasRedundancy;return d.box(d.types.sdtp,i)},d.stbl=function(e){return d.box(d.types.stbl,d.stsd(e),d.box(d.types.stts,d.STTS),d.box(d.types.stsc,d.STSC),d.box(d.types.stsz,d.STSZ),d.box(d.types.stco,d.STCO))},d.avc1=function(e){var t,n,r,i=[],o=[];for(t=0;t<e.sps.length;t++)r=(n=e.sps[t]).byteLength,i.push(r>>>8&255),i.push(255&r),i=i.concat(Array.prototype.slice.call(n));for(t=0;t<e.pps.length;t++)r=(n=e.pps[t]).byteLength,o.push(r>>>8&255),o.push(255&r),o=o.concat(Array.prototype.slice.call(n));var a=d.box(d.types.avcC,new Uint8Array([1,i[3],i[4],i[5],255,224|e.sps.length].concat(i).concat([e.pps.length]).concat(o))),s=e.width,l=e.height,u=e.pixelRatio[0],c=e.pixelRatio[1];return d.box(d.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,s>>8&255,255&s,l>>8&255,255&l,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),a,d.box(d.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),d.box(d.types.pasp,new Uint8Array([u>>24,u>>16&255,u>>8&255,255&u,c>>24,c>>16&255,c>>8&255,255&c])))},d.esds=function(e){var t=e.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(e.config).concat([6,1,2]))},d.mp4a=function(e){var t=e.samplerate;return d.box(d.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,t>>8&255,255&t,0,0]),d.box(d.types.esds,d.esds(e)))},d.mp3=function(e){var t=e.samplerate;return d.box(d.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,t>>8&255,255&t,0,0]))},d.stsd=function(e){return"audio"===e.type?"mp3"===e.segmentCodec&&"mp3"===e.codec?d.box(d.types.stsd,d.STSD,d.mp3(e)):d.box(d.types.stsd,d.STSD,d.mp4a(e)):d.box(d.types.stsd,d.STSD,d.avc1(e))},d.tkhd=function(e){var t=e.id,n=e.duration*e.timescale,r=e.width,i=e.height,o=Math.floor(n/(s+1)),a=Math.floor(n%(s+1));return d.box(d.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,0,0,0,0,o>>24,o>>16&255,o>>8&255,255&o,a>>24,a>>16&255,a>>8&255,255&a,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,r>>8&255,255&r,0,0,i>>8&255,255&i,0,0]))},d.traf=function(e,t){var n=d.sdtp(e),r=e.id,i=Math.floor(t/(s+1)),o=Math.floor(t%(s+1));return d.box(d.types.traf,d.box(d.types.tfhd,new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r])),d.box(d.types.tfdt,new Uint8Array([1,0,0,0,i>>24,i>>16&255,i>>8&255,255&i,o>>24,o>>16&255,o>>8&255,255&o])),d.trun(e,n.length+16+20+8+16+8+8),n)},d.trak=function(e){return e.duration=e.duration||4294967295,d.box(d.types.trak,d.tkhd(e),d.mdia(e))},d.trex=function(e){var t=e.id;return d.box(d.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},d.trun=function(e,t){var n,r,i,o,a,s,l=e.samples||[],u=l.length,c=12+16*u,f=new Uint8Array(c);for(t+=8+c,f.set(["video"===e.type?1:0,0,15,1,u>>>24&255,u>>>16&255,u>>>8&255,255&u,t>>>24&255,t>>>16&255,t>>>8&255,255&t],0),n=0;n<u;n++)i=(r=l[n]).duration,o=r.size,a=r.flags,s=r.cts,f.set([i>>>24&255,i>>>16&255,i>>>8&255,255&i,o>>>24&255,o>>>16&255,o>>>8&255,255&o,a.isLeading<<2|a.dependsOn,a.isDependedOn<<6|a.hasRedundancy<<4|a.paddingValue<<1|a.isNonSync,61440&a.degradPrio,15&a.degradPrio,s>>>24&255,s>>>16&255,s>>>8&255,255&s],12+16*n);return d.box(d.types.trun,f)},d.initSegment=function(e){d.types||d.init();var t=d.moov(e),n=new Uint8Array(d.FTYP.byteLength+t.byteLength);return n.set(d.FTYP),n.set(t,d.FTYP.byteLength),n},d}();r.types=void 0,r.HDLR_TYPES=void 0,r.STTS=void 0,r.STSC=void 0,r.STCO=void 0,r.STSZ=void 0,r.VMHD=void 0,r.SMHD=void 0,r.STSD=void 0,r.FTYP=void 0,r.DINF=void 0,t.default=r},"./src/remux/mp4-remuxer.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return r}),n.d(t,"normalizePts",function(){return ye}),n.d(t,"flushTextTrackMetadataCueSamples",function(){return C}),n.d(t,"flushTextTrackUserdataCueSamples",function(){return L});var p=n("./src/polyfills/number.ts"),Y=n("./src/remux/aac-helper.ts"),ue=n("./src/remux/mp4-generator.ts"),ce=n("./src/events.ts"),fe=n("./src/errors.ts"),de=n("./src/utils/logger.ts"),O=n("./src/types/loader.ts"),he=n("./src/utils/timescale-conversion.ts");function pe(){return(pe=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var ge=null,ve=null,r=function(){function e(e,t,n,r){if(void 0===r&&(r=""),this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=void 0,this._initDTS=void 0,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.observer=e,this.config=t,this.typeSupported=n,this.ISGenerated=!1,null===ge){var i=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);ge=i?parseInt(i[1]):0}if(null===ve){var o=navigator.userAgent.match(/Safari\/(\d+)/i);ve=o?parseInt(o[1]):0}}var t=e.prototype;return t.destroy=function(){},t.resetTimeStamp=function(e){de.logger.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=e},t.resetNextTimestamp=function(){de.logger.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1},t.resetInitSegment=function(){de.logger.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1},t.getVideoStartPts=function(e){var r=!1,t=e.reduce(function(e,t){var n=t.pts-e;return n<-4294967296?(r=!0,ye(e,t.pts)):n>0?e:t.pts},e[0].pts);return r&&de.logger.debug("PTS rollover detected"),t},t.remux=function(e,t,n,r,i,o,a,s){var l,u,c,f,d,h,p=i,g=i,v=e.pid>-1,y=t.pid>-1,m=t.samples.length,b=e.samples.length>0,E=a&&m>0||m>1;if((!v||b)&&(!y||E)||this.ISGenerated||a){this.ISGenerated||(c=this.generateIS(e,t,i));var T,k=this.isVideoContiguous,w=-1;if(E&&(w=function(e){for(var t=0;t<e.length;t++)if(e[t].key)return t;return-1}(t.samples),!k&&this.config.forceKeyFrameOnDiscontinuity))if(h=!0,w>0){de.logger.warn("[mp4-remuxer]: Dropped "+w+" out of "+m+" video samples due to a missing keyframe");var _=this.getVideoStartPts(t.samples);t.samples=t.samples.slice(w),t.dropped+=w,T=g+=(t.samples[0].pts-_)/t.inputTimeScale}else-1===w&&(de.logger.warn("[mp4-remuxer]: No keyframe found out of "+m+" video samples"),h=!1);if(this.ISGenerated){if(b&&E){var S=this.getVideoStartPts(t.samples),A=(ye(e.samples[0].pts,S)-S)/t.inputTimeScale;p+=Math.max(0,A),g+=Math.max(0,-A)}if(b){if(e.samplerate||(de.logger.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),c=this.generateIS(e,t,i)),u=this.remuxAudio(e,p,this.isAudioContiguous,o,y||E||s===O.PlaylistLevelType.AUDIO?g:void 0),E){var P=u?u.endPTS-u.startPTS:0;t.inputTimeScale||(de.logger.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),c=this.generateIS(e,t,i)),l=this.remuxVideo(t,g,k,P)}}else E&&(l=this.remuxVideo(t,g,k,0));l&&(l.firstKeyFrame=w,l.independent=-1!==w,l.firstKeyFramePTS=T)}}return this.ISGenerated&&(n.samples.length&&(d=C(n,i,this._initPTS,this._initDTS)),r.samples.length&&(f=L(r,i,this._initPTS))),{audio:u,video:l,initSegment:c,independent:h,text:f,id3:d}},t.generateIS=function(e,t,n){var r,i,o,a=e.samples,s=t.samples,l=this.typeSupported,u={},c=!Object(p.isFiniteNumber)(this._initPTS),f="audio/mp4";if(c&&(r=i=1/0),e.config&&a.length){switch(e.timescale=e.samplerate,e.segmentCodec){case"mp3":l.mpeg?(f="audio/mpeg",e.codec=""):l.mp3&&(e.codec="mp3")}u.audio={id:"audio",container:f,codec:e.codec,initSegment:"mp3"===e.segmentCodec&&l.mpeg?new Uint8Array(0):ue.default.initSegment([e]),metadata:{channelCount:e.channelCount}},c&&(o=e.inputTimeScale,r=i=a[0].pts-Math.round(o*n))}if(t.sps&&t.pps&&s.length&&(t.timescale=t.inputTimeScale,u.video={id:"main",container:"video/mp4",codec:t.codec,initSegment:ue.default.initSegment([t]),metadata:{width:t.width,height:t.height}},c)){o=t.inputTimeScale;var d=this.getVideoStartPts(s),h=Math.round(o*n);i=Math.min(i,ye(s[0].dts,d)-h),r=Math.min(r,d-h)}if(Object.keys(u).length)return this.ISGenerated=!0,c&&(this._initPTS=r,this._initDTS=i),{tracks:u,initPTS:r,timescale:o}},t.remuxVideo=function(e,F,t,N){var n,r,i=e.inputTimeScale,o=e.samples,a=[],s=o.length,j=this._initPTS,l=this.nextAvcDts,u=8,c=this.videoSampleDuration,f=Number.POSITIVE_INFINITY,d=Number.NEGATIVE_INFINITY,U=!1;t&&null!==l||(l=F*i-(o[0].pts-ye(o[0].dts,o[0].pts)));for(var h=0;h<s;h++){var p=o[h];p.pts=ye(p.pts-j,l),p.dts=ye(p.dts-j,l),p.dts<o[h>0?h-1:h].dts&&(U=!0)}U&&o.sort(function(e,t){var n=e.dts-t.dts,r=e.pts-t.pts;return n||r}),n=o[0].dts;var B=(r=o[o.length-1].dts)-n,g=B?Math.round(B/(s-1)):c||e.inputTimeScale/30;if(t){var v=n-l,H=v>g;if(H||v<-1){H?de.logger.warn("AVC: "+Object(he.toMsFromMpegTsClock)(v,!0)+" ms ("+v+"dts) hole between fragments detected, filling it"):de.logger.warn("AVC: "+Object(he.toMsFromMpegTsClock)(-v,!0)+" ms ("+v+"dts) overlapping between fragments detected"),n=l;var $=o[0].pts-v;o[0].dts=n,o[0].pts=$,de.logger.log("Video: First PTS/DTS adjusted: "+Object(he.toMsFromMpegTsClock)($,!0)+"/"+Object(he.toMsFromMpegTsClock)(n,!0)+", delta: "+Object(he.toMsFromMpegTsClock)(v,!0)+" ms")}}n=Math.max(0,n);for(var G=0,V=0,y=0;y<s;y++){for(var m=o[y],Y=m.units,z=Y.length,b=0,E=0;E<z;E++)b+=Y[E].data.length;V+=b,G+=z,m.length=b,m.dts=Math.max(m.dts,n),f=Math.min(m.pts,f),d=Math.max(m.pts,d)}r=o[s-1].dts;var T,k=V+4*G+8;try{T=new Uint8Array(k)}catch(e){return void this.observer.emit(ce.Events.ERROR,ce.Events.ERROR,{type:fe.ErrorTypes.MUX_ERROR,details:fe.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:k,reason:"fail allocating video mdat "+k})}var K=new DataView(T.buffer);K.setUint32(0,k),T.set(ue.default.types.mdat,4);for(var W=!1,w=Number.POSITIVE_INFINITY,_=Number.POSITIVE_INFINITY,S=Number.NEGATIVE_INFINITY,A=Number.NEGATIVE_INFINITY,P=0;P<s;P++){for(var O=o[P],q=O.units,X=0,C=0,Q=q.length;C<Q;C++){var J=q[C],Z=J.data,L=J.data.byteLength;K.setUint32(u,L),u+=4,T.set(Z,u),u+=L,X+=4+L}var D=void 0;if(P<s-1)c=o[P+1].dts-O.dts,D=o[P+1].pts-O.pts;else{var ee=this.config,x=P>0?O.dts-o[P-1].dts:g;if(D=P>0?O.pts-o[P-1].pts:g,ee.stretchShortVideoTrack&&null!==this.nextAudioPts){var te=Math.floor(ee.maxBufferHole*i),R=(N?f+N*i:this.nextAudioPts)-O.pts;R>te?((c=R-x)<0?c=x:W=!0,de.logger.log("[mp4-remuxer]: It is approximately "+R/90+" ms to the next segment; using duration "+c/90+" ms for the last video frame.")):c=x}else c=x}var ne=Math.round(O.pts-O.dts);w=Math.min(w,c),S=Math.max(S,c),_=Math.min(_,D),A=Math.max(A,D),a.push(new me(O.key,c,X,ne))}if(a.length)if(ge){if(ge<70){var re=a[0].flags;re.dependsOn=2,re.isNonSync=0}}else if(ve&&A-_<S-w&&g/S<.025&&0===a[0].cts){de.logger.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");for(var I=n,M=0,ie=a.length;M<ie;M++){var oe=I+a[M].duration,ae=I+a[M].cts;if(M<ie-1){var se=oe+a[M+1].cts;a[M].duration=se-ae}else a[M].duration=M?a[M-1].duration:g;a[M].cts=0,I=oe}}console.assert(null!==c,"mp4SampleDuration must be computed"),c=W||!c?g:c,this.nextAvcDts=l=r+c,this.videoSampleDuration=c,this.isVideoContiguous=!0;var le={data1:ue.default.moof(e.sequenceNumber++,n,pe({},e,{samples:a})),data2:T,startPTS:f/i,endPTS:(d+c)/i,startDTS:n/i,endDTS:l/i,type:"video",hasAudio:!1,hasVideo:!0,nb:a.length,dropped:e.dropped};return e.samples=[],e.dropped=0,console.assert(T.length,"MDAT length must not be zero"),le},t.remuxAudio=function(e,F,t,n,r){var i=e.inputTimeScale,o=i/(e.samplerate?e.samplerate:i),a="aac"===e.segmentCodec?1024:1152,s=a*o,l=this._initPTS,u="mp3"===e.segmentCodec&&this.typeSupported.mpeg,c=[],f=void 0!==r,d=e.samples,h=u?0:8,p=this.nextAudioPts||-1,g=F*i;if(this.isAudioContiguous=t=t||d.length&&p>0&&(n&&Math.abs(g-p)<9e3||Math.abs(ye(d[0].pts-l,g)-p)<20*s),d.forEach(function(e){e.pts=ye(e.pts-l,g)}),!t||p<0){if(!(d=d.filter(function(e){return e.pts>=0})).length)return;p=0===r?0:n&&!f?Math.max(0,g):d[0].pts}if("aac"===e.segmentCodec)for(var v=this.config.maxAudioFramesDrift,y=0,m=p;y<d.length;y++){var b=d[y],E=b.pts,T=E-m,N=Math.abs(1e3*T/i);if(T<=-v*s&&f)0===y&&(de.logger.warn("Audio frame @ "+(E/i).toFixed(3)+"s overlaps nextAudioPts by "+Math.round(1e3*T/i)+" ms."),this.nextAudioPts=p=m=E);else if(T>=v*s&&N<1e4&&f){var k=Math.round(T/s);(m=E-k*s)<0&&(k--,m+=s),0===y&&(this.nextAudioPts=p=m),de.logger.warn("[mp4-remuxer]: Injecting "+k+" audio frame @ "+(m/i).toFixed(3)+"s due to "+Math.round(1e3*T/i)+" ms gap.");for(var w=0;w<k;w++){var j=Math.max(m,0),_=Y.default.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);_||(de.logger.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),_=b.unit.subarray()),d.splice(y,0,{unit:_,pts:j}),m+=s,y++}}b.pts=m,m+=s}for(var S,A=null,P=null,O=0,C=d.length;C--;)O+=d[C].unit.byteLength;for(var L=0,U=d.length;L<U;L++){var D=d[L],x=D.unit,R=D.pts;if(null!==P){c[L-1].duration=Math.round((R-P)/o)}else{if(t&&"aac"===e.segmentCodec&&(R=p),A=R,!(O>0))return;O+=h;try{S=new Uint8Array(O)}catch(e){return void this.observer.emit(ce.Events.ERROR,ce.Events.ERROR,{type:fe.ErrorTypes.MUX_ERROR,details:fe.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:O,reason:"fail allocating audio mdat "+O})}u||(new DataView(S.buffer).setUint32(0,O),S.set(ue.default.types.mdat,4))}S.set(x,h);var I=x.byteLength;h+=I,c.push(new me(!0,a,I,0)),P=R}var M=c.length;if(M){var B=c[c.length-1];this.nextAudioPts=p=P+o*B.duration;var H=u?new Uint8Array(0):ue.default.moof(e.sequenceNumber++,A/o,pe({},e,{samples:c}));e.samples=[];var $=A/i,G=p/i,V={data1:H,data2:S,startPTS:$,endPTS:G,startDTS:$,endDTS:G,type:"audio",hasAudio:!0,hasVideo:!1,nb:M};return this.isAudioContiguous=!0,console.assert(S.length,"MDAT length must not be zero"),V}},t.remuxEmptyAudio=function(e,t,n,r){var i=e.inputTimeScale,o=i/(e.samplerate?e.samplerate:i),a=this.nextAudioPts,s=(null!==a?a:r.startDTS*i)+this._initDTS,l=r.endDTS*i+this._initDTS,u=1024*o,c=Math.ceil((l-s)/u),f=Y.default.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);if(de.logger.warn("[mp4-remuxer]: remux empty Audio"),f){for(var d=[],h=0;h<c;h++){var p=s+h*u;d.push({unit:f,pts:p,dts:p})}return e.samples=d,this.remuxAudio(e,t,n,!1)}de.logger.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec")},e}();function ye(e,t){var n;if(null===t)return e;for(n=t<e?-8589934592:8589934592;Math.abs(e-t)>4294967296;)e+=n;return e}function C(e,t,n,r){var i=e.samples.length;if(i){for(var o=e.inputTimeScale,a=0;a<i;a++){var s=e.samples[a];s.pts=ye(s.pts-n,t*o)/o,s.dts=ye(s.dts-r,t*o)/o}var l=e.samples;return e.samples=[],{samples:l}}}function L(e,t,n){var r=e.samples.length;if(r){for(var i=e.inputTimeScale,o=0;o<r;o++){var a=e.samples[o];a.pts=ye(a.pts-n,t*i)/i}e.samples.sort(function(e,t){return e.pts-t.pts});var s=e.samples;return e.samples=[],{samples:s}}}var me=function(e,t,n,r){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=t,this.size=n,this.cts=r,this.flags=new i(e)},i=function(e){this.isLeading=0,this.isDependedOn=0,this.hasRedundancy=0,this.degradPrio=0,this.dependsOn=1,this.isNonSync=1,this.dependsOn=e?2:1,this.isNonSync=e?0:1}},"./src/remux/passthrough-remuxer.ts":function(e,t,n){"use strict";n.r(t);var T=n("./src/polyfills/number.ts"),k=n("./src/remux/mp4-remuxer.ts"),w=n("./src/utils/mp4-tools.ts"),o=n("./src/loader/fragment.ts"),_=n("./src/utils/logger.ts"),r=function(){function e(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=void 0,this.initTracks=void 0,this.lastEndTime=null}var t=e.prototype;return t.destroy=function(){},t.resetTimeStamp=function(e){this.initPTS=e,this.lastEndTime=null},t.resetNextTimestamp=function(){this.lastEndTime=null},t.resetInitSegment=function(e,t,n){this.audioCodec=t,this.videoCodec=n,this.generateInitSegment(e),this.emitInitSegment=!0},t.generateInitSegment=function(e){var t=this.audioCodec,n=this.videoCodec;if(!e||!e.byteLength)return this.initTracks=void 0,void(this.initData=void 0);var r=this.initData=Object(w.parseInitSegment)(e);t||(t=a(r.audio,o.ElementaryStreamTypes.AUDIO)),n||(n=a(r.video,o.ElementaryStreamTypes.VIDEO));var i={};r.audio&&r.video?i.audiovideo={container:"video/mp4",codec:t+","+n,initSegment:e,id:"main"}:r.audio?i.audio={container:"audio/mp4",codec:t,initSegment:e,id:"audio"}:r.video?i.video={container:"video/mp4",codec:n,initSegment:e,id:"main"}:_.logger.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=i},t.remux=function(e,t,n,r,i){var o,a=this.initPTS,s=this.lastEndTime,l={audio:void 0,video:void 0,text:r,id3:n,initSegment:void 0};Object(T.isFiniteNumber)(s)||(s=this.lastEndTime=i||0);var u=t.samples;if(!u||!u.length)return l;var c={initPTS:void 0,timescale:1},f=this.initData;if(f&&f.length||(this.generateInitSegment(u),f=this.initData),!f||!f.length)return _.logger.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),l;this.emitInitSegment&&(c.tracks=this.initTracks,this.emitInitSegment=!1);var d=Object(w.getStartDTS)(f,u);Object(T.isFiniteNumber)(a)||(this.initPTS=c.initPTS=a=d-i);var h=Object(w.getDuration)(u,f),p=e?d-a:s,g=p+h;Object(w.offsetStartDTS)(f,u,a),h>0?this.lastEndTime=g:(_.logger.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());var v=!!f.audio,y=!!f.video,m="";v&&(m+="audio"),y&&(m+="video");var b={data1:u,startPTS:p,startDTS:p,endPTS:g,endDTS:g,type:m,hasAudio:v,hasVideo:y,nb:1,dropped:0};l.audio="audio"===b.type?b:void 0,l.video="audio"!==b.type?b:void 0,l.initSegment=c;var E=null!=(o=this.initPTS)?o:0;return l.id3=Object(k.flushTextTrackMetadataCueSamples)(n,i,E,E),r.samples.length&&(l.text=Object(k.flushTextTrackUserdataCueSamples)(r,i,E)),l},e}();function a(e,t){var n=null==e?void 0:e.codec;return n&&n.length>4?n:"hvc1"===n||"hev1"===n?"hvc1.1.c.L120.90":"av01"===n?"av01.0.04M.08":"avc1"===n||t===o.ElementaryStreamTypes.VIDEO?"avc1.42e01e":"mp4a.40.5"}t.default=r},"./src/task-loop.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return r});var r=function(){function e(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}var t=e.prototype;return t.destroy=function(){this.onHandlerDestroying(),this.onHandlerDestroyed()},t.onHandlerDestroying=function(){this.clearNextTick(),this.clearInterval()},t.onHandlerDestroyed=function(){},t.hasInterval=function(){return!!this._tickInterval},t.hasNextTick=function(){return!!this._tickTimer},t.setInterval=function(e){return!this._tickInterval&&(this._tickInterval=self.setInterval(this._boundTick,e),!0)},t.clearInterval=function(){return!!this._tickInterval&&(self.clearInterval(this._tickInterval),this._tickInterval=null,!0)},t.clearNextTick=function(){return!!this._tickTimer&&(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0)},t.tick=function(){this._tickCallCount++,1===this._tickCallCount&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)},t.tickImmediate=function(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)},t.doTick=function(){},e}()},"./src/types/cmcd.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"CMCDVersion",function(){return a}),n.d(t,"CMCDObjectType",function(){return r}),n.d(t,"CMCDStreamingFormat",function(){return i}),n.d(t,"CMCDStreamType",function(){return o});var r,i,o,a=1;!function(e){e.MANIFEST="m",e.AUDIO="a",e.VIDEO="v",e.MUXED="av",e.INIT="i",e.CAPTION="c",e.TIMED_TEXT="tt",e.KEY="k",e.OTHER="o"}(r||(r={})),function(e){e.DASH="d",e.HLS="h",e.SMOOTH="s",e.OTHER="o"}(i||(i={})),function(e){e.VOD="v",e.LIVE="l"}(o||(o={}))},"./src/types/demuxer.ts":function(e,t,n){"use strict";var r;n.r(t),n.d(t,"MetadataSchema",function(){return r}),function(e){e.audioId3="org.id3",e.dateRange="com.apple.quicktime.HLS",e.emsg="https://aomedia.org/emsg/ID3"}(r||(r={}))},"./src/types/level.ts":function(e,t,n){"use strict";function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o;function r(e,t){var n=e.canSkipUntil,r=e.canSkipDateRanges,i=e.endSN;return n&&(void 0!==t?t-i:0)<n?r?o.v2:o.Yes:o.No}n.r(t),n.d(t,"HlsSkip",function(){return o}),n.d(t,"getSkipValue",function(){return r}),n.d(t,"HlsUrlParameters",function(){return a}),n.d(t,"Level",function(){return s}),function(e){e.No="",e.Yes="YES",e.v2="v2"}(o||(o={}));var a=function(){function e(e,t,n){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=e,this.part=t,this.skip=n}return e.prototype.addDirectives=function(e){var t=new self.URL(e);return void 0!==this.msn&&t.searchParams.set("_HLS_msn",this.msn.toString()),void 0!==this.part&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.toString()},e}(),s=function(){function e(e){this.attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.unknownCodecs=void 0,this.audioGroupIds=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.textGroupIds=void 0,this.url=void 0,this._urlId=0,this.url=[e.url],this.attrs=e.attrs,this.bitrate=e.bitrate,e.details&&(this.details=e.details),this.id=e.id||0,this.name=e.name,this.width=e.width||0,this.height=e.height||0,this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.unknownCodecs=e.unknownCodecs,this.codecSet=[e.videoCodec,e.audioCodec].filter(function(e){return e}).join(",").replace(/\.[^.,]+/g,"")}var t,n,r;return t=e,(n=[{key:"maxBitrate",get:function(){return Math.max(this.realBitrate,this.bitrate)}},{key:"uri",get:function(){return this.url[this._urlId]||""}},{key:"urlId",get:function(){return this._urlId},set:function(e){var t=e%this.url.length;this._urlId!==t&&(this.details=void 0,this._urlId=t)}}])&&i(t.prototype,n),r&&i(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}()},"./src/types/loader.ts":function(e,t,n){"use strict";var r,i;n.r(t),n.d(t,"PlaylistContextType",function(){return r}),n.d(t,"PlaylistLevelType",function(){return i}),function(e){e.MANIFEST="manifest",e.LEVEL="level",e.AUDIO_TRACK="audioTrack",e.SUBTITLE_TRACK="subtitleTrack"}(r||(r={})),function(e){e.MAIN="main",e.AUDIO="audio",e.SUBTITLE="subtitle"}(i||(i={}))},"./src/types/transmuxer.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"ChunkMetadata",function(){return r});var r=function(e,t,n,r,i,o){void 0===r&&(r=0),void 0===i&&(i=-1),void 0===o&&(o=!1),this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing={start:0,executeStart:0,executeEnd:0,end:0},this.buffering={audio:{start:0,executeStart:0,executeEnd:0,end:0},video:{start:0,executeStart:0,executeEnd:0,end:0},audiovideo:{start:0,executeStart:0,executeEnd:0,end:0}},this.level=e,this.sn=t,this.id=n,this.size=r,this.part=i,this.partial=o}},"./src/utils/attr-list.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"AttrList",function(){return o});var r=/^(\d+)x(\d+)$/,i=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,o=function(){function n(e){for(var t in"string"==typeof e&&(e=n.parseAttrList(e)),e)e.hasOwnProperty(t)&&(this[t]=e[t])}var e=n.prototype;return e.decimalInteger=function(e){var t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t},e.hexadecimalInteger=function(e){if(this[e]){var t=(this[e]||"0x").slice(2);t=(1&t.length?"0":"")+t;for(var n=new Uint8Array(t.length/2),r=0;r<t.length/2;r++)n[r]=parseInt(t.slice(2*r,2*r+2),16);return n}return null},e.hexadecimalIntegerAsNumber=function(e){var t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t},e.decimalFloatingPoint=function(e){return parseFloat(this[e])},e.optionalFloat=function(e,t){var n=this[e];return n?parseFloat(n):t},e.enumeratedString=function(e){return this[e]},e.bool=function(e){return"YES"===this[e]},e.decimalResolution=function(e){var t=r.exec(this[e]);if(null!==t)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}},n.parseAttrList=function(e){var t,n={};for(i.lastIndex=0;null!==(t=i.exec(e));){var r=t[2];0===r.indexOf('"')&&r.lastIndexOf('"')===r.length-1&&(r=r.slice(1,-1)),n[t[1]]=r}return n},n}()},"./src/utils/binary-search.ts":function(e,t,n){"use strict";n.r(t);t.default={search:function(e,t){for(var n=0,r=e.length-1,i=null,o=null;n<=r;){var a=t(o=e[i=(n+r)/2|0]);if(a>0)n=i+1;else{if(!(a<0))return o;r=i-1}}return null}}},"./src/utils/buffer-helper.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"BufferHelper",function(){return o});var r=n("./src/utils/logger.ts"),i={length:0,start:function(){return 0},end:function(){return 0}},o=function(){function a(){}return a.isBuffered=function(e,t){try{if(e)for(var n=a.getBuffered(e),r=0;r<n.length;r++)if(t>=n.start(r)&&t<=n.end(r))return!0}catch(e){}return!1},a.bufferInfo=function(e,t,n){try{if(e){var r,i=a.getBuffered(e),o=[];for(r=0;r<i.length;r++)o.push({start:i.start(r),end:i.end(r)});return this.bufferedInfo(o,t,n)}}catch(e){}return{len:0,start:t,end:t,nextStart:void 0}},a.bufferedInfo=function(e,t,n){t=Math.max(0,t),e.sort(function(e,t){var n=e.start-t.start;return n||t.end-e.end});var r=[];if(n)for(var i=0;i<e.length;i++){var o=r.length;if(o){var a=r[o-1].end;e[i].start-a<n?e[i].end>a&&(r[o-1].end=e[i].end):r.push(e[i])}else r.push(e[i])}else r=e;for(var s,l=0,u=t,c=t,f=0;f<r.length;f++){var d=r[f].start,h=r[f].end;if(t+n>=d&&t<h)u=d,l=(c=h)-t;else if(t+n<d){s=d;break}}return{len:l,start:u||0,end:c||0,nextStart:s}},a.getBuffered=function(e){try{return e.buffered}catch(e){return r.logger.log("failed to get media.buffered",e),i}},a}()},"./src/utils/cea-608-parser.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"Row",function(){return m}),n.d(t,"CaptionScreen",function(){return b});var d,r=n("./src/utils/logger.ts"),i={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},s=function(e){var t=e;return i.hasOwnProperty(e)&&(t=i[e]),String.fromCharCode(t)},h=15,o=100,a={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},l={17:2,18:4,21:6,22:8,23:10,19:13,20:15},u={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},c={25:2,26:4,29:6,30:8,31:10,27:13,28:15},f=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];!function(e){e[e.ERROR=0]="ERROR",e[e.TEXT=1]="TEXT",e[e.WARNING=2]="WARNING",e[e.INFO=2]="INFO",e[e.DEBUG=3]="DEBUG",e[e.DATA=3]="DATA"}(d||(d={}));var p=function(){function e(){this.time=null,this.verboseLevel=d.ERROR}return e.prototype.log=function(e,t){this.verboseLevel>=e&&r.logger.log(this.time+" ["+e+"] "+t)},e}(),g=function(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n].toString(16));return t},v=function(){function e(e,t,n,r,i){this.foreground=void 0,this.underline=void 0,this.italics=void 0,this.background=void 0,this.flash=void 0,this.foreground=e||"white",this.underline=t||!1,this.italics=n||!1,this.background=r||"black",this.flash=i||!1}var t=e.prototype;return t.reset=function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},t.setStyles=function(e){for(var t=["foreground","underline","italics","background","flash"],n=0;n<t.length;n++){var r=t[n];e.hasOwnProperty(r)&&(this[r]=e[r])}},t.isDefault=function(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash},t.equals=function(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash},t.copy=function(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash},t.toString=function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash},e}(),y=function(){function e(e,t,n,r,i,o){this.uchar=void 0,this.penState=void 0,this.uchar=e||" ",this.penState=new v(t,n,r,i,o)}var t=e.prototype;return t.reset=function(){this.uchar=" ",this.penState.reset()},t.setChar=function(e,t){this.uchar=e,this.penState.copy(t)},t.setPenState=function(e){this.penState.copy(e)},t.equals=function(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)},t.copy=function(e){this.uchar=e.uchar,this.penState.copy(e.penState)},t.isEmpty=function(){return" "===this.uchar&&this.penState.isDefault()},e}(),m=function(){function e(e){this.chars=void 0,this.pos=void 0,this.currPenState=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chars=[];for(var t=0;t<o;t++)this.chars.push(new y);this.logger=e,this.pos=0,this.currPenState=new v}var t=e.prototype;return t.equals=function(e){for(var t=!0,n=0;n<o;n++)if(!this.chars[n].equals(e.chars[n])){t=!1;break}return t},t.copy=function(e){for(var t=0;t<o;t++)this.chars[t].copy(e.chars[t])},t.isEmpty=function(){for(var e=!0,t=0;t<o;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e},t.setCursor=function(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(d.DEBUG,"Negative cursor position "+this.pos),this.pos=0):this.pos>o&&(this.logger.log(d.DEBUG,"Too large cursor position "+this.pos),this.pos=o)},t.moveCursor=function(e){var t=this.pos+e;if(e>1)for(var n=this.pos+1;n<t+1;n++)this.chars[n].setPenState(this.currPenState);this.setCursor(t)},t.backSpace=function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},t.insertChar=function(e){e>=144&&this.backSpace();var t=s(e);this.pos>=o?this.logger.log(d.ERROR,"Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!"):(this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1))},t.clearFromPos=function(e){var t;for(t=e;t<o;t++)this.chars[t].reset()},t.clear=function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},t.clearToEndOfRow=function(){this.clearFromPos(this.pos)},t.getTextString=function(){for(var e=[],t=!0,n=0;n<o;n++){var r=this.chars[n].uchar;" "!==r&&(t=!1),e.push(r)}return t?"":e.join("")},t.setPenStyles=function(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)},e}(),b=function(){function e(e){this.rows=void 0,this.currRow=void 0,this.nrRollUpRows=void 0,this.lastOutputScreen=void 0,this.logger=void 0,this.rows=[];for(var t=0;t<h;t++)this.rows.push(new m(e));this.logger=e,this.currRow=h-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.reset()}var t=e.prototype;return t.reset=function(){for(var e=0;e<h;e++)this.rows[e].clear();this.currRow=h-1},t.equals=function(e){for(var t=!0,n=0;n<h;n++)if(!this.rows[n].equals(e.rows[n])){t=!1;break}return t},t.copy=function(e){for(var t=0;t<h;t++)this.rows[t].copy(e.rows[t])},t.isEmpty=function(){for(var e=!0,t=0;t<h;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e},t.backSpace=function(){this.rows[this.currRow].backSpace()},t.clearToEndOfRow=function(){this.rows[this.currRow].clearToEndOfRow()},t.insertChar=function(e){this.rows[this.currRow].insertChar(e)},t.setPen=function(e){this.rows[this.currRow].setPenStyles(e)},t.moveCursor=function(e){this.rows[this.currRow].moveCursor(e)},t.setCursor=function(e){this.logger.log(d.INFO,"setCursor: "+e),this.rows[this.currRow].setCursor(e)},t.setPAC=function(e){this.logger.log(d.INFO,"pacData = "+JSON.stringify(e));var t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(var n=0;n<h;n++)this.rows[n].clear();var r=this.currRow+1-this.nrRollUpRows,i=this.lastOutputScreen;if(i){var o=i.rows[r].cueStartTime,a=this.logger.time;if(o&&null!==a&&o<a)for(var s=0;s<this.nrRollUpRows;s++)this.rows[t-this.nrRollUpRows+s+1].copy(i.rows[r+s])}}this.currRow=t;var l=this.rows[this.currRow];if(null!==e.indent){var u=e.indent,c=Math.max(u-1,0);l.setCursor(e.indent),e.color=l.chars[c].penState.foreground}var f={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(f)},t.setBkgData=function(e){this.logger.log(d.INFO,"bkgData = "+JSON.stringify(e)),this.backSpace(),this.setPen(e),this.insertChar(32)},t.setRollUpRows=function(e){this.nrRollUpRows=e},t.rollUp=function(){if(null!==this.nrRollUpRows){this.logger.log(d.TEXT,this.getDisplayText());var e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),this.logger.log(d.INFO,"Rolling up")}else this.logger.log(d.DEBUG,"roll_up but nrRollUpRows not set yet")},t.getDisplayText=function(e){e=e||!1;for(var t=[],n="",r=-1,i=0;i<h;i++){var o=this.rows[i].getTextString();o&&(r=i+1,e?t.push("Row "+r+": '"+o+"'"):t.push(o.trim()))}return t.length>0&&(n=e?"["+t.join(" | ")+"]":t.join("\n")),n},t.getTextAndFormat=function(){return this.rows},e}(),E=function(){function e(e,t,n){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new b(n),this.nonDisplayedMemory=new b(n),this.lastOutputScreen=new b(n),this.currRollUpRow=this.displayedMemory.rows[h-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=n}var t=e.prototype;return t.reset=function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[h-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null},t.getHandler=function(){return this.outputFilter},t.setHandler=function(e){this.outputFilter=e},t.setPAC=function(e){this.writeScreen.setPAC(e)},t.setBkgData=function(e){this.writeScreen.setBkgData(e)},t.setMode=function(e){e!==this.mode&&(this.mode=e,this.logger.log(d.INFO,"MODE="+e),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)},t.insertChars=function(e){for(var t=0;t<e.length;t++)this.writeScreen.insertChar(e[t]);var n=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(d.INFO,n+": "+this.writeScreen.getDisplayText(!0)),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(this.logger.log(d.TEXT,"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},t.ccRCL=function(){this.logger.log(d.INFO,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},t.ccBS=function(){this.logger.log(d.INFO,"BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},t.ccAOF=function(){},t.ccAON=function(){},t.ccDER=function(){this.logger.log(d.INFO,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},t.ccRU=function(e){this.logger.log(d.INFO,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)},t.ccFON=function(){this.logger.log(d.INFO,"FON - Flash On"),this.writeScreen.setPen({flash:!0})},t.ccRDC=function(){this.logger.log(d.INFO,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},t.ccTR=function(){this.logger.log(d.INFO,"TR"),this.setMode("MODE_TEXT")},t.ccRTD=function(){this.logger.log(d.INFO,"RTD"),this.setMode("MODE_TEXT")},t.ccEDM=function(){this.logger.log(d.INFO,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)},t.ccCR=function(){this.logger.log(d.INFO,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)},t.ccENM=function(){this.logger.log(d.INFO,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},t.ccEOC=function(){if(this.logger.log(d.INFO,"EOC - End Of Caption"),"MODE_POP-ON"===this.mode){var e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,this.logger.log(d.TEXT,"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)},t.ccTO=function(e){this.logger.log(d.INFO,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)},t.ccMIDROW=function(e){var t={flash:!1};if(t.underline=e%2==1,t.italics=e>=46,t.italics)t.foreground="white";else{var n=Math.floor(e/2)-16;t.foreground=["white","green","blue","cyan","red","yellow","magenta"][n]}this.logger.log(d.INFO,"MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)},t.outputDataUpdate=function(e){void 0===e&&(e=!1);var t=this.logger.time;null!==t&&this.outputFilter&&(null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t):this.cueStartTime=t,this.lastOutputScreen.copy(this.displayedMemory))},t.cueSplitAtTime=function(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))},e}(),T=function(){function e(e,t,n){this.channels=void 0,this.currentChannel=0,this.cmdHistory=void 0,this.logger=void 0;var r=new p;this.channels=[null,new E(e,t,r),new E(e+1,n,r)],this.cmdHistory={a:null,b:null},this.logger=r}var t=e.prototype;return t.getHandler=function(e){return this.channels[e].getHandler()},t.setHandler=function(e,t){this.channels[e].setHandler(t)},t.addData=function(e,t){var n,r,i,o=!1;this.logger.time=e;for(var a=0;a<t.length;a+=2)if(r=127&t[a],i=127&t[a+1],0!==r||0!==i){if(this.logger.log(d.DATA,"["+g([t[a],t[a+1]])+"] -> ("+g([r,i])+")"),(n=this.parseCmd(r,i))||(n=this.parseMidrow(r,i)),n||(n=this.parsePAC(r,i)),n||(n=this.parseBackgroundAttributes(r,i)),!n&&(o=this.parseChars(r,i))){var s=this.currentChannel;if(s&&s>0)this.channels[s].insertChars(o);else this.logger.log(d.WARNING,"No channel found yet. TEXT-MODE?")}n||o||this.logger.log(d.WARNING,"Couldn't parse cleaned data "+g([r,i])+" orig: "+g([t[a],t[a+1]]))}},t.parseCmd=function(e,t){var n=this.cmdHistory;if(!((20===e||28===e||21===e||29===e)&&t>=32&&t<=47)&&!((23===e||31===e)&&t>=33&&t<=35))return!1;if(w(e,t,n))return k(null,null,n),this.logger.log(d.DEBUG,"Repeated command ("+g([e,t])+") is dropped"),!0;var r=20===e||21===e||23===e?1:2,i=this.channels[r];return 20===e||21===e||28===e||29===e?32===t?i.ccRCL():33===t?i.ccBS():34===t?i.ccAOF():35===t?i.ccAON():36===t?i.ccDER():37===t?i.ccRU(2):38===t?i.ccRU(3):39===t?i.ccRU(4):40===t?i.ccFON():41===t?i.ccRDC():42===t?i.ccTR():43===t?i.ccRTD():44===t?i.ccEDM():45===t?i.ccCR():46===t?i.ccENM():47===t&&i.ccEOC():i.ccTO(t-32),k(e,t,n),this.currentChannel=r,!0},t.parseMidrow=function(e,t){var n=0;if((17===e||25===e)&&t>=32&&t<=47){if((n=17===e?1:2)!==this.currentChannel)return this.logger.log(d.ERROR,"Mismatch channel in midrow parsing"),!1;var r=this.channels[n];return!!r&&(r.ccMIDROW(t),this.logger.log(d.DEBUG,"MIDROW ("+g([e,t])+")"),!0)}return!1},t.parsePAC=function(e,t){var n,r=this.cmdHistory;if(!((e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127)&&!((16===e||24===e)&&t>=64&&t<=95))return!1;if(w(e,t,r))return k(null,null,r),!0;var i=e<=23?1:2;n=t>=64&&t<=95?1===i?a[e]:u[e]:1===i?l[e]:c[e];var o=this.channels[i];return!!o&&(o.setPAC(this.interpretPAC(n,t)),k(e,t,r),this.currentChannel=i,!0)},t.interpretPAC=function(e,t){var n,r={color:null,italics:!1,indent:null,underline:!1,row:e};return n=t>95?t-96:t-64,r.underline=1==(1&n),n<=13?r.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(n/2)]:n<=15?(r.italics=!0,r.color="white"):r.indent=4*Math.floor((n-16)/2),r},t.parseChars=function(e,t){var n,r,i=null,o=null;(e>=25?(n=2,o=e-8):(n=1,o=e),o>=17&&o<=19)?(r=17===o?t+80:18===o?t+112:t+144,this.logger.log(d.INFO,"Special char '"+s(r)+"' in channel "+n),i=[r]):e>=32&&e<=127&&(i=0===t?[e]:[e,t]);if(i){var a=g(i);this.logger.log(d.DEBUG,"Char codes =  "+a.join(",")),k(e,t,this.cmdHistory)}return i},t.parseBackgroundAttributes=function(e,t){var n;if(!((16===e||24===e)&&t>=32&&t<=47)&&!((23===e||31===e)&&t>=45&&t<=47))return!1;var r={};16===e||24===e?(n=Math.floor((t-32)/2),r.background=f[n],t%2==1&&(r.background=r.background+"_semi")):45===t?r.background="transparent":(r.foreground="black",47===t&&(r.underline=!0));var i=e<=23?1:2;return this.channels[i].setBkgData(r),k(e,t,this.cmdHistory),!0},t.reset=function(){for(var e=0;e<Object.keys(this.channels).length;e++){var t=this.channels[e];t&&t.reset()}this.cmdHistory={a:null,b:null}},t.cueSplitAtTime=function(e){for(var t=0;t<this.channels.length;t++){var n=this.channels[t];n&&n.cueSplitAtTime(e)}},e}();function k(e,t,n){n.a=e,n.b=t}function w(e,t,n){return n.a===e&&n.b===t}t.default=T},"./src/utils/codecs.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"isCodecType",function(){return i}),n.d(t,"isCodecSupportedInMp4",function(){return o});var r={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,av01:!0,drac:!0,dva1:!0,dvav:!0,dvh1:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0},text:{stpp:!0,wvtt:!0}};function i(e,t){var n=r[t];return!!n&&!0===n[e.slice(0,4)]}function o(e,t){return MediaSource.isTypeSupported((t||"video")+'/mp4;codecs="'+e+'"')}},"./src/utils/cues.ts":function(e,t,n){"use strict";n.r(t);var g=n("./src/utils/vttparser.ts"),v=n("./src/utils/webvtt-parser.ts"),y=n("./src/utils/texttrack-utils.ts"),m=/\s/,r={newCue:function(t,e,n,r){for(var i,o,a,s,l,u=[],c=self.VTTCue||self.TextTrackCue,f=0;f<r.rows.length;f++)if(a=!0,s=0,l="",!(i=r.rows[f]).isEmpty()){for(var d=0;d<i.chars.length;d++)m.test(i.chars[d].uchar)&&a?s++:(l+=i.chars[d].uchar,a=!1);i.cueStartTime=e,e===n&&(n+=1e-4),s>=16?s--:s++;var h=Object(g.fixLineBreaks)(l.trim()),p=Object(v.generateCueId)(e,n,h);t&&t.cues&&t.cues.getCueById(p)||((o=new c(e,n,h)).id=p,o.line=f+1,o.align="left",o.position=10+Math.min(80,10*Math.floor(8*s/32)),u.push(o))}return t&&u.length&&(u.sort(function(e,t){return"auto"===e.line||"auto"===t.line?0:e.line>8&&t.line>8?t.line-e.line:e.line-t.line}),u.forEach(function(e){return Object(y.addCueToTrack)(t,e)})),u}};t.default=r},"./src/utils/discontinuities.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"findFirstFragWithCC",function(){return s}),n.d(t,"shouldAlignOnDiscontinuities",function(){return i}),n.d(t,"findDiscontinuousReferenceFrag",function(){return l}),n.d(t,"adjustSlidingStart",function(){return c}),n.d(t,"alignStream",function(){return f}),n.d(t,"alignPDT",function(){return d}),n.d(t,"alignFragmentByPDTDelta",function(){return h}),n.d(t,"alignMediaPlaylistByPDT",function(){return p});var o=n("./src/polyfills/number.ts"),a=n("./src/utils/logger.ts"),r=n("./src/controller/level-helper.ts");function s(e,t){for(var n=null,r=0,i=e.length;r<i;r++){var o=e[r];if(o&&o.cc===t){n=o;break}}return n}function i(e,t,n){return!(!t.details||!(n.endCC>n.startCC||e&&e.cc<n.startCC))}function l(e,t){var n=e.fragments,r=t.fragments;if(r.length&&n.length){var i=s(n,r[0].cc);if(i&&(!i||i.startPTS))return i;a.logger.log("No frag in previous level to align on")}else a.logger.log("No fragments to align")}function u(e,t){if(e){var n=e.start+t;e.start=e.startPTS=n,e.endPTS=n+e.duration}}function c(e,t){for(var n=t.fragments,r=0,i=n.length;r<i;r++)u(n[r],e);t.fragmentHint&&u(t.fragmentHint,e),t.alignedSliding=!0}function f(e,t,n){t&&(!function(e,t,n){if(i(e,n,t)){var r=l(n.details,t);r&&Object(o.isFiniteNumber)(r.start)&&(a.logger.log("Adjusting PTS using last level due to CC increase within current level "+t.url),c(r.start,t))}}(e,n,t),!n.alignedSliding&&t.details&&d(n,t.details),n.alignedSliding||!t.details||n.skippedSegments||Object(r.adjustSliding)(t.details,n))}function d(e,t){if(t.fragments.length&&e.hasProgramDateTime&&t.hasProgramDateTime){var n=t.fragments[0].programDateTime,r=e.fragments[0].programDateTime,i=(r-n)/1e3+t.fragments[0].start;i&&Object(o.isFiniteNumber)(i)&&(a.logger.log("Adjusting PTS using programDateTime delta "+(r-n)+"ms, sliding:"+i.toFixed(3)+" "+e.url+" "),c(i,e))}}function h(e,t){var n=e.programDateTime;if(n){var r=(n-t)/1e3;e.start=e.startPTS=r,e.endPTS=r+e.duration}}function p(e,t){if(t.fragments.length&&e.hasProgramDateTime&&t.hasProgramDateTime){var n=t.fragments[0].programDateTime-1e3*t.fragments[0].start;e.fragments.forEach(function(e){h(e,n)}),e.fragmentHint&&h(e.fragmentHint,n),e.alignedSliding=!0}}},"./src/utils/ewma-bandwidth-estimator.ts":function(e,t,n){"use strict";n.r(t);var i=n("./src/utils/ewma.ts"),r=function(){function e(e,t,n){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultEstimate_=n,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new i.default(e),this.fast_=new i.default(t)}var t=e.prototype;return t.update=function(e,t){var n=this.slow_,r=this.fast_;this.slow_.halfLife!==e&&(this.slow_=new i.default(e,n.getEstimate(),n.getTotalWeight())),this.fast_.halfLife!==t&&(this.fast_=new i.default(t,r.getEstimate(),r.getTotalWeight()))},t.sample=function(e,t){var n=(e=Math.max(e,this.minDelayMs_))/1e3,r=8*t/n;this.fast_.sample(n,r),this.slow_.sample(n,r)},t.canEstimate=function(){var e=this.fast_;return e&&e.getTotalWeight()>=this.minWeight_},t.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},t.destroy=function(){},e}();t.default=r},"./src/utils/ewma.ts":function(e,t,n){"use strict";n.r(t);var r=function(){function e(e,t,n){void 0===t&&(t=0),void 0===n&&(n=0),this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=e,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=t,this.totalWeight_=n}var t=e.prototype;return t.sample=function(e,t){var n=Math.pow(this.alpha_,e);this.estimate_=t*(1-n)+n*this.estimate_,this.totalWeight_+=e},t.getTotalWeight=function(){return this.totalWeight_},t.getEstimate=function(){if(this.alpha_){var e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_},e}();t.default=r},"./src/utils/fetch-loader.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"fetchSupported",function(){return l});var f=n("./src/polyfills/number.ts"),r=n("./src/loader/load-stats.ts"),c=n("./src/demux/chunk-cache.ts");function i(e){var r="function"==typeof Map?new Map:void 0;return(i=function(e){if(null===e||(t=e,-1===Function.toString.call(t).indexOf("[native code]")))return e;var t;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==r){if(r.has(e))return r.get(e);r.set(e,n)}function n(){return o(e,arguments,s(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),a(n,e)})(e)}function o(e,t,n){return(o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&a(i,n.prototype),i}).apply(null,arguments)}function a(e,t){return(a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(){return(d=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function l(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch(e){}return!1}var u=function(){function e(e){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=void 0,this.response=void 0,this.controller=void 0,this.context=void 0,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=e.fetchSetup||h,this.controller=new self.AbortController,this.stats=new r.LoadStats}var t=e.prototype;return t.destroy=function(){this.loader=this.callbacks=null,this.abortInternal()},t.abortInternal=function(){var e=this.response;e&&e.ok||(this.stats.aborted=!0,this.controller.abort())},t.abort=function(){var e;this.abortInternal(),null!==(e=this.callbacks)&&void 0!==e&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)},t.load=function(r,i,o){var a=this,s=this.stats;if(s.loading.start)throw new Error("Loader can only be used once.");s.loading.start=self.performance.now();var e=function(e,t){var n={method:"GET",mode:"cors",credentials:"same-origin",signal:t,headers:new self.Headers(d({},e.headers))};e.rangeEnd&&n.headers.set("Range","bytes="+e.rangeStart+"-"+String(e.rangeEnd-1));return n}(r,this.controller.signal),l=o.onProgress,u="arraybuffer"===r.responseType,c=u?"byteLength":"length";this.context=r,this.config=i,this.callbacks=o,this.request=this.fetchSetup(r,e),self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(function(){a.abortInternal(),o.onTimeout(s,r,a.response)},i.timeout),self.fetch(this.request).then(function(e){if(a.response=a.loader=e,!e.ok){var t=e.status,n=e.statusText;throw new p(n||"fetch, bad network response",t,e)}return s.loading.first=Math.max(self.performance.now(),s.loading.start),s.total=parseInt(e.headers.get("Content-Length")||"0"),l&&Object(f.isFiniteNumber)(i.highWaterMark)?a.loadProgressively(e,s,r,i.highWaterMark,l):u?e.arrayBuffer():e.text()}).then(function(e){var t=a.response;self.clearTimeout(a.requestTimeout),s.loading.end=Math.max(self.performance.now(),s.loading.first),s.loaded=s.total=e[c];var n={url:t.url,data:e};l&&!Object(f.isFiniteNumber)(i.highWaterMark)&&l(s,r,e,t),o.onSuccess(n,s,r,t)}).catch(function(e){if(self.clearTimeout(a.requestTimeout),!s.aborted){var t=e&&e.code||0,n=e?e.message:null;o.onError({code:t,text:n},r,e?e.details:null)}})},t.getCacheAge=function(){var e=null;if(this.response){var t=this.response.headers.get("age");e=t?parseFloat(t):null}return e},t.loadProgressively=function(i,o,a,s,l){void 0===s&&(s=0);var u=new c.default,e=i.body.getReader();return function r(){return e.read().then(function(e){if(e.done)return u.dataLength&&l(o,a,u.flush(),i),Promise.resolve(new ArrayBuffer(0));var t=e.value,n=t.length;return o.loaded+=n,n<s||u.dataLength?(u.push(t),u.dataLength>=s&&l(o,a,u.flush(),i)):l(o,a,t,i),r()}).catch(function(){return Promise.reject()})}()},e}();function h(e,t){return new self.Request(e.url,t)}var p=function(i){var e,t;function n(e,t,n){var r;return(r=i.call(this,e)||this).code=void 0,r.details=void 0,r.code=t,r.details=n,r}return t=i,(e=n).prototype=Object.create(t.prototype),e.prototype.constructor=e,a(e,t),n}(i(Error));t.default=u},"./src/utils/imsc1-ttml-parser.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"IMSC1_CODEC",function(){return i}),n.d(t,"parseIMSC1",function(){return s});var l=n("./src/utils/mp4-tools.ts"),r=n("./src/utils/vttparser.ts"),v=n("./src/utils/vttcue.ts"),u=n("./src/demux/id3.ts"),c=n("./src/utils/timescale-conversion.ts"),y=n("./src/utils/webvtt-parser.ts");function m(){return(m=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var i="stpp.ttml.im1t",o=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,a=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,b={left:"start",center:"center",right:"end",start:"start",end:"end"};function s(e,t,n,r,i){var o=Object(l.findBox)(new Uint8Array(e),["mdat"]);if(0!==o.length){var a=o.map(function(e){return Object(u.utf8ArrayToStr)(e)}),s=Object(c.toTimescaleFromScale)(t,1,n);try{a.forEach(function(e){return r(function(e,f){var n=(new DOMParser).parseFromString(e,"text/xml").getElementsByTagName("tt")[0];if(!n)throw new Error("Invalid ttml");var r={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},d=Object.keys(r).reduce(function(e,t){return e[t]=n.getAttribute("ttp:"+t)||r[t],e},{}),h="preserve"!==n.getAttribute("xml:space"),p=T(E(n,"styling","style")),g=T(E(n,"layout","region")),t=E(n,"body","[begin]");return[].map.call(t,function(e){var t=function i(e,o){return[].slice.call(e.childNodes).reduce(function(e,t,n){var r;return"br"===t.nodeName&&n?e+"\n":null!==(r=t.childNodes)&&void 0!==r&&r.length?i(t,o):o?e+t.textContent.trim().replace(/\s+/g," "):e+t.textContent},"")}(e,h);if(!t||!e.hasAttribute("begin"))return null;var n=_(e.getAttribute("begin"),d),r=_(e.getAttribute("dur"),d),i=_(e.getAttribute("end"),d);if(null===n)throw w(e);if(null===i){if(null===r)throw w(e);i=n+r}var o=new v.default(n-f,i-f,t);o.id=Object(y.generateCueId)(o.startTime,o.endTime,o.text);var a=g[e.getAttribute("region")],s=p[e.getAttribute("style")];o.position=10,o.size=80;var l=function(r,i,e){var o="http://www.w3.org/ns/ttml#styling",a=null,t=null!=r&&r.hasAttribute("style")?r.getAttribute("style"):null;t&&e.hasOwnProperty(t)&&(a=e[t]);return["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"].reduce(function(e,t){var n=k(i,o,t)||k(r,o,t)||k(a,o,t);return n&&(e[t]=n),e},{})}(a,s,p),u=l.textAlign;if(u){var c=b[u];c&&(o.lineAlign=c),o.align=u}return m(o,l),o}).filter(function(e){return null!==e})}(e,s))})}catch(e){i(e)}}else i(new Error("Could not parse IMSC1 mdat"))}function E(e,t,n){var r=e.getElementsByTagName(t)[0];return r?[].slice.call(r.querySelectorAll(n)):[]}function T(e){return e.reduce(function(e,t){var n=t.getAttribute("xml:id");return n&&(e[n]=t),e},{})}function k(e,t,n){return e&&e.hasAttributeNS(t,n)?e.getAttributeNS(t,n):null}function w(e){return new Error("Could not parse ttml timestamp "+e)}function _(e,t){if(!e)return null;var n=Object(r.parseTimeStamp)(e);return null===n&&(o.test(e)?n=function(e,t){var n=o.exec(e),r=(0|n[4])+(0|n[5])/t.subFrameRate;return 3600*(0|n[1])+60*(0|n[2])+(0|n[3])+r/t.frameRate}(e,t):a.test(e)&&(n=function(e,t){var n=a.exec(e),r=Number(n[1]);switch(n[2]){case"h":return 3600*r;case"m":return 60*r;case"ms":return 1e3*r;case"f":return r/t.frameRate;case"t":return r/t.tickRate}return r}(e,t))),n}},"./src/utils/logger.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"enableLogs",function(){return s}),n.d(t,"logger",function(){return l});var i=function(){},r={trace:i,debug:i,log:i,warn:i,info:i,error:i},o=r;function a(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];n.forEach(function(e){o[e]=t[e]?t[e].bind(t):function(e){var t=self.console[e];return t?t.bind(self.console,"["+e+"] >"):i}(e)})}function s(e){if(self.console&&!0===e||"object"==typeof e){a(e,"debug","log","info","warn","error");try{o.log()}catch(e){o=r}}else o=r}var l=r},"./src/utils/mediakeys-helper.ts":function(e,t,n){"use strict";var r;n.r(t),n.d(t,"KeySystems",function(){return r}),n.d(t,"requestMediaKeySystemAccess",function(){return i}),function(e){e.WIDEVINE="com.widevine.alpha",e.PLAYREADY="com.microsoft.playready"}(r||(r={}));var i="undefined"!=typeof self&&self.navigator&&self.navigator.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null},"./src/utils/mediasource-helper.ts":function(e,t,n){"use strict";function r(){return self.MediaSource||self.WebKitMediaSource}n.r(t),n.d(t,"getMediaSource",function(){return r})},"./src/utils/mp4-tools.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"RemuxerTrackIdConfig",function(){return r}),n.d(t,"bin2str",function(){return v}),n.d(t,"readUint16",function(){return S}),n.d(t,"readUint32",function(){return L}),n.d(t,"readSint32",function(){return D}),n.d(t,"writeUint32",function(){return u}),n.d(t,"findBox",function(){return x}),n.d(t,"parseSegmentIndex",function(){return E}),n.d(t,"parseInitSegment",function(){return o}),n.d(t,"getStartDTS",function(){return a}),n.d(t,"getDuration",function(){return c}),n.d(t,"computeRawDurationFromSamples",function(){return T}),n.d(t,"offsetStartDTS",function(){return f}),n.d(t,"segmentValidRange",function(){return d}),n.d(t,"appendUint8Array",function(){return h}),n.d(t,"parseSamples",function(){return p}),n.d(t,"parseSEIMessageFromNALu",function(){return I}),n.d(t,"parseEmsg",function(){return g});var i=n("./src/utils/typed-array.ts"),C=n("./src/loader/fragment.ts"),_=n("./src/demux/id3.ts"),s=Math.pow(2,32)-1,l=[].push,r={video:1,audio:2,id3:3,text:4};function v(e){return String.fromCharCode.apply(null,e)}function S(e,t){var n=e[t]<<8|e[t+1];return n<0?65536+n:n}function L(e,t){var n=D(e,t);return n<0?4294967296+n:n}function D(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]}function u(e,t,n){e[t]=n>>24,e[t+1]=n>>16&255,e[t+2]=n>>8&255,e[t+3]=255&n}function x(e,t){var n=[];if(!t.length)return n;for(var r=e.byteLength,i=0;i<r;){var o=L(e,i),a=o>1?i+o:r;if(v(e.subarray(i+4,i+8))===t[0])if(1===t.length)n.push(e.subarray(i+8,a));else{var s=x(e.subarray(i+8,a),t.slice(1));s.length&&l.apply(n,s)}i=a}return n}function E(e){var t=[],n=e[0],r=8,i=L(e,r);r+=4;r+=0===n?8:16,r+=2;var o=e.length+0,a=S(e,r);r+=2;for(var s=0;s<a;s++){var l=r,u=L(e,l);l+=4;var c=2147483647&u;if(1===(2147483648&u)>>>31)return console.warn("SIDX has hierarchical references (not supported)"),null;var f=L(e,l);l+=4,t.push({referenceSize:c,subsegmentDuration:f,info:{duration:f/i,start:o,end:o+c-1}}),o+=c,r=l+=4}return{earliestPresentationTime:0,timescale:i,version:n,referencesCount:a,references:t}}function o(e){for(var r=[],t=x(e,["moov","trak"]),n=0;n<t.length;n++){var i=t[n],o=x(i,["tkhd"])[0];if(o){var a=o[0],s=0===a?12:20,l=L(o,s),u=x(i,["mdia","mdhd"])[0];if(u){var c=L(u,s=0===(a=u[0])?12:20),f=x(i,["mdia","hdlr"])[0];if(f){var d=v(f.subarray(8,12)),h={soun:C.ElementaryStreamTypes.AUDIO,vide:C.ElementaryStreamTypes.VIDEO}[d];if(h){var p=x(i,["mdia","minf","stbl","stsd"])[0],g=void 0;p&&(g=v(p.subarray(12,16))),r[l]={timescale:c,type:h},r[h]={timescale:c,id:l,codec:g}}}}}}return x(e,["moov","mvex","trex"]).forEach(function(e){var t=L(e,4),n=r[t];n&&(n.default={duration:L(e,12),flags:L(e,20)})}),r}function a(l,e){return x(e,["moof","traf"]).reduce(function(e,t){var a=x(t,["tfdt"])[0],s=a[0],n=x(t,["tfhd"]).reduce(function(e,t){var n=L(t,4),r=l[n];if(r){var i=L(a,4);1===s&&(i*=Math.pow(2,32),i+=L(a,8));var o=i/(r.timescale||9e4);if(isFinite(o)&&(null===e||o<e))return o}return e},null);return null!==n&&isFinite(n)&&(null===e||n<e)?n:e},null)||0}function c(e,t){for(var n=0,r=0,i=0,o=x(e,["moof","traf"]),a=0;a<o.length;a++){var s=o[a],l=x(s,["tfhd"])[0],u=t[L(l,4)];if(u){var c=u.default,f=L(l,0)|(null==c?void 0:c.flags),d=null==c?void 0:c.duration;8&f&&(d=L(l,2&f?12:8));for(var h=u.timescale||9e4,p=x(s,["trun"]),g=0;g<p.length;g++){if(!(n=T(p[g]))&&d)n=d*L(p[g],4);u.type===C.ElementaryStreamTypes.VIDEO?r+=n/h:u.type===C.ElementaryStreamTypes.AUDIO&&(i+=n/h)}}}if(0===r&&0===i){for(var v=0,y=x(e,["sidx"]),m=0;m<y.length;m++){var b=E(y[m]);null!=b&&b.references&&(v+=b.references.reduce(function(e,t){return e+t.info.duration||0},0))}return v}return r||i}function T(e){var t=L(e,0),n=8;1&t&&(n+=4),4&t&&(n+=4);for(var r=0,i=L(e,4),o=0;o<i;o++){if(256&t)r+=L(e,n),n+=4;512&t&&(n+=4),1024&t&&(n+=4),2048&t&&(n+=4)}return r}function f(i,e,a){x(e,["moof","traf"]).forEach(function(r){x(r,["tfhd"]).forEach(function(e){var t=L(e,4),n=i[t];if(n){var o=n.timescale||9e4;x(r,["tfdt"]).forEach(function(e){var t=e[0],n=L(e,4);if(0===t)n-=a*o,u(e,4,n=Math.max(n,0));else{n*=Math.pow(2,32),n+=L(e,8),n-=a*o,n=Math.max(n,0);var r=Math.floor(n/(s+1)),i=Math.floor(n%(s+1));u(e,4,r),u(e,8,i)}})}})})}function d(e){var t={valid:null,remainder:null},n=x(e,["moof"]);if(!n)return t;if(n.length<2)return t.remainder=e,t;var r=n[n.length-1];return t.valid=Object(i.sliceUint8)(e,0,r.byteOffset-8),t.remainder=Object(i.sliceUint8)(e,r.byteOffset-8),t}function h(e,t){var n=new Uint8Array(e.length+t.length);return n.set(e),n.set(t,e.length),n}function p(w,_){var S=[],A=_.samples,P=_.timescale,s=_.id,O=!1;return x(A,["moof"]).map(function(e){var k=e.byteOffset-8;x(e,["traf"]).map(function(a){var e=x(a,["tfdt"]).map(function(e){var t=e[0],n=L(e,4);return 1===t&&(n*=Math.pow(2,32),n+=L(e,8)),n/P})[0];return void 0!==e&&(w=e),x(a,["tfhd"]).map(function(e){var t=L(e,4),n=16777215&L(e,0),E=0,r=0!=(16&n),T=0,i=0!=(32&n),o=8;t===s&&(0!=(1&n)&&(o+=8),0!=(2&n)&&(o+=4),0!=(8&n)&&(E=L(e,o),o+=4),r&&(T=L(e,o),o+=4),i&&(o+=4),"video"===_.type&&(O=function(e){if(!e)return!1;var t=e.indexOf("."),n=t<0?e:e.substring(0,t);return"hvc1"===n||"hev1"===n||"dvh1"===n||"dvhe"===n}(_.codec)),x(a,["trun"]).map(function(e){var t=e[0],n=16777215&L(e,0),r=0!=(1&n),i=0,o=0!=(4&n),a=0!=(256&n),s=0,l=0!=(512&n),u=0,c=0!=(1024&n),f=0!=(2048&n),d=0,h=L(e,4),p=8;r&&(i=L(e,p),p+=4),o&&(p+=4);for(var g=i+k,v=0;v<h;v++){if(a?(s=L(e,p),p+=4):s=E,l?(u=L(e,p),p+=4):u=T,c&&(p+=4),f&&(d=0===t?L(e,p):D(e,p),p+=4),_.type===C.ElementaryStreamTypes.VIDEO)for(var y=0;y<u;){var m=L(A,g),b=31&A[g+=4];if(R(O,b))I(A.subarray(g,g+m),w+d/P,S);g+=m,y+=m+4}w+=s/P}}))})})}),S}function R(e,t){return e?39===t||40===t:6===t}function I(e,t,n){var r=function(e){var t=e.byteLength,n=[],r=1;for(;r<t-2;)0===e[r]&&0===e[r+1]&&3===e[r+2]?(n.push(r+2),r+=2):r++;if(0===n.length)return e;var i=t-n.length,o=new Uint8Array(i),a=0;for(r=0;r<i;a++,r++)a===n[0]&&(a++,n.shift()),o[r]=e[a];return o}(e),i=0;i++;for(var o=0,a=0,s=!1,l=0;i<r.length;){o=0;do{if(i>=r.length)break;o+=l=r[i++]}while(255===l);a=0;do{if(i>=r.length)break;a+=l=r[i++]}while(255===l);var u=r.length-i;if(!s&&4===o&&i<r.length){if(s=!0,181===r[i++]){var c=S(r,i);if(i+=2,49===c){var f=L(r,i);if(i+=4,1195456820===f){var d=r[i++];if(3===d){var h=r[i++],p=64&h,g=p?2+3*(31&h):0,v=new Uint8Array(g);if(p){v[0]=h;for(var y=1;y<g;y++)v[y]=r[i++]}n.push({type:d,payloadType:o,pts:t,bytes:v})}}}}}else if(5===o&&a<u){if(s=!0,a>16){for(var m=[],b=0;b<16;b++){var E=r[i++].toString(16);m.push(1==E.length?"0"+E:E),3!==b&&5!==b&&7!==b&&9!==b||m.push("-")}for(var T=a-16,k=new Uint8Array(T),w=0;w<T;w++)k[w]=r[i++];n.push({payloadType:o,pts:t,uuid:m.join(""),userData:Object(_.utf8ArrayToStr)(k),userDataBytes:k})}}else if(a<u)i+=a;else if(a>u)break}}function g(e){var t=e[0],n="",r="",i=0,o=0,a=0,s=0,l=0,u=0;if(0===t){for(;"\0"!==v(e.subarray(u,u+1));)n+=v(e.subarray(u,u+1)),u+=1;for(n+=v(e.subarray(u,u+1)),u+=1;"\0"!==v(e.subarray(u,u+1));)r+=v(e.subarray(u,u+1)),u+=1;r+=v(e.subarray(u,u+1)),u+=1,i=L(e,12),o=L(e,16),s=L(e,20),l=L(e,24),u=28}else if(1===t){i=L(e,u+=4);var c=L(e,u+=4),f=L(e,u+=4);for(u+=4,a=Math.pow(2,32)*c+f,Number.isSafeInteger(a)||(a=Number.MAX_SAFE_INTEGER,console.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),s=L(e,u),l=L(e,u+=4),u+=4;"\0"!==v(e.subarray(u,u+1));)n+=v(e.subarray(u,u+1)),u+=1;for(n+=v(e.subarray(u,u+1)),u+=1;"\0"!==v(e.subarray(u,u+1));)r+=v(e.subarray(u,u+1)),u+=1;r+=v(e.subarray(u,u+1)),u+=1}return{schemeIdUri:n,value:r,timeScale:i,presentationTime:a,presentationTimeDelta:o,eventDuration:s,id:l,payload:e.subarray(u,e.byteLength)}}},"./src/utils/output-filter.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return r});var r=function(){function e(e,t){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=t}var t=e.prototype;return t.dispatchCue=function(){null!==this.startTime&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)},t.newCue=function(e,t,n){(null===this.startTime||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=n,this.timelineController.createCaptionsTrack(this.trackName)},t.reset=function(){this.cueRanges=[],this.startTime=null},e}()},"./src/utils/texttrack-utils.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"sendAddTrackEvent",function(){return r}),n.d(t,"addCueToTrack",function(){return o}),n.d(t,"clearCurrentCues",function(){return a}),n.d(t,"removeCuesInRange",function(){return s}),n.d(t,"getCuesInRange",function(){return l});var i=n("./src/utils/logger.ts");function r(e,t){var n;try{n=new Event("addtrack")}catch(e){(n=document.createEvent("Event")).initEvent("addtrack",!1,!1)}n.track=e,t.dispatchEvent(n)}function o(e,t){var n=e.mode;if("disabled"===n&&(e.mode="hidden"),e.cues&&!e.cues.getCueById(t.id))try{if(e.addCue(t),!e.cues.getCueById(t.id))throw new Error("addCue is failed for: "+t)}catch(n){i.logger.debug("[texttrack-utils]: "+n);var r=new self.TextTrackCue(t.startTime,t.endTime,t.text);r.id=t.id,e.addCue(r)}"disabled"===n&&(e.mode=n)}function a(e){var t=e.mode;if("disabled"===t&&(e.mode="hidden"),e.cues)for(var n=e.cues.length;n--;)e.removeCue(e.cues[n]);"disabled"===t&&(e.mode=t)}function s(e,t,n,r){var i=e.mode;if("disabled"===i&&(e.mode="hidden"),e.cues&&e.cues.length>0)for(var o=l(e.cues,t,n),a=0;a<o.length;a++)r&&!r(o[a])||e.removeCue(o[a]);"disabled"===i&&(e.mode=i)}function l(e,t,n){var r=[],i=function(e,t){if(t<e[0].startTime)return 0;var n=e.length-1;if(t>e[n].endTime)return-1;for(var r=0,i=n;r<=i;){var o=Math.floor((i+r)/2);if(t<e[o].startTime)i=o-1;else{if(!(t>e[o].startTime&&r<n))return o;r=o+1}}return e[r].startTime-t<t-e[i].startTime?r:i}(e,t);if(i>-1)for(var o=i,a=e.length;o<a;o++){var s=e[o];if(s.startTime>=t&&s.endTime<=n)r.push(s);else if(s.startTime>n)return r}return r}},"./src/utils/time-ranges.ts":function(e,t,n){"use strict";n.r(t);t.default={toString:function(e){for(var t="",n=e.length,r=0;r<n;r++)t+="["+e.start(r).toFixed(3)+","+e.end(r).toFixed(3)+"]";return t}}},"./src/utils/timescale-conversion.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"toTimescaleFromBase",function(){return i}),n.d(t,"toTimescaleFromScale",function(){return o}),n.d(t,"toMsFromMpegTsClock",function(){return a}),n.d(t,"toMpegTsClockFromTimescale",function(){return s});var r=9e4;function i(e,t,n,r){void 0===n&&(n=1),void 0===r&&(r=!1);var i=e*t*n;return r?Math.round(i):i}function o(e,t,n,r){return void 0===n&&(n=1),void 0===r&&(r=!1),i(e,t,1/n,r)}function a(e,t){return void 0===t&&(t=!1),i(e,1e3,1/r,t)}function s(e,t){return void 0===t&&(t=1),i(e,r,1/t)}},"./src/utils/typed-array.ts":function(e,t,n){"use strict";function r(e,t,n){return Uint8Array.prototype.slice?e.slice(t,n):new Uint8Array(Array.prototype.slice.call(e,t,n))}n.r(t),n.d(t,"sliceUint8",function(){return r})},"./src/utils/vttcue.ts":function(e,t,n){"use strict";n.r(t),t.default=function(){if("undefined"!=typeof self&&self.VTTCue)return self.VTTCue;var b=["","lr","rl"],t=["start","middle","end","left","right"];function E(e,t){if("string"!=typeof t)return!1;if(!Array.isArray(e))return!1;var n=t.toLowerCase();return!!~e.indexOf(n)&&n}function T(e){return E(t,e)}function k(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(var i=1;i<arguments.length;i++){var o=arguments[i];for(var a in o)e[a]=o[a]}return e}function e(e,t,n){var r=this,i={enumerable:!0};r.hasBeenReset=!1;var o="",a=!1,s=e,l=t,u=n,c=null,f="",d=!0,h="auto",p="start",g=50,v="middle",y=50,m="middle";Object.defineProperty(r,"id",k({},i,{get:function(){return o},set:function(e){o=""+e}})),Object.defineProperty(r,"pauseOnExit",k({},i,{get:function(){return a},set:function(e){a=!!e}})),Object.defineProperty(r,"startTime",k({},i,{get:function(){return s},set:function(e){if("number"!=typeof e)throw new TypeError("Start time must be set to a number.");s=e,this.hasBeenReset=!0}})),Object.defineProperty(r,"endTime",k({},i,{get:function(){return l},set:function(e){if("number"!=typeof e)throw new TypeError("End time must be set to a number.");l=e,this.hasBeenReset=!0}})),Object.defineProperty(r,"text",k({},i,{get:function(){return u},set:function(e){u=""+e,this.hasBeenReset=!0}})),Object.defineProperty(r,"region",k({},i,{get:function(){return c},set:function(e){c=e,this.hasBeenReset=!0}})),Object.defineProperty(r,"vertical",k({},i,{get:function(){return f},set:function(e){var t=function(e){return E(b,e)}(e);if(!1===t)throw new SyntaxError("An invalid or illegal string was specified.");f=t,this.hasBeenReset=!0}})),Object.defineProperty(r,"snapToLines",k({},i,{get:function(){return d},set:function(e){d=!!e,this.hasBeenReset=!0}})),Object.defineProperty(r,"line",k({},i,{get:function(){return h},set:function(e){if("number"!=typeof e&&"auto"!==e)throw new SyntaxError("An invalid number or illegal string was specified.");h=e,this.hasBeenReset=!0}})),Object.defineProperty(r,"lineAlign",k({},i,{get:function(){return p},set:function(e){var t=T(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");p=t,this.hasBeenReset=!0}})),Object.defineProperty(r,"position",k({},i,{get:function(){return g},set:function(e){if(e<0||e>100)throw new Error("Position must be between 0 and 100.");g=e,this.hasBeenReset=!0}})),Object.defineProperty(r,"positionAlign",k({},i,{get:function(){return v},set:function(e){var t=T(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");v=t,this.hasBeenReset=!0}})),Object.defineProperty(r,"size",k({},i,{get:function(){return y},set:function(e){if(e<0||e>100)throw new Error("Size must be between 0 and 100.");y=e,this.hasBeenReset=!0}})),Object.defineProperty(r,"align",k({},i,{get:function(){return m},set:function(e){var t=T(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");m=t,this.hasBeenReset=!0}})),r.displayState=void 0}return e.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},e}()},"./src/utils/vttparser.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"parseTimeStamp",function(){return a}),n.d(t,"fixLineBreaks",function(){return h}),n.d(t,"VTTParser",function(){return i});var s=n("./src/utils/vttcue.ts"),r=function(){function e(){}return e.prototype.decode=function(e,t){if(!e)return"";if("string"!=typeof e)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))},e}();function a(e){function t(e,t,n,r){return 3600*(0|e)+60*(0|t)+(0|n)+parseFloat(r||0)}var n=e.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return n?parseFloat(n[2])>59?t(n[2],n[3],0,n[4]):t(n[1],n[2],n[3],n[4]):null}var l=function(){function e(){this.values=Object.create(null)}var t=e.prototype;return t.set=function(e,t){this.get(e)||""===t||(this.values[e]=t)},t.get=function(e,t,n){return n?this.has(e)?this.values[e]:t[n]:this.has(e)?this.values[e]:t},t.has=function(e){return e in this.values},t.alt=function(e,t,n){for(var r=0;r<n.length;++r)if(t===n[r]){this.set(e,t);break}},t.integer=function(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))},t.percent=function(e,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){var n=parseFloat(t);if(n>=0&&n<=100)return this.set(e,n),!0}return!1},e}();function u(e,t,n,r){var i=r?e.split(r):[e];for(var o in i)if("string"==typeof i[o]){var a=i[o].split(n);if(2===a.length)t(a[0],a[1])}}var c=new s.default(0,0,""),f="middle"===c.align?"middle":"center";function d(t,e,o){var n=t;function r(){var e=a(t);if(null===e)throw new Error("Malformed timestamp: "+n);return t=t.replace(/^[^\sa-zA-Z-]+/,""),e}function i(){t=t.replace(/^\s+/,"")}if(i(),e.startTime=r(),i(),"--\x3e"!==t.slice(0,3))throw new Error("Malformed time stamp (time stamps must be separated by '--\x3e'): "+n);t=t.slice(3),i(),e.endTime=r(),i(),function(e,t){var i=new l;u(e,function(e,t){var n;switch(e){case"region":for(var r=o.length-1;r>=0;r--)if(o[r].id===t){i.set(e,o[r].region);break}break;case"vertical":i.alt(e,t,["rl","lr"]);break;case"line":n=t.split(","),i.integer(e,n[0]),i.percent(e,n[0])&&i.set("snapToLines",!1),i.alt(e,n[0],["auto"]),2===n.length&&i.alt("lineAlign",n[1],["start",f,"end"]);break;case"position":n=t.split(","),i.percent(e,n[0]),2===n.length&&i.alt("positionAlign",n[1],["start",f,"end","line-left","line-right","auto"]);break;case"size":i.percent(e,t);break;case"align":i.alt(e,t,["start",f,"end","left","right"])}},/:/,/\s/),t.region=i.get("region",null),t.vertical=i.get("vertical","");var n=i.get("line","auto");"auto"===n&&-1===c.line&&(n=-1),t.line=n,t.lineAlign=i.get("lineAlign","start"),t.snapToLines=i.get("snapToLines",!0),t.size=i.get("size",100),t.align=i.get("align",f);var r=i.get("position","auto");"auto"===r&&50===c.position&&(r="start"===t.align||"left"===t.align?0:"end"===t.align||"right"===t.align?100:50),t.position=r}(t,e)}function h(e){return e.replace(/<br(?: \/)?>/gi,"\n")}var i=function(){function e(){this.state="INITIAL",this.buffer="",this.decoder=new r,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}var t=e.prototype;return t.parse=function(e){var r=this;function t(){var e=r.buffer,t=0;for(e=h(e);t<e.length&&"\r"!==e[t]&&"\n"!==e[t];)++t;var n=e.slice(0,t);return"\r"===e[t]&&++t,"\n"===e[t]&&++t,r.buffer=e.slice(t),n}e&&(r.buffer+=r.decoder.decode(e,{stream:!0}));try{var n="";if("INITIAL"===r.state){if(!/\r\n|\n/.test(r.buffer))return this;var i=(n=t()).match(/^(Ã¯Â»Â¿)?WEBVTT([ \t].*)?$/);if(!i||!i[0])throw new Error("Malformed WebVTT signature.");r.state="HEADER"}for(var o=!1;r.buffer;){if(!/\r\n|\n/.test(r.buffer))return this;switch(o?o=!1:n=t(),r.state){case"HEADER":/:/.test(n)?u(n,function(e,t){},/:/):n||(r.state="ID");continue;case"NOTE":n||(r.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(n)){r.state="NOTE";break}if(!n)continue;if(r.cue=new s.default(0,0,""),r.state="CUE",-1===n.indexOf("--\x3e")){r.cue.id=n;continue}case"CUE":if(!r.cue){r.state="BADCUE";continue}try{d(n,r.cue,r.regionList)}catch(e){r.cue=null,r.state="BADCUE";continue}r.state="CUETEXT";continue;case"CUETEXT":var a=-1!==n.indexOf("--\x3e");if(!n||a&&(o=!0)){r.oncue&&r.cue&&r.oncue(r.cue),r.cue=null,r.state="ID";continue}if(null===r.cue)continue;r.cue.text&&(r.cue.text+="\n"),r.cue.text+=n;continue;case"BADCUE":n||(r.state="ID")}}}catch(e){"CUETEXT"===r.state&&r.cue&&r.oncue&&r.oncue(r.cue),r.cue=null,r.state="INITIAL"===r.state?"BADWEBVTT":"BADCUE"}return this},t.flush=function(){try{if((this.cue||"HEADER"===this.state)&&(this.buffer+="\n\n",this.parse()),"INITIAL"===this.state||"BADWEBVTT"===this.state)throw new Error("Malformed WebVTT signature.")}catch(e){this.onparsingerror&&this.onparsingerror(e)}return this.onflush&&this.onflush(),this},e}()},"./src/utils/webvtt-parser.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"generateCueId",function(){return _}),n.d(t,"parseWebVTT",function(){return i});var o=n("./src/polyfills/number.ts"),y=n("./src/utils/vttparser.ts"),m=n("./src/demux/id3.ts"),b=n("./src/utils/timescale-conversion.ts"),E=n("./src/remux/mp4-remuxer.ts"),T=/\r\n|\n\r|\n|\r/g,k=function(e,t,n){return void 0===n&&(n=0),e.slice(n,n+t.length)===t},w=function(e){var t=parseInt(e.slice(-3)),n=parseInt(e.slice(-6,-4)),r=parseInt(e.slice(-9,-7)),i=e.length>9?parseInt(e.substring(0,e.indexOf(":"))):0;if(!(Object(o.isFiniteNumber)(t)&&Object(o.isFiniteNumber)(n)&&Object(o.isFiniteNumber)(r)&&Object(o.isFiniteNumber)(i)))throw Error("Malformed X-TIMESTAMP-MAP: Local:"+e);return t+=1e3*n,t+=6e4*r,t+=36e5*i},r=function(e){for(var t=5381,n=e.length;n;)t=33*t^e.charCodeAt(--n);return(t>>>0).toString()};function _(e,t,n){return r(e.toString())+r(t.toString())+r(n)}var S=function(e,t,n){var r=e[t],i=e[r.prevCC];if(!i||!i.new&&r.new)return e.ccOffset=e.presentationOffset=r.start,void(r.new=!1);for(;null!==(o=i)&&void 0!==o&&o.new;){var o;e.ccOffset+=r.start-i.start,r.new=!1,i=e[(r=i).prevCC]}e.presentationOffset=n};function i(e,t,n,s,l,u,r,i){var o,a=new y.VTTParser,c=Object(m.utf8ArrayToStr)(new Uint8Array(e)).trim().replace(T,"\n").split("\n"),f=[],d=Object(b.toMpegTsClockFromTimescale)(t,n),h="00:00.000",p=0,g=0,v=!0;a.oncue=function(e){var t=s[l],n=s.ccOffset,r=(p-d)/9e4;null!=t&&t.new&&(void 0!==g?n=s.ccOffset=t.start:S(s,l,r)),r&&(n=r-s.presentationOffset);var i=e.endTime-e.startTime,o=Object(E.normalizePts)(9e4*(e.startTime+n-g),9e4*u)/9e4;e.startTime=Math.max(o,0),e.endTime=Math.max(o+i,0);var a=e.text.trim();e.text=decodeURIComponent(encodeURIComponent(a)),e.id||(e.id=_(e.startTime,e.endTime,a)),e.endTime>0&&f.push(e)},a.onparsingerror=function(e){o=e},a.onflush=function(){o?i(o):r(f)},c.forEach(function(e){if(v){if(k(e,"X-TIMESTAMP-MAP=")){v=!1,e.slice(16).split(",").forEach(function(e){k(e,"LOCAL:")?h=e.slice(6):k(e,"MPEGTS:")&&(p=parseInt(e.slice(7)))});try{g=w(h)/1e3}catch(e){o=e}return}""===e&&(v=!1)}a.parse(e+"\n")}),a.flush()}},"./src/utils/xhr-loader.ts":function(e,t,n){"use strict";n.r(t);var c=n("./src/utils/logger.ts"),r=n("./src/loader/load-stats.ts"),i=/^age:\s*[\d.]+\s*$/m,o=function(){function e(e){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=void 0,this.loader=null,this.stats=void 0,this.xhrSetup=e?e.xhrSetup:null,this.stats=new r.LoadStats,this.retryDelay=0}var t=e.prototype;return t.destroy=function(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null},t.abortInternal=function(){var e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,4!==e.readyState&&(this.stats.aborted=!0,e.abort()))},t.abort=function(){var e;this.abortInternal(),null!==(e=this.callbacks)&&void 0!==e&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)},t.load=function(e,t,n){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=e,this.config=t,this.callbacks=n,this.retryDelay=t.retryDelay,this.loadInternal()},t.loadInternal=function(){var e=this.config,t=this.context;if(e){var n=this.loader=new self.XMLHttpRequest,r=this.stats;r.loading.first=0,r.loaded=0;var i=this.xhrSetup;try{if(i)try{i(n,t.url)}catch(e){n.open("GET",t.url,!0),i(n,t.url)}n.readyState||n.open("GET",t.url,!0);var o=this.context.headers;if(o)for(var a in o)n.setRequestHeader(a,o[a])}catch(e){return void this.callbacks.onError({code:n.status,text:e.message},t,n)}t.rangeEnd&&n.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),n.onreadystatechange=this.readystatechange.bind(this),n.onprogress=this.loadprogress.bind(this),n.responseType=t.responseType,self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),e.timeout),n.send()}},t.readystatechange=function(){var e=this.context,t=this.loader,n=this.stats;if(e&&t){var r=t.readyState,i=this.config;if(!n.aborted&&r>=2)if(self.clearTimeout(this.requestTimeout),0===n.loading.first&&(n.loading.first=Math.max(self.performance.now(),n.loading.start)),4===r){t.onreadystatechange=null,t.onprogress=null;var o=t.status;if(o>=200&&o<300){var a,s;if(n.loading.end=Math.max(self.performance.now(),n.loading.first),s="arraybuffer"===e.responseType?(a=t.response).byteLength:(a=t.responseText).length,n.loaded=n.total=s,!this.callbacks)return;var l=this.callbacks.onProgress;if(l&&l(n,e,a,t),!this.callbacks)return;var u={url:t.responseURL,data:a};this.callbacks.onSuccess(u,n,e,t)}else n.retry>=i.maxRetry||o>=400&&o<499?(c.logger.error(o+" while loading "+e.url),this.callbacks.onError({code:o,text:t.statusText},e,t)):(c.logger.warn(o+" while loading "+e.url+", retrying in "+this.retryDelay+"..."),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,i.maxRetryDelay),n.retry++)}else self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),i.timeout)}},t.loadtimeout=function(){c.logger.warn("timeout while loading "+this.context.url);var e=this.callbacks;e&&(this.abortInternal(),e.onTimeout(this.stats,this.context,this.loader))},t.loadprogress=function(e){var t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total)},t.getCacheAge=function(){var e=null;if(this.loader&&i.test(this.loader.getAllResponseHeaders())){var t=this.loader.getResponseHeader("age");e=t?parseFloat(t):null}return e},e}();t.default=o}}).default},e.exports=r())},function(e,t){function X(e){return(X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var h,n=function(){function l(e){return null==e?String(e):R[K.call(e)]||"object"}function a(e){return"function"==l(e)}function o(e){return null!=e&&e==e.window}function s(e){return null!=e&&e.nodeType==e.DOCUMENT_NODE}function r(e){return"object"==l(e)}function u(e){return r(e)&&!o(e)&&Object.getPrototypeOf(e)==Object.prototype}function c(e){return"number"==typeof e.length}function F(e){return e.length>0?k.fn.concat.apply([],e):e}function f(e){return e.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}function n(e){return e in t?t[e]:t[e]=new RegExp("(^|\\s)"+e+"(\\s|$)")}function d(e,t){return"number"!=typeof t||j[f(e)]?t:t+"px"}function i(e){return"children"in e?O.call(e.children):k.map(e.childNodes,function(e){return 1==e.nodeType?e:void 0})}function h(e,t){var n,r=e?e.length:0;for(n=0;r>n;n++)this[n]=e[n];this.length=r,this.selector=t||""}function p(e,t,n){for(T in t)n&&(u(t[T])||M(t[T]))?(u(t[T])&&!u(e[T])&&(e[T]={}),M(t[T])&&!M(e[T])&&(e[T]=[]),p(e[T],t[T],n)):t[T]!==E&&(e[T]=t[T])}function g(e,t){return null==t?k(e):k(e).filter(t)}function v(e,t,n,r){return a(t)?t.call(e,n,r):t}function y(e,t,n){null==n?e.removeAttribute(t):e.setAttribute(t,n)}function m(e,t){var n=e.className||"",r=n&&n.baseVal!==E;return t===E?r?n.baseVal:n:void(r?n.baseVal=t:e.className=t)}function b(t){try{return t?"true"==t||"false"!=t&&("null"==t?null:+t+""==t?+t:/^[\[\{]/.test(t)?k.parseJSON(t):t):t}catch(e){return t}}var E,T,k,w,_,S,A=[],N=A.concat,P=A.filter,O=A.slice,C=window.document,L={},t={},j={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},D=/^\s*<(\w+|!)[^>]*>/,U=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,B=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,x=/^(?:body|html)$/i,H=/([A-Z])/g,$=["val","css","html","text","data","width","height","offset"],e=C.createElement("table"),G=C.createElement("tr"),V={tr:C.createElement("tbody"),tbody:e,thead:e,tfoot:e,td:G,th:G,"*":C.createElement("div")},Y=/complete|loaded|interactive/,z=/^[\w-]*$/,R={},K=R.toString,I={},W=C.createElement("div"),q={tabindex:"tabIndex",readonly:"readOnly",for:"htmlFor",class:"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},M=Array.isArray||function(e){return e instanceof Array};return I.matches=function(e,t){if(!t||!e||1!==e.nodeType)return!1;var n=e.webkitMatchesSelector||e.mozMatchesSelector||e.oMatchesSelector||e.matchesSelector;if(n)return n.call(e,t);var r,i=e.parentNode,o=!i;return o&&(i=W).appendChild(e),r=~I.qsa(i,t).indexOf(e),o&&W.removeChild(e),r},_=function(e){return e.replace(/-+(.)?/g,function(e,t){return t?t.toUpperCase():""})},S=function(n){return P.call(n,function(e,t){return n.indexOf(e)==t})},I.fragment=function(e,t,n){var r,i,o;return U.test(e)&&(r=k(C.createElement(RegExp.$1))),r||(e.replace&&(e=e.replace(B,"<$1></$2>")),t===E&&(t=D.test(e)&&RegExp.$1),t in V||(t="*"),(o=V[t]).innerHTML=""+e,r=k.each(O.call(o.childNodes),function(){o.removeChild(this)})),u(n)&&(i=k(r),k.each(n,function(e,t){$.indexOf(e)>-1?i[e](t):i.attr(e,t)})),r},I.Z=function(e,t){return new h(e,t)},I.isZ=function(e){return e instanceof I.Z},I.init=function(e,t){var n;if(!e)return I.Z();if("string"==typeof e)if("<"==(e=e.trim())[0]&&D.test(e))n=I.fragment(e,RegExp.$1,t),e=null;else{if(t!==E)return k(t).find(e);n=I.qsa(C,e)}else{if(a(e))return k(C).ready(e);if(I.isZ(e))return e;if(M(e))n=function(e){return P.call(e,function(e){return null!=e})}(e);else if(r(e))n=[e],e=null;else if(D.test(e))n=I.fragment(e.trim(),RegExp.$1,t),e=null;else{if(t!==E)return k(t).find(e);n=I.qsa(C,e)}}return I.Z(n,e)},(k=function(e,t){return I.init(e,t)}).extend=function(t){var n,e=O.call(arguments,1);return"boolean"==typeof t&&(n=t,t=e.shift()),e.forEach(function(e){p(t,e,n)}),t},I.qsa=function(e,t){var n,r="#"==t[0],i=!r&&"."==t[0],o=r||i?t.slice(1):t,a=z.test(o);return e.getElementById&&a&&r?(n=e.getElementById(o))?[n]:[]:1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType?[]:O.call(a&&!r&&e.getElementsByClassName?i?e.getElementsByClassName(o):e.getElementsByTagName(t):e.querySelectorAll(t))},k.contains=C.documentElement.contains?function(e,t){return e!==t&&e.contains(t)}:function(e,t){for(;t&&(t=t.parentNode);)if(t===e)return!0;return!1},k.type=l,k.isFunction=a,k.isWindow=o,k.isArray=M,k.isPlainObject=u,k.isEmptyObject=function(e){var t;for(t in e)return!1;return!0},k.inArray=function(e,t,n){return A.indexOf.call(t,e,n)},k.camelCase=_,k.trim=function(e){return null==e?"":String.prototype.trim.call(e)},k.uuid=0,k.support={},k.expr={},k.noop=function(){},k.map=function(e,t){var n,r,i,o=[];if(c(e))for(r=0;r<e.length;r++)null!=(n=t(e[r],r))&&o.push(n);else for(i in e)null!=(n=t(e[i],i))&&o.push(n);return F(o)},k.each=function(e,t){var n,r;if(c(e)){for(n=0;n<e.length;n++)if(!1===t.call(e[n],n,e[n]))return e}else for(r in e)if(!1===t.call(e[r],r,e[r]))return e;return e},k.grep=function(e,t){return P.call(e,t)},window.JSON&&(k.parseJSON=JSON.parse),k.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){R["[object "+t+"]"]=t.toLowerCase()}),k.fn={constructor:I.Z,length:0,forEach:A.forEach,reduce:A.reduce,push:A.push,sort:A.sort,splice:A.splice,indexOf:A.indexOf,concat:function(){var e,t,n=[];for(e=0;e<arguments.length;e++)t=arguments[e],n[e]=I.isZ(t)?t.toArray():t;return N.apply(I.isZ(this)?this.toArray():this,n)},map:function(n){return k(k.map(this,function(e,t){return n.call(e,t,e)}))},slice:function(){return k(O.apply(this,arguments))},ready:function(e){return Y.test(C.readyState)&&C.body?e(k):C.addEventListener("DOMContentLoaded",function(){e(k)},!1),this},get:function(e){return e===E?O.call(this):this[e>=0?e:e+this.length]},toArray:function(){return this.get()},size:function(){return this.length},remove:function(){return this.each(function(){null!=this.parentNode&&this.parentNode.removeChild(this)})},each:function(n){return A.every.call(this,function(e,t){return!1!==n.call(e,t,e)}),this},filter:function(t){return a(t)?this.not(this.not(t)):k(P.call(this,function(e){return I.matches(e,t)}))},add:function(e,t){return k(S(this.concat(k(e,t))))},is:function(e){return this.length>0&&I.matches(this[0],e)},not:function(t){var n=[];if(a(t)&&t.call!==E)this.each(function(e){t.call(this,e)||n.push(this)});else{var r="string"==typeof t?this.filter(t):c(t)&&a(t.item)?O.call(t):k(t);this.forEach(function(e){r.indexOf(e)<0&&n.push(e)})}return k(n)},has:function(e){return this.filter(function(){return r(e)?k.contains(this,e):k(this).find(e).size()})},eq:function(e){return-1===e?this.slice(e):this.slice(e,+e+1)},first:function(){var e=this[0];return e&&!r(e)?e:k(e)},last:function(){var e=this[this.length-1];return e&&!r(e)?e:k(e)},find:function(e){var n=this;return e?"object"==X(e)?k(e).filter(function(){var t=this;return A.some.call(n,function(e){return k.contains(e,t)})}):1==this.length?k(I.qsa(this[0],e)):this.map(function(){return I.qsa(this,e)}):k()},closest:function(e,t){var n=this[0],r=!1;for("object"==X(e)&&(r=k(e));n&&!(r?r.indexOf(n)>=0:I.matches(n,e));)n=n!==t&&!s(n)&&n.parentNode;return k(n)},parents:function(e){for(var t=[],n=this;n.length>0;)n=k.map(n,function(e){return(e=e.parentNode)&&!s(e)&&t.indexOf(e)<0?(t.push(e),e):void 0});return g(t,e)},parent:function(e){return g(S(this.pluck("parentNode")),e)},children:function(e){return g(this.map(function(){return i(this)}),e)},contents:function(){return this.map(function(){return this.contentDocument||O.call(this.childNodes)})},siblings:function(e){return g(this.map(function(e,t){return P.call(i(t.parentNode),function(e){return e!==t})}),e)},empty:function(){return this.each(function(){this.innerHTML=""})},pluck:function(t){return k.map(this,function(e){return e[t]})},show:function(){return this.each(function(){var e,t,n;"none"==this.style.display&&(this.style.display=""),"none"==getComputedStyle(this,"").getPropertyValue("display")&&(this.style.display=(e=this.nodeName,L[e]||(t=C.createElement(e),C.body.appendChild(t),n=getComputedStyle(t,"").getPropertyValue("display"),t.parentNode.removeChild(t),"none"==n&&(n="block"),L[e]=n),L[e]))})},replaceWith:function(e){return this.before(e).remove()},wrap:function(t){var n=a(t);if(this[0]&&!n)var r=k(t).get(0),i=r.parentNode||this.length>1;return this.each(function(e){k(this).wrapAll(n?t.call(this,e):i?r.cloneNode(!0):r)})},wrapAll:function(e){if(this[0]){k(this[0]).before(e=k(e));for(var t;(t=e.children()).length;)e=t.first();k(e).append(this)}return this},wrapInner:function(i){var o=a(i);return this.each(function(e){var t=k(this),n=t.contents(),r=o?i.call(this,e):i;n.length?n.wrapAll(r):t.append(r)})},unwrap:function(){return this.parent().each(function(){k(this).replaceWith(k(this).children())}),this},clone:function(){return this.map(function(){return this.cloneNode(!0)})},hide:function(){return this.css("display","none")},toggle:function(t){return this.each(function(){var e=k(this);(t===E?"none"==e.css("display"):t)?e.show():e.hide()})},prev:function(e){return k(this.pluck("previousElementSibling")).filter(e||"*")},next:function(e){return k(this.pluck("nextElementSibling")).filter(e||"*")},html:function(n){return 0 in arguments?this.each(function(e){var t=this.innerHTML;k(this).empty().append(v(this,n,e,t))}):0 in this?this[0].innerHTML:null},text:function(n){return 0 in arguments?this.each(function(e){var t=v(this,n,e,this.textContent);this.textContent=null==t?"":""+t}):0 in this?this[0].textContent:null},attr:function(t,n){var e;return"string"!=typeof t||1 in arguments?this.each(function(e){if(1===this.nodeType)if(r(t))for(T in t)y(this,T,t[T]);else y(this,t,v(this,n,e,this.getAttribute(t)))}):this.length&&1===this[0].nodeType?!(e=this[0].getAttribute(t))&&t in this[0]?this[0][t]:e:E},removeAttr:function(e){return this.each(function(){1===this.nodeType&&e.split(" ").forEach(function(e){y(this,e)},this)})},prop:function(t,n){return t=q[t]||t,1 in arguments?this.each(function(e){this[t]=v(this,n,e,this[t])}):this[0]&&this[0][t]},data:function(e,t){var n="data-"+e.replace(H,"-$1").toLowerCase(),r=1 in arguments?this.attr(n,t):this.attr(n);return null!==r?b(r):E},val:function(t){return 0 in arguments?this.each(function(e){this.value=v(this,t,e,this.value)}):this[0]&&(this[0].multiple?k(this[0]).find("option").filter(function(){return this.selected}).pluck("value"):this[0].value)},offset:function(o){if(o)return this.each(function(e){var t=k(this),n=v(this,o,e,t.offset()),r=t.offsetParent().offset(),i={top:n.top-r.top,left:n.left-r.left};"static"==t.css("position")&&(i.position="relative"),t.css(i)});if(!this.length)return null;if(!k.contains(C.documentElement,this[0]))return{top:0,left:0};var e=this[0].getBoundingClientRect();return{left:e.left+window.pageXOffset,top:e.top+window.pageYOffset,width:Math.round(e.width),height:Math.round(e.height)}},css:function(e,t){if(arguments.length<2){var n,r=this[0];if(!r)return;if(n=getComputedStyle(r,""),"string"==typeof e)return r.style[_(e)]||n.getPropertyValue(e);if(M(e)){var i={};return k.each(e,function(e,t){i[t]=r.style[_(t)]||n.getPropertyValue(t)}),i}}var o="";if("string"==l(e))t||0===t?o=f(e)+":"+d(e,t):this.each(function(){this.style.removeProperty(f(e))});else for(T in e)e[T]||0===e[T]?o+=f(T)+":"+d(T,e[T])+";":this.each(function(){this.style.removeProperty(f(T))});return this.each(function(){this.style.cssText+=";"+o})},index:function(e){return e?this.indexOf(k(e)[0]):this.parent().children().indexOf(this[0])},hasClass:function(e){return!!e&&A.some.call(this,function(e){return this.test(m(e))},n(e))},addClass:function(n){return n?this.each(function(e){if("className"in this){w=[];var t=m(this);v(this,n,e,t).split(/\s+/g).forEach(function(e){k(this).hasClass(e)||w.push(e)},this),w.length&&m(this,t+(t?" ":"")+w.join(" "))}}):this},removeClass:function(t){return this.each(function(e){if("className"in this){if(t===E)return m(this,"");w=m(this),v(this,t,e,w).split(/\s+/g).forEach(function(e){w=w.replace(n(e)," ")}),m(this,w.trim())}})},toggleClass:function(n,r){return n?this.each(function(e){var t=k(this);v(this,n,e,m(this)).split(/\s+/g).forEach(function(e){(r===E?!t.hasClass(e):r)?t.addClass(e):t.removeClass(e)})}):this},scrollTop:function(e){if(this.length){var t="scrollTop"in this[0];return e===E?t?this[0].scrollTop:this[0].pageYOffset:this.each(t?function(){this.scrollTop=e}:function(){this.scrollTo(this.scrollX,e)})}},scrollLeft:function(e){if(this.length){var t="scrollLeft"in this[0];return e===E?t?this[0].scrollLeft:this[0].pageXOffset:this.each(t?function(){this.scrollLeft=e}:function(){this.scrollTo(e,this.scrollY)})}},position:function(){if(this.length){var e=this[0],t=this.offsetParent(),n=this.offset(),r=x.test(t[0].nodeName)?{top:0,left:0}:t.offset();return n.top-=parseFloat(k(e).css("margin-top"))||0,n.left-=parseFloat(k(e).css("margin-left"))||0,r.top+=parseFloat(k(t[0]).css("border-top-width"))||0,r.left+=parseFloat(k(t[0]).css("border-left-width"))||0,{top:n.top-r.top,left:n.left-r.left}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||C.body;e&&!x.test(e.nodeName)&&"static"==k(e).css("position");)e=e.offsetParent;return e})}},k.fn.detach=k.fn.remove,["width","height"].forEach(function(r){var i=r.replace(/./,function(e){return e[0].toUpperCase()});k.fn[r]=function(t){var e,n=this[0];return t===E?o(n)?n["inner"+i]:s(n)?n.documentElement["scroll"+i]:(e=this.offset())&&e[r]:this.each(function(e){(n=k(this)).css(r,v(this,t,e,n[r]()))})}}),["after","prepend","before","append"].forEach(function(t,a){var s=a%2;k.fn[t]=function(){var t,r,i=k.map(arguments,function(e){return"object"==(t=l(e))||"array"==t||null==e?e:I.fragment(e)}),o=this.length>1;return i.length<1?this:this.each(function(e,t){r=s?t:t.parentNode,t=0==a?t.nextSibling:1==a?t.firstChild:2==a?t:null;var n=k.contains(C.documentElement,r);i.forEach(function(e){if(o)e=e.cloneNode(!0);else if(!r)return k(e).remove();r.insertBefore(e,t),n&&function e(t,n){n(t);for(var r=0,i=t.childNodes.length;i>r;r++)e(t.childNodes[r],n)}(e,function(e){null==e.nodeName||"SCRIPT"!==e.nodeName.toUpperCase()||e.type&&"text/javascript"!==e.type||e.src||window.eval.call(window,e.innerHTML)})})})},k.fn[s?t+"To":"insert"+(a?"Before":"After")]=function(e){return k(e)[t](this),this}}),I.Z.prototype=h.prototype=k.fn,I.uniq=S,I.deserializeValue=b,k.zepto=I,k}();window.Zepto=n,void 0===window.$&&(window.$=n),function(c){function f(e){return e._zid||(e._zid=t++)}function a(e,t,n,r){if((t=d(t)).ns)var i=function(e){return new RegExp("(?:^| )"+e.replace(" "," .* ?")+"(?: |$)")}(t.ns);return(k[f(e)]||[]).filter(function(e){return!(!e||t.e&&e.e!=t.e||t.ns&&!i.test(e.ns)||n&&f(e.fn)!==f(n)||r&&e.sel!=r)})}function d(e){var t=(""+e).split(".");return{e:t[0],ns:t.slice(1).sort().join(" ")}}function h(e,t){return e.del&&!n&&e.e in r||!!t}function p(e){return w[e]||n&&r[e]||e}function u(i,e,t,o,a,s,l){var n=f(i),u=k[n]||(k[n]=[]);e.split(/\s/).forEach(function(e){if("ready"==e)return c(document).ready(t);var n=d(e);n.fn=t,n.sel=a,n.e in w&&(t=function(e){var t=e.relatedTarget;return!t||t!==this&&!c.contains(this,t)?n.fn.apply(this,arguments):void 0}),n.del=s;var r=s||t;n.proxy=function(e){if(!(e=v(e)).isImmediatePropagationStopped()){e.data=o;var t=r.apply(i,e._args==m?[e]:[e].concat(e._args));return!1===t&&(e.preventDefault(),e.stopPropagation()),t}},n.i=u.length,u.push(n),"addEventListener"in i&&i.addEventListener(p(n.e),n.proxy,h(n,l))})}function g(t,e,n,r,i){var o=f(t);(e||"").split(/\s/).forEach(function(e){a(t,e,n,r).forEach(function(e){delete k[o][e.i],"removeEventListener"in t&&t.removeEventListener(p(e.e),e.proxy,h(e,i))})})}function v(r,i){return(i||!r.isDefaultPrevented)&&(i||(i=r),c.each(e,function(e,t){var n=i[e];r[e]=function(){return this[t]=s,n&&n.apply(i,arguments)},r[t]=_}),(i.defaultPrevented!==m?i.defaultPrevented:"returnValue"in i?!1===i.returnValue:i.getPreventDefault&&i.getPreventDefault())&&(r.isDefaultPrevented=s)),r}function y(e){var t,n={originalEvent:e};for(t in e)i.test(t)||e[t]===m||(n[t]=e[t]);return v(n,e)}var m,t=1,b=Array.prototype.slice,E=c.isFunction,T=function(e){return"string"==typeof e},k={},o={},n="onfocusin"in window,r={focus:"focusin",blur:"focusout"},w={mouseenter:"mouseover",mouseleave:"mouseout"};o.click=o.mousedown=o.mouseup=o.mousemove="MouseEvents",c.event={add:u,remove:g},c.proxy=function(e,t){var n=2 in arguments&&b.call(arguments,2);if(E(e)){var r=function(){return e.apply(t,n?n.concat(b.call(arguments)):arguments)};return r._zid=f(e),r}if(T(t))return n?(n.unshift(e[t],e),c.proxy.apply(null,n)):c.proxy(e[t],e);throw new TypeError("expected function")},c.fn.bind=function(e,t,n){return this.on(e,t,n)},c.fn.unbind=function(e,t){return this.off(e,t)},c.fn.one=function(e,t,n,r){return this.on(e,t,n,r,1)};var s=function(){return!0},_=function(){return!1},i=/^([A-Z]|returnValue$|layer[XY]$)/,e={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};c.fn.delegate=function(e,t,n){return this.on(t,e,n)},c.fn.undelegate=function(e,t,n){return this.off(t,e,n)},c.fn.live=function(e,t){return c(document.body).delegate(this.selector,e,t),this},c.fn.die=function(e,t){return c(document.body).undelegate(this.selector,e,t),this},c.fn.on=function(t,i,n,o,a){var s,l,r=this;return t&&!T(t)?(c.each(t,function(e,t){r.on(e,i,n,t,a)}),r):(T(i)||E(o)||!1===o||(o=n,n=i,i=m),(o===m||!1===n)&&(o=n,n=m),!1===o&&(o=_),r.each(function(e,r){a&&(s=function(e){return g(r,e.type,o),o.apply(this,arguments)}),i&&(l=function(e){var t,n=c(e.target).closest(i,r).get(0);return n&&n!==r?(t=c.extend(y(e),{currentTarget:n,liveFired:r}),(s||o).apply(n,[t].concat(b.call(arguments,1)))):void 0}),u(r,t,o,n,i,l||s)}))},c.fn.off=function(e,n,t){var r=this;return e&&!T(e)?(c.each(e,function(e,t){r.off(e,n,t)}),r):(T(n)||E(t)||!1===t||(t=n,n=m),!1===t&&(t=_),r.each(function(){g(this,e,t,n)}))},c.fn.trigger=function(e,t){return(e=T(e)||c.isPlainObject(e)?c.Event(e):v(e))._args=t,this.each(function(){e.type in r&&"function"==typeof this[e.type]?this[e.type]():"dispatchEvent"in this?this.dispatchEvent(e):c(this).triggerHandler(e,t)})},c.fn.triggerHandler=function(n,r){var i,o;return this.each(function(e,t){(i=y(T(n)?c.Event(n):n))._args=r,i.target=t,c.each(a(t,n.type||n),function(e,t){return o=t.proxy(i),!i.isImmediatePropagationStopped()&&void 0})}),o},"focusin focusout focus blur load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select keydown keypress keyup error".split(" ").forEach(function(t){c.fn[t]=function(e){return 0 in arguments?this.bind(t,e):this.trigger(t)}}),c.Event=function(e,t){T(e)||(e=(t=e).type);var n=document.createEvent(o[e]||"Events"),r=!0;if(t)for(var i in t)"bubbles"==i?r=!!t[i]:n[i]=t[i];return n.initEvent(e,r,!0),v(n)}}(n),function(g){function i(e,t,n){var r=g.Event(t);return g(e).trigger(r,n),!r.isDefaultPrevented()}function a(e,t,n,r){return e.global?i(t||S,n,r):void 0}function v(e){e.global&&0==g.active++&&a(e,null,"ajaxStart")}function o(e){e.global&&!--g.active&&a(e,null,"ajaxStop")}function y(e,t){var n=t.context;return!1!==t.beforeSend.call(n,e,t)&&!1!==a(t,n,"ajaxBeforeSend",[e,t])&&void a(t,n,"ajaxSend",[e,t])}function m(e,t,n,r){var i=n.context,o="success";n.success.call(i,e,o,t),r&&r.resolveWith(i,[e,o,t]),a(n,i,"ajaxSuccess",[t,n,e]),s(o,t,n)}function b(e,t,n,r,i){var o=r.context;r.error.call(o,n,t,e),i&&i.rejectWith(o,[n,t,e]),a(r,o,"ajaxError",[n,r,e||t]),s(t,n,r)}function s(e,t,n){var r=n.context;n.complete.call(r,t,e),a(n,r,"ajaxComplete",[t,n]),o(n)}function E(){}function T(e){return e&&(e=e.split(";",2)[0]),e&&(e==f?"html":e==r?"json":t.test(e)?"script":n.test(e)&&"xml")||"text"}function k(e,t){return""==t?e:(e+"&"+t).replace(/[&?]{1,2}/,"?")}function l(e,t,n,r){return g.isFunction(t)&&(r=n,n=t,t=void 0),g.isFunction(n)||(r=n,n=void 0),{url:e,data:t,success:n,dataType:r}}var w,_,c=0,S=window.document,u=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,t=/^(?:text|application)\/javascript/i,n=/^(?:text|application)\/xml/i,r="application/json",f="text/html",A=/^\s*$/,P=S.createElement("a");P.href=window.location.href,g.active=0,g.ajaxJSONP=function(n,r){if(!("type"in n))return g.ajax(n);var i,o,e=n.jsonpCallback,a=(g.isFunction(e)?e():e)||"jsonp"+ ++c,s=S.createElement("script"),l=window[a],t=function(e){g(s).triggerHandler("error",e||"abort")},u={abort:t};return r&&r.promise(u),g(s).on("load error",function(e,t){clearTimeout(o),g(s).off().remove(),"error"!=e.type&&i?m(i[0],u,n,r):b(null,t||"error",u,n,r),window[a]=l,i&&g.isFunction(l)&&l(i[0]),l=i=void 0}),!1===y(u,n)?(t("abort"),u):(window[a]=function(){i=arguments},s.src=n.url.replace(/\?(.+)=\?/,"?$1="+a),S.head.appendChild(s),n.timeout>0&&(o=setTimeout(function(){t("timeout")},n.timeout)),u)},g.ajaxSettings={type:"GET",beforeSend:E,success:E,error:E,complete:E,context:null,global:!0,xhr:function(){return new window.XMLHttpRequest},accepts:{script:"text/javascript, application/javascript, application/x-javascript",json:r,xml:"application/xml, text/xml",html:f,text:"text/plain"},crossDomain:!1,timeout:0,processData:!0,cache:!0},g.ajax=function(e){var t,n,r=g.extend({},e||{}),i=g.Deferred&&g.Deferred();for(w in g.ajaxSettings)void 0===r[w]&&(r[w]=g.ajaxSettings[w]);v(r),r.crossDomain||((t=S.createElement("a")).href=r.url,t.href=t.href,r.crossDomain=P.protocol+"//"+P.host!=t.protocol+"//"+t.host),r.url||(r.url=window.location.toString()),(n=r.url.indexOf("#"))>-1&&(r.url=r.url.slice(0,n)),function(e){e.processData&&e.data&&"string"!=g.type(e.data)&&(e.data=g.param(e.data,e.traditional)),!e.data||e.type&&"GET"!=e.type.toUpperCase()||(e.url=k(e.url,e.data),e.data=void 0)}(r);var o=r.dataType,a=/\?.+=\?/.test(r.url);if(a&&(o="jsonp"),!1!==r.cache&&(e&&!0===e.cache||"script"!=o&&"jsonp"!=o)||(r.url=k(r.url,"_="+Date.now())),"jsonp"==o)return a||(r.url=k(r.url,r.jsonp?r.jsonp+"=?":!1===r.jsonp?"":"callback=?")),g.ajaxJSONP(r,i);var s,l=r.accepts[o],u={},c=function(e,t){u[e.toLowerCase()]=[e,t]},f=/^([\w-]+:)\/\//.test(r.url)?RegExp.$1:window.location.protocol,d=r.xhr(),h=d.setRequestHeader;if(i&&i.promise(d),r.crossDomain||c("X-Requested-With","XMLHttpRequest"),c("Accept",l||"*/*"),(l=r.mimeType||l)&&(l.indexOf(",")>-1&&(l=l.split(",",2)[0]),d.overrideMimeType&&d.overrideMimeType(l)),(r.contentType||!1!==r.contentType&&r.data&&"GET"!=r.type.toUpperCase())&&c("Content-Type",r.contentType||"application/x-www-form-urlencoded"),r.headers)for(_ in r.headers)c(_,r.headers[_]);if(d.setRequestHeader=c,d.onreadystatechange=function(){if(4==d.readyState){d.onreadystatechange=E,clearTimeout(s);var e,t=!1;if(d.status>=200&&d.status<300||304==d.status||0==d.status&&"file:"==f){o=o||T(r.mimeType||d.getResponseHeader("content-type")),e=d.responseText;try{"script"==o?(0,eval)(e):"xml"==o?e=d.responseXML:"json"==o&&(e=A.test(e)?null:g.parseJSON(e))}catch(e){t=e}t?b(t,"parsererror",d,r,i):m(e,d,r,i)}else b(d.statusText||null,d.status?"error":"abort",d,r,i)}},!1===y(d,r))return d.abort(),b(null,"abort",d,r,i),d;if(r.xhrFields)for(_ in r.xhrFields)d[_]=r.xhrFields[_];var p=!("async"in r)||r.async;for(_ in d.open(r.type,r.url,p,r.username,r.password),u)h.apply(d,u[_]);return r.timeout>0&&(s=setTimeout(function(){d.onreadystatechange=E,d.abort(),b(null,"timeout",d,r,i)},r.timeout)),d.send(r.data?r.data:null),d},g.get=function(){return g.ajax(l.apply(null,arguments))},g.post=function(){var e=l.apply(null,arguments);return e.type="POST",g.ajax(e)},g.getJSON=function(){var e=l.apply(null,arguments);return e.dataType="json",g.ajax(e)},g.fn.load=function(e,t,n){if(!this.length)return this;var r,i=this,o=e.split(/\s/),a=l(e,t,n),s=a.success;return o.length>1&&(a.url=o[0],r=o[1]),a.success=function(e){i.html(r?g("<div>").html(e.replace(u,"")).find(r):e),s&&s.apply(i,arguments)},g.ajax(a),this};var d=encodeURIComponent;g.param=function(e,t){var n=[];return n.add=function(e,t){g.isFunction(t)&&(t=t()),null==t&&(t=""),this.push(d(e)+"="+d(t))},function n(r,e,i,o){var a,s=g.isArray(e),l=g.isPlainObject(e);g.each(e,function(e,t){a=g.type(t),o&&(e=i?o:o+"["+(l||"object"==a||"array"==a?e:"")+"]"),!o&&s?r.add(t.name,t.value):"array"==a||!i&&"object"==a?n(r,t,i,e):r.add(e,t)})}(n,e,t),n.join("&").replace(/%20/g,"+")}}(n),(h=n).Callbacks=function(r){r=h.extend({},r);var n,i,o,a,s,l,u=[],c=!r.once&&[],f=function e(t){for(n=r.memory&&t,i=!0,l=a||0,a=0,s=u.length,o=!0;u&&s>l;++l)if(!1===u[l].apply(t[0],t[1])&&r.stopOnFalse){n=!1;break}o=!1,u&&(c?c.length&&e(c.shift()):n?u.length=0:d.disable())},d={add:function(){if(u){var e=u.length;(function n(e){h.each(e,function(e,t){"function"==typeof t?r.unique&&d.has(t)||u.push(t):t&&t.length&&"string"!=typeof t&&n(t)})})(arguments),o?s=u.length:n&&(a=e,f(n))}return this},remove:function(){return u&&h.each(arguments,function(e,t){for(var n;(n=h.inArray(t,u,n))>-1;)u.splice(n,1),o&&(s>=n&&--s,l>=n&&--l)}),this},has:function(e){return!(!u||!(e?h.inArray(e,u)>-1:u.length))},empty:function(){return s=u.length=0,this},disable:function(){return u=c=n=void 0,this},disabled:function(){return!u},lock:function(){return c=void 0,n||d.disable(),this},locked:function(){return!c},fireWith:function(e,t){return!u||i&&!c||(t=[e,(t=t||[]).slice?t.slice():t],o?c.push(t):f(t)),this},fire:function(){return d.fireWith(this,arguments)},fired:function(){return!!i}};return d},function(c){function f(e){var i=[["resolve","done",c.Callbacks({once:1,memory:1}),"resolved"],["reject","fail",c.Callbacks({once:1,memory:1}),"rejected"],["notify","progress",c.Callbacks({memory:1})]],o="pending",a={state:function(){return o},always:function(){return s.done(arguments).fail(arguments),this},then:function(){var t=arguments;return f(function(o){c.each(i,function(e,r){var i=c.isFunction(t[e])&&t[e];s[r[1]](function(){var e=i&&i.apply(this,arguments);if(e&&c.isFunction(e.promise))e.promise().done(o.resolve).fail(o.reject).progress(o.notify);else{var t=this===a?o.promise():this,n=i?[e]:arguments;o[r[0]+"With"](t,n)}})}),t=null}).promise()},promise:function(e){return null!=e?c.extend(e,a):a}},s={};return c.each(i,function(e,t){var n=t[2],r=t[3];a[t[1]]=n.add,r&&n.add(function(){o=r},i[1^e][2].disable,i[2][2].lock),s[t[0]]=function(){return s[t[0]+"With"](this===s?a:this,arguments),this},s[t[0]+"With"]=n.fireWith}),a.promise(s),e&&e.call(s,s),s}var d=Array.prototype.slice;c.when=function(e){var i,t,n,r=d.call(arguments),o=r.length,a=0,s=1!==o||e&&c.isFunction(e.promise)?o:0,l=1===s?e:f(),u=function(t,n,r){return function(e){n[t]=this,r[t]=arguments.length>1?d.call(arguments):e,r===i?l.notifyWith(n,r):--s||l.resolveWith(n,r)}};if(o>1)for(i=new Array(o),t=new Array(o),n=new Array(o);o>a;++a)r[a]&&c.isFunction(r[a].promise)?r[a].promise().done(u(a,n,r)).fail(l.reject).progress(u(a,t,i)):--s;return s||l.resolveWith(n,r),l.promise()},c.Deferred=f}(n),function(s){function l(){v=null,m.last&&(m.el.trigger("longTap"),m={})}function u(){v&&clearTimeout(v),v=null}function c(){h&&clearTimeout(h),p&&clearTimeout(p),g&&clearTimeout(g),v&&clearTimeout(v),h=p=g=v=null,m={}}function f(e){return("touch"==e.pointerType||e.pointerType==e.MSPOINTER_TYPE_TOUCH)&&e.isPrimary}function d(e,t){return e.type=="pointer"+t||e.type.toLowerCase()=="mspointer"+t}var h,p,g,v,y,m={};s(document).ready(function(){var t,n,r,i,o=0,a=0;"MSGesture"in window&&((y=new MSGesture).target=document.body),s(document).bind("MSGestureEnd",function(e){var t=e.velocityX>1?"Right":e.velocityX<-1?"Left":e.velocityY>1?"Down":e.velocityY<-1?"Up":null;t&&(m&&m.el&&m.el.trigger("swipe"),m&&m.el&&m.el.trigger("swipe"+t))}).on("touchstart MSPointerDown pointerdown",function(e){(!(i=d(e,"down"))||f(e))&&(r=i?e:e.touches[0],e.touches&&1===e.touches.length&&m.x2&&(m.x2=void 0,m.y2=void 0),t=Date.now(),n=t-(m.last||t),m.el=s("tagName"in r.target?r.target:r.target.parentNode),h&&clearTimeout(h),m.x1=r.pageX,m.y1=r.pageY,n>0&&250>=n&&(m.isDoubleTap=!0),m.last=t,v=setTimeout(l,750),y&&i&&y.addPointer(e.pointerId))}).on("touchmove MSPointerMove pointermove",function(e){(!(i=d(e,"move"))||f(e))&&(r=i?e:e.touches[0],u(),m.x2=r.pageX,m.y2=r.pageY,o+=Math.abs(m.x1-m.x2),a+=Math.abs(m.y1-m.y2))}).on("touchend MSPointerUp pointerup",function(e){(!(i=d(e,"up"))||f(e))&&(u(),m.x2&&Math.abs(m.x1-m.x2)>30||m.y2&&Math.abs(m.y1-m.y2)>30?g=setTimeout(function(){m&&m.el&&m.el.trigger("swipe"),m&&m.el&&m.el.trigger("swipe"+function(e,t,n,r){return Math.abs(e-t)>=Math.abs(n-r)?e-t>0?"Left":"Right":n-r>0?"Up":"Down"}(m.x1,m.x2,m.y1,m.y2)),m={}},0):"last"in m&&(30>o&&30>a?p=setTimeout(function(){var e=s.Event("tap");e.cancelTouch=c,m.el&&m.el.trigger(e),m.isDoubleTap?(m.el&&m.el.trigger("doubleTap"),m={}):h=setTimeout(function(){h=null,m.el&&m.el.trigger("singleTap"),m={}},250)},0):m={}),o=a=0)}).on("touchcancel MSPointerCancel pointercancel",c),s(window).on("scroll",c)}),["swipe","swipeLeft","swipeRight","swipeUp","swipeDown","doubleTap","tap","singleTap","longTap"].forEach(function(t){s.fn[t]=function(e){return this.on(t,e)}})}(n),function(s){function e(e){return!(!(e=s(e)).width()&&!e.height())&&"none"!==e.css("display")}function t(e,t){e=e.replace(/=#\]/g,'="#"]');var n,r,i=c.exec(e);if(i&&i[2]in a&&(n=a[i[2]],r=i[3],e=i[1],r)){var o=Number(r);r=isNaN(o)?r.replace(/^["']|["']$/g,""):o}return t(e,n,r)}var l=s.zepto,u=l.qsa,i=l.matches,a=s.expr[":"]={visible:function(){return e(this)?this:void 0},hidden:function(){return e(this)?void 0:this},selected:function(){return this.selected?this:void 0},checked:function(){return this.checked?this:void 0},parent:function(){return this.parentNode},first:function(e){return 0===e?this:void 0},last:function(e,t){return e===t.length-1?this:void 0},eq:function(e,t,n){return e===n?this:void 0},contains:function(e,t,n){return s(this).text().indexOf(n)>-1?this:void 0},has:function(e,t,n){return l.qsa(this,n).length?this:void 0}},c=new RegExp("(.*):(\\w+)(?:\\(([^)]+)\\))?$\\s*"),f=/^\s*>/,d="Zepto"+ +new Date;l.qsa=function(o,a){return t(a,function(e,n,r){try{var t;!e&&n?e="*":f.test(e)&&(t=s(o).addClass(d),e="."+d+" "+e);var i=u(o,e)}catch(e){throw console.error("error performing selector: %o",a),e}finally{t&&t.removeClass(d)}return n?l.uniq(s.map(i,function(e,t){return n.call(e,t,i,r)})):i})},l.matches=function(r,e){return t(e,function(e,t,n){return!(e&&!i(r,e)||t&&t.call(r,null,n)!==r)})}}(n),function(){try{getComputedStyle(void 0)}catch(e){var t=getComputedStyle;window.getComputedStyle=function(e){try{return t(e)}catch(e){return null}}}}(),e.exports=n},function(e,t,n){"use strict";var i=n(6);function u(){}var c={},o=["REJECTED"],a=["FULFILLED"],r=["PENDING"];function s(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=r,this.queue=[],this.outcome=void 0,e!==u&&h(this,e)}function l(e,t,n){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function f(t,n,r){i(function(){var e;try{e=n(r)}catch(e){return c.reject(t,e)}e===t?c.reject(t,new TypeError("Cannot resolve promise with itself")):c.resolve(t,e)})}function d(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function h(t,e){var n=!1;function r(e){n||(n=!0,c.reject(t,e))}function i(e){n||(n=!0,c.resolve(t,e))}var o=p(function(){e(i,r)});"error"===o.status&&r(o.value)}function p(e,t){var n={};try{n.value=e(t),n.status="success"}catch(e){n.status="error",n.value=e}return n}e.exports=s,s.prototype.finally=function(t){if("function"!=typeof t)return this;var n=this.constructor;return this.then(function(e){return n.resolve(t()).then(function(){return e})},function(e){return n.resolve(t()).then(function(){throw e})})},s.prototype.catch=function(e){return this.then(null,e)},s.prototype.then=function(e,t){if("function"!=typeof e&&this.state===a||"function"!=typeof t&&this.state===o)return this;var n=new this.constructor(u);this.state!==r?f(n,this.state===a?e:t,this.outcome):this.queue.push(new l(n,e,t));return n},l.prototype.callFulfilled=function(e){c.resolve(this.promise,e)},l.prototype.otherCallFulfilled=function(e){f(this.promise,this.onFulfilled,e)},l.prototype.callRejected=function(e){c.reject(this.promise,e)},l.prototype.otherCallRejected=function(e){f(this.promise,this.onRejected,e)},c.resolve=function(e,t){var n=p(d,t);if("error"===n.status)return c.reject(e,n.value);var r=n.value;if(r)h(e,r);else{e.state=a,e.outcome=t;for(var i=-1,o=e.queue.length;++i<o;)e.queue[i].callFulfilled(t)}return e},c.reject=function(e,t){e.state=o,e.outcome=t;for(var n=-1,r=e.queue.length;++n<r;)e.queue[n].callRejected(t);return e},s.resolve=function(e){if(e instanceof this)return e;return c.resolve(new this(u),e)},s.reject=function(e){var t=new this(u);return c.reject(t,e)},s.all=function(e){var n=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var r=e.length,i=!1;if(!r)return this.resolve([]);var o=new Array(r),a=0,t=-1,s=new this(u);for(;++t<r;)l(e[t],t);return s;function l(e,t){n.resolve(e).then(function(e){o[t]=e,++a!==r||i||(i=!0,c.resolve(s,o))},function(e){i||(i=!0,c.reject(s,e))})}},s.race=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,r=!1;if(!n)return this.resolve([]);var i=-1,o=new this(u);for(;++i<n;)a=e[i],t.resolve(a).then(function(e){r||(r=!0,c.resolve(o,e))},function(e){r||(r=!0,c.reject(o,e))});var a;return o}},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){window,e.exports=function(n){var r={};function i(e){if(r[e])return r[e].exports;var t=r[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,i),t.l=!0,t.exports}return i.m=n,i.c=r,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=20)}([function(e,t){e.exports=function(n){var a=[];return a.toString=function(){return this.map(function(e){var t=function(e,t){var n=e[1]||"",r=e[3];if(!r)return n;if(t&&"function"==typeof btoa){var i=function(e){return"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(e))))+" */"}(r),o=r.sources.map(function(e){return"/*# sourceURL="+r.sourceRoot+e+" */"});return[n].concat(o).concat([i]).join("\n")}return[n].join("\n")}(e,n);return e[2]?"@media "+e[2]+"{"+t+"}":t}).join("")},a.i=function(e,t){"string"==typeof e&&(e=[[null,e,""]]);for(var n={},r=0;r<this.length;r++){var i=this[r][0];"number"==typeof i&&(n[i]=!0)}for(r=0;r<e.length;r++){var o=e[r];"number"==typeof o[0]&&n[o[0]]||(t&&!o[2]?o[2]=t:t&&(o[2]="("+o[2]+") and ("+t+")"),a.push(o))}},a}},function(e,t,r){var l={},n=function(e){var t;return function(){return void 0===t&&(t=function(){return window&&document&&document.all&&!window.atob}.apply(this,arguments)),t}}(),o=function(e){var r={};return function(e,t){if("function"==typeof e)return e();if(void 0===r[e]){var n=function(e,t){return t?t.querySelector(e):document.querySelector(e)}.call(this,e,t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}r[e]=n}return r[e]}}(),s=null,u=0,a=[],c=r(58);function f(e,t){for(var n=0;n<e.length;n++){var r=e[n],i=l[r.id];if(i){i.refs++;for(var o=0;o<i.parts.length;o++)i.parts[o](r.parts[o]);for(;o<r.parts.length;o++)i.parts.push(y(r.parts[o],t))}else{var a=[];for(o=0;o<r.parts.length;o++)a.push(y(r.parts[o],t));l[r.id]={id:r.id,refs:1,parts:a}}}}function d(e,t){for(var n=[],r={},i=0;i<e.length;i++){var o=e[i],a=t.base?o[0]+t.base:o[0],s={css:o[1],media:o[2],sourceMap:o[3]};r[a]?r[a].parts.push(s):n.push(r[a]={id:a,parts:[s]})}return n}function h(e,t){var n=o(e.insertInto);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var r=a[a.length-1];if("top"===e.insertAt)r?r.nextSibling?n.insertBefore(t,r.nextSibling):n.appendChild(t):n.insertBefore(t,n.firstChild),a.push(t);else if("bottom"===e.insertAt)n.appendChild(t);else{if("object"!=typeof e.insertAt||!e.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var i=o(e.insertAt.before,n);n.insertBefore(t,i)}}function p(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e);var t=a.indexOf(e);t>=0&&a.splice(t,1)}function g(e){var t=document.createElement("style");if(void 0===e.attrs.type&&(e.attrs.type="text/css"),void 0===e.attrs.nonce){var n=r.nc;n&&(e.attrs.nonce=n)}return v(t,e.attrs),h(e,t),t}function v(t,n){Object.keys(n).forEach(function(e){t.setAttribute(e,n[e])})}function y(t,e){var n,r,i,o;if(e.transform&&t.css){if(!(o=e.transform(t.css)))return function(){};t.css=o}if(e.singleton){var a=u++;n=s||(s=g(e)),r=b.bind(null,n,a,!1),i=b.bind(null,n,a,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=function(e){var t=document.createElement("link");return void 0===e.attrs.type&&(e.attrs.type="text/css"),e.attrs.rel="stylesheet",v(t,e.attrs),h(e,t),t}(e),r=function(e,t,n){var r=n.css,i=n.sourceMap,o=void 0===t.convertToAbsoluteUrls&&i;(t.convertToAbsoluteUrls||o)&&(r=c(r)),i&&(r+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(i))))+" */");var a=new Blob([r],{type:"text/css"}),s=e.href;e.href=URL.createObjectURL(a),s&&URL.revokeObjectURL(s)}.bind(null,n,e),i=function(){p(n),n.href&&URL.revokeObjectURL(n.href)}):(n=g(e),r=function(e,t){var n=t.css,r=t.media;if(r&&e.setAttribute("media",r),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}.bind(null,n),i=function(){p(n)});return r(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;r(t=e)}else i()}}e.exports=function(e,a){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(a=a||{}).attrs="object"==typeof a.attrs?a.attrs:{},a.singleton||"boolean"==typeof a.singleton||(a.singleton=n()),a.insertInto||(a.insertInto="head"),a.insertAt||(a.insertAt="bottom");var s=d(e,a);return f(s,a),function(e){for(var t=[],n=0;n<s.length;n++){var r=s[n];(i=l[r.id]).refs--,t.push(i)}for(e&&f(d(e,a),a),n=0;n<t.length;n++){var i;if(0===(i=t[n]).refs){for(var o=0;o<i.parts.length;o++)i.parts[o]();delete l[i.id]}}}};var m=function(){var n=[];return function(e,t){return n[e]=t,n.filter(Boolean).join("\n")}}();function b(e,t,n,r){var i=n?"":r.css;if(e.styleSheet)e.styleSheet.cssText=m(t,i);else{var o=document.createTextNode(i),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(o,a[t]):e.appendChild(o)}}},function(e,t){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}e.exports=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.options=e||{}}return function(e,t,n){t&&r(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(t,[{key:"name",get:function(){return this.constructor.name}},{key:"tagName",get:function(){return this.options.tagName||"div"}},{key:"attributes",get:function(){return{class:this.options.className}}},{key:"attr",value:function(e,t){if(void 0===t)return this.element.getAttribute(e);this.element.setAttribute(e,t)}},{key:"show",value:function(){this.removeClass("ad_runner_ui_hide")}},{key:"hide",value:function(){this.addClass("ad_runner_ui_hide")}},{key:"on",value:function(e,t){this.element.addEventListener(e,t)}},{key:"off",value:function(e,t){this.element.removeEventListener(e,t)}},{key:"html",value:function(e){this.element.innerHTML=e}},{key:"style",value:function(e,t){this.element.style[e]=t}},{key:"appendChild",value:function(e){this.element.appendChild(e.element||e)}},{key:"hasClass",value:function(e){return this.element.classList?this.element.classList.contains(e):new RegExp("(^|\\s)"+e+"($|\\s)").test(this.element.className)}},{key:"addClass",value:function(e){this.element.classList?this.element.classList.add(e):this.hasClass(this.element,e)||(this.element.className=(this.element.className+" "+e).trim())}},{key:"removeClass",value:function(t){this.element.classList?this.element.classList.remove(t):this.element.className=this.element.className.split(/\s+/).filter(function(e){return e!==t}).join(" ")}},{key:"render",value:function(){var n=this;this.element=this.options.element||document.createElement(this.tagName),Object.keys(this.attributes).forEach(function(e){var t=n.attributes[e];void 0!==t&&n.element.setAttribute(e,t)})}},{key:"remove",value:function(){this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.element=null}}]),t}()},function(e,t,n){var r=n(5).DEFAULT_MAX_VOLUME;function i(e,t){return String(e).toUpperCase().indexOf(String(t).toUpperCase())>-1}function o(){var n={};return n.promise=new Promise(function(e,t){n.resolve=e,n.reject=t}),n}e.exports={contentVolumeToAdVolume:function(e){return e?e/100*r:0},convertToSecond:function(e){var t=isNaN(e)?e.split(":"):e;return 60*+t[0]*60+60*+t[1]+ +t[2]},isImaAd:function(e){return!i(e.system.name,"celtra")&&(i(e.system.name,"google")||i(e.system.version,"google")||i(e.system.name,"gamma"))},isFacebookAd:function(e){return i(e.system.name,"facebook")||i(e.system.version,"facebook")},isAsiaSmartAd:function(e){return e.vastAdTagURI&&i(e.vastAdTagURI,"adnetwork.adasiaholdings.com")||i(e.system.name,"smart")||i(e.system.name,"wootag")},isYomediaAd:function(e){return i(e.system.name,"yomedia")},formatTime:function(e,t){if(!isFinite(e))return"--:--";e*=1e3;var n=(e=parseInt(e/1e3))%60,r=(e=parseInt(e/60))%60,i=(e=parseInt(e/60))%24,o=parseInt(e/24),a="";return o&&o>0&&(a+=o+":",i<1&&(a+="00:")),(i&&i>0||t)&&(a+=("0"+i).slice(-2)+":"),a+=("0"+r).slice(-2)+":",(a+=("0"+n).slice(-2)).trim()},createPromiseDefer:o,createTimeoutPromise:function(e){var t=o(),n=setTimeout(t.resolve,e);return t.promise.cancel=function(){return clearTimeout(n)},t.promise},isMobile:function(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|Windows Phone|IEMobile|Opera Mini/i.test(navigator.userAgent)}}},function(e,t,n){"use strict";var r=["AdLoaded","AdStarted","AdStopped","AdSkipped","AdSkippableStateChange","AdSizeChange","AdLinearChange","AdDurationChange","AdExpandedChange","AdRemainingTimeChange","AdVolumeChange","AdImpression","AdViewableImpression","AdVideoStart","AdVideoFirstQuartile","AdVideoMidpoint","AdVideoThirdQuartile","AdVideoProgress","AdVideoComplete","AdClickThru","AdInteraction","AdUserAcceptInvitation","AdUserMinimize","AdUserClose","AdPaused","AdPlaying","AdLog","AdError","AdClickBackground","AdClickThruVpaid"];r.forEach(function(e){r[e]=e}),Object.freeze(r),e.exports=r},function(e,t){e.exports={AD_POSITION:{preroll:"pre-roll",midroll:"mid-roll",postroll:"post-roll"},AD_DONE_REASON:{timeout:"timeout",error:"error",ended:"ended",skipped:"skipped"},COUNT_DOWN_DURATION:5,PRELOAD_DURATION:7,DEFAULT_MIDROLL_START_TIME:10,DEFAULT_SKIP_TIMEOUT:3,DEFAULT_AD_START_TIMEOUT:10,DEFAULT_NON_LINEAR_DURATION:15,DEFAULT_MAX_VOLUME:.75}},function(e,t){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function l(e){return"function"==typeof e}function u(e){return"object"===n(e)&&null!==e}function c(e){return void 0===e}r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(e){if(!function(e){return"number"==typeof e}(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},r.prototype.emit=function(e){var t,n,r,i,o,a;if(this._events||(this._events={}),"error"===e&&(!this._events.error||u(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var s=new Error('Uncaught, unspecified "error" event. ('+t+")");throw s.context=t,s}if(c(n=this._events[e]))return!1;if(l(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:i=Array.prototype.slice.call(arguments,1),n.apply(this,i)}else if(u(n))for(i=Array.prototype.slice.call(arguments,1),r=(a=n.slice()).length,o=0;o<r;o++)a[o].apply(this,i);return!0},r.prototype.addListener=function(e,t){var n;if(!l(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,l(t.listener)?t.listener:t),this._events[e]?u(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,u(this._events[e])&&!this._events[e].warned&&(n=c(this._maxListeners)?r.defaultMaxListeners:this._maxListeners)&&n>0&&this._events[e].length>n&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(e,t){if(!l(t))throw TypeError("listener must be a function");var n=!1;function r(){this.removeListener(e,r),n||(n=!0,t.apply(this,arguments))}return r.listener=t,this.on(e,r),this},r.prototype.removeListener=function(e,t){var n,r,i,o;if(!l(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(i=(n=this._events[e]).length,r=-1,n===t||l(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(u(n)){for(o=i;o-- >0;)if(n[o]===t||n[o].listener&&n[o].listener===t){r=o;break}if(r<0)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(r,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},r.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(l(n=this._events[e]))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},r.prototype.listeners=function(e){return this._events&&this._events[e]?l(this._events[e])?[this._events[e]]:this._events[e].slice():[]},e.exports=r},function(e,t,n){e.exports={VastPlayer:n(22),VAST:n(8),EventEmitter:n(6)}},function(e,t,n){e.exports=n(23)},function(e,t,n){"use strict";var r=["abort","canplay","canplaythrough","durationchange","emptied","encrypted","ended","error","interruptbegin","interruptend","loadeddata","loadedmetadata","loadstart","mozaudioavailable","pause","play","playing","progress","ratechange","seeked","seeking","stalled","suspend","timeupdate","volumechange","waiting"];r.forEach(function(e){this[e.toUpperCase()]=e},r),Object.freeze(r),e.exports=r},function(e,t,n){"use strict";var r=n(15),i=document.createElement("video");n(14),t.isDesktop=!/Android|Silk|Mobile|PlayBook/.test(r.navigator.userAgent),t.canPlay=function(e){switch(i.canPlayType(e)){case"probably":return 2;case"maybe":return 1;default:return 0}},Object.freeze(t)},function(e,t,n){"use strict";function i(n,e,r){e.on(n,function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];r.emit.apply(r,[n].concat(e))})}function r(t,n,r){r.forEach(function(e){n.listeners(e).length>0&&i(e,t,n)}),n.on("newListener",function(e){r.indexOf(e)>-1&&n.listeners(e).length<1&&i(e,t,n)})}function o(e){this.events=e.slice(),this.__private__={target:null,source:null}}o.prototype.from=function(e){return this.__private__.source=e,this.__private__.target&&r(e,this.__private__.target,this.events),this},o.prototype.to=function(e){return this.__private__.target=e,this.__private__.source&&r(this.__private__.source,e,this.events),this},e.exports=o},function(e,t){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}e.exports=function(){function i(e,t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),this.adContainerElement=e,this.videoContent=t,this.logger=n.logger,this.onAdStarted=n.onAdStarted,this.onAdStopped=n.onAdStopped,this.onAdLoaded=n.onAdLoaded,this.options=r,this.logger.debug(this.name,"initializing")}return function(e,t,n){t&&r(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(i,[{key:"selfControl",get:function(){return!1}},{key:"canClickThrough",get:function(){return!1}},{key:"viewDetailLink",get:function(){return""}},{key:"loadAd",value:function(e){throw new Error("this must be overridden")}},{key:"initUserAction",value:function(){throw new Error("this must be overridden")}},{key:"canRun",value:function(e){throw new Error("this must be overridden")}},{key:"start",value:function(){throw new Error("this must be overridden")}},{key:"stop",value:function(){throw new Error("this must be overridden")}},{key:"pause",value:function(){throw new Error("this must be overridden")}},{key:"resume",value:function(){throw new Error("this must be overridden")}},{key:"cancel",value:function(){throw new Error("this must be overridden")}},{key:"viewDetail",value:function(){throw new Error("this must be overridden")}},{key:"setVolume",value:function(e){throw new Error("this must be overridden")}},{key:"setAdData",value:function(e){this.adData=e}},{key:"getVolume",value:function(){throw new Error("this must be overridden")}},{key:"isPaused",value:function(){throw new Error("this must be overridden")}},{key:"getRemainingTime",value:function(){throw new Error("this must be overridden")}},{key:"getDuration",value:function(){throw new Error("this must be overridden")}},{key:"getSkipOffset",value:function(){throw new Error("this must be overridden")}},{key:"resize",value:function(e,t,n){}},{key:"destroy",value:function(){throw new Error("this must be overridden")}}]),i}()},function(e,t,n){"use strict";e.exports=function(){return Array.prototype.slice.call(arguments).reduce(function(e,n){return Object.keys(n||{}).reduce(function(e,t){return e[t]=n[t],e},e)},{})}},function(e,t){var n={JAVASCRIPT:"application/javascript",FLASH:"application/x-shockwave-flash"};Object.freeze(n),e.exports=n},function(e,t){e.exports=window},function(e,t,n){"use strict";var r=n(40),i=n(9);function o(t,e){var n=this;r.call(this,Math.floor(t.duration||0),e),this.video=t,[i.PLAYING,i.PAUSE,i.TIMEUPDATE].forEach(function(e){return t.addEventListener(e,function(){return n.tick()},!1)})}o.prototype=Object.create(r.prototype),o.prototype._getState=function(){return{playing:!this.video.paused,currentTime:this.video.currentTime}},e.exports=o},function(e,t){e.exports={getVpaidVendor:function(e){return/moatads\.com/.test(e[0].uri)?"MOAT":/yomedia\.vn/.test(e[0].uri)?"YOMEDIA":null},getUrlParam:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];t||(t=window.location.href),e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var r="[\\".concat(n?"#":"?","&]").concat(e,"=([^&#]*)"),i=new RegExp(r).exec(t);return null==i?null:decodeURIComponent(i[1])},httpGet:function(r){return new Promise(function(e,t){var n=new XMLHttpRequest;n.open("GET",r,!0),n.withCredentials=!0,n.onreadystatechange=function(){n.readyState===XMLHttpRequest.DONE&&(200===n.status?e(n.responseText):t(new Error("unexpected status code or empty body: ".concat(n.status))))},n.send()})},isURL:function(e){return!!new RegExp("^(https?:\\/\\/)?","i").test(e)}}},function(e,t,n){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=n(46),o=n(52),h=n(53),p=[i,o,h],g=function(){},a=function(){function d(e){var t=this,n=e.linearAdContainer,r=e.nonLinearAdContainer,i=e.contentPlayer,o=e.logger,a=e.onAdStarted,s=e.onAdStopped,l=e.onAdSkipped,u=e.onAdLoaded,c=e.onResetState,f=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),this.logger=o,this.props={onAdStarted:a,onAdStopped:s,onAdSkipped:l,onAdLoaded:u||g,onResetState:c||g},this.loadPromise=null,this.currentPlayer=null,this.adData=null,this.adStarted=!1,this.adCancelled=!1,this.adVolume=1,this.lastError=null,this.players=p.map(function(e){return new e(e===h?r:n,i,{logger:o,onAdStarted:t._onAdStarted.bind(t),onAdStopped:t._onAdStopped.bind(t),onAdSkipped:t._onAdSkipped.bind(t),onAdLoaded:t._onAdLoaded.bind(t)},f)})}return function(e,t,n){t&&r(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(d,[{key:"name",get:function(){return"Player"}},{key:"initUserAction",value:function(){this.players.forEach(function(e){return e.initUserAction()})}},{key:"load",value:function(e){return this.adData=e,this.adCancelled=!1,this.adStarted=!1,this.lastError=null,this.loadPromise=this._loadAd(),this.loadPromise}},{key:"start",value:function(){this._playAd()}},{key:"stop",value:function(){this.currentPlayer.stop()}},{key:"skip",value:function(){this.currentPlayer.skip()}},{key:"cancel",value:function(){this.adCancelled=!0,this.currentPlayer&&this.currentPlayer.cancel()}},{key:"pause",value:function(){this.currentPlayer.pause()}},{key:"resume",value:function(){this.currentPlayer.resume()}},{key:"destroy",value:function(){this.players.forEach(function(e){return e.destroy()})}},{key:"resize",value:function(t,n,r){this.players.forEach(function(e){return e.resize(t,n,r)})}},{key:"setVolume",value:function(e){this.adVolume=e,this.currentPlayer&&this.currentPlayer.setVolume(e)}},{key:"getCurrentPlayer",value:function(){return this.currentPlayer}},{key:"isPlayingLinearAd",value:function(){return this.currentPlayer instanceof i?this.currentPlayer.currentAd&&this.currentPlayer.currentAd.isLinear():!(this.currentPlayer instanceof h)}},{key:"isGoogleNonLinearAd",value:function(){return this.currentPlayer instanceof i&&this.currentPlayer.currentAd&&!this.currentPlayer.currentAd.isLinear()}},{key:"_onAdStarted",value:function(){this.adStarted=!0,this.props.onAdStarted()}},{key:"_onAdStopped",value:function(e,t,n,r){var i=r||this.adData;this.adStarted||n?this.props.onAdStopped(e,t,i):(this.lastError=e,this._playAd(this.adIndex+1))}},{key:"_onAdSkipped",value:function(){this.props.onAdSkipped()}},{key:"_onAdLoaded",value:function(){this.props.onAdLoaded()}},{key:"_loadAd",value:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(this.logger.debug(this.name,"_loadAd | adIndex",n," | adData",this.adData.ads),this.adCancelled)return Promise.resolve();var e=this.adData.ads[n];if(this.currentPlayer=null,!e)return n>0&&this.logger.debug(this.name,"no ad left to load"),Promise.resolve();this.logger.debug(this.name,"loading ad item ".concat(n+1,"/").concat(this.adData.ads.length),e);var r=this._getPlayerForAd(e);return r?r.loadAd(e,this.adData).then(function(){return t.logger.debug(t.name,"ad loaded"),{player:r,adIndex:n}}).catch(function(e){return t.logger.error(t.name,"error while loading ad, falling back to next item:",e),t._loadAd(n+1)}):(this.logger.debug(this.name,"no player to play this ad, trying next item",e),this._loadAd(n+1))}},{key:"_playAd",value:function(){var e,r=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.adCancelled||(this.loadPromise?(e=this.loadPromise,delete this.loadPromise):e=this._loadAd(t),e.then(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.player,n=e.adIndex;r.adCancelled||(t?(r.adIndex=n,r.currentPlayer=t,t.setAdData(r.adData),t.setVolume(r.adVolume),t.start()):r._onAdStopped(r.lastError||new Error("Cannot run ad"),null,!0))}))}},{key:"_getPlayerForAd",value:function(t){return this.players.filter(function(e){return e.canRun(t)})[0]}}]),d}();e.exports=a},function(e,t,n){function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t){return(a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var l=n(2),u=n(3).formatTime;n(62),e.exports=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&a(e,t)}(r,l);var n=function(r){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=s(r);if(i){var n=s(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===o(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)}}(r);function r(e){var t;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(t=n.call(this,e)).render(),"string"!=typeof t.options.template)throw new Error("options.template is required");return t}return function(e,t,n){t&&i(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(r,[{key:"attributes",get:function(){return{class:this.options.className||"ad_runner_ui_countdown"}}},{key:"update",value:function(e){this._setRemainingTime(e)}},{key:"_setRemainingTime",value:function(e){var t;t=this.options.formatTime?u(e):Math.round(e),this.element.textContent=this.options.template.replace("%s",t)}}]),r}()},function(e,t,n){e.exports={Runner:n(21),Player:n(18),VAST:n(7).VAST}},function(e,t,n){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=n(7).VAST,a=n(18),s=n(60),l=n(61),u=n(87),i=n(3),c=i.contentVolumeToAdVolume,f=i.convertToSecond,d=i.createPromiseDefer,h=i.createTimeoutPromise,p=n(5),g=p.AD_POSITION,v=p.AD_DONE_REASON,y=p.DEFAULT_AD_START_TIMEOUT,m=p.DEFAULT_MIDROLL_START_TIME,b={free:1,loading:2,starting:3,playing:4},E={startTimeout:y,skipTimeout:p.DEFAULT_SKIP_TIMEOUT,countdownPlay:!0,defaultMidrollStartTime:m,getPoster:function(){},showSlideBlack:!1,removeAdmarkOnError:!0,autoPlayAdBreaks:!0,autoPlay:!1,mute:!1},T=function(){function i(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),this.plugin=e,this.options=this._normalizeOption(t);var n=e.getAdContainers(),r=e.getContentPlayer();this.player=new a({linearAdContainer:n.linear,nonLinearAdContainer:n.nonLinear,contentPlayer:r,logger:this.logger,onAdStarted:this._onAdStarted.bind(this),onAdStopped:this._onAdStopped.bind(this),onAdSkipped:this._onAdSkipped.bind(this),onAdLoaded:this._onAdLoaded.bind(this),onResetState:this._onResetState.bind(this)},this.options),this.scheduler=new s({logger:this.logger,prepareAd:this._prepareAd.bind(this),beforePlayAd:this._beforePlayAd.bind(this),preloadAd:this._preloadAd.bind(this),loadAd:this._loadAd.bind(this),playAd:this._playAd.bind(this)}),this.adUi=new l(this.options,n),this.adMark=new u(n.adMark),this.state=b.free,this.adsLoaded=!1,this.adDeferred=null}return function(e,t,n){t&&r(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(i,[{key:"name",get:function(){return"Runner"}},{key:"logger",get:function(){return this.plugin.getLogger()}},{key:"viewDetailLink",get:function(){var e=this.player.getCurrentPlayer();return e&&e.viewDetailLink}},{key:"onContentProgress",value:function(e){this.scheduler.onContentProgress(e)}},{key:"onContentEnded",value:function(){this.scheduler.onContentEnded(),this.adMark.removeMarkItems()}},{key:"onUserAction",value:function(){this.player.initUserAction()}},{key:"onAdsDataLoaded",value:function(e){var t=this;this.logger.debug(this.name,"onAdsDataLoaded",e),this._normalizeAdsData(e),this.scheduler.populateAdsData(e),this.plugin.getContentMetadata().then(function(e){t.scheduler&&t.scheduler.dataLoadingDeferred.promise.then(function(){t.adMark.render(e.duration,t.scheduler.midrollAds)})})}},{key:"destroy",value:function(){this.player.destroy(),this.player=null,this.scheduler=null,this.adUi.remove(),this.adMark.remove()}},{key:"resize",value:function(e,t,n){this.player.resize(e,t,n)}},{key:"pauseAd",value:function(){this.player.pause()}},{key:"resumeAd",value:function(){this.player.resume()}},{key:"stopAd",value:function(){this.player.stop()}},{key:"showPosterAndPlayIcon",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this.adUi.skipButton,n=t.poster,r=t.playIcon;e?(t.loadPoster(),n.show(),r.show()):(n.hide(),r.hide())}},{key:"_onResetState",value:function(){this.state=b.free,this.adsLoaded=!1}},{key:"_preloadAd",value:function(e){this.adsLoaded||this._loadAd(e)}},{key:"_prepareAd",value:function(e,t){this.options.countdownPlay&&this.adsLoaded&&(this.adUi.countdownToPlay.show(),this.adUi.countdownToPlay.update(t))}},{key:"_beforePlayAd",value:function(e,t){var n=this;this.adUi.countdownToPlay.hide(),e||!this.adsLoaded?setTimeout(function(){n.adsLoaded&&(n.options.showSlideBlack?(n.plugin.pauseForAd(),n.logger.debug(n.name,"Showing black screen"),n.adUi.slideBlack.show(),n.adUi.slideBlack.fadeIn(),setTimeout(function(){t()},2e3)):t())},1e3):t()}},{key:"_loadAd",value:function(e){this.state===b.free&&(this.adsLoaded=!1,this.state=b.loading,this.adDeferred=d(),this.logger.debug(this.name,"loading ad",e),this.player.load(e))}},{key:"_playAd",value:function(e,t){var n=this;return this._loadAd(e),this.logger.debug(this.name,"play ad",e),this.state=b.starting,this.adMetadata=t,this.adUi.onAdWillStart(),this.plugin.onAdWillStart&&this.plugin.onAdWillStart(),this.adTimeoutPromise=h(1e3*this.options.startTimeout),this.adTimeoutPromise.then(function(){n.logger.debug(n.name,"cannot start ad within ".concat(n.options.startTimeout,"s, cancelling...")),n.player&&n.player.cancel(),n._onAdStopped(null,v.timeout,e)}),this.player.setVolume(c(this.plugin.getContentVolume())),this.player.start(),this.adDeferred.promise}},{key:"_onAdStarted",value:function(){var e=this;this._mayPauseContent();var t=this.player.getCurrentPlayer();this.state=b.playing,this.adTimeoutPromise.cancel(),this.adUi.slideBlack.fadeOut(),setTimeout(function(){e.adUi.slideBlack.hide()},400),this.adUi.setPlayer(t),this.adUi.onAdStarted(this.adMetadata),this.plugin.onAdStarted&&this.plugin.onAdStarted(),this.logger.debug(this.name,"ad started by player:",t.name),this.player.isPlayingLinearAd()||(this.state=b.free,this.adDeferred.resolve(),this._mayResumeContent())}},{key:"_onAdStopped",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:v.ended,r=arguments.length>2?arguments[2]:void 0;switch(e&&(n=v.error),this.player.isGoogleNonLinearAd()&&this.plugin.hideLinearAdContainer&&this.plugin.hideLinearAdContainer(),(!e||e&&this.options.removeAdmarkOnError)&&r._completeAd&&r._completeAd(),this.state){case b.loading:break;case b.starting:case b.playing:}t.adTimeoutPromise.cancel(),t.adUi.onAdStopped(),t.plugin.onAdStopped&&t.plugin.onAdStopped(n),t._mayResumeContent(),t.logger.debug(t.name,"ad stopped:",n,e||""),t.adUi.slideBlack.hide(),this.state=b.free,this.adsLoaded=!1,this.adDeferred.resolve()}},{key:"_onAdSkipped",value:function(){this.plugin.onAdSkipped&&this.plugin.onAdSkipped()}},{key:"_onAdLoaded",value:function(){this.adsLoaded=!0}},{key:"_mayPauseContent",value:function(){this.player.isPlayingLinearAd()?this.plugin.pauseForAd():this.player.isGoogleNonLinearAd()&&(this.plugin.showLinearAdContainer&&this.plugin.showLinearAdContainer(),this.adUi.onAdStopped())}},{key:"_mayResumeContent",value:function(){this.adMetadata.order===this.adMetadata.total&&this.plugin.resumeAfterAd()}},{key:"_normalizeAdsData",value:function(e){var t=this;e.forEach(function(e){e.ads=o.pojoFromXML(e.server.tag).ads,delete e.server,Object.assign(e,t._buildAdOption(e))})}},{key:"_buildAdOption",value:function(e){var t={position:e.position,skipoffset:e.skipoffset?f(e.skipoffset):-1,startTime:e.startTime?f(e.startTime):0};return t.position!==g.midroll||t.startTime||(this.logger.warn(this.name,"no startTime specified on mid-roll ad, will use default startTime:",this.options.defaultMidrollStartTime),t.startTime=this.options.defaultMidrollStartTime),t}},{key:"_normalizeOption",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.assign({},E,e,{getPoster:this.plugin.getPoster&&this.plugin.getPoster.bind(this.plugin)})}}]),i}();e.exports=T},function(e,t,n){"use strict";function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var r=n(6),i=n(8),c=n(37),f=n(41),d=n(4),h=n(11),p=n(44),a=n(45),l=n(10),g=n(17);function u(e){return e}function o(){return new Error("VASTPlayer not ready.")}function v(n){return function(){var e=this,t=this.__private__.player;return this.ready?t[n]?t[n].apply(t,arguments).then(function(){return e}):Promise.resolve().then(function(){return e}):Promise.reject(o())}}function y(t){return{get:function(){if(!this.ready)throw o();return this.__private__.player[t]},set:function(e){if(!this.ready)throw o();return this.__private__.player[t]=e}}}function m(e,t){return String(e).toUpperCase().indexOf(String(t).toUpperCase())>-1}function b(e,t){var n=this;r.call(this),this.__private__={container:e,config:function e(){var t,n,r,i,o={},a=arguments.length;for(t=0;t<a;t++)for(r in n=arguments[t]||{})i=n[r],void 0===o[r]&&(o[r]=i),"object"===s(i)&&(o[r]=e(o[r],i));return o}(t,{vast:{resolveWrappers:!0,maxRedirects:5},tracking:{mapper:u},width:480,height:270}),vast:null,ready:!1,player:null,isVPAID:!1,vpaidVendor:null,video:a()};var o=this;this.on(d.AdClickThru,function(e,t,n){var r=e||o.viewDetailLink;n&&r&&(this.__private__.player.alreadyEmitViewable||(this.__private__.player.alreadyEmitViewable=!0,this.__private__.player.emit(d.AdViewableImpression)),window.open(r));var i=o.vast.get("ads[0].creatives[0].videoClicks.clickTrackings");i&&i.length>0&&i.map(function(e){var t=new XMLHttpRequest;t.open("GET",e,!0),t.send(null)})}),this.on(d.AdClickBackground,function(){var e=o.__private__.player;e.video&&l.isDesktop&&(e.video.paused?n.resumeAd():n.pauseAd())})}n(15).console,b.prototype=Object.create(r.prototype),Object.defineProperties(b.prototype,{container:{get:function(){return this.__private__.container}},config:{get:function(){return this.__private__.config}},vast:{get:function(){return this.__private__.vast}},ready:{get:function(){return this.__private__.ready}},paused:{get:function(){return this.__private__.video.paused}},video:{set:function(e){return this.__private__.video=e}},isVPAID:{get:function(){return this.__private__.isVPAID}},isAsiaSmartAd:{get:function(){return(e=this.vast.ads[0]).vastAdTagURI&&m(e.vastAdTagURI,"adnetwork.adasiaholdings.com")||m(e.system.name,"smart")||m(e.system.name,"wootag");var e}},vpaidVendor:{get:function(){return this.__private__.vpaidVendor}},viewDetailLink:{get:function(){return this.vast&&this.vast.get("ads[0].creatives[0].videoClicks.clickThrough")}},adRemainingTime:y("adRemainingTime"),adDuration:y("adDuration"),adVolume:y("adVolume")}),b.prototype.load=function(e){var u=this,t=this.config.vast;return("string"==typeof e?i.fetch(e,t):new i(e).resolveWrappers()).then(function(n){var e=function(){var e=n.filter("ads[0].creatives[0].mediaFiles",c.canPlayMediaFile),t=n.filter("ads[0].creatives[0].mediaFiles",f.canPlayMediaFile);if(t.length>0)return u.__private__.isVPAID=!1,u.__private__.vpaidVendor=null,{player:new f(u.container,u.__private__.video,u.config),mediaFiles:t};if(e.length>0)return u.__private__.isVPAID=!0,u.__private__.vpaidVendor=g.getVpaidVendor(e),{player:new c(u.container,u.__private__.video,u.config,u),mediaFiles:e};throw new Error("There are no playable <MediaFile>s.")}(),t=e.player,r=e.mediaFiles,i={adParameters:n.get("ads[0].creatives[0].parameters"),progressEvents:n.get("ads[0].creatives[0].trackingEvents").filter(function(e){return"progress"==e.event})},o=[].concat(n.map("ads[0].impressions",function(e){return{event:"impression",uri:e.uri}}),n.map("ads[0].viewableImpressions",function(e){return{event:"viewableImpression",uri:e.uri}}),n.map("ads[0].errors",function(e){return{event:"error",uri:e}}),n.get("ads[0].creatives[0].trackingEvents"),n.map("ads[0].creatives[0].videoClicks.clickTrackings",function(e){return{event:"clickThrough",uri:e}})),a=new h(d),s=new p(o,u.config.tracking.mapper);if(a.from(t).to(u),u.__private__.vast=n,u.__private__.player=t,u.isAsiaSmartAd){var l=n.get("ads[0].creatives[0].duration");l&&(t.adDuration=l)}return t.load(r,i).then(function(){s.track(t)})}).then(function(){return u.__private__.ready=!0,u.emit("ready"),u}).catch(function(e){throw u.emit("error",e),e})},b.prototype.startAd=v("startAd"),b.prototype.stopAd=v("stopAd"),b.prototype.skipAd=v("skipAd"),b.prototype.pauseAd=v("pauseAd"),b.prototype.resumeAd=v("resumeAd"),b.prototype.playAd=v("playAd"),b.prototype.init=function(){var e=this.__private__.video,t=this.__private__.container;return e.init(t)},b.vpaidSWFLocation="https://ajax.cdnjs.com/ajax/libs/videojs-vast-vpaid/2.0.2/VPAIDFlash.swf",e.exports=b},function(e,t,n){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o=n(24),r=n(25),a=n(26),s=n(13),l=n(27),u=Array.prototype.push,c=n(28),f={inline:function(e){a({description:null,survey:null},e)},wrapper:function(){}},d={linear:function(e){a({trackingEvents:[],parameters:null,videoClicks:null},e),(e.mediaFiles||[]).forEach(function(e){a({id:null,bitrate:null,scalable:null,maintainAspectRatio:null,apiFramework:null},e)})},companions:function(e){e.companions.forEach(function(e){a({expandedWidth:null,expandedHeight:null,apiFramework:null,trackingEvents:[],clickThrough:null,altText:null,parameters:null},e)})},nonLinear:function(e){a({trackingEvents:[]},e),e.ads.forEach(function(e){a({id:null,expandedWidth:null,expandedHeight:null,scalable:null,maintainAspectRatio:null,minSuggestedDuration:null,apiFramework:null,clickThrough:null,parameters:null},e)})}},h=["ads.celtra.com"];function p(){}function g(t,e){var n=t.indexOf("redirectUrl=");if(n>-1&&h.some(function(e){return t.indexOf(e)>-1})){var r=t.slice(n+"redirectUrl=".length);return t=t.slice(0,n),o.get(t,e).catch(p).then(function(){return o.get(r,e)})}return o.get(t,e)}function v(e){r(e,this,!0),this.ads.forEach(function(e){a({system:{version:null},errors:[]},e),e.creatives.forEach(function(e){a({id:null,sequence:null,adID:null},e),d[e.type](e)}),f[e.type](e)}),this.__private__={wrappers:[],inlines:[]}}Object.defineProperties(v.prototype,{wrappers:{get:function(){var e=this.__private__.wrappers;return e.length=0,u.apply(e,this.filter("ads",function(e){return"wrapper"===e.type})),e}},inlines:{get:function(){var e=this.__private__.inlines;return e.length=0,u.apply(e,this.filter("ads",function(e){return"inline"===e.type})),e}}}),v.prototype.get=function(e){return((e||"").match(/[^\[\]\.]+/g)||[]).reduce(function(e,t){return e?e[t]:void 0},this)},v.prototype.set=function(r,e){var t=function(){for(var e,t=/[^\[\]\.]+/g,n=[];e=t.exec(r);)n.push({token:e[0],type:o(e,e.index+e[0].length)});return n}(),n=t.pop(),i=t.reduce(function(e,t){return e[t.token]||(e[t.token]=new t.type)},this);function o(e,t){switch(e.input.charAt(t)){case".":return Object;case"[":return Array;case"]":return o(e,t+1);default:return null}}if(!r)throw new Error("prop must be specified.");return i[n.token]=e},v.prototype.map=function(e,t){var n=this.get(e)||[],r=n.length,i=[];if(!(n instanceof Array))return i;for(var o=0;o<r;o++)i.push(t.call(this,n[o],o,n));return i},v.prototype.filter=function(e,t){var n=this.get(e)||[],r=n.length,i=[];if(!(n instanceof Array))return i;for(var o=0;o<r;o++)t.call(this,n[o],o,n)&&i.push(n[o]);return i},v.prototype.find=function(e,t){var n=this.get(e)||[],r=n.length;if(n instanceof Array)for(var i=0;i<r;i++)if(t.call(this,n[i],i,n))return n[i]},v.prototype.toPOJO=function(){var e=JSON.parse(JSON.stringify(this));return delete e.__private__,e},v.prototype.copy=function(){return new this.constructor(this.toPOJO())},v.prototype.resolveWrappers=function(){var t=isNaN(arguments[0])?1/0:arguments[0],e="function"==typeof arguments[0]?arguments[0]:arguments[1],n=this.constructor,r=this;return 0===t?Promise.reject(new Error("Too many redirects were made.")):l(Promise.all(this.map("wrappers",function(t){return Promise.resolve(g(t.vastAdTagURI,{withCredentials:!0})).then(function(e){return{wrapper:t,response:n.pojoFromXML(e.data).ads}})})).then(function(e){var i=e.map(function(e){return e.wrapper}),o=e.map(function(e){return e.response});return new n(s(r.toPOJO(),{ads:r.map("ads",function(e){var t=i.indexOf(e),n=i[t],r=o[t];return r?r.map(function(e,t){var n=function(e){return{linear:e.filter(r("linear")),companions:e.filter(r("companions")),nonLinear:e.filter(r("nonLinear"))}}(e.creatives);function r(t){return function(e){return e.type===t}}return a(e.impressions,t.impressions),a(e.viewableImpressions,t.viewableImpressions),a(e.errors,t.errors),t.creatives.forEach(function(e){a(n[e.type].shift()||{},e)}),u.apply(t.creatives,"wrapper"!==t.type?[]:["linear","companions","nonLinear"].reduce(function(e,t){return e.concat(n[t])},[])),t}.bind(null,n)):[e]}).reduce(function(e,t){return e.concat(t)})}))}).then(function(e){return e.get("wrappers.length")>0?e.resolveWrappers(t-1):e}),e)},v.prototype.toXML=function(){var e=this.validate();if(!e.valid)throw new Error("VAST is invalid: "+e.reasons.join(", "));return c(this)},v.prototype.validate=function(){var t=this,n=[],r={inline:function(r){var i={linear:function(e){s(e,{exists:["duration"],atLeastOne:["mediaFiles"]})},companions:function(n){t.get(n("companions")).forEach(function(e,t){s(function(e){return n("companions["+t+"]."+e)},{exists:[],atLeastOne:["resources"]})})},nonLinear:function(n){t.get(n("ads")).forEach(function(e,t){s(function(e){return n("ads["+t+"]."+e)},{exists:[],atLeastOne:["resources"]})})}};s(r,{exists:["title"],atLeastOne:["creatives"]}),t.get(r("creatives")).forEach(function(e,t){function n(e){return r("creatives["+t+"]."+e)}s(n,{exists:["type"],atLeastOne:[]}),(i[e.type]||p)(n)})},wrapper:function(e){s(e,{exists:["vastAdTagURI"],atLeastOne:[]})}};function i(e,t){e||n.push(t)}function o(e){i(t.get(e),e+" is required")}function a(e){i(t.get(e+".length")>0,e+" must contain at least one value")}function s(e,t){t.exists.map(e).forEach(o),t.atLeastOne.map(e).forEach(a)}return s(function(e){return e},{exists:[],atLeastOne:["ads"]}),this.get("ads").forEach(function(e,t){function n(e){return"ads["+t+"]."+e}s(n,{exists:["type","system.name"],atLeastOne:["impressions"]}),(r[e.type]||p)(n)}),{valid:0===n.length,reasons:0===n.length?null:n}},v.pojoFromXML=n(31),v.fetch=function(e){var n="object"===i(arguments[1])&&arguments[1]||{},t="function"==typeof arguments[2]?arguments[2]:arguments[1],r=this;return l(Promise.resolve(g(e,{headers:n.headers||{}})).then(function(e){var t=new r(r.pojoFromXML(e.data));return n.resolveWrappers?t.resolveWrappers(n.maxRedirects):t}),t)},e.exports=v},function(e,t){e.exports={get:function(r){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=e.withCredentials,o=e.headers;return new Promise(function(e,t){var n=new XMLHttpRequest;n.open("GET",r),n.withCredentials=Boolean(i),n.onreadystatechange=function(){n.readyState===XMLHttpRequest.DONE&&(200===n.status?e({data:n.responseText}):t(new Error("Unexpected status code:",n.status)))},o&&Object.keys(o).forEach(function(e){n.setRequestHeader(e,o[e])}),n.send()})}}},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o=Array.prototype.push;e.exports=function i(e){var t="object"===r(arguments[1])?arguments[1]:null,n="boolean"==typeof arguments[1]?arguments[1]:arguments[2];return Object(e)!==e?e:e instanceof Array?function(e,t,n){var r=t||[];return o.apply(r,n?e.map(function(e){return i(e,null,!0)}):e),r}(e,t,n):function(n,e,r){return Object.keys(n).reduce(function(e,t){return e[t]=r?i(n[t],null,!0):n[t],e},e||{})}(e,t,n)}},function(e,t,n){"use strict";var i=Array.prototype.push;function o(e){return Object(e)===e}function a(e){return e instanceof Array}e.exports=function n(r,t){return[r,t].every(a)?(i.apply(t,r.filter(function(e){return t.indexOf(e)<0})),t):Object.keys(r).reduce(function(e,t){return[r[t],e[t]].every(o)&&n(r[t],e[t]),t in e||(e[t]=r[t]),e},t)}},function(e,t,n){"use strict";e.exports=function(e,t){return"function"!=typeof t?e:(e.then(function(e){t(null,e)},function(e){t(e)}),e)}},function(e,t,n){"use strict";var r=n(29),i=n(30),o={linear:function(e){return{tag:"Linear",children:[{tag:"Duration",value:r(e.duration)},a(e.trackingEvents),l(e)].concat(e.videoClicks?[{tag:"VideoClicks",children:[{tag:"ClickThrough",value:e.videoClicks.clickThrough,cdata:!0}].concat(e.videoClicks.clickTrackings.map(function(e){return{tag:"ClickTracking",value:e,cdata:!0}}),e.videoClicks.customClicks.map(function(e){return{tag:"CustomClick",attributes:{id:e.id},value:e.uri,cdata:!0}}))}]:[],[{tag:"MediaFiles",children:e.mediaFiles.map(function(e){return{tag:"MediaFile",attributes:{id:e.id,width:e.width,height:e.height,bitrate:e.bitrate,type:e.type,delivery:e.delivery,scalable:e.scalable,maintainAspectRatio:e.maintainAspectRatio,apiFramework:e.apiFramework},value:e.uri,cdata:!0}})}])}},companions:function(e){return{tag:"CompanionAds",children:e.companions.map(function(e){return{tag:"Companion",attributes:{id:e.id,width:e.width,height:e.height,expandedWidth:e.expandedWidth,expandedHeight:e.expandedHeight,apiFramework:e.apiFramework},children:s(e.resources).concat([a(e.trackingEvents),{tag:"CompanionClickThrough",value:e.clickThrough,cdata:!0},{tag:"AltText",value:e.altText},l(e)])}})}},nonLinear:function(e){return{tag:"NonLinearAds",children:e.ads.map(function(e){return{tag:"NonLinear",attributes:{id:e.id,width:e.width,height:e.height,expandedWidth:e.expandedWidth,expandedHeight:e.expandedHeight,scalable:e.scalable,maintainAspectRatio:e.maintainAspectRatio,minSuggestedDuration:r(e.minSuggestedDuration),apiFramework:e.apiFramework},children:s(e.resources).concat([{tag:"NonLinearClickThrough",value:e.clickThrough,cdata:!0},l(e)])}}).concat([a(e.trackingEvents)])}}};function a(e){return{tag:"TrackingEvents",children:e.map(function(e){return{tag:"Tracking",attributes:{event:e.event},value:e.uri,cdata:!0}})}}function s(e){return e.map(function(t){return{tag:function(e){switch(t.type){case"static":return"StaticResource";case"iframe":return"IFrameResource";case"html":return"HTMLResource"}}(),attributes:{creativeType:t.creativeType},value:t.data,cdata:!0}})}function l(e){return{tag:"AdParameters",value:e.parameters}}e.exports=function(e){return i({tag:"VAST",attributes:{version:e.get("version")},children:e.map("ads",function(e){return{tag:"Ad",attributes:{id:e.id},children:[{tag:function(){switch(e.type){case"inline":return"InLine";case"wrapper":return"Wrapper"}}(),children:[{tag:"AdSystem",attributes:{version:e.system.version},value:e.system.name},{tag:"AdTitle",value:e.title},{tag:"Description",value:e.description},{tag:"Survey",value:e.survey,cdata:!0},{tag:"VASTAdTagURI",value:e.vastAdTagURI,cdata:!0}].concat(e.errors.map(function(e){return{tag:"Error",value:e,cdata:!0}}),e.impressions.map(function(e){return{tag:"Impression",value:e.uri,cdata:!0,attributes:{id:e.id}}}),[{tag:"ViewableImpression",children:e.viewableImpressions.map(function(e){return{tag:"Viewable",value:e.uri,cdata:!0,attributes:{id:e.id}}})}],[{tag:"Creatives",children:e.creatives.map(function(e){return{tag:"Creative",attributes:{id:e.id,sequence:e.sequence,AdID:e.adID},children:[(t=e.type,o[t](e))]};var t}),required:!0}])}]}})},!0)}},function(e,t,n){"use strict";function r(e){return(e>9?"":"0")+e.toString()}e.exports=function(e){return Number(e)!==e?null:[Math.floor(e/60/60),Math.floor(e/60%60),Math.floor(e%60%60)].map(r).join(":")}},function(e,t,n){"use strict";function g(e){return null!=e}function v(e){return void 0!==e?String(e).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):""}function y(e){return e.cdata?function(e){return(void 0!==e?function(e){for(var t,n,r=[],i=/]]>/g,o=0;t=i.exec(e);)n=t.index+2,r.push(t.input.substring(o,n)),o=n;return r.push(e.substring(o,e.length)),r}(String(e)):[""]).reduce(function(e,t){return e+"<![CDATA["+t+"]]>"},"")}(e.value):v(e.value)}e.exports=function(e,t){return['<?xml version="1.0" encoding="UTF-8"?>'].concat(function n(e,r,i){var t=e.tag,o=e.attributes||{},a=Object.keys(o),s=e.children||[],l=e.value,u=s.length>0,c=a.every(function(e){return g(o[e])})&&a.length>0,f=g(l)||u||c,d=function(e){for(var t="";e--;)t+=" ";return t}(r),h="<"+t+Object.keys(o).reduce(function(e,t){return i&&!g(o[t])?e:e+" "+t+'="'+v(o[t])+'"'},"")+">",p="</"+t+">";return!i||f||e.required?u?[d+h].concat(e.children.reduce(function(e,t){return e.concat(n(t,r+4,i))},[]),[d+p]):[d+h+y(e)+p]:[]}(e,0,t)).join("\n")}},function(e,t,n){"use strict";var r=n(32),s=n(33),l=n(34),u=n(13),i=n(35),c=n(36),f={linear:function(e){var t=h(e.find("Duration")),n=h(e.find("Linear")),r=e.find("Tracking"),i=h(e.find("AdParameters")),o=e.find("VideoClicks")[0],a=e.find("MediaFile");return{type:"linear",skipOffset:n.attributes.skipoffset,duration:s(t.value)||void 0,trackingEvents:r.map(function(e){var t={event:e.attributes.event,uri:e.value};return"progress"===e.attributes.event&&(t.offset=s(e.attributes.offset)),t}),parameters:i.value,videoClicks:o&&function(){var e=h(o.find("ClickThrough")),t=o.find("ClickTracking"),n=o.find("CustomClick");return{clickThrough:e.value,clickTrackings:t.map(function(e){return e.value}),customClicks:n.map(function(e){return{id:e.attributes.id,uri:e.value}})}}(),mediaFiles:a.map(function(e){var t=e.attributes;return{id:t.id,delivery:t.delivery,type:t.type,uri:e.value,bitrate:c(t.bitrate),width:c(t.width),height:c(t.height),scalable:l(t.scalable),maintainAspectRatio:l(t.maintainAspectRatio),apiFramework:t.apiFramework}})}},companions:function(e){return{type:"companions",companions:e.find("Companion").map(function(e){var t=e.find("Tracking"),n=h(e.find("CompanionClickThrough")),r=h(e.find("StaticResource")),i=h(e.find("AltText")),o=h(e.find("AdParameters"));return{id:e.attributes.id,width:c(e.attributes.width),height:c(e.attributes.height),expandedWidth:c(e.attributes.expandedWidth),expandedHeight:c(e.attributes.expandedHeight),apiFramework:e.attributes.apiFramework,resources:function(e){return e.find("URL").map(function(e){return{data:e.value}})}(e),staticResource:r.value,trackingEvents:t.map(function(e){return{event:e.attributes.event,uri:e.value}}),clickThrough:n.value,altText:i.value,parameters:o.value}})}},nonLinear:function(e){var t=e.find("NonLinear"),n=e.find("Tracking");return{type:"nonLinear",ads:t.map(function(e){var t=h(e.find("NonLinearClickThrough")),n=h(e.find("StaticResource")),r=h(e.find("AdParameters"));return{id:e.attributes.id,width:e.attributes.width,height:e.attributes.height,expandedWidth:c(e.attributes.expandedWidth),expandedHeight:c(e.attributes.expandedHeight),scalable:l(e.attributes.scalable),maintainAspectRatio:l(e.attributes.maintainAspectRatio),minSuggestedDuration:s(e.attributes.minSuggestedDuration)||void 0,apiFramework:e.attributes.apiFramework,resources:n.value,clickThrough:t.value,parameters:r.value}}),trackingEvents:n.map(function(e){return{event:e.attributes.event,uri:e.value}})}}},d={inline:function(e){var t=h(e.find("AdTitle")),n=h(e.find("Description")),r=h(e.find("Survey"));return{type:"inline",title:t.value,description:n.value,survey:r.value}},wrapper:function(e){return{type:"wrapper",vastAdTagURI:h(e.find("VASTAdTagURI")).value}}};function h(e){return e[0]||{attributes:{}}}e.exports=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"VAST",n=r(e);if(!n(t)[0])throw new Error("["+e+"] is not a valid VAST document.");return i({version:h(n(t)).attributes.version,ads:n("Ad").map(function(e){var t=h(e.find("Wrapper,InLine")).tag.toLowerCase(),n=h(e.find("AdSystem")),r=h(e.find("AdTitle")),i=h(e.find("Description")),o=e.find("Error"),a=e.find("Impression"),s=e.find("ViewableImpression Viewable"),l=e.find("Creative").filter(function(e){return e.children().length});return u({id:e.attributes.id,system:{name:n.value,version:n.attributes.version},advertiser:{title:r.value,description:i.value},errors:o.map(function(e){return e.value}),impressions:a.map(function(e){return{uri:e.value,id:e.attributes.id}}),viewableImpressions:s.map(function(e){return{uri:e.value,id:e.attributes.id}}),creatives:l.map(function(e){var t=function(){switch(h(e.find("Linear,CompanionAds,NonLinearAds")).tag){case"Linear":return"linear";case"CompanionAds":return"companions";case"NonLinearAds":return"nonLinear"}}();return u({id:e.attributes.id,sequence:c(e.attributes.sequence),adID:e.attributes.AdID},f[t](e))})},d[t](e))})},!0)}},function(e,t,n){"use strict";var r=Array.prototype.map,i=Array.prototype.filter,o=Array.prototype.reduce,a=new DOMParser;function s(t){var e=t.childElementCount>0;return{tag:t.tagName,value:e?null:t.textContent,attributes:o.call(t.attributes,function(e,t){return e[t.name]=t.value,e},{}),find:function(e){return l(t.querySelectorAll(e))},children:function(){return i.call(t.childNodes,function(e){return e instanceof Element}).map(s)}}}function l(e){return r.call(e,s)}e.exports=function(e){var t=a.parseFromString(e,"application/xml");return function(e){return l(t.querySelectorAll(e))}}},function(e,t,n){"use strict";e.exports=function(e){var t=(e||"").match(/^(\d\d):(\d\d):(\d\d)$/);return t&&t.slice(1,4).map(parseFloat).reduce(function(e,t,n){return e+t*Math.pow(60,Math.abs(n-2))},0)}},function(e,t,n){"use strict";e.exports=function(e){switch((e||"").toLowerCase()){case"true":return!0;case"false":return!1}}},function(e,t,n){"use strict";e.exports=function n(r,i){return Object(r)!==r?r:Object.keys(r).reduce(function(e,t){return i&&r[t]instanceof Array?e[t]=r[t].filter(function(e){return void 0!==e}).map(function(e){return n(e,!0)}):i&&r[t]instanceof Object?e[t]=n(r[t],!0):void 0!==r[t]&&(e[t]=r[t]),e},{})}},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}e.exports=function(e){if(/string|number|boolean/.test(r(e)))return isNaN(e)?void 0:Number(e)}},function(e,t,n){"use strict";function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t){return(i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function l(e,t,n,r){return(l="undefined"!=typeof Reflect&&Reflect.set?Reflect.set:function(e,t,n,r){var i,o=a(e,t);if(o){if((i=Object.getOwnPropertyDescriptor(o,t)).set)return i.set.call(r,n),!0;if(!i.writable)return!1}if(i=Object.getOwnPropertyDescriptor(r,t)){if(!i.writable)return!1;i.value=n,Object.defineProperty(r,t,i)}else!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(r,t,n);return!0})(e,t,n,r)}function u(){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=a(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}}).apply(this,arguments)}function a(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=c(e)););return e}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=n(38),d=n(4),h=n(14),p=n(9),g=n(10).isDesktop,v=n(39),y=n(16),m=n(11),b=n(17),E=n(8);function T(e,t,n){return e.addEventListener(t,n,!1)}var o=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&i(e,t)}(a,f);var o=function(r){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=c(r);if(i){var n=c(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===s(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)}}(a);function a(e,t,n,r){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(i=o.call(this,e)).frame=null,i.video=t,i.config=n,i.parent=r,i}return function(e,t,n){t&&r(e.prototype,t),n&&r(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(a,[{key:"adVolume",get:function(){return u(c(a.prototype),"adVolume",this)},set:function(e){(function(e,t,n,r,i){if(!l(e,t,n,r||e)&&i)throw new Error("failed to set property")})(c(a.prototype),"adVolume",e,this,!0),this.video.muted=0===e}},{key:"load",value:function(e,l){var u=this,c=e[0].uri,f=e[0].bitrate;return new Promise(function(r,i){var o=document.createElement("iframe"),e=document.createElement("script"),a=u.video,n=null;function s(e){u.container.removeChild(o),u.adVolume=0,u.video.clean&&u.video.clean(),u.video=null,u.frame=null,u.api=null,e&&i(e)}o.src="about:blank",o.setAttribute("scrolling","no"),o.style.width="100%",o.style.height="100%",o.style.display="block",o.style.opacity="0",o.style.border="none",u.container.appendChild(o),o.contentWindow.document.open(),o.contentWindow.document.close(),o.contentWindow.document.body.style.margin="0",u.frame=o,e.src=c,e.onload=function(){var t=o.contentWindow.getVPAIDAd(),e=o.contentWindow.document.body,n=u.vpaidVersion=new v(t.handshakeVersion("2.0"));if(n.major>2)return i(new Error("VPAID version "+n+" is not supported."));o.contentWindow.addEventListener("resize",function(){var e=o.getBoundingClientRect();u.resizeAd(e.width,e.height,"normal")},!1),d.forEach(function(n){if(u.parent.isAsiaSmartAd||n!==d.AdStarted)return t.subscribe(function(){for(var e=new Array(arguments.length),t=arguments.length;t--;)e[t]=arguments[t];return u.emit.apply(u,[n].concat(e))},n)}),u.once(d.AdLoaded,function(){o.style.opacity="1",u.api=t;var e=b.getUrlParam("vast",c);e&&b.isURL(e)&&function(e){return b.httpGet(e)}(e).then(function(e){var t=new E(E.pojoFromXML(e)).get("ads[0].creatives[0].videoClicks.clickThrough");u.api.clickThrough=t}),r(u)}),u.once(d.AdError,function(e){s(new Error(e))}),u.once(d.AdStopped,s),u.parent.isAsiaSmartAd&&(u.once(d.AdStopped,function(e){u.emit(d.AdSkipped)}),u.once(d.AdVideoStart,function(e){var t=o.contentWindow.document.querySelector(".sas-container").querySelector("iframe").contentWindow.document.querySelector("video");u.video=t,u.parent.video=t})),t.initAd(u.config.width,u.config.height,"normal",f,{AdParameters:l.adParameters},{slot:e,videoSlot:a,videoSlotCanAutoPlay:g})},e.onerror=function(){s(new Error("Failed to load MediaFile ["+c+"]."))},function(t,n,r){T(t,n,function e(){return function(e,t,n){e.removeEventListener(t,n,!1)}(t,n,e),r.apply(this,arguments)})}(a,p.PLAYING,function(){u.emit(d.AdStarted)}),T(a,p.TIMEUPDATE,function(){var e,t;e=u.container,!((t=e.getBoundingClientRect()).top||t.height/2<=window.innerHeight-t.top&&t.bottom>=t.height/2)||u.alreadyEmitViewable?n=null:(n||(n=a.currentTime),a.currentTime-n>=2&&(u.alreadyEmitViewable=!0,u.emit(d.AdViewableImpression)))}),T(a,p.LOADEDMETADATA,function(){var e=new y(a,l.progressEvents);new m([d.AdVideoProgress]).from(e).to(u)}),o.contentWindow.document.body.appendChild(a),o.contentWindow.document.body.appendChild(e)})}}],[{key:"canPlayMediaFile",value:function(e){return(e.type===h.JAVASCRIPT||"application/x-javascript"===e.type)&&"VPAID"===e.apiFramework}}]),a}();e.exports=o},function(e,t,n){"use strict";var r=n(6),i=n(4);function o(t,a){return function(){var e=arguments,n=this.api,r=this;function i(){return new Error("Ad has not been loaded.")}function o(){return n[t].apply(n,e)}if(!a){if(!n)throw i();return o()}return new Promise(function(e,t){return n?(r.once(a,function(){e(r)}),o()):t(i())})}}function a(e){r.call(this),this.container=e,this.api=null,this.vpaidVersion=null}a.prototype=Object.create(r.prototype),Object.defineProperties(a.prototype,{adLinear:{get:o("getAdLinear")},adWidth:{get:o("getAdWidth")},adHeight:{get:o("getAdHeight")},adExpanded:{get:o("getAdExpanded")},adSkippableState:{get:o("getAdSkippableState")},adRemainingTime:{get:o("getAdRemainingTime")},adDuration:{get:o("getAdDuration"),set:function(e){}},adVolume:{get:o("getAdVolume"),set:o("setAdVolume")},adCompanions:{get:o("getAdCompanions")},adIcons:{get:o("getAdIcons")}}),a.prototype.load=function(){throw new Error("VPAID subclass must implement load() method.")},a.prototype.resizeAd=o("resizeAd",i.AdSizeChange),a.prototype.startAd=o("startAd",i.AdStarted),a.prototype.stopAd=o("stopAd",i.AdStopped),a.prototype.pauseAd=o("pauseAd",i.AdPaused),a.prototype.resumeAd=o("resumeAd",i.AdPlaying),a.prototype.playAd=o("playAd",i.AdPlaying),a.prototype.expandAd=o("expandAd",i.AdExpandedChange),a.prototype.collapseAd=o("collapseAd",i.AdExpandedChange),a.prototype.skipAd=function(){o("skipAd",i.AdSkipped).call(this),this.stopAd()},e.exports=a},function(e,t,n){"use strict";function r(e){var t=e.split(".").map(parseFloat);this.string=e,this.major=t[0],this.minor=t[1],this.patch=t[2],Object.freeze(this)}r.prototype.toString=function(){return this.string},e.exports=r},function(e,t,n){"use strict";var r=n(6),a=n(4);function s(e,t,n){e!==a.AdVideoProgress?t.fired[e]||(t.emit(e),t.fired[e]=!0):t.emit(e,n)}function i(e,t){r.apply(this,arguments),this.duration=e,this.progressEvents=t.sort(function(e,t){return e.offset<t.offset}),this.seconds=Array.apply([],new Array(e)).map(function(){return!1}),this.fired=[a.AdVideoStart,a.AdVideoFirstQuartile,a.AdVideoMidpoint,a.AdVideoThirdQuartile,a.AdVideoComplete].reduce(function(e,t){return e[t]=!1,e},{})}i.prototype=Object.create(r.prototype),i.prototype.tick=function(){var t=this,n=this.seconds,e=this._getState(),r=Math.round(e.currentTime)-1,i=[1,2,3,4].map(function(e){return Math.floor(this.duration/4*e)},this);function o(e){var t=i[e-1];return!(!t||0==t)&&n.slice(0,t).every(function(e){return!0===e})}e.playing&&(s(a.AdVideoStart,this),r>-1&&(this.seconds[r]=!0)),o(1)&&s(a.AdVideoFirstQuartile,this),o(2)&&s(a.AdVideoMidpoint,this),o(3)&&s(a.AdVideoThirdQuartile,this),o(4)&&s(a.AdVideoComplete,this),this.progressEvents.length&&this._popMatchProgressEvents(e.currentTime).forEach(function(e){return s(a.AdVideoProgress,t,e)})},i.prototype._popMatchProgressEvents=function(e){for(var t=this.progressEvents,n=t.length-1;n>-1&&e>t[n].offset;)n-=1;return t.splice(n+1)},i.prototype._getState=function(){throw Error("this method must be overridden")},e.exports=i},function(e,t,n){"use strict";var r=n(6),l=n(10).canPlay,u=n(42),c=n(4),f=n(9),d=n(16),h=n(11);function p(e,t,n){return e.addEventListener(t,n,!1)}function g(t,n,r){return p(t,n,function e(){return function(e,t,n){e.removeEventListener(t,n,!1)}(t,n,e),r.apply(this,arguments)})}function i(e,t){function n(){return new Error("The <video> has not been loaded.")}return function(){if(!this.video){if(t)return Promise.reject(n());throw n()}return e.apply(this,arguments)}}function o(){return this.container.removeChild(this.video),this.video.clean(),this.video=null,this.alreadyEmitViewable=!1,Promise.resolve(this)}function a(e,t,n){r.call(this),this.container=e,this.video=t,this.config=n,this.__private__={hasPlayed:!1}}a.prototype=Object.create(r.prototype),Object.defineProperties(a.prototype,{adRemainingTime:{get:i(function(){return this.video.duration-this.video.currentTime})},adDuration:{get:i(function(){return this.video.duration})},adVolume:{get:i(function(){return this.video.volume}),set:i(function(e){this.video.muted=0===e,this.video.volume=e})}}),a.prototype.load=function(o,a){var s=this;return new Promise(function(t,n){var r=s.video,e=function(e,t){var n=t.width,r=e.map(function(e){return{mediaFile:e,playability:"video/3gpp"!==e.type&&l(e.type)}}).filter(function(e){return e.playability>0}).sort(u("-playability","-mediaFile.bitrate")),i=r.map(function(e){return Math.abs(n-e.mediaFile.width)}),o=r[i.indexOf(Math.min.apply(Math,i))];return!o||o.playability<1?null:o.mediaFile}(o,{width:s.config.width,height:s.config.height}),i=null;if(!e)return n(new Error("There are no playable <MediaFile>s."));r.src=e.uri,g(r,f.LOADEDMETADATA,function(){var e=new d(r,a.progressEvents);new h(c).from(e).to(s),t(s),s.emit(c.AdLoaded),p(r,f.DURATIONCHANGE,function(){s.emit(c.AdDurationChange)}),p(r,f.VOLUMECHANGE,function(){s.emit(c.AdVolumeChange)})}),g(r,f.ERROR,function(){var e=r.error;s.emit(c.AdError,e.message),n(e)}),g(r,f.PLAYING,function(){s.__private__.hasPlayed=!0,s.emit(c.AdImpression)}),g(r,f.ENDED,function(){s.stopAd()}),p(r,f.TIMEUPDATE,function(){var e,t;e=s.container,!((t=e.getBoundingClientRect()).top||t.height/2<=window.innerHeight-t.top&&t.bottom>=t.height/2)||s.alreadyEmitViewable?i=null:(i||(i=r.currentTime),r.currentTime-i>=2&&(s.alreadyEmitViewable=!0,s.emit(c.AdViewableImpression)))}),p(r,"click",function(){s.emit(c.AdClickBackground,null,null,!0)}),s.container.appendChild(r)})},a.prototype.startAd=i(function(){var n=this,r=this.video;return this.__private__.hasPlayed?Promise.reject(new Error("The advertisement has already been started.")):new Promise(function(e,t){return g(r,f.PLAYING,function(){e(n),n.alreadyPlayAd=!0,n.emit(c.AdStarted)}),r.play().catch(t)})},!0),a.prototype.stopAd=i(function(){return this.emit(c.AdStopped),o.call(this)},!0),a.prototype.skipAd=i(function(){return this.emit(c.AdSkipped),o.call(this)},!0),a.prototype.pauseAd=i(function(){var t=this,n=this.video;return this.video.paused?Promise.resolve(this):new Promise(function(e){return g(n,f.PAUSE,function(){e(t),t.emit(c.AdPaused)}),n.pause()})},!0),a.prototype.resumeAd=i(function(){var t=this,n=this.video;return this.__private__.hasPlayed?this.video.paused?new Promise(function(e){return g(n,f.PLAY,function(){e(t),t.emit(c.AdPlaying)}),n.play()}):Promise.resolve(this):Promise.reject(new Error("The ad has not been started yet."))},!0),a.canPlayMediaFile=function(e){return Boolean(document.createElement("video").canPlayType(e.type))},e.exports=a},function(e,t,n){var r,s,i,l=n(43);i=function(t){return function(e){return typeof e===t}},s=function(o,e){var a=1,s=e||function(e,t){return t};return"-"===o[0]&&(a=-1,o=o.substr(1)),function(e,t){var n,r=s(o,l.get(e,o)),i=s(o,l.get(t,o));return r<i&&(n=-1),r>i&&(n=1),r===i&&(n=0),n*a}},r=function(){var e=Array.prototype.slice.call(arguments),o=e.filter(i("string")),a=e.filter(i("function"))[0];return function(e,t){for(var n=o.length,r=0,i=0;0===r&&i<n;)r=s(o[i],a)(e,t),i++;return r}},e.exports=r},function(n,r,e){var i,o,a;!function(e,t){"use strict";"object"==typeof n&&"object"==typeof n.exports?n.exports=t():(o=[],void 0===(a="function"==typeof(i=t)?i.apply(r,o):i)||(n.exports=a))}(0,function(){"use strict";var t=Object.prototype.toString,n=Object.prototype.hasOwnProperty;function a(e){if(!e)return!0;if(o(e)&&0===e.length)return!0;for(var t in e)if(n.call(e,t))return!1;return!0}function r(e){return t.call(e)}function s(e){return"number"==typeof e||"[object Number]"===r(e)}function l(e){return"string"==typeof e||"[object String]"===r(e)}function o(e){return"object"==typeof e&&"number"==typeof e.length&&"[object Array]"===r(e)}function u(e){var t=parseInt(e);return t.toString()===e?t:e}function c(e,t,n,r){if(s(t)&&(t=[t]),a(t))return e;if(l(t))return c(e,t.split("."),n,r);var i=u(t[0]);if(1===t.length){var o=e[i];return void 0!==o&&r||(e[i]=n),o}return void 0===e[i]&&(s(i)?e[i]=[]:e[i]={}),c(e[i],t.slice(1),n,r)}var f={ensureExists:function(e,t,n){return c(e,t,n,!0)},set:function(e,t,n,r){return c(e,t,n,r)},insert:function(e,t,n,r){var i=f.get(e,t);r=~~r,o(i)||(i=[],f.set(e,t,i)),i.splice(r,0,n)},empty:function(e,t){if(a(t))return e;if(!a(e)){var n;if(!(n=f.get(e,t)))return e;if(l(n))return f.set(e,t,"");if(function(e){return"[object Boolean]"===r(e)}(n))return f.set(e,t,!1);if(s(n))return f.set(e,t,0);if(!o(n))return f.set(e,t,null);n.length=0}},push:function(e,t){var n=f.get(e,t);o(n)||(n=[],f.set(e,t,n)),n.push.apply(n,Array.prototype.slice.call(arguments,2))},coalesce:function(e,t,n){for(var r,i=0,o=t.length;i<o;i++)if(void 0!==(r=f.get(e,t[i])))return r;return n},get:function(e,t,n){if(s(t)&&(t=[t]),a(t))return e;if(a(e))return n;if(l(t))return f.get(e,t.split("."),n);var r=u(t[0]);return 1===t.length?void 0===e[r]?n:e[r]:f.get(e[r],t.slice(1),n)},del:function(e,t){return function e(t,n){if(s(n)&&(n=[n]),!a(t)){if(a(n))return t;if(l(n))return e(t,n.split("."));var r=u(n[0]),i=t[r];if(1===n.length)void 0!==i&&(o(t)?t.splice(r,1):delete t[r]);else if(void 0!==t[r])return e(t[r],n.slice(1));return t}}(e,t)}};return f})},function(e,t,n){"use strict";var r=n(4);function a(e){return e}function s(e,t){(e||[]).forEach(function(e){(new Image).src=t(e)})}function i(e,t){this.pixels=e.reduce(function(e,t){return t&&(e[t.event]||(e[t.event]=[])).push(t.uri),e},{}),this.__private__={mapper:t||a}}i.prototype.track=function(e){var i=this.pixels,o=this.__private__.mapper,t=e.adVolume;function n(e,t,n){function r(e){return o((t||a)(e))}return function(){n&&!n()||s(i[e],r)}}e.on(r.AdSkipped,n("skip")),e.on(r.AdStarted,n("creativeView")),e.on(r.AdVolumeChange,n("unmute",null,function(){return 0===t&&e.adVolume>0})),e.on(r.AdVolumeChange,n("mute",null,function(){return t>0&&0===e.adVolume})),e.on(r.AdImpression,n("impression")),e.on(r.AdViewableImpression,function(){n("viewableImpression"),n("impression")}),e.on(r.AdVideoStart,n("start")),e.on(r.AdVideoFirstQuartile,n("firstQuartile")),e.on(r.AdVideoMidpoint,n("midpoint")),e.on(r.AdVideoThirdQuartile,n("thirdQuartile")),e.on(r.AdVideoProgress,function(e){s([e.uri],o||a)}),e.on(r.AdVideoComplete,n("complete")),e.on(r.AdUserAcceptInvitation,n("acceptInvitationLinear")),e.on(r.AdUserMinimize,n("collapse")),e.on(r.AdUserClose,n("closeLinear")),e.on(r.AdPaused,n("pause")),e.on(r.AdResumed,n("resume")),e.on(r.AdPlaying,n("resume")),e.on(r.AdError,n("error",function(e){return e.replace(/\[ERRORCODE\]/g,901)})),e.on(r.AdVolumeChange,function(){t=e.adVolume})},e.exports=i},function(e,t){e.exports=function(){var r=document.createElement("video"),i=[],t=!1,o=r.addEventListener,a=r.removeEventListener,e=r.play,n=Array.prototype.map.call(r.attributes,function(e){return e.name});return r.init=function(e){return t?Promise.resolve():(t=!0,r.parentNode||e.appendChild(r),Promise.resolve().then(function(){return r.load()}).catch(function(e){return console.log("Error while initializing video",e)}))},r.clean=function(){i.forEach(function(e){a.call(r,e.type,e.listener,e.options)}),i=[],r.load(),s()},r.addEventListener=function(e,t,n){return i.push({type:e,listener:t,options:n}),o.call(r,e,t,n)},r.removeEventListener=function(e,t,n){return a.call(r,e,t,n)},r.play=function(){return t=!0,e.call(r)},s(),r;function s(){Array.prototype.forEach.call(r.attributes,function(e){-1===n.indexOf(e.name)&&r.removeAttribute(e.name)}),r.setAttribute("webkit-playsinline",""),r.setAttribute("playsinline",""),r.setAttribute("preload","auto"),r.style.display="block",r.style.width="100%",r.style.height="100%",r.style.position="absolute",r.style.left="0px",r.style.top="0px",r.style.backgroundColor="#000",r.style.objectFit="contain"}}},function(e,t,n){e.exports=n(47)},function(e,t,n){function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t){return(i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var c=n(48),f=n(50),d=n(12),o=n(3),h=o.isImaAd,p=o.createPromiseDefer,g=n(51),v=n(5).DEFAULT_MAX_VOLUME;e.exports=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&i(e,t)}(a,d);var o=function(r){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=u(r);if(i){var n=u(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===s(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return l(e)}(this,e)}}(a);function a(e,t,n,r){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(i=o.call(this,e,t,n,r))._onAdsManagerLoaded=i._onAdsManagerLoaded.bind(l(i)),i._onAdEvent=i._onAdEvent.bind(l(i)),i._onAdErrorEvent=i._onAdErrorEvent.bind(l(i)),i.adDisplayContainer=null,i.adsLoader=null,i.adsManager=null,i.adOption=null,i.currentAd=null,i.volume=i.videoContent.muted?0:i.videoContent.volume*v,i.paused=!1,i.destroyed=!1,i.loadDeferred=null,i.startAdRequested=!1,i.cancelledAdRequested=!1,i.initUserActionHappened=!1,c.load().then(function(){return i._init()}).catch(function(e){i.destroyed||i.logger.error(i.name,"cannot load SDK",e)}),i}return function(e,t,n){t&&r(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(a,[{key:"name",get:function(){return"GoogleImaPlayer"}},{key:"videoContentWidth",get:function(){return this.videoContent.offsetWidth}},{key:"videoContentHeight",get:function(){return this.videoContent.offsetHeight}},{key:"videoContentVolume",get:function(){return this.videoContent.muted?0:this.videoContent.volume}},{key:"selfControl",get:function(){return!1}},{key:"canClickThrough",get:function(){return!0}},{key:"isGoogleImaAd",get:function(){return!0}},{key:"initUserAction",value:function(){!this.initUserActionHappened&&this.adDisplayContainer&&(this.initUserActionHappened=!0,this.adDisplayContainer.initialize(),this.adDisplayContainer.initialized=!0,this.logger.debug(this.name,"init user action done"))}},{key:"loadAd",value:function(e,t){var n=this;this.logger.debug(this.name,"loadAd ad ",e),this.adOption=t,this.tracker=new f(e),this.tracker._trackEvent("requestVast"),this.loadDeferred=p();var r=e.vastAdTagURI;return c.isReady().then(function(){return n._requestAds(r)}).then(function(){return n.loadDeferred.promise})}},{key:"canRun",value:function(e){return h(e)}},{key:"start",value:function(){return this.startAdRequested=!1,this.cancelledAdRequested=!1,this.paused=!1,this.destroyed?this._onAdStopped(new Error("cannot play ad since adsManager was destroyed")):this.adsManager?(this.initUserAction(),void this.adsManager.start()):(this.startAdRequested=!0,void this.logger.debug(this.name,"cannot play ad since adsManager is not loaded yet, try to play on load event"))}},{key:"stop",value:function(){this.adsManager&&this.adsManager.stop()}},{key:"skip",value:function(){this.stop()}},{key:"pause",value:function(){this.adsManager&&this.adsManager.pause()}},{key:"resume",value:function(){this.adsManager&&this.adsManager.resume()}},{key:"cancel",value:function(){this.adsManager?this.adsManager.stop():this.cancelledAdRequested=!0}},{key:"setVolume",value:function(e){this.logger.debug(this.name,"setVolume | volume ",e),this.volume=e,this.adsManager&&this.adsManager.setVolume(e)}},{key:"getVolume",value:function(){return this.volume}},{key:"isPaused",value:function(){return this.paused}},{key:"getRemainingTime",value:function(){return this.adsManager.getRemainingTime()}},{key:"getDuration",value:function(){return this.currentAd?this.currentAd.getDuration():0}},{key:"getSkipOffset",value:function(){return this.logger.debug(this.name,"skipTimeOffset",this.currentAd&&this.currentAd.getSkipTimeOffset()),this.adOption?this.adOption.skipoffset:-1}},{key:"resize",value:function(){this.adsManager&&this.adsManager.resize(this.videoContentWidth,this.videoContentHeight,google.ima.ViewMode.NORMAL)}},{key:"destroy",value:function(){this.destroyed=!0,this._destroyAdsManager(),this._destroyAdDisplayContainer(),this.element&&(this.adContainerElement.removeChild(this.element),this.element=null),this.logger.debug(this.name,"destroyed")}},{key:"_init",value:function(){this.destroyed||(this.element=document.createElement("div"),this.element.style.width="100%",this.element.style.height="100%",this.element.style.position="absolute",this.element.style.zIndex=1,this.element.style.backgroundColor="rgba(0, 0, 0, 0.8)",this.element.setAttribute("data-player",this.name),this.adContainerElement.appendChild(this.element),google.ima.settings.setVpaidMode(google.ima.ImaSdkSettings.VpaidMode.INSECURE),google.ima.settings.setDisableCustomPlaybackForIOS10Plus(!0),google.ima.settings.setDisableFlashAds(!0),this.adDisplayContainer=new google.ima.AdDisplayContainer(this.element,this.videoContent),this.adsLoader=new google.ima.AdsLoader(this.adDisplayContainer),this.adsLoader.getSettings().setPlayerType("zplayer-ima"),this.adsLoader.getSettings().setPlayerVersion(g.version),this.adsLoader.getSettings().setAutoPlayAdBreaks(this.options.autoPlayAdBreaks),this.adsLoader.addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,this._onAdsManagerLoaded,!1),this.adsLoader.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,this._onAdErrorEvent,!1),this._hide())}},{key:"_show",value:function(){this.element.style.display="block"}},{key:"_hide",value:function(){this.element.style.display="none"}},{key:"_requestAds",value:function(e){this.logger.debug(this.name,"_requestAds | adTagUrl",e);var t=new google.ima.AdsRequest;t.adTagUrl=e,t.linearAdSlotWidth=this.videoContentWidth,t.linearAdSlotHeight=this.videoContentHeight,t.nonLinearAdSlotWidth=this.videoContentWidth,t.nonLinearAdSlotHeight=this.videoContentHeight,t.forceNonLinearFullSlot=!0,t.setAdWillAutoPlay(this.options.autoPlay),t.setAdWillPlayMuted(this.options.mute),this.adsLoader.requestAds(t)}},{key:"_onAdsManagerLoaded",value:function(e){var t=new google.ima.AdsRenderingSettings;t.restoreCustomPlaybackStateOnAdBreakComplete=!0,t.enablePreloading=!0,this.adsManager=e.getAdsManager(this.videoContent,t),this.setVolume(this.volume),this.adsManager.init(this.videoContentWidth,this.videoContentHeight,google.ima.ViewMode.NORMAL),this._startAdsManager(this.adsManager)}},{key:"_startAdsManager",value:function(e){e.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,this._onAdErrorEvent,!1,this);var t=[google.ima.AdEvent.Type.LOADED,google.ima.AdEvent.Type.STARTED,google.ima.AdEvent.Type.IMPRESSION,google.ima.AdEvent.Type.FIRST_QUARTILE,google.ima.AdEvent.Type.MIDPOINT,google.ima.AdEvent.Type.THIRD_QUARTILE,google.ima.AdEvent.Type.COMPLETE,google.ima.AdEvent.Type.PAUSED,google.ima.AdEvent.Type.RESUMED,google.ima.AdEvent.Type.SKIPPED,google.ima.AdEvent.Type.CLICK,google.ima.AdEvent.Type.USER_CLOSE,google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,google.ima.AdEvent.Type.ALL_ADS_COMPLETED];for(var n in t)e.addEventListener(t[n],this._onAdEvent,!1,this);this.cancelledAdRequested?this.cancel():this.startAdRequested&&this.start()}},{key:"_onAdEvent",value:function(e){var t=this;this.logger.debug(this.name,"Ad event:",e.type),this.tracker.onAdEvent(e);var n=e.getAd();switch(e.type){case google.ima.AdEvent.Type.LOADED:this.onAdLoaded(),this.loadDeferred.resolve(),this.loadDeferred=null,n.isLinear()||(this.element.style.backgroundColor="transparent");break;case google.ima.AdEvent.Type.STARTED:if(this.currentAd=n,this._onAdStarted(),!n.isLinear()){var r=-1===n.g.duration?15:n.g.duration;setTimeout(function(){t.adsManager&&t.adsManager.stop(),t._onAdStopped()},1e3*r)}break;case google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED:this._onAdStopped();break;case google.ima.AdEvent.Type.PAUSED:this._onAdPausedEvent();break;case google.ima.AdEvent.Type.RESUMED:this._onAdResumedEvent()}}},{key:"_onAdErrorEvent",value:function(e){var t=e.getError();this.loadDeferred?this.loadDeferred.reject(t):(this.logger.error(this.name,"Ad error:",t.toString()),this._onAdStopped(t))}},{key:"_onAdPausedEvent",value:function(){this.paused=!0}},{key:"_onAdResumedEvent",value:function(){this.paused=!1}},{key:"_onAdStarted",value:function(){this._show(),this.onAdStarted()}},{key:"_onAdStopped",value:function(e){this._hide(),this._destroyAdsManager(),this.onAdStopped(e)}},{key:"_destroyAdsManager",value:function(){this.adsManager&&(this.adsManager.destroy(),this.adsManager=null)}},{key:"_destroyAdDisplayContainer",value:function(){this.adDisplayContainer&&(this.adDisplayContainer.destroy(),this.adDisplayContainer=null)}}]),a}()},function(e,t,n){var r,i=n(49);e.exports={load:function(){return r||(r=new Promise(function(t,n){i(function(e){e?t():n(new Error("failed to load IMA SDK"))},!0,6e3)})),r},isReady:function(){return r}}},function(e,t){e.exports=function(t,e,n){var r=window,i=document,o=null,a=function(e){r.clearTimeout(o),"function"==typeof t&&t(e)};if(r.google&&r.google.ima)a(!0);else{var s=!0===e?"https:":"",l=i.getElementsByTagName("script")[0],u=i.createElement("script");u.src=s+"//imasdk.googleapis.com/js/sdkloader/ima3.js",u.async=!0,"function"==typeof t&&(u.onload=function(){a(!0)}),l.parentNode.insertBefore(u,l),n&&(o=r.setTimeout(function(){a(!1)},n))}}},function(e,t){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}e.exports=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.impressionEvents=[].concat(e.impressions||[],e.viewableImpressions||[]),this.trackingEvents=e.creatives.lenght&&e.creatives[0].trackingEvents||[],e.creatives.lenght&&e.creatives[0].videoClicks&&(this.clickTrackingUri=e.creatives[0].videoClicks.clickTrackings[0])}return function(e,t,n){t&&r(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(t,[{key:"onAdEvent",value:function(e){var t=this;switch(e.type){case google.ima.AdEvent.Type.IMPRESSION:this.impressionEvents.forEach(function(e){return t._fireEvent(e.uri)});break;case google.ima.AdEvent.Type.STARTED:this._trackEvent("start"),this._trackEvent("creativeView");break;case google.ima.AdEvent.Type.FIRST_QUARTILE:this._trackEvent("firstQuartile");break;case google.ima.AdEvent.Type.MIDPOINT:this._trackEvent("midpoint");break;case google.ima.AdEvent.Type.THIRD_QUARTILE:this._trackEvent("thirdQuartile");break;case google.ima.AdEvent.Type.COMPLETE:this._trackEvent("complete");break;case google.ima.AdEvent.Type.PAUSED:this._trackEvent("pause");break;case google.ima.AdEvent.Type.RESUMED:this._trackEvent("resume");break;case google.ima.AdEvent.Type.SKIPPED:this._trackEvent("skip");break;case google.ima.AdEvent.Type.USER_CLOSE:this._trackEvent("close");break;case google.ima.AdEvent.Type.CLICK:this.clickTrackingUri&&this._fireEvent(this.clickTrackingUri)}}},{key:"_trackEvent",value:function(t){var n=this;this.trackingEvents.filter(function(e){return e.event===t}).forEach(function(e){return n._fireEvent(e.uri)})}},{key:"_fireEvent",value:function(e){e&&((new Image).src=e)}}]),t}()},function(e){e.exports={name:"@zplayer/ad-runner",version:"1.0.35",description:"Generic ad runner library for media player",main:"dist/ad-runner.min.js",author:"ZTE folks",publishConfig:{registry:"https://nexus-repo.zapps.vn/repository/zjs-repo/"},scripts:{dev:"webpack-dev-server --progress --mode development --config webpack.config.js",watch:"webpack --progress --watch --mode development --output-filename=[name].min.js --config webpack.config.js",build:"webpack -p --progress --mode production --config webpack.config.js","build-demo":"webpack --progress --mode development --config webpack.config.js",lint:"eslint *.js src/"},devDependencies:{"@babel/core":"^7.1.2","@babel/preset-env":"^7.1.0","@zjs/vast-player":"1.3.69","babel-loader":"^8.0.4","clean-webpack-plugin":"0.1.19","css-loader":"1.0.0",eslint:"^5.4.0","eslint-plugin-import":"^2.15.0","generate-changelog":"^1.7.1","html-webpack-plugin":"3.2.0","node-sass":"4.13.0","sass-loader":"7.1.0","style-loader":"0.23.0",webpack:"4.17.2","webpack-cli":"3.1.0","webpack-dev-server":"3.1.8","webpack-merge":"4.1.4"}}},function(e,t,n){function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t){return(i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var c=n(7).VastPlayer,f=n(12),o=n(3),d=o.isImaAd,h=o.isFacebookAd,p=o.isAsiaSmartAd,g=o.isYomediaAd,v=n(5).AD_DONE_REASON;e.exports=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&i(e,t)}(a,f);var o=function(r){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=u(r);if(i){var n=u(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===s(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return l(e)}(this,e)}}(a);function a(e,t,n,r){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(i=o.call(this,e,t,n,r)).adOption=null,i.loadPromise=null,i.initUserActionHappened=!1,i.onAdSkipped=n.onAdSkipped,i._onAdError=i._onAdError.bind(l(i)),i._init(),i}return function(e,t,n){t&&r(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(a,[{key:"name",get:function(){return"VastLinearPlayer"}},{key:"canClickThrough",get:function(){return this.player.isVPAID&&"MOAT"!==this.player.vpaidVendor&&"YOMEDIA"!==this.player.vpaidVendor}},{key:"isFacebookAd",get:function(){return h(this.ad)}},{key:"isAsiaSmartAd",get:function(){return p(this.ad)}},{key:"isYomediaAd",get:function(){return g(this.ad)||!1}},{key:"viewDetailLink",get:function(){return this.player&&this.player.viewDetailLink}},{key:"canRun",value:function(e){return!d(e)&&"linear"===e.creatives[0].type}},{key:"initUserAction",value:function(){this.initUserActionHappened||(this.initUserActionHappened=!0,this.player.init(),this.logger.debug(this.name,"init user action done"))}},{key:"loadAd",value:function(e,t){return this.ad=e,this.adOption=t,this.loadPromise=this.player.load({ads:[e]}),this.loadPromise}},{key:"start",value:function(){var e=this;this.loadPromise.then(function(){return e.player.startAd()}).catch(this._onAdError)}},{key:"stop",value:function(){var e=this;this.loadPromise.then(function(){return e.player.stopAd()}).catch(this._onAdError)}},{key:"skip",value:function(){var e=this;this.loadPromise.then(function(){return e.player.skipAd()}).catch(this._onAdError)}},{key:"pause",value:function(){var e=this;return this.loadPromise.then(function(){return e.player.pauseAd()}).catch(this._onAdError)}},{key:"resume",value:function(){var e=this;return this.loadPromise.then(function(){e.isYomediaAd?e.player.playAd():e.player.resumeAd()}).catch(this._onAdError)}},{key:"cancel",value:function(){this.stop()}},{key:"viewDetail",value:function(){var t=this;this.loadPromise.then(function(){if(t.player.isVPAID)try{var e=t.player.__private__.player.api&&t.player.__private__.player.api.clickThrough;if(e)return void t.player.emit("AdClickThru",e,null,!0);t.player.__private__.video.click(),t.resume()}catch(e){t.logger.error(t.name,"error while simulate click on VPAID ad",e)}else t.player.emit("AdClickThru",null,null,!0)}).catch(this._onAdError)}},{key:"setVolume",value:function(e){var t=this;this.loadPromise.then(function(){t.player.adVolume=e})}},{key:"getVolume",value:function(){return this.loadPromise?this.player.adVolume:0}},{key:"isPaused",value:function(){return this.player.paused}},{key:"getRemainingTime",value:function(){if(this.isAsiaSmartAd||this.isYomediaAd){var e=this.getDuration();return e>0?e-this.getAdCurrentTime():e}return this.player&&this.player.adRemainingTime}},{key:"getDuration",value:function(){return this.player&&this.player.adDuration}},{key:"getAdCurrentTime",value:function(){return Math.floor(this.player.__private__.video.currentTime)}},{key:"getSkipOffset",value:function(){return this.logger.debug(this.name,"skipTimeOffset",this.adOption.skipoffset),this.adOption?this.adOption.skipoffset:-1}},{key:"destroy",value:function(){this.loadPromise&&this.ad&&this.stop(),this.player=null,this.element&&(this.adContainerElement.removeChild(this.element),this.element=null),this.logger.debug(this.name,"destroyed")}},{key:"_init",value:function(){var e=this,t=document.createElement("div"),n=new c(t,{width:e.videoContent.offsetWidth,height:e.videoContent.offsetHeight});t.style.width="100%",t.style.height="100%",t.style.position="absolute",t.style.zIndex=1,t.setAttribute("data-player",this.name),n.on("AdStarted",function(){return e._onAdStartedEvent()}),n.on("AdStopped",function(){return e._onAdStoppedEvent()}),n.on("AdSkipped",function(){return e._onAdSkippedEvent()}),n.on("AdLoaded",function(){return e._onAdLoadedEvent()}),e.adContainerElement.appendChild(t),e.element=t,e.player=n,e._hide()}},{key:"_show",value:function(){this.element.style.display="block"}},{key:"_hide",value:function(){this.element.style.display="none"}},{key:"_onAdLoadedEvent",value:function(){this.onAdLoaded()}},{key:"_onAdStartedEvent",value:function(){if(this._show(),this.onAdStarted(),this.isFacebookAd)try{this.player.__private__.player.frame.contentDocument.querySelector("#an_skip_button").style.display="none"}catch(e){this.logger.warn(this.name,"failed to remove FB skip button",e)}}},{key:"_onAdStoppedEvent",value:function(e,t){this.loadPromise=null,this._hide(),this.onAdStopped(e,t)}},{key:"_onAdSkippedEvent",value:function(){this.onAdSkipped(),this._onAdStoppedEvent(null,v.skipped)}},{key:"_onAdError",value:function(e){this._onAdStoppedEvent(e)}}]),a}()},function(e,t,n){e.exports=n(54)},function(e,t,n){function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t){return(i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var u=n(12),c=n(3).isImaAd,f=n(55),d=n(59),h=n(5).DEFAULT_NON_LINEAR_DURATION;e.exports=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&i(e,t)}(a,u);var o=function(r){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=l(r);if(i){var n=l(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===s(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)}}(a);function a(e,t,n,r){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(i=o.call(this,e,t,n,r)).ad=null,i.adOption=null,i.imgUrl=null,i.adTimer=null,i}return function(e,t,n){t&&r(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(a,[{key:"name",get:function(){return"VastNonLinearPlayer"}},{key:"selfControl",get:function(){return!0}},{key:"viewDetailLink",get:function(){return this.ad.creatives[0].ads[0].clickThrough}},{key:"canRun",value:function(e){return!c(e)&&e.creatives.length&&"nonLinear"===e.creatives[0].type}},{key:"initUserAction",value:function(){}},{key:"loadAd",value:function(e,t){this.ad=e,this.adOption=t,this.imgUrl=null;var n=e.creatives[0].ads[0].resources;return n&&this._isValidImageAd(n)?(this.imgUrl=n,this.onAdLoaded(),Promise.resolve()):Promise.reject(new Error("no playable non-linear file"))}},{key:"start",value:function(){this.adTimer&&this.stop();var e=this.ad.creatives[0],t=parseInt(e.ads[0].width),n=parseInt(e.ads[0].height);return this.tracker=new d(this.ad),this.adUi=new f(this,this.videoContent.offsetWidth,this.videoContent.offsetHeight),this.adUi.setImage(this.imgUrl,t,n),this.adContainerElement.appendChild(this.adUi.element),this._onAdStartedEvent(),Promise.resolve()}},{key:"stop",value:function(){this._onAdStoppedEvent()}},{key:"cancel",value:function(){this.stop()}},{key:"viewDetail",value:function(){try{var e=this.viewDetailLink;e&&window.open(e,"_blank")}catch(e){this.logger.error(this.name,"error while showing detail of ad",e)}}},{key:"setVolume",value:function(){}},{key:"getRemainingTime",value:function(){}},{key:"getDuration",value:function(){}},{key:"destroy",value:function(){this._stopAdTimer(),this.adUi&&this.adUi.remove(),this.logger.debug(this.name,"destroyed")}},{key:"_isValidImageAd",value:function(e){return!/\.swf/.test(e)}},{key:"_startAdTimer",value:function(){var e=this;this.adTimer=setTimeout(function(){return e.stop()},1e3*(this.adOption.duration||h))}},{key:"_stopAdTimer",value:function(){clearTimeout(this.adTimer),delete this.adTimer}},{key:"_onAdStartedEvent",value:function(){this._startAdTimer(),this.adUi.show(),this.tracker.onAdStarted(),this.onAdStarted()}},{key:"_onAdStoppedEvent",value:function(){this._stopAdTimer(),this.adUi.remove(),this.tracker.onAdStopped(),this.onAdStopped(null,null,!0,this.adData)}}]),a}()},function(e,t,n){function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=c(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}}).apply(this,arguments)}function l(e,t){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}n(56);var f=n(2);e.exports=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t)}(o,f);var i=function(r){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=c(r);if(i){var n=c(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===a(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return u(e)}(this,e)}}(o);function o(e,t,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(r=i.call(this,{className:"ad_runner_non_linear_ad_ui"})).player=e,r.maxWidth=t,r.maxHeight=n,r._onCloseButtonClickEvent=r._onCloseButtonClickEvent.bind(u(r)),r._onImageClickEvent=r._onImageClickEvent.bind(u(r)),r.render(),r._registerEvents(),r}return function(e,t,n){t&&r(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(o,[{key:"render",value:function(){s(c(o.prototype),"render",this).call(this),this.closeButton=new f({tagName:"span"}),this.closeButton.render(),this.closeButton.html("[x]"),this.closeButton.attr("title","ÄÃ³ng quáº£ng cÃ¡o"),this.appendChild(this.closeButton),this.image=new f({tagName:"img"}),this.image.render(),this.appendChild(this.image)}},{key:"remove",value:function(){this._unregisterEvents(),s(c(o.prototype),"remove",this).call(this)}},{key:"setImage",value:function(e,t,n){(t>this.maxWidth||n>this.maxHeight)&&(this.image.attr("width","auto"),this.image.attr("height","auto"),t>n?this.image.style("max-width","".concat(this.maxWidth-40,"px")):this.image.style("max-height","".concat(this.maxHeight-40,"px"))),this.image.attr("src",e)}},{key:"_registerEvents",value:function(){this.closeButton.on("click",this._onCloseButtonClickEvent),this.image.on("click",this._onImageClickEvent)}},{key:"_unregisterEvents",value:function(){this.closeButton.off("click",this._onCloseButtonClickEvent),this.image.off("click",this._onImageClickEvent)}},{key:"_onCloseButtonClickEvent",value:function(e){e.stopPropagation(),this.player.stop()}},{key:"_onImageClickEvent",value:function(e){e.stopPropagation(),this.player.viewDetail()}}]),o}()},function(e,t,n){var r=n(57);"string"==typeof r&&(r=[[e.i,r,""]]),n(1)(r,{hmr:!0,transform:void 0,insertInto:void 0}),r.locals&&(e.exports=r.locals)},function(e,t,n){(e.exports=n(0)(!1)).push([e.i,".ad_runner_non_linear_ad_ui span{position:absolute;top:0;right:0;color:#f9754d;cursor:pointer;padding:2px;font-weight:bold;background-color:white}.ad_runner_non_linear_ad_ui img{cursor:pointer}\n",""])},function(e,t){e.exports=function(e){var t="undefined"!=typeof window&&window.location;if(!t)throw new Error("fixUrls requires window.location");if(!e||"string"!=typeof e)return e;var i=t.protocol+"//"+t.host,o=i+t.pathname.replace(/\/[^\/]*$/,"/");return e.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(e,t){var n,r=t.trim().replace(/^"(.*)"$/,function(e,t){return t}).replace(/^'(.*)'$/,function(e,t){return t});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(r)?e:(n=0===r.indexOf("//")?r:0===r.indexOf("/")?i+r:o+r.replace(/^\.\//,""),"url("+JSON.stringify(n)+")")})}},function(e,t){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var n=["start","creativeView"],i=["close"];e.exports=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.impressionEvents=[].concat(e.impressions||[],e.viewableImpressions||[]),this.trackingEvents=e.creatives[0].trackingEvents}return function(e,t,n){t&&r(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(t,[{key:"onAdStarted",value:function(){var t=this;this.impressionEvents.forEach(function(e){return t._fireEvent(e.uri)}),this._trackEvents(n)}},{key:"onAdStopped",value:function(){this._trackEvents(i)}},{key:"_trackEvents",value:function(t){var n=this;this.trackingEvents.filter(function(e){return t.indexOf(e.event)>-1}).forEach(function(e){return n._fireEvent(e.uri)})}},{key:"_fireEvent",value:function(e){e&&((new Image).src=e)}}]),t}()},function(e,t,n){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=n(5),o=i.AD_POSITION,l=i.PRELOAD_DURATION,u=i.COUNT_DOWN_DURATION,c=n(3).createPromiseDefer,f="midroll";function d(e){return e.ads[0]&&e.ads[0].creatives.length&&"nonLinear"!==e.ads[0].creatives[0].type}e.exports=function(){function s(e){var t=e.prepareAd,n=e.beforePlayAd,r=e.preloadAd,i=e.loadAd,o=e.playAd,a=e.logger;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),this.props={prepareAd:t,beforePlayAd:n,preloadAd:r,loadAd:i,playAd:o,logger:a},this._reset(),this.dataLoadingDeferred=c()}return function(e,t,n){t&&r(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(s,[{key:"name",get:function(){return"Scheduler"}},{key:"logger",get:function(){return this.props.logger}},{key:"populateAdsData",value:function(e){var t=this;e.forEach(function(e){return e.position===o.preroll?t.prerollAds.push(e):e.position===o.postroll?t.postrollAds.push(e):void t.midrollAds.push(e)}),this.midrollAds.sort(function(e,t){return t.startTime>e.startTime?1:-1}),this.prerollAds.length&&this.props.loadAd(this.prerollAds[0]),this.dataLoadingDeferred.resolve()}},{key:"onContentProgress",value:function(e){var t=this;if(this.ignoredFirstFrame){if(!this.state)return this._setState("preroll"),void this.dataLoadingDeferred.promise.then(function(){t._playAds(t.prerollAds).then(function(){t._setState(f)})});if(this.state===f){if(!this.midrollAds.length)return this._setState("postroll");var n=e.current<0?e.total:e.current,r=this._getAdsPriorTime(this.midrollAds,n),i=this._getAdsPriorTime(this.midrollAds,n+l);if(i.length&&this.props.preloadAd(i[0]),r.length)this.midrollAds.splice(this.midrollAds.length-r.length,r.length),this.props.beforePlayAd(d(r[0]),function(){t._playAds(r)});else{var o=this._getAdsPriorTime(this.midrollAds,n+u);if(o.length){var a=o[0].startTime-n;this.props.prepareAd(o[0],a)}}}}else this.ignoredFirstFrame=!0}},{key:"onContentEnded",value:function(){this.midrollAds.length&&this.logger.warn(this.name,"cannot play these mid-roll ads because start time is too late",this.midrollAds),this._playAds(this.postrollAds),this._reset()}},{key:"_reset",value:function(){this.ignoredFirstFrame=!1,this._setState(null),this.prerollAds=[],this.midrollAds=[],this.postrollAds=[]}},{key:"_setState",value:function(e){this.logger.info(this.name,"state changed from ".concat(this.state," to ").concat(e)),this.state=e}},{key:"_playAds",value:function(e){var t=this,n=[],r=[];return e.forEach(function(e){d(e)?n.push(e):r.push(e)}),this._playAd(n).then(function(){return t._playAd(r)})}},{key:"_playAd",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=e[n];if(r){var i={order:n+1,total:e.length};return this.props.playAd(r,i).catch(function(e){t.logger.error(t.name,"error while playing ad",e)}).then(function(){return t._playAd(e,n+1)})}return Promise.resolve()}},{key:"_getAdsPriorTime",value:function(e,t){for(var n=e.length-1;n>-1&&t>e[n].startTime;)--n;return e.slice(n+1).reverse()}}]),s}()},function(e,t,n){function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=c(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}}).apply(this,arguments)}function l(e,t){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=n(2),d=n(19),h=n(64),p=n(3),g=n(79),v=n(82);n(85);var y="is_mobile";e.exports=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t)}(i,f);var r=function(r){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=c(r);if(i){var n=c(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===o(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return u(e)}(this,e)}}(i);function i(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(n=r.call(this)).options=e,n.adContainers=t,n.$adContainer=new f({element:t.linear}),n.$adContainer.render(),n.adPlayer=null,n.adPaused=!1,n.adVolume=0,n.adVolumeCached=1,n.mouseEntered=!1,n._onClick=n._onClick.bind(u(n)),n._onMouseEnter=n._onMouseEnter.bind(u(n)),n._onMouseLeave=n._onMouseLeave.bind(u(n)),n._onSkipBtnClick=n._onSkipBtnClick.bind(u(n)),n._onViewDetailBtnClick=n._onViewDetailBtnClick.bind(u(n)),n.render(),n._registerEvents(),n.control.hide(),p.isMobile()&&(n.addClass(y),n.$adContainer.off("mouseenter",n._onMouseEnter),n.$adContainer.off("mouseleave",n._onMouseLeave)),n}return function(e,t,n){t&&a(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(i,[{key:"name",get:function(){return"ad_runner_ui"}},{key:"attributes",get:function(){return{class:this.name}}},{key:"render",value:function(){return s(c(i.prototype),"render",this).call(this),this.hide(),this.$uiLoading=new f({className:"ad_runner_ui_loading"}),this.$uiLoading.render(),this.$uiLoading.element.textContent="Äang táº£i quáº£ng cÃ¡o...",this.$uiLoading.hide(),this.$uiViewDetail=new f({className:"ad_runner_ui_viewdetail"}),this.$uiViewDetail.render(),this.$uiViewDetail.element.textContent="Xem chi tiáº¿t quáº£ng cÃ¡o",this.$uiAdIndex=new f({className:"ad_runner_ui_adindex"}),this.$uiAdIndex.render(),this.$uiAdIndex.hide(),this.countdownToPlay=new d({template:"Quáº£ng cÃ¡o hiá»n thá» sau %ss",className:"ad_runner_ui_countdown_to_play"}),this.countdownToPlay.hide(),this.skipButton=new g({getPoster:this.options.getPoster}),this.control=new h(this),this.slideBlack=new v(this),this.appendChild(this.$uiViewDetail),this.appendChild(this.$uiAdIndex),this.appendChild(this.skipButton),this.appendChild(this.control),this.$adContainer.appendChild(this),this.adContainers.notification.appendChild(this.countdownToPlay.element),this.adContainers.notification.appendChild(this.$uiLoading.element),this.adContainers.notification.appendChild(this.slideBlack.element),this}},{key:"remove",value:function(){this._unregisterEvents(),this._stopSkipTimer(),this._stopProgressTimer(),this.skipButton.remove(),this.countdownToPlay.remove(),this.control.remove(),this.$uiLoading.remove(),this.slideBlack.remove(),s(c(i.prototype),"remove",this).call(this)}},{key:"setPlayer",value:function(e){this.adPlayer=e}},{key:"togglePlayPause",value:function(){this.adPlayer.isPaused()?(this.adPlayer.resume(),this._onPauseStateChanged(!1)):(this.adPlayer.pause(),this._onPauseStateChanged(!0))}},{key:"toggleMute",value:function(){var e=this.adPlayer.getVolume(),t=e?0:this.adVolumeCached;this.adPlayer.setVolume(t),this._onVolumeChanged(t),this.adVolumeCached=e}},{key:"onAdWillStart",value:function(){this.show(),this.$uiLoading.show(),this.$uiViewDetail.hide(),this.$uiAdIndex.hide(),this.skipButton.hide(),this.skipButton.loadPoster(),this.countdownToPlay.hide()}},{key:"onAdStarted",value:function(e){if(this.adPlayer.selfControl)return this.$uiLoading.hide(),void this.hide();this.adPlayer.canClickThrough?this.addClass("click-through"):this.removeClass("click-through"),this.adPlayer.isFacebookAd?this.addClass("facebook-ad"):this.removeClass("facebook-ad"),this.adPlayer.isGoogleImaAd?this.addClass("google-ima-ad"):this.removeClass("google-ima-ad"),this.$uiLoading.hide(),this.$uiViewDetail.show(),e&&e.total>1&&(this.$uiAdIndex.show(),this.$uiAdIndex.html("Quáº£ng cÃ¡o ".concat(e.order," / ").concat(e.total))),this._startProgressTimer(),this.adPlayer.getSkipOffset()>-1&&(this.skipButton.show(),this.skipButton.update(this._getTimeToSkip()||5),this._startSkipTimer()),this._onVolumeChanged(this.adPlayer.getVolume())}},{key:"onAdStopped",value:function(){this._stopSkipTimer(),this._stopProgressTimer(),this.$uiLoading.hide(),this.hide()}},{key:"_registerEvents",value:function(){this.on("click",this._onClick),this.$adContainer.on("mouseenter",this._onMouseEnter),this.$adContainer.on("mouseleave",this._onMouseLeave),this.skipButton.on("click",this._onSkipBtnClick),this.$uiViewDetail.on("click",this._onViewDetailBtnClick)}},{key:"_unregisterEvents",value:function(){this.off("click",this._onClick),this.$adContainer.off("mouseenter",this._onMouseEnter),this.$adContainer.off("mouseleave",this._onMouseLeave),this.skipButton.off("click",this._onSkipBtnClick),this.$uiViewDetail.off("click",this._onViewDetailBtnClick)}},{key:"_startProgressTimer",value:function(){var n=this;this.progressTimer=setInterval(function(){var e={duration:n.adPlayer.getDuration(),remaining:n.adPlayer.getRemainingTime(),paused:n.adPlayer.isPaused()};n.control.onProgress(e);var t=n.adPlayer.getVolume();e.paused!==n.adPaused&&n._onPauseStateChanged(e.paused),t!==n.adVolume&&n._onVolumeChanged(t)},1e3)}},{key:"_stopProgressTimer",value:function(){clearInterval(this.progressTimer),this.progressTimer=null}},{key:"_startSkipTimer",value:function(){var t=this;this._stopSkipTimer();var n=this._getTimeToSkip();this.skipTimer=setInterval(function(){var e=t._getTimeToSkip();t.adPlayer.isPaused()||(n-=1),e<=0||e-n>t.options.skipTimeout?(t.skipButton.skipOn(),t._stopSkipTimer()):t.skipButton.update(e)},1e3)}},{key:"_stopSkipTimer",value:function(){this.skipTimer&&(clearInterval(this.skipTimer),this.skipTimer=null)}},{key:"_getTimeToSkip",value:function(){var e=this.adPlayer.getSkipOffset()+this.adPlayer.getRemainingTime()-this.adPlayer.getDuration();return e<0?5:e}},{key:"_onSkipBtnClick",value:function(e){var t=this;e.stopPropagation(),function(i){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:400,a=arguments.length>2?arguments[2]:void 0;i.style.opacity||(i.style.opacity=1);var s=null;window.requestAnimationFrame(function e(t){var n=t-(s=s||t),r=parseFloat(1-n/o,2);i.style.opacity=r<0?0:r,n>o?"function"==typeof a&&a():window.requestAnimationFrame(e)})}(this.adPlayer.element,300,function(){t.adPlayer.skip(),t.adPlayer.element.style.opacity=null})}},{key:"_onViewDetailBtnClick",value:function(e){e.stopPropagation(),this.adPlayer.viewDetail()}},{key:"_onClick",value:function(){this.togglePlayPause()}},{key:"_onMouseEnter",value:function(){this.mouseEntered=!0,!this.adPaused&&this.control.show()}},{key:"_onMouseLeave",value:function(){this.mouseEntered=!1,!this.adPaused&&this.control.hide()}},{key:"_onPauseStateChanged",value:function(e){this.adPaused=e,this.control.onPauseStateChanged(e,this.mouseEntered)}},{key:"_onVolumeChanged",value:function(e){this.adVolume=e,this.control.onMuteStateChanged(0===e)}}]),i}()},function(e,t,n){var r=n(63);"string"==typeof r&&(r=[[e.i,r,""]]),n(1)(r,{hmr:!0,transform:void 0,insertInto:void 0}),r.locals&&(e.exports=r.locals)},function(e,t,n){(e.exports=n(0)(!1)).push([e.i,".ad_runner_ui_countdown{background-color:rgba(0,0,0,0.4);color:#eee;font-size:12px;height:auto;line-height:18px;padding:5px;position:absolute;width:auto;top:10px;left:10px}\n",""])},function(e,t,n){function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=l(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}}).apply(this,arguments)}function s(e,t){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var u=n(2),c=n(65),f=n(68),d=n(71),h=n(74);n(77),e.exports=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&s(e,t)}(r,u);var n=function(r){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=l(r);if(i){var n=l(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===o(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)}}(r);function r(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(t=n.call(this)).adUi=e,t.render(),t}return function(e,t,n){t&&i(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(r,[{key:"name",get:function(){return"ad_runner_ui_control"}},{key:"attributes",get:function(){return{class:this.name}}},{key:"show",value:function(){this.playpause.show(),this.volume.show(),this.timer.show(),this.removeClass("minimized"),this.adUi.addClass("has_control")}},{key:"hide",value:function(){this.playpause.hide(),this.volume.hide(),this.timer.hide(),this.addClass("minimized"),this.adUi.removeClass("has_control")}},{key:"remove",value:function(){this.timeline.remove(),this.playpause.remove(),this.volume.remove(),this.timer.remove(),a(l(r.prototype),"remove",this).call(this)}},{key:"render",value:function(){a(l(r.prototype),"render",this).call(this),this.timeline=new c,this.playpause=new f(this.adUi),this.timer=new h,this.volume=new d(this.adUi),this.appendChild(this.timeline),this.appendChild(this.playpause),this.appendChild(this.timer),this.appendChild(this.volume)}},{key:"onProgress",value:function(e){e.paused||(this.timeline.setPosition((e.duration-e.remaining)/e.duration*100),this.timer.update(e))}},{key:"onPauseStateChanged",value:function(e,t){e?this.show():t||this.hide(),this.playpause.onPauseStateChanged(e)}},{key:"onMuteStateChanged",value:function(e){this.volume.onMuteStateChanged(e)}}]),r}()},function(e,t,n){function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(){return(i="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=s(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}}).apply(this,arguments)}function a(e,t){return(a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var l=n(2);n(66),e.exports=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&a(e,t)}(n,l);var t=function(r){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=s(r);if(i){var n=s(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===o(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)}}(n);function n(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(e=t.call(this)).render(),e}return function(e,t,n){t&&r(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(n,[{key:"name",get:function(){return"ad_runner_ui_timeline"}},{key:"attributes",get:function(){return{class:this.name}}},{key:"render",value:function(){i(s(n.prototype),"render",this).call(this),this.$uiProgress=new l,this.$uiProgress.render(),this.appendChild(this.$uiProgress)}},{key:"setPosition",value:function(e){e<=100&&this.$uiProgress.style("width","".concat(e,"%"))}}]),n}()},function(e,t,n){var r=n(67);"string"==typeof r&&(r=[[e.i,r,""]]),n(1)(r,{hmr:!0,transform:void 0,insertInto:void 0}),r.locals&&(e.exports=r.locals)},function(e,t,n){(e.exports=n(0)(!1)).push([e.i,".ad_runner_ui_timeline{bottom:0;height:4px;left:0;position:absolute;width:100%}.ad_runner_ui_timeline>div{-webkit-transition:width 1s linear;-moz-transition:width 1s linear;-o-transition:width 1s linear;transition:width 1s linear;background-color:#ffff00;height:100%;width:0%}\n",""])},function(e,t,n){function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=u(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}}).apply(this,arguments)}function s(e,t){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var c=n(2);n(69);var f='<svg height="100%" version="1.1" viewBox="0 0 36 36" width="100%"><path d="M 12,26 16,26 16,10 12,10 z M 21,26 25,26 25,10 21,10 z"></path></svg>';e.exports=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&s(e,t)}(r,c);var n=function(r){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=u(r);if(i){var n=u(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===o(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return l(e)}(this,e)}}(r);function r(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(t=n.call(this)).adUi=e,t._onClickEvent=t._onClickEvent.bind(l(t)),t.render(),t._registerEvents(),t}return function(e,t,n){t&&i(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(r,[{key:"name",get:function(){return"ad_runner_ui_playpause"}},{key:"attributes",get:function(){return{class:this.name}}},{key:"render",value:function(){a(u(r.prototype),"render",this).call(this),this.html(f)}},{key:"remove",value:function(){this._unregisterEvents(),a(u(r.prototype),"remove",this).call(this)}},{key:"onPauseStateChanged",value:function(e){e?this.html('<svg height="100%" version="1.1" viewBox="0 0 36 36" width="100%"><path d="M 12,26 18.5,22 18.5,14 12,10 z M 18.5,22 25,18 25,18 18.5,14 z"></path></svg>'):this.html(f)}},{key:"_registerEvents",value:function(){this.on("click",this._onClickEvent)}},{key:"_unregisterEvents",value:function(){this.off("click",this._onClickEvent)}},{key:"_onClickEvent",value:function(e){e.stopPropagation(),this.adUi.togglePlayPause()}}]),r}()},function(e,t,n){var r=n(70);"string"==typeof r&&(r=[[e.i,r,""]]),n(1)(r,{hmr:!0,transform:void 0,insertInto:void 0}),r.locals&&(e.exports=r.locals)},function(e,t,n){(e.exports=n(0)(!1)).push([e.i,".ad_runner_ui_playpause{width:35px;height:35px;float:left;margin-left:5px}.ad_runner_ui_playpause:hover{cursor:pointer}.ad_runner_ui_playpause>svg{fill:#f5f5f5}.ad_runner_ui_playpause:hover>svg,.ad_runner_ui_playpause:active>svg{fill:#ffffff}\n",""])},function(e,t,n){function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=u(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}}).apply(this,arguments)}function s(e,t){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var c=n(2);n(72);var f='<svg height="100%" viewBox="0 0 36 36" width="100%"><path d="M8,21 L12,21 L17,26 L17,10 L12,15 L8,15 L8,21 Z M19,14 L19,22 C20.48,21.32 21.5,19.77 21.5,18 C21.5,16.26 20.48,14.74 19,14 Z M19,11.29 C21.89,12.15 24,14.83 24,18 C24,21.17 21.89,23.85 19,24.71 L19,26.77 C23.01,25.86 26,22.28 26,18 C26,13.72 23.01,10.14 19,9.23 L19,11.29 Z"></path></svg>';e.exports=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&s(e,t)}(r,c);var n=function(r){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=u(r);if(i){var n=u(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===o(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return l(e)}(this,e)}}(r);function r(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(t=n.call(this))._onClickEvent=t._onClickEvent.bind(l(t)),t.adUi=e,t.render(),t._registerEvents(),t}return function(e,t,n){t&&i(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(r,[{key:"name",get:function(){return"ad_runner_ui_volume"}},{key:"attributes",get:function(){return{class:this.name}}},{key:"render",value:function(){a(u(r.prototype),"render",this).call(this),this.html(f)}},{key:"remove",value:function(){this._unregisterEvents(),a(u(r.prototype),"remove",this).call(this)}},{key:"onMuteStateChanged",value:function(e){e?this.html('<svg height="100%" viewBox="0 0 36 36" width="100%"><path d="m16.98686,9.984l0,4.219l-2.109,-2.109l2.109,-2.11zm-7.734,-0.984l16.734,16.734l-1.266,1.266l-2.063,-2.063c-1.078,0.844 -2.297,1.5 -3.656,1.828l0,-2.063c0.844,-0.234 1.594,-0.656 2.25,-1.172l-4.266,-4.266l0,6.75l-5.016,-5.016l-3.984,0l0,-6l4.734,0l-4.734,-4.734l1.267,-1.264zm14.718,9c0,-3.188 -2.063,-5.859 -4.969,-6.703l0,-2.063c4.031,0.891 6.984,4.5 6.984,8.766c0,1.5 -0.375,2.953 -1.031,4.172l-1.5,-1.547c0.328,-0.797 0.516,-1.688 0.516,-2.625zm-2.484,0c0,0.234 0,0.422 -0.047,0.609l-2.438,-2.438l0,-2.203c1.5,0.75 2.484,2.25 2.484,4.031l0.001,0.001z"></path></svg>'):this.html(f)}},{key:"_registerEvents",value:function(){this.on("click",this._onClickEvent)}},{key:"_unregisterEvents",value:function(){this.off("click",this._onClickEvent)}},{key:"_onClickEvent",value:function(e){e.stopPropagation(),this.adUi.toggleMute()}}]),r}()},function(e,t,n){var r=n(73);"string"==typeof r&&(r=[[e.i,r,""]]),n(1)(r,{hmr:!0,transform:void 0,insertInto:void 0}),r.locals&&(e.exports=r.locals)},function(e,t,n){(e.exports=n(0)(!1)).push([e.i,".ad_runner_ui_volume{width:35px;height:35px;float:right;margin-right:5px}.ad_runner_ui_volume:hover{cursor:pointer}.ad_runner_ui_volume>svg{fill:#f5f5f5}.ad_runner_ui_volume:hover>svg,.ad_runner_ui_volume:active>svg{fill:#ffffff}\n",""])},function(e,t,n){function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(){return(i="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=s(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}}).apply(this,arguments)}function a(e,t){return(a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var l=n(2),u=n(3).formatTime;n(75),e.exports=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&a(e,t)}(n,l);var t=function(r){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=s(r);if(i){var n=s(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===o(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)}}(n);function n(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(e=t.call(this)).render(),e}return function(e,t,n){t&&r(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(n,[{key:"name",get:function(){return"ad_runner_ui_timer"}},{key:"attributes",get:function(){return{class:this.name}}},{key:"render",value:function(){i(s(n.prototype),"render",this).call(this),this.html("00:00 / 00:00")}},{key:"update",value:function(e){var t=u(e.duration-e.remaining),n=u(e.duration);this.html("".concat(t," / ").concat(n))}}]),n}()},function(e,t,n){var r=n(76);"string"==typeof r&&(r=[[e.i,r,""]]),n(1)(r,{hmr:!0,transform:void 0,insertInto:void 0}),r.locals&&(e.exports=r.locals)},function(e,t,n){(e.exports=n(0)(!1)).push([e.i,".ad_runner_ui_timer{color:#f5f5f5;float:left;margin-left:5px;height:35px;line-height:35px;font-size:12px}\n",""])},function(e,t,n){var r=n(78);"string"==typeof r&&(r=[[e.i,r,""]]),n(1)(r,{hmr:!0,transform:void 0,insertInto:void 0}),r.locals&&(e.exports=r.locals)},function(e,t,n){(e.exports=n(0)(!1)).push([e.i,".ad_runner_ui_control{-webkit-transition:height 100ms ease;-moz-transition:height 100ms ease;-o-transition:height 100ms ease;transition:height 100ms ease;background:linear-gradient(transparent, #000);bottom:0;height:40px;left:0;position:absolute;width:100%;pointer-events:none}.ad_runner_ui_control.minimized{background:none;height:5px}.ad_runner_ui_control>*{pointer-events:auto}\n",""])},function(e,t,n){function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=c(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}}).apply(this,arguments)}function l(e,t){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=n(2),d=n(19);n(80),e.exports=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t)}(i,f);var r=function(r){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=c(r);if(i){var n=c(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===o(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return u(e)}(this,e)}}(i);function i(e){var t,n=e.getPoster;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=r.call(this))._onPosterLoad=t._onPosterLoad.bind(u(t)),t.render(),t._registerEvents(),t.getPoster=n,t}return function(e,t,n){t&&a(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(i,[{key:"attributes",get:function(){return{class:"ad_runner_ui_skip_button"}}},{key:"render",value:function(){s(c(i.prototype),"render",this).call(this),this.countdown=new d({template:"Bá» qua quáº£ng cÃ¡o sau %ss",className:"countdown"}),this.countdown.render(),this.update=this.countdown.update.bind(this.countdown),this.skipText=new f({className:"skip_text"}),this.skipText.render(),this.skipText.element.textContent="Bá» qua",this.poster=new f({tagName:"img"}),this.poster.render(),this.poster.hide(),this.playIcon=new f({className:"play_icon"}),this.playIcon.render(),this.playIcon.html('<svg viewBox="12 12 24 24"><style type="text/css"> .st1{fill:none;stroke:#f1f1f1;stroke-width:1;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:10;} </style><g><g><path class="st1" d="M21.88173,28.00095l6.30217-3.67922c0.24333-0.14206,0.24348-0.49362,0.00028-0.63589l-6.30217-3.68663 c-0.2455-0.14361-0.5542,0.03345-0.5542,0.31786v7.36585C21.32781,27.9672,21.63623,28.14428,21.88173,28.00095z"/><circle class="st1" cx="24" cy="24" r="11.1667"/></g></g></svg>'),this.appendChild(this.skipText),this.appendChild(this.countdown),this.appendChild(this.poster),this.appendChild(this.playIcon)}},{key:"show",value:function(){s(c(i.prototype),"show",this).call(this),this.skipText.hide(),this.countdown.show(),this.removeClass("skippable")}},{key:"hide",value:function(){s(c(i.prototype),"hide",this).call(this),this.poster.hide(),this.removeClass("has_poster")}},{key:"remove",value:function(){this._unregisterEvents(),this.countdown.remove(),this.poster.remove(),this.skipText.remove(),this.playIcon.remove(),s(c(i.prototype),"remove",this).call(this)}},{key:"loadPoster",value:function(){var t=this;this.getPoster&&this.getPoster().then(function(e){t.poster.attr("src",e)})}},{key:"skipOn",value:function(){this.skipText.show(),this.countdown.hide(),this.addClass("skippable")}},{key:"_onPosterLoad",value:function(){this.poster.show(),this.addClass("has_poster")}},{key:"_registerEvents",value:function(){this.poster.on("load",this._onPosterLoad)}},{key:"_unregisterEvents",value:function(){this.poster.off("load",this._onPosterLoad)}}]),i}()},function(e,t,n){var r=n(81);"string"==typeof r&&(r=[[e.i,r,""]]),n(1)(r,{hmr:!0,transform:void 0,insertInto:void 0}),r.locals&&(e.exports=r.locals)},function(e,t,n){(e.exports=n(0)(!1)).push([e.i,".ad_runner_ui_skip_button{background-color:rgba(0,0,0,0.4);color:#eee;font-size:12px;height:auto;line-height:18px;padding:5px;position:absolute;width:auto;-webkit-transition:bottom 100ms ease;-moz-transition:bottom 100ms ease;-o-transition:bottom 100ms ease;transition:bottom 100ms ease;background-color:#2b2a2a;align-items:center;border:1px solid rgba(72,72,72,0.4);bottom:35px;display:flex;height:42px;padding:0;pointer-events:none !important;right:0px;text-align:center}.ad_runner_ui_skip_button.skippable{pointer-events:auto !important;cursor:pointer}.ad_runner_ui_skip_button .countdown{padding:5px;max-width:100px}.ad_runner_ui_skip_button .skip_text{font-size:13px;width:100px}.ad_runner_ui_skip_button .play_icon{position:absolute;width:65px;height:30px;right:0;display:none}.ad_runner_ui_skip_button .play_icon svg{width:30px;height:30px}.ad_runner_ui_skip_button.skippable.has_poster .play_icon{display:block}.ad_runner_ui_skip_button img{height:38px;object-fit:cover;width:65px}.is_mobile .ad_runner_ui_skip_button{width:170px;justify-content:center}.is_mobile .ad_runner_ui_skip_button .countdown{max-width:120px}.ad_runner_ui.facebook-ad .ad_runner_ui_skip_button{background-color:#000}.ad_runner_ui.has_control .ad_runner_ui_skip_button{bottom:35px}\n",""])},function(e,t,n){function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(){return(i="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=s(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}}).apply(this,arguments)}function a(e,t){return(a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}n(83);var l=n(2);e.exports=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&a(e,t)}(n,l);var t=function(r){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=s(r);if(i){var n=s(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===o(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)}}(n);function n(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(e=t.call(this,{className:"ad_runners_ui_slide_black"})).render(),e}return function(e,t,n){t&&r(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(n,[{key:"fadeIn",value:function(){this.addClass("ad_ui_slide_black_fade_in")}},{key:"fadeOut",value:function(){this.removeClass("ad_ui_slide_black_fade_in")}},{key:"render",value:function(){i(s(n.prototype),"render",this).call(this),this.html('<span class="ad_message_text">Video ná»i dung sáº½ tiáº¿p tá»¥c sau Äoáº¡n quáº£ng cÃ¡o</span>'),this.hide()}}]),n}()},function(e,t,n){var r=n(84);"string"==typeof r&&(r=[[e.i,r,""]]),n(1)(r,{hmr:!0,transform:void 0,insertInto:void 0}),r.locals&&(e.exports=r.locals)},function(e,t,n){(e.exports=n(0)(!1)).push([e.i,".ad_runners_ui_slide_black{position:absolute;top:0;left:0;z-index:1;width:100%;height:100%;background-color:#000;opacity:0;-webkit-transition:opacity .3s linear;-moz-transition:opacity .3s linear;-o-transition:opacity .3s linear;transition:opacity .3s linear}.ad_runners_ui_slide_black.ad_ui_slide_black_fade_in{opacity:1}.ad_runners_ui_slide_black .ad_message_text{color:#eee;font-size:13px;position:absolute;left:10px;bottom:10px}\n",""])},function(e,t,n){var r=n(86);"string"==typeof r&&(r=[[e.i,r,""]]),n(1)(r,{hmr:!0,transform:void 0,insertInto:void 0}),r.locals&&(e.exports=r.locals)},function(e,t,n){(e.exports=n(0)(!1)).push([e.i,'.ad_runner_ui{left:0px;position:absolute;top:0px;width:100%;height:100%;z-index:2}.ad_runner_ui.click-through{pointer-events:none}.ad_runner_ui.click-through>*{pointer-events:auto}.ad_runner_ui.click-through .ad_runner_ui_viewdetail{display:none}.ad_runner_ui .ad_runner_ui_viewdetail{background-color:rgba(0,0,0,0.4);color:#eee;font-size:12px;height:auto;line-height:18px;padding:5px;position:absolute;width:auto;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAATCAYAAAByUDbMAAAA2ElEQVQ4ja2U0U3DMBRFz0MM0BkyQleo2CAVm7ACYoaOUDagjJBs0G6A6AaHjzhSVcXGDtw/289H9z1fGbVXv83rCKBuCzWqwwPwBmz4D92Qt433+iVnawz0wDEtr/N+Myx1cEjLE/C6CpZAn0wzPkXE0+15New3UDXsDjQC+1xh8TVTvuYcDmo+RiVYEwh4bGhtFxHXTN0z8LXoTO3Uc40j9SUb2gT9ALqSo6o2I2JUR6ZkV4MWYQm4V7sWEBRyFhGXFlARtkahnpmG/Ve9z/9S6aet0aB2P+baSzgLyi9XAAAAAElFTkSuQmCC");background-position-x:calc(100% - 5px);background-position-y:center;background-repeat:no-repeat;background-size:12px;cursor:pointer;padding-right:20px;right:10px;top:10px}.ad_runner_ui .ad_runner_ui_adindex{background-color:rgba(0,0,0,0.4);color:#eee;font-size:12px;height:auto;line-height:18px;padding:5px;position:absolute;width:auto;background-color:transparent;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAjVJREFUOBHlVEFrU0EQ/mb35TVtqqRKq0LaXhRbxbMggh5UKioePQserEcP4smjoHjoTUERvAi9eCmC9A+UCqJQJIJ6KAhNqlBLNE3y8nb89iV5SbB66bEDYb/9ZufLzOy8BXadia84Wi/MOCezgE6rYoTkEEQy3Bu6hZxfScFxUSIH1YigSm6D+6Ix+jgz9u2NROWJ87Fziz5gp2aNuWCcczd3KtSJ91oGghMdorPa4bsIR5eQ2b8IM3itQ8OEZ8ktIBwrIsg/B8xo6ksAtdgb6WNt7hZsbhZxdR4arSDY+xASngbsOEWesIMNxL/mKH6Svvv9gtQKyOR6WZO9TKFlxL/nSFuE2Yuw2Stw0QeIySHavAONv/JOfkLsZG+oxzkKqhdNTYKjcLWF9j6GuhI8J1pJOHXfk9VtzacxXaCBHwc/Cl2Ly+zCnnQvxOrWeWqzxclga7UF/tF0eq4NnOFU1XtZx3JNeIqHp2AGZljWQbZtmSW/S47Z7FV2YgLhyEv28EFvqJ/QutRK4yU25EDqkTxv8hVMcCShtLmKxo8zxDEFHsEOtW5dXQXRxvWk391YKUt9rVDkxE+lZBtIcJwZnoMdvo1m5R5c9UXiEXuY47IP2lxhRlt9YfzCPgX8nj4zw78EtfkRMX8uesuS36eBGn/xyW5v1DIKebq9t8VqY4mg9r8jqc9rJY9DbW3ykoi7wUyPqSCfPA6QAdb078cBWk8eB+XjIFJUNc+yh1Zfp+q7B/wBa0XJ8tc9BKoAAAAASUVORK5CYII=");background-position-y:center;background-repeat:no-repeat;bottom:50px;left:15px;padding-left:25px;text-shadow:0 0 4px #000}.ad_runner_ui_countdown_to_play{background-color:rgba(0,0,0,0.4);color:#eee;font-size:12px;height:auto;line-height:18px;padding:5px;position:absolute;width:auto;top:10px;left:10px;z-index:1}.ad_runner_ui_loading{background-color:rgba(0,0,0,0.4);color:#eee;font-size:12px;height:auto;line-height:18px;padding:5px;position:absolute;width:auto;top:10px;left:10px}.ad_runner_ui_hide{display:none !important}\n',""])},function(e,t,n){function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=c(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}}).apply(this,arguments)}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}n(88);var f=n(2);e.exports=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&s(e,t)}(i,f);var r=function(r){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=c(r);if(i){var n=c(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===o(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return l(e)}(this,e)}}(i);function i(e){var t,n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),u((t=l(n=r.call(this,{className:"ad_runners_ui_ad_mark_container"})),c(i.prototype)),"render",t).call(t),n.containerElement=e,e&&e.appendChild(n.element),n}return function(e,t,n){t&&a(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(i,[{key:"render",value:function(r,e){var i=this;this.containerElement&&e.forEach(function(e){var t=100*e.startTime/r;if(0<=t&&t<=100){var n=i._createAdMarkItem(t);i.appendChild(n),e.adMarkItem=n,e._completeAd=function(){n.remove()}}})}},{key:"removeMarkItems",value:function(){this.html("")}},{key:"setContainer",value:function(e){e.appendChild(this.element)}},{key:"_createAdMarkItem",value:function(e){var t=document.createElement("span");return t.setAttribute("class","ad_runners_ui_ad_mark_container_item"),t.style.left="".concat(e,"%"),t}}]),i}()},function(e,t,n){var r=n(89);"string"==typeof r&&(r=[[e.i,r,""]]),n(1)(r,{hmr:!0,transform:void 0,insertInto:void 0}),r.locals&&(e.exports=r.locals)},function(e,t,n){(e.exports=n(0)(!1)).push([e.i,".ad_runners_ui_ad_mark_container{display:flex !important;width:100%;height:100%}.ad_runners_ui_ad_mark_container .ad_runners_ui_ad_mark_container_item{height:100%;width:5px;background-color:yellow;display:block;position:relative}\n",""])}])},function(e,t,n){"use strict";(function(e){"function"!=typeof e.Promise&&(e.Promise=n(2))}).call(this,n(3))},function(c,e,t){"use strict";(function(t){var n,r,e=t.MutationObserver||t.WebKitMutationObserver;if(e){var i=0,o=new e(u),a=t.document.createTextNode("");o.observe(a,{characterData:!0}),n=function(){a.data=i=++i%2}}else if(t.setImmediate||void 0===t.MessageChannel)n="document"in t&&"onreadystatechange"in t.document.createElement("script")?function(){var e=t.document.createElement("script");e.onreadystatechange=function(){u(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},t.document.documentElement.appendChild(e)}:function(){setTimeout(u,0)};else{var s=new t.MessageChannel;s.port1.onmessage=u,n=function(){s.port2.postMessage(0)}}var l=[];function u(){var e,t;r=!0;for(var n=l.length;n;){for(t=l,l=[],e=-1;++e<n;)t[e]();n=l.length}r=!1}c.exports=function(e){1!==l.push(e)||r||n()}}).call(this,t(3))},function(e,t,n){var r=n(8);Object.getOwnPropertySymbols||(Object.getOwnPropertySymbols=r)},function(e,t,n){(function(j){!function(e,t){"use strict";if(!(t in e)){var i,n=typeof j==typeof n?window:j,r=0,o=""+Math.random(),a="__symbol:",s=a.length,l="__symbol@@"+o,u="defineProperty",c="defineProperties",f="getOwnPropertyNames",d="getOwnPropertyDescriptor",h="propertyIsEnumerable",p=e[f],g=e[d],v=e.create,y=e.keys,m=e.freeze||e,b=e[u],E=e[c],T=g(e,f),k=e.prototype,w=k.hasOwnProperty,_=k[h],S=k.toString,A=function(e,t,n){w.call(e,l)||b(e,l,{enumerable:!1,configurable:!1,writable:!1,value:{}}),e[l]["@@"+t]=n},P=function(){},O=function(e){return e!=l&&!w.call(R,e)},C=function(e){return e!=l&&w.call(R,e)},L=function(e){var t=""+e;return C(t)?w.call(this,t)&&this[l]["@@"+t]:_.call(this,e)},D=function(t){return b(k,t,{enumerable:!1,configurable:!0,get:P,set:function(e){i(this,t,{enumerable:!1,configurable:!0,writable:!0,value:e}),A(this,t,!0)}}),m(R[t]=b(e(t),"constructor",F))},x=function e(t){if(this instanceof e)throw new TypeError("Symbol is not a constructor");return D(a.concat(t||"",o,++r))},R=v(null),F={value:x},N=function(e){return R[e]},I=function(e,t,n){var r=""+t;return C(r)?(i(e,r,n.enumerable?function(e){var t=v(e);return t.enumerable=!1,t}(n):n),A(e,r,!!n.enumerable)):b(e,t,n),e},M=function(e){return p(e).filter(C).map(N)};T.value=I,b(e,u,T),T.value=M,b(e,t,T),T.value=function(e){return p(e).filter(O)},b(e,f,T),T.value=function(t,n){var e=M(n);return e.length?y(n).concat(e).forEach(function(e){L.call(n,e)&&I(t,e,n[e])}):E(t,n),t},b(e,c,T),T.value=L,b(k,h,T),T.value=x,b(n,"Symbol",T),T.value=function(e){var t=a.concat(a,e,o);return t in k?R[t]:D(t)},b(x,"for",T),T.value=function(e){if(O(e))throw new TypeError(e+" is not a symbol");if(w.call(R,e)){var t=e.slice(s);if(t.slice(0,s)===a&&(t=t.slice(s))!==o)return(t=t.slice(0,t.length-o.length)).length>0?t:void 0}},b(x,"keyFor",T),T.value=function(e,t){var n=g(e,t);return n&&C(t)&&(n.enumerable=L.call(e,t)),n},b(e,d,T),T.value=function(e,t){return 1===arguments.length||void 0===t?v(e):function(e,t){var n=v(e);return p(t).forEach(function(e){L.call(t,e)&&I(n,e,t[e])}),n}(e,t)},b(e,"create",T),T.value=function(){var e=S.call(this);return"[object String]"===e&&C(this)?"[object Symbol]":e},b(k,"toString",T);try{if(!0!==v(b({},a,{get:function(){return b(this,a,{value:!0})[a]}}))[a])throw"IE11";i=b}catch(e){i=function(e,t,n){var r=g(k,t);delete k[t],b(e,t,n),b(k,t,r)}}}}(Object,"getOwnPropertySymbols"),function(t,n){"use strict";var r,i=t.defineProperty,o=t.prototype,a=o.toString,s="toStringTag";["iterator","match","replace","search","split","hasInstance","isConcatSpreadable","unscopables","species","toPrimitive",s].forEach(function(e){if(!(e in n))switch(i(n,e,{value:n(e)}),e){case s:(r=t.getOwnPropertyDescriptor(o,"toString")).value=function(){var e=a.call(this),t=null!=this?this[n.toStringTag]:this;return null==t?e:"[object "+t+"]"},i(o,"toString",r)}})}(Object,Symbol),function(a,e,t){function s(){return this}e[a]||(e[a]=function(){var t=0,n=this,e={next:function(){var e=n.length<=t;return e?{done:e}:{done:e,value:n[t++]}}};return e[a]=s,e}),t[a]||(t[a]=function(){var n=String.fromCodePoint,r=this,i=0,o=r.length,e={next:function(){var e=o<=i,t=e?"":n(r.codePointAt(i));return i+=t.length,e?{done:e}:{done:e,value:t}}};return e[a]=s,e})}(Symbol.iterator,Array.prototype,String.prototype),e.exports=Object.getOwnPropertySymbols}).call(this,n(3))},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,r){var i={"./blue.scss":[33,1],"./green.scss":[34,2],"./light_blue.scss":[35,3],"./purple.scss":[36,4],"./red.scss":[37,5]};function n(t){var n=i[t];return n?r.e(n[1]).then(function(){var e=n[0];return r.t(e,7)}):Promise.resolve().then(function(){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e})}n.keys=function(){return Object.keys(i)},n.id=23,e.exports=n},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(F,e,a){"use strict";a.r(e);var t={};a.r(t),a.d(t,"cloneDeep",function(){return ve}),a.d(t,"getDeep",function(){return m}),a.d(t,"each",function(){return me}),a.d(t,"extend",function(){return d}),a.d(t,"objValuesToArray",function(){return be});var n={};a.r(n),a.d(n,"hasClass",function(){return Le}),a.d(n,"addClass",function(){return T}),a.d(n,"removeClass",function(){return h}),a.d(n,"toggleClass",function(){return p}),a.d(n,"setClass",function(){return De}),a.d(n,"setStyles",function(){return g}),a.d(n,"isEl",function(){return xe}),a.d(n,"isTextNode",function(){return Re}),a.d(n,"emptyEl",function(){return Ie}),a.d(n,"normalizeContent",function(){return Me}),a.d(n,"appendContent",function(){return Fe}),a.d(n,"insertContent",function(){return Ne}),a.d(n,"textContent",function(){return je}),a.d(n,"createEl",function(){return k}),a.d(n,"createElFromHTML",function(){return Ue}),a.d(n,"getAttribute",function(){return Be}),a.d(n,"setAttribute",function(){return He}),a.d(n,"removeAttribute",function(){return $e}),a.d(n,"findPosition",function(){return Ge}),a.d(n,"isOnViewport",function(){return Ve}),a.d(n,"getPointerPosition",function(){return Ye}),a.d(n,"isSingleLeftClick",function(){return ze}),a.d(n,"removeFromDom",function(){return Ke});var r={};a.r(r),a.d(r,"IS_IPAD",function(){return yt}),a.d(r,"IS_IPHONE",function(){return mt}),a.d(r,"IS_IPOD",function(){return bt}),a.d(r,"IS_IOS",function(){return S}),a.d(r,"IOS_VERSION",function(){return Et}),a.d(r,"IS_ANDROID",function(){return Tt}),a.d(r,"ANDROID_VERSION",function(){return kt}),a.d(r,"IS_NATIVE_ANDROID",function(){return wt}),a.d(r,"IS_FIREFOX",function(){return _t}),a.d(r,"IS_EDGE",function(){return St}),a.d(r,"IS_CHROME",function(){return At}),a.d(r,"CHROME_VERSION",function(){return Pt}),a.d(r,"IE_VERSION",function(){return Ot}),a.d(r,"IS_SAFARI",function(){return Ct}),a.d(r,"IS_ANY_SAFARI",function(){return Lt}),a.d(r,"IS_MOBILE",function(){return A});var N={};a.r(N),a.d(N,"createPromiseDefer",function(){return Dt});var i={};a.r(i),a.d(i,"orderBy",function(){return qt}),a.d(i,"whereBy",function(){return Xt}),a.d(i,"average",function(){return Qt}),a.d(i,"findWithAttr",function(){return Jt});var o={};a.r(o),a.d(o,"getHours",function(){return Yr}),a.d(o,"getMinutes",function(){return zr}),a.d(o,"getSeconds",function(){return Kr}),a.d(o,"getCurrentTimeSeconds",function(){return Wr}),a.d(o,"formatTime",function(){return qr});var s={};a.r(s),a.d(s,"format",function(){return Zo}),a.d(s,"escapeHtml",function(){return ea}),a.d(s,"trimHtml",function(){return ta}),a.d(s,"trimAccents",function(){return na}),a.d(s,"startsWith",function(){return ra}),a.d(s,"endsWith",function(){return ia}),a.d(s,"generateId",function(){return oa}),a.d(s,"getPercentage",function(){return aa}),a.d(s,"replaceAll",function(){return sa}),a.d(s,"toTitleCase",function(){return la}),a.d(s,"toPascalCase",function(){return ua}),a.d(s,"toCamelCase",function(){return ca}),a.d(s,"stripHTML",function(){return fa}),a.d(s,"getHTML",function(){return da});var j={};a.r(j),a.d(j,"checkAdBlocker",function(){return is});var U={};a.r(U),a.d(U,"fetchUrl",function(){return os});var B={};a.r(B),a.d(B,"fadeOut",function(){return Rl}),a.d(B,"fadeIn",function(){return Il});a(5),a(7);var H={};function $(e){return H[e]||(H[e]=0),e+ ++H[e]}function G(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var V="font-weight: bold; font-size: 13px;",Y="color: #ff8000;"+V,z="color: #ff0000;"+V,K=1,W=4,q=["color: #0000ff;font-weight: bold; font-size: 13px;","color: #006600;font-weight: bold; font-size: 13px;",Y,z,z],X=["debug","info","warn","error","disabled"],f=function(){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:K,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:W;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this.level=e,this.offLevel=t}var e,t;return e=n,(t=[{key:"debug",value:function(e){this.log(e,0,Array.prototype.slice.call(arguments,1))}},{key:"info",value:function(e){this.log(e,K,Array.prototype.slice.call(arguments,1))}},{key:"warn",value:function(e){this.log(e,2,Array.prototype.slice.call(arguments,1))}},{key:"error",value:function(e){this.log(e,3,Array.prototype.slice.call(arguments,1))}},{key:"onOff",value:function(){this.level===this.offLevel?this.level=this.previousLevel:(this.previousLevel=this.level,this.level=this.offLevel),window.console&&window.console.log&&window.console.log("%c[Zplayer.Log] set log level to "+X[this.level],Y)}},{key:"level",value:function(e){this.level=e}},{key:"log",value:function(e,t,n){if(!(t<this.level)){n||(n=e,e=null);var r=q[t],i="";e&&(i="["+e+"]"),window.console&&window.console.log&&window.console.log.apply(console,["%c["+X[t]+"]"+i,r].concat(n))}}}])&&G(e.prototype,t),n}();function Q(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function J(e){return(J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}f.LEVEL_DEBUG=0,f.LEVEL_INFO=K,f.LEVEL_WARN=2,f.LEVEL_ERROR=3,f.LEVEL_DISABLED=W,f.getInstance=function(){return void 0===this._instance&&(this._instance=new this,this._instance.previousLevel=this._instance.level,this._instance.level=this._instance.offLevel),this._instance},f.setLevel=function(e){this.getInstance().level=e},f.debug=function(){this.getInstance().debug.apply(this.getInstance(),arguments)},f.info=function(){this.getInstance().info.apply(this.getInstance(),arguments)},f.warn=function(){this.getInstance().warn.apply(this.getInstance(),arguments)},f.error=function(){this.getInstance().error.apply(this.getInstance(),arguments)};var Z=Array.prototype.slice,ee=/\s+/,te=function(e,t,n,r){if(!n)return!0;if("object"===J(n)){for(var i in n)e[t].apply(e,[i,n[i]].concat(r));return!1}if(ee.test(n)){for(var o=n.split(ee),a=0,s=o.length;a<s;a++)e[t].apply(e,[o[a]].concat(r));return!1}return!0},ne=function(e,n,r,i){var o,a=-1,s=e.length,l=n[0],u=n[1],c=n[2];!function t(){try{switch(n.length){case 0:for(;++a<s;)(o=e[a]).callback.call(o.ctx);return;case 1:for(;++a<s;)(o=e[a]).callback.call(o.ctx,l);return;case 2:for(;++a<s;)(o=e[a]).callback.call(o.ctx,l,u);return;case 3:for(;++a<s;)(o=e[a]).callback.call(o.ctx,l,u,c);return;default:for(;++a<s;)(o=e[a]).callback.apply(o.ctx,n);return}}catch(e){f.error.apply(f,[r,"error on event",i,"trigger","-",e]),t()}}()},l=function(){function n(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n)}var e,t,r;return e=n,r=[{key:"register",value:function(e){n.Custom||(n.Custom={});var t="string"==typeof e&&e.toUpperCase().trim();t&&!n.Custom[t]?n.Custom[t]=t.toLowerCase().split("_").map(function(e,t){return 0===t?e:e=e[0].toUpperCase()+e.slice(1)}).join(""):f.error("Events","Error when register event: "+e)}}],(t=[{key:"on",value:function(e,t,n){if(!te(this,"on",e,[t,n])||!t)return this;this._events||(this._events={});var r=this._events[e]||(this._events[e]=[]);return r?(r.push({callback:t,context:n,ctx:n||this}),this):this}},{key:"once",value:function(e,t,n){var r,i=this;if(!te(this,"once",e,[t,n])||!t)return this;return r=function(){i.off(e,r),t.apply(this,arguments)},this.on(e,r,n)}},{key:"off",value:function(e,t,n){var r,i,o,a,s,l,u,c;if(!this._events||!te(this,"off",e,[t,n]))return this;if(!e&&!t&&!n)return this._events=void 0,this;for(s=0,l=(a=e?[e]:Object.keys(this._events)).length;s<l&&(e=a[s],o=this._events[e])&&(this._events[e]=r=[],t||n);s++){for(u=0,c=o.length;u<c;u++)i=o[u],(t&&t!==i.callback&&t!==i.callback._callback||n&&n!==i.context)&&r.push(i);r.length||delete this._events[e]}return this}},{key:"trigger",value:function(e){var t=this.name||this.constructor.name;if(!e)return f.warn.apply(f,[t,"trying to trigger undefined event, ignored"]),this;if(!this._events)return this;var n=Z.call(arguments,1);if(!te(this,"trigger",e,n))return this;var r=this._events[e],i=this._events.all;return r&&ne(r,n,t,e),i&&ne(i,arguments,t,e),this}},{key:"stopListening",value:function(e,t,n){var r=this._listeningTo;if(!r)return this;var i=!t&&!n;for(var o in n||"object"!==J(t)||(n=this),e&&((r={})[e._listenId]=e),r)(e=r[o]).off(t,n,this),(i||0===Object.keys(e._events).length)&&delete this._listeningTo[o];return this}}])&&Q(e.prototype,t),r&&Q(e,r),n}(),re={listenTo:"on",listenToOnce:"once"};Object.keys(re).forEach(function(r){l.prototype[r]=function(e,t,n){return(this._listeningTo||(this._listeningTo={}))[e._listenId||(e._listenId=$("l"))]=e,n||"object"!==J(t)||(n=this),e[re[r]](t,n,this),this}});function ie(e){return(ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function oe(e,t){return!t||"object"!==ie(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ae(e){return(ae=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function se(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function le(e,t){return(le=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}["PLAYER_PLAY","PLAYER_PLAY_INTENT","PLAYER_PAUSE","PLAYER_STOP","PLAYER_ENDED","PLAYER_SEEK","PLAYER_SEEKED","PLAYER_SEEKING","PLAYER_ERROR","PLAYER_TIMEUPDATE","PLAYER_PROGRESS","PLAYER_FULLSCREEN","PLAYER_READY","PLAYER_BUFFERING","PLAYER_BUFFERING_CHANGE","PLAYER_BUFFERFULL","PLAYER_PRESS_PLAY","PLAYER_VOLUMEUPDATE","PLAYER_LOADEDMETADATA","PLAYER_CLICK","PLAYER_DBLCLICK","PLAYER_KEYDOWN","PLAYER_MOUSE_ENTER","PLAYER_MOUSE_LEAVE","PLAYER_MOUSE_MOVE","PLAYER_CONTEXTMENU","PLAYER_LEVELS_AVAILABEL","PLAYER_LEVEL_SWITCHED","PLAYER_SETTINGS_MENU_HIDE","PLAYER_QUALITY_LEVELS_SELECTED","PLAYER_UPDATE_SIZE","PLAYER_CANPLAYTHROUGH","PLAYER_WAITING","PLAYER_ORIENTATION_CHANGE","PLAYER_AD_PAUSE_REQUEST","PLAYER_AD_RESUME_REQUEST","PLAYER_AD_WILL_START","PLAYER_AD_STARTED","PLAYER_AD_STOPPED","PLAYER_AD_SKIPPED","PLAYER_AD_LOAD_TIMEOUT","PLAYER_MEDIACONTROL_DISABLE","PLAYER_MEDIACONTROL_ENABLE","PLAYER_MEDIACONTROL_SHOW","PLAYER_MEDIACONTROL_HIDE","PLAYER_MEDIACONTROL_READY","PLAYER_MEDIACONTROL_CLICK","PLAYER_MEDIACONTROL_DBLCLICK","PLAYER_DVRSTATECHANGED","PLAYER_THEATER_MODE_CHANGE","PLAYBACK_PROGRESS","PLAYBACK_TIMEUPDATE","PLAYBACK_BUFFERING","PLAYBACK_BUFFERING_CHANGE","PLAYBACK_BUFFERFULL","PLAYBACK_SETTINGSUPDATE","PLAYBACK_LOADEDMETADATA","PLAYBACK_VOLUMEUPDATE","PLAYBACK_HIGHDEFINITIONUPDATE","PLAYBACK_BITRATE","PLAYBACK_LEVELS_AVAILABLE","PLAYBACK_LEVEL_SWITCH_START","PLAYBACK_LEVEL_SWITCH_END","PLAYBACK_PLAYBACKSTATE","PLAYBACK_DVR","PLAYBACK_DVRSTATECHANGED","PLAYBACK_MEDIACONTROL_DISABLE","PLAYBACK_MEDIACONTROL_ENABLE","PLAYBACK_ENDED","PLAYBACK_PLAY_INTENT","PLAYBACK_PLAY","PLAYBACK_PAUSE","PLAYBACK_SEEKING","PLAYBACK_WAITING","PLAYBACK_SEEKED","PLAYBACK_STOP","PLAYBACK_ERROR","PLAYBACK_STATS_ADD","PLAYBACK_FRAGMENT_LOADED","PLAYBACK_LEVEL_SWITCHED","PLAYBACK_SUBTITLE_AVAILABLE","PLAYBACK_SUBTITLE_CHANGED","PLAYBACK_FULLSCREEN_IOS","PLAYBACK_CANPLAYTHROUGH","MEDIACONTROL_HIDE","MEDIACONTROL_SHOW","LOADING_SPINNER_HIDE","LOADING_SPINNER_SHOW","MEDIACONTROL_MOUSEMOVE_SEEKBAR","MEDIACONTROL_MOUSELEAVE_SEEKBAR"].forEach(function(e){l[e]=e});var ue=function(e){var t,n,r;function i(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),e&&(t=e.options),(n=oe(this,ae(i).call(this))).player=e,n._options=t,n.uniqueId=$("o"),n._nameEvents={},n.constructor.NAME_EVENTS.forEach(function(e){l[e]=e,n._nameEvents[e]=e}),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&le(e,t)}(i,l),t=i,r=[{key:"NAME_EVENTS",get:function(){return[]}}],(n=[{key:"bindEvents",value:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.player;this.listenEvents.forEach(function(e){e.once?t.listenToOnce(e.target||n||t,e.name,e.handler):t.listenTo(e.target||n||t,e.name,e.handler)})}},{key:"unbindEvents",value:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.player;this.listenEvents.forEach(function(e){e.once?t.stopListening(e.target||n||t,e.name):t.stopListening(e.target||n||t,e.name,e.handler)})}},{key:"options",get:function(){return this._options}},{key:"listenEvents",get:function(){return[]}}])&&se(t.prototype,n),r&&se(t,r),i}(),u=function(e){return null!=e?e.constructor:null},c=function(e,t){return Boolean(e&&t&&e instanceof t)},ce=function(e){return null==e},fe=function(e){return u(e)===Object},de=function(e){return u(e)===String},he=function(e){return Array.isArray(e)},pe=function(e){return c(e,NodeList)},ge=function(e){return ce(e)||(de(e)||he(e)||pe(e))&&!e.length||fe(e)&&!Object.keys(e).length},E={nullOrUndefined:ce,object:fe,number:function(e){return u(e)===Number&&!Number.isNaN(e)},string:de,boolean:function(e){return u(e)===Boolean},function:function(e){return u(e)===Function},array:he,weakMap:function(e){return c(e,WeakMap)},nodeList:pe,element:function(e){return c(e,Element)},textNode:function(e){return u(e)===Text},event:function(e){return c(e,Event)},cue:function(e){return c(e,window.TextTrackCue)||c(e,window.VTTCue)},track:function(e){return c(e,TextTrack)||!ce(e)&&de(e.kind)},url:function(e){if(c(e,window.URL))return!0;var t=e;e.startsWith("http://")&&e.startsWith("https://")||(t="http://".concat(e));try{return!ge(new URL(t).hostname)}catch(e){return!1}},empty:ge};function ve(e){return JSON.parse(JSON.stringify(e))}function m(e,t){return t.split(".").reduce(function(e,t){return e&&e[t]},e)}var ye=function(e){return E.object(e)?Object.keys(e):[]};function me(t,n){ye(t).forEach(function(e){return n(t[e],e)})}function d(e){e=e||{};for(var t=1,n=arguments.length;t<n;++t){var r=arguments[t];if(r)for(var i in r)r.hasOwnProperty(i)&&("[object Object]"!==Object.prototype.toString.call(r[i])?e[i]=r[i]:e[i]=d(e[i],r[i]))}return e}function be(t){return Object.values&&Object.values(t)||Object.keys(t).map(function(e){return t[e]})}function Ee(e){return(Ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Te(e,t){return!t||"object"!==Ee(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ke(e){return(ke=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function we(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _e(e,t,n){return t&&we(e.prototype,t),n&&we(e,n),e}function Se(e,t){return(Se=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ae=function(e){function n(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(t=Te(this,ke(n).call(this,e))).pluginOptions=t.getPluginOptions(),t.enabled=!0,t.pluginOptions.disabled&&t.disable(),t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Se(e,t)}(n,ue),_e(n,[{key:"defaultOptions",get:function(){return{}}}]),_e(n,[{key:"initialize",value:function(){var e=this;return Promise.resolve().then(function(){return e.setUp()}).then(function(){return e.enabled&&e.bindEvents()})}},{key:"getPluginOptions",value:function(){return d(this.defaultOptions,m(this._options,"pluginsOptions.".concat(this.name))||this.defaultOptions)}},{key:"setUp",value:function(){}},{key:"enable",value:function(){this.enabled||(this.bindEvents(),this.enabled=!0,f.debug(this.name,"enabled"))}},{key:"disable",value:function(){this.enabled&&(this.unbindEvents(),this.enabled=!1,f.debug(this.name,"disabled"))}},{key:"destroy",value:function(){this.disable(),this.player.removePlugin(this.name)}}]),n}(),Pe=a(1),Oe=a.n(Pe);function Ce(e){if(/\s/.test(e))throw new Error("class has illegal whitespace characters")}function Le(e,t){return Ce(t),e.classList?e.classList.contains(t):(n=t,new RegExp("(^|\\s)"+n+"($|\\s)")).test(e.className);var n}function T(e,t){return e.classList?e.classList.add(t):Le(e,t)||(e.className=(e.className+" "+t).trim()),e}function h(e,t){return e.classList?e.classList.remove(t):(Ce(t),e.className=e.className.split(/\s+/).filter(function(e){return e!==t}).join(" ")),e}function p(e,t,n){if(e.classList)return void 0===n?e.classList.toggle(t):e.classList.toggle(t,n);var r=Le(e,t);return"function"==typeof n&&(n=n(e,t)),"boolean"!=typeof n&&(n=!r),n!==r?(n?T(e,t):h(e,t),e):void 0}function De(e,t){return e.className=t,e}function g(e,t){for(var n in t)if(null===t[n]){var r=n.split(/(?=[A-Z])/).map(function(e){return e.toLowerCase()}).join("-");e.style.removeProperty(r)}else e.style[n]=t[n];return e}function xe(e){return E.object(e)&&1===e.nodeType}function Re(e){return E.object(e)&&3===e.nodeType}function Ie(e){for(;e.firstChild;)e.removeChild(e.firstChild);return e}function Me(e){return"function"==typeof e&&(e=e()),(Array.isArray(e)?e:[e]).map(function(e){return"function"==typeof e&&(e=e()),xe(e)||Re(e)?e:"string"==typeof e&&/\S/.test(e)?document.createTextNode(e):void 0}).filter(function(e){return e})}function Fe(t,e){return Me(e).forEach(function(e){return t.appendChild(e)}),t}function Ne(e,t){return Fe(Ie(e),t)}function je(e,t){return void 0===e.textContent?e.innerText=t:e.textContent=t,e}function k(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"div",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3?arguments[3]:void 0,i=document.createElement(e);return Object.getOwnPropertyNames(n).forEach(function(e){var t=n[e];-1!==e.indexOf("aria-")||"role"===e||"type"===e?i.setAttribute(e,t):i[e]=t}),Object.getOwnPropertyNames(t).forEach(function(e){i.setAttribute(e,t[e])}),r&&Fe(i,r),i}function Ue(e){var t=document.createElement("div");return t.innerHTML=e,t.firstChild}function Be(e,t){return e.getAttribute(t)}function He(e,t,n){e.setAttribute(t,n)}function $e(e,t){e.removeAttribute(t)}function Ge(e){var t;if(e.getBoundingClientRect&&e.parentNode&&(t=e.getBoundingClientRect()),!t)return{left:0,top:0};var n=document.documentElement,r=document.body,i=n.clientLeft||r.clientLeft||0,o=window.pageXOffset||r.scrollLeft,a=t.left+o-i,s=n.clientTop||r.clientTop||0,l=window.pageYOffset||r.scrollTop,u=t.top+l-s;return{left:Math.round(a),top:Math.round(u)}}function Ve(e){if(e){var t=e.getBoundingClientRect();return t.height/2<=window.innerHeight-t.top&&t.bottom>=t.height/2}}function Ye(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r={},i=Ge(e),o=n?e.offsetHeight:e.offsetWidth,a=n?e.offsetWidth:e.offsetHeight,s=i.top,l=i.left,u=t.pageY,c=t.pageX;return t.changedTouches&&(c=t.changedTouches[0].pageX,u=t.changedTouches[0].pageY),r.y=Math.max(0,Math.min(1,(s-u+a)/a)),r.x=Math.max(0,Math.min(1,(c-l)/o)),r}function ze(e){return void 0===e.button&&void 0===e.buttons||0===e.button&&void 0===e.buttons||0===e.button&&1===e.buttons}function Ke(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function We(e){return(We="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Xe(e,t){return!t||"object"!==We(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Qe(e){return(Qe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Je(e,t){return(Je=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ze=/^(\S+)\s*(.*)$/,v=function(e){function r(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(n=Xe(this,Qe(r).call(this,e,t))).cid=$("c"),n.buildElement(),n.delegateEvents(),n}var t,n,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Je(e,t)}(r,ue),t=r,i=[{key:"tagName",get:function(){return"div"}},{key:"events",get:function(){return{}}},{key:"attributes",get:function(){return{}}}],(n=[{key:"$",value:function(e){return this.$el.find(e)}},{key:"setElement",value:function(e){return this.$el=Oe.a.zepto.isZ(e)?e:Oe()(e),this.el=this.$el[0],this}},{key:"buildElement",value:function(){if(this.el)this.setElement(this.el,!1);else{var e=d({},this.attributes);this.id&&(e.id=this.id);var t=d({},this.properties),n=k(this.tagName,t,e);this.setElement(n,!1)}}},{key:"delegateEvents",value:function(e){if(!e&&!(e=this.events))return this;for(var t in e){var n=e[t];if(n&&n.constructor!==Function&&(n=this[e[t]]),n){var r=t.match(Ze),i=r[1],o=r[2];i+=".delegateEvents"+this.cid,""===o?this.$el.on(i,n.bind(this)):this.$el.on(i,o,n.bind(this))}}}},{key:"undelegateEvents",value:function(){return this.$el.off(".delegateEvents"+this.cid),this}},{key:"render",value:function(){return this}},{key:"remove",value:function(){return this.$el.remove(),this.unbindEvents(),this.undelegateEvents(),this}},{key:"getAttribute",value:function(e){return Be(this.el,e)}},{key:"setAttribute",value:function(e,t){He(this.el,e,t)}},{key:"removeAttribute",value:function(e){$e(this.el,e)}},{key:"setStyles",value:function(e){g(this.el,e)}},{key:"hasClass",value:function(e){return Le(this.el,e)}},{key:"addClass",value:function(e){T(this.el,e)}},{key:"removeClass",value:function(e){h(this.el,e)}},{key:"toggleClass",value:function(e,t){p(this.el,e,t)}},{key:"show",value:function(){this.removeClass("--z--hide")}},{key:"hide",value:function(){this.addClass("--z--hide")}},{key:"properties",get:function(){return{}}}])&&qe(t.prototype,n),i&&qe(t,i),r}();function et(e){return(et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function tt(e,t){return!t||"object"!==et(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function nt(e){return(nt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function rt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function it(e,t,n){return t&&rt(e.prototype,t),n&&rt(e,n),e}function ot(e,t){return(ot=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var y=function(e){function n(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(t=tt(this,nt(n).call(this,e))).pluginOptions=t.getPluginOptions(),t.enabled=!0,t.pluginOptions.disabled&&t.disable(),t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ot(e,t)}(n,v),it(n,[{key:"defaultOptions",get:function(){return{}}}]),it(n,[{key:"initialize",value:function(){var e=this;return Promise.resolve().then(function(){return e.setUp()}).then(function(){return e.render()}).then(function(){return e.enabled&&e.bindEvents()})}},{key:"getPluginOptions",value:function(){return d(this.defaultOptions,m(this._options,"pluginsOptions.".concat(this.name))||this.defaultOptions)}},{key:"setUp",value:function(){}},{key:"enable",value:function(){this.enabled||(this.bindEvents(),this.show(),this.enabled=!0,f.debug(this.name,"enabled"))}},{key:"disable",value:function(){this.enabled&&(this.unbindEvents(),this.hide(),this.enabled=!1,f.debug(this.name,"disabled"))}},{key:"destroy",value:function(){this.disable(),this.remove(),this.player.removePlugin(this.name)}}]),n}();a(9);function at(e){return(at="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function st(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function lt(e,t){return!t||"object"!==at(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ut(e){return(ut=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ct(e,t){return(ct=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var b=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),lt(this,ut(t).call(this,null,e))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ct(e,t)}(t,v),n=t,(r=[{key:"play",value:function(){throw new Error("this must be implemented")}},{key:"pause",value:function(){throw new Error("this must be implemented")}},{key:"stop",value:function(){}},{key:"seek",value:function(){}},{key:"seekPercentage",value:function(){}},{key:"getDuration",value:function(){return 0}},{key:"isPlaying",value:function(){return!1}},{key:"isReady",value:function(){throw new Error("this must be implemented")}},{key:"getPlaybackType",value:function(){return t.NO_OP}},{key:"isHighDefinitionInUse",value:function(){return!1}},{key:"volume",value:function(){}},{key:"getVolume",value:function(){return 0}},{key:"isHlsPlayback",value:function(){return!1}},{key:"isMp4Playback",value:function(){return!1}},{key:"destroy",value:function(){this.remove()}}])&&st(n.prototype,r),i&&st(n,i),t}();b.canPlay=function(){return!1},b.VOD="vod",b.AOD="aod",b.LIVE="live",b.LIVE_END="live_end",b.NO_OP="no_op",b.type="playback";var ft,dt,ht,pt,w=b,_=window.navigator&&window.navigator.userAgent||"",gt=/AppleWebKit\/([\d.]+)/i.exec(_),vt=gt?parseFloat(gt.pop()):null,yt=/iPad/i.test(_),mt=/iPhone/i.test(_)&&!yt,bt=/iPod/i.test(_),S=mt||yt||bt,Et=(ft=_.match(/OS (\d+)_/i))&&ft[1]?ft[1]:null,Tt=/Android/i.test(_),kt=function(){var e=_.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);if(!e)return null;var t=e[1]&&parseFloat(e[1]),n=e[2]&&parseFloat(e[2]);return t&&n?parseFloat(e[1]+"."+e[2]):t||null}(),wt=Tt&&kt<5&&vt<537,_t=/Firefox/i.test(_),St=/Edge/i.test(_),At=!St&&(/Chrome/i.test(_)||/CriOS/i.test(_)),Pt=(pt=_.match(/(Chrome|CriOS)\/(\d+)/))&&pt[2]?parseFloat(pt[2]):null,Ot=(!(ht=(dt=/MSIE\s(\d+)\.\d/.exec(_))&&parseFloat(dt[1]))&&/Trident\/7.0/i.test(_)&&/rv:11.0/.test(_)&&(ht=11),ht),Ct=/Safari/i.test(_)&&!At&&!Tt&&!St,Lt=(Ct||S)&&!At,A=/Android|webOS|iPhone|iPad|iPod|BlackBerry|Windows Phone|IEMobile|Mobile Safari|Opera Mini/i.test(_);function Dt(){var n={};return n.promise=new Promise(function(e,t){n.resolve=e,n.reject=t}),n}function xt(e){return(xt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Rt(e,t){return!t||"object"!==xt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function It(e,t,n){return(It="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Mt(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function Mt(e){return(Mt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ft(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Nt(e,t,n){return t&&Ft(e.prototype,t),n&&Ft(e,n),e}function jt(e,t){return(jt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ut(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var Bt={wav:["audio/wav"],mp3:["audio/mp3",'audio/mpeg;codecs="mp3"'],aac:['audio/mp4;codecs="mp4a.40.5"'],oga:["audio/ogg"]},Ht=Object.keys(Bt).reduce(function(e,t){return[].concat(Ut(e),Ut(Bt[t]))},[]),$t=function(e){function a(){var e,t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];(t=Rt(this,(e=Mt(a)).call.apply(e,[this].concat(r))))._readyDeferred=Dt(),t._destroyed=!1,t._loadStarted=!1,t._playheadMoving=!1,t._playheadMovingTimer=null,t._stopped=!1,t.isHlsPlayback()||t.setupSource(t.options.src),t.options.playback||(t.options.playback=t.options||{});var o=t.options.playback.preload||(Ct?"auto":t.options.preload);return d(t.el,{muted:t.options.mute,loop:t.options.loop,preload:o,autoPlay:t.options.autoPlay||!1}),t.options.playInline&&(t.setAttribute("webkit-playsinline",""),t.setAttribute("playsinline","")),t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&jt(e,t)}(a,w),Nt(a,[{key:"isAudioOnly",get:function(){var e=this.options.src,t=a._mimeTypesForUrl(e,Bt,this.options.mimeType);return this.options.playback&&this.options.playback.audioOnly||this.options.audioOnly||Ht.indexOf(t[0])>=0}},{key:"events",get:function(){return{canplay:"_onCanPlay",canplaythrough:"_onCanplaythrough",error:"_onError",loadeddata:"_onLoadedData",loadedmetadata:"_onLoadedMetadata",stalled:"_onStalled",timeupdate:"_onTimeUpdate",waiting:"_onWaiting",pause:"_onPause",playing:"_onPlaying",progress:"_onProgress",seeking:"_onSeeking",seeked:"_onSeeked",ended:"_onEnded",webkitbeginfullscreen:"_onBeginFullScreen",webkitendfullscreen:"_onEndFullScreen"}}},{key:"ended",get:function(){return this.el.ended}},{key:"buffering",get:function(){return this._isBuffering}}]),Nt(a,[{key:"setupSource",value:function(e){E.empty(e)||(this._src=e,this.el.src=e)}},{key:"getSource",value:function(){return this._src}},{key:"render",value:function(){return this._readyDeferred.resolve(),this}},{key:"isPlaying",value:function(){return!this.el.paused&&!this.el.ended}},{key:"isReady",value:function(){return this._readyDeferred.promise}},{key:"play",value:function(){return this._stopped=!1,this._handleBufferingEvents(),this.playPromise=this.el.play(),f.debug(this.name,"PLAY_PROMISE",this.playPromise),this.playPromise}},{key:"pause",value:function(){var e=this;this.playPromise?this.playPromise.then(function(){return e.el.pause()}):this.el.pause()}},{key:"stop",value:function(){this.pause(),this._stopped=!0,this._stopPlayheadMovingChecks(),this._handleBufferingEvents(),this.trigger(l.PLAYBACK_STOP)}},{key:"volume",value:function(e){e<0||e>100||(0===e?this.mute():this.unmute(),this.el.volume=e/100,this.trigger(l.PLAYBACK_VOLUMEUPDATE,e))}},{key:"getVolume",value:function(){return this.el.volume}},{key:"mute",value:function(){this.$el.attr({muted:"true"}),this.el.muted=!0}},{key:"unmute",value:function(){this.$el.attr({muted:null}),this.el.muted=!1}},{key:"isMuted",value:function(){return this.el.muted}},{key:"seek",value:function(e){E.number(e)&&(this.el.currentTime=e)}},{key:"seekPercentage",value:function(e){var t=this.el.duration*(e/100);this.seek(t)}},{key:"getCurrentTime",value:function(){this.el.currentTime}},{key:"getDuration",value:function(){return this.el.duration}},{key:"setPlaybackRate",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.el.playbackRate=e}},{key:"setPreload",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"metadata";return this.el.preload=e,this}},{key:"destroy",value:function(){this._destroyed=!0,It(Mt(a.prototype),"destroy",this).call(this),this.el.removeAttribute("src"),this._src=null}},{key:"_now",value:function(){return Date.now()}},{key:"_onCanPlay",value:function(){this._handleBufferingEvents()}},{key:"_onCanplaythrough",value:function(e){this._handleBufferingEvents(),this.trigger(l.PLAYBACK_CANPLAYTHROUGH,{time:this._now(),data:e})}},{key:"_onError",value:function(){var e=this.el.error;if(e){var t={code:e.code,description:e.message,raw:e};this.trigger(l.PLAYBACK_ERROR,t)}else f.warn(this.name,"HTML5 media unknown error")}},{key:"_onWaiting",value:function(e){this._handleBufferingEvents(),this.trigger(l.PLAYBACK_WAITING,{time:this._now(),data:e}),this._loadStarted=!0}},{key:"_onLoadedData",value:function(){this._loadStarted=!0,this._handleBufferingEvents()}},{key:"_onLoadedMetadata",value:function(e){this._handleBufferingEvents(),this.trigger(l.PLAYBACK_LOADEDMETADATA,{duration:e.target.duration,data:e})}},{key:"_onStalled",value:function(){this._handleBufferingEvents()}},{key:"_onTimeUpdate",value:function(){this.trigger(l.PLAYBACK_TIMEUPDATE,{current:this.el.currentTime,total:this.el.duration})}},{key:"_onProgress",value:function(){if(this.el.buffered.length){for(var e=this.el.buffered.length,t=[],n=0,r=0;r<e;r++)t=[].concat(Ut(t),[{start:this.el.buffered.start(r),end:this.el.buffered.end(r)}]),this.el.currentTime>=t[r].start&&this.el.currentTime<=t[r].end&&(n=r);var i={start:t[n].start,current:t[n].end,total:this.el.duration};this.trigger(l.PLAYBACK_PROGRESS,i,t)}}},{key:"_onPause",value:function(){this._stopPlayheadMovingChecks(),this._handleBufferingEvents(),this.trigger(l.PLAYBACK_PAUSE)}},{key:"_onPlaying",value:function(){this._startPlayheadMovingChecks(),this._handleBufferingEvents(),this.trigger(l.PLAYBACK_PLAY)}},{key:"_onSeeking",value:function(e){this._handleBufferingEvents(),this.trigger(l.PLAYBACK_SEEKING,{time:this._now(),data:e})}},{key:"_onSeeked",value:function(){this._handleBufferingEvents(),this.trigger(l.PLAYBACK_SEEKED)}},{key:"_onEnded",value:function(){this._handleBufferingEvents(),this.trigger(l.PLAYBACK_ENDED,this.name)}},{key:"_handleBufferingPercent",value:function(){if("html5_video"===this.name&&(1===this.el.networkState||2===this.el.networkState)){for(var e,t=this.el.buffered.length,n=this.el.currentTime,r=0,i=0;i<t;i++){var o=this.el.buffered.end(i);(o<=n&&o>r||this.el.buffered.start(i)<=n&&o>=n)&&(r=o)}e=100/6*(6-(n+3-r)),this.trigger(l.PLAYBACK_BUFFERING_CHANGE,e)}}},{key:"_handleBufferingEvents",value:function(){this._handleBufferingPercent();var e=!this.el.ended&&!this.el.paused,t=this._loadStarted&&!this.el.ended&&!this._stopped&&(e&&!this._playheadMoving||this.el.readyState<this.el.HAVE_FUTURE_DATA);this._isBuffering!=t&&(this._isBuffering=t,t?this.trigger(l.PLAYBACK_BUFFERING,this.name):this.trigger(l.PLAYBACK_BUFFERFULL,this.name))}},{key:"_startPlayheadMovingChecks",value:function(){null===this._playheadMovingTimer&&(this._playheadMovingTimeOnCheck=null,this._determineIfPlayheadMoving(),this._playheadMovingTimer=setInterval(this._determineIfPlayheadMoving.bind(this),500))}},{key:"_stopPlayheadMovingChecks",value:function(){null!==this._playheadMovingTimer&&(clearInterval(this._playheadMovingTimer),this._playheadMovingTimer=null,this._playheadMoving=!1)}},{key:"_determineIfPlayheadMoving",value:function(){var e=this._playheadMovingTimeOnCheck,t=this.el.currentTime;this._playheadMoving=e!==t,this._playheadMovingTimeOnCheck=t,this._handleBufferingEvents()}},{key:"_onBeginFullScreen",value:function(){this.trigger(l.PLAYBACK_FULLSCREEN_IOS,!0)}},{key:"_onEndFullScreen",value:function(){this.trigger(l.PLAYBACK_FULLSCREEN_IOS,!1)}},{key:"getPlaybackType",value:function(){throw new Error("this must be implemented")}}]),a}();function Gt(e){return(Gt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Vt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Yt(e,t){return!t||"object"!==Gt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function zt(e){return(zt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Kt(e,t){return(Kt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}$t._mimeTypesForUrl=function(e,t,n){var r=(e.split("?")[0].match(/.*\.(.*)$/)||[])[1],i=n||r&&t[r.toLowerCase()]||[];return i.constructor===Array?i:[i]},$t._canPlay=function(e,t,n,r){var i=$t._mimeTypesForUrl(n,t,r),o=document.createElement(e);return!!i.filter(function(e){return!!o.canPlayType(e).replace(/no/,"")})[0]};var Wt=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Yt(this,zt(t).apply(this,arguments))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Kt(e,t)}(t,$t),n=t,(r=[{key:"getPlaybackType",value:function(){var e=w.VOD;return[0,void 0,1/0].indexOf(this.el.duration)>=0?w.LIVE:e}},{key:"isMp4Playback",value:function(){return!0}},{key:"name",get:function(){return"html5_video"}},{key:"tagName",get:function(){return this.isAudioOnly?"audio":"video"}},{key:"attributes",get:function(){return{"data-html5-video":""}}}])&&Vt(n.prototype,r),i&&Vt(n,i),t}();function qt(e,n){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(E.array(e)&&n)return e.sort(function(e,t){return r?e[n]-t[n]:t[n]-e[n]})}function Xt(e,t,n){if(E.array(e))return e.filter(function(e){return e[t]===n}).shift()}function Qt(e){return e.length?e.reduce(function(e,t){return e+t},0)/e.length:0}function Jt(e,t,n){for(var r=e.length,i=0;i<r;i++)if(e[i][t]===n)return i;return-1}Wt.canPlay=function(e,t){var n={mp4:["avc1.42E01E","avc1.58A01E","avc1.4D401E","avc1.64001E","mp4v.20.8","mp4v.20.240","mp4a.40.2"].map(function(e){return'video/mp4; codecs="'+e+', mp4a.40.2"'}),ogg:['video/ogg; codecs="theora, vorbis"','video/ogg; codecs="dirac"','video/ogg; codecs="theora, speex"'],"3gpp":['video/3gpp; codecs="mp4v.20.8, samr"'],webm:['video/webm; codecs="vp8, vorbis"'],mkv:['video/x-matroska; codecs="theora, vorbis"'],m3u8:["application/x-mpegurl"]};return n.ogv=n.ogg,n["3gp"]=n["3gpp"],$t._canPlay("video",n,e,t)};var Zt=a(0),P=a.n(Zt);function en(e){return(en="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function tn(e,t,n){return(tn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=nn(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function nn(e){return(nn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function rn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function on(e,t,n){return t&&rn(e.prototype,t),n&&rn(e,n),e}function an(e,t){return(an=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function sn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var ln={startLevel:-1},un=16,cn=function(e){function s(){var e,t,n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n=this,(t=!(r=(e=nn(s)).call.apply(e,[this].concat(o)))||"object"!==en(r)&&"function"!=typeof r?sn(n):r)._config={hls:m(t.options,"playback.hls")||ln,recoverMaxRetry:m(t.options,"playback.hls.recoverMaxRetry")||un},t._recoverRetry=0,t._recoveredMediaError=!1,t._playbackType=w.VOD,t._onHLSJSError=t._onHLSJSError.bind(sn(sn(t))),t._initHls(),t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&an(e,t)}(s,$t),on(s,[{key:"name",get:function(){return"hls"}},{key:"tagName",get:function(){return this.isAudioOnly?"audio":"video"}},{key:"levels",get:function(){return this._levels||[]}},{key:"currentLevel",get:function(){return null===this._currentLevel||void 0===this._currentLevel?-1:this._currentLevel},set:function(e){var t=this;this.playPromise&&this.playPromise.then(function(){t._currentLevel=e,t._hls&&(t._hls.currentLevel=t._currentLevel)})}},{key:"startLevel",set:function(e){var t=this;this.playPromise&&this.playPromise.then(function(){t._startLevel=e,t._hls&&(t._hls.startLevel=t._startLevel)})},get:function(){return this._startLevel}}],[{key:"canPlay",value:function(e,t){var n=e.split("?")[0].match(/.*\.(.*)$/)||[];return(n.length>1&&"m3u8"===n[1].toLowerCase()||"application/x-mpegURL"===t||"application/vnd.apple.mpegurl"===t)&&P.a.isSupported()}}]),on(s,[{key:"stop",value:function(){tn(nn(s.prototype),"stop",this).call(this),this._hls.destroy(),delete this._hls}},{key:"isHlsPlayback",value:function(){return!0}},{key:"_initHls",value:function(){var e=this,t=new P.a(this._config.hls);t.on(P.a.Events.MEDIA_ATTACHED,function(){return t.loadSource(e.options.src)}),t.on(P.a.Events.ERROR,this._onHLSJSError),t.once(P.a.Events.LEVEL_LOADED,this._updatePlaybackType.bind(this)),t.on(P.a.Events.LEVEL_SWITCH,this._onLevelSwitch.bind(this)),t.on(P.a.Events.LEVEL_SWITCHED,this._onLevelSwitched.bind(this)),t.on(P.a.Events.FRAG_LOAD_PROGRESS,this._onFragLoadingProgress.bind(this)),t.on(P.a.Events.FRAG_LOADED,this._onFragLoadedProgress.bind(this)),t.attachMedia(this.el),this._hls=t}},{key:"_updatePlaybackType",value:function(e,t){f.debug(this.name,"_updatePlaybackType",t),this._playbackType=t.details.live?w.LIVE:t.details.startSN>0?w.LIVE_END:w.VOD,this.trigger(l.PLAYBACK_DVRSTATECHANGED),this._fillLevels(),f.debug(this.name,"LEVELS",this._levels),this.initLevelFromLocalStorage()}},{key:"_onLevelSwitch",value:function(e,t){f.debug(this.name,"_onLevelSwitch",t)}},{key:"_onLevelSwitched",value:function(e,t){f.debug(this.name,"_onLevelSwitched",t);var n=Xt(this.levels,"index",t.level);this.trigger(l.PLAYBACK_LEVEL_SWITCHED,n)}},{key:"_addingSuffixCharacter",value:function(e){var t=e.toString().toLowerCase();return t.indexOf("p")>-1?t:t+"p"}},{key:"_generateLabel",value:function(e){return e.name||Math.ceil(e.bitrate/1e3)}},{key:"_fillLevels",value:function(){var n=this;E.empty(this._levels)&&(this._levels=this._hls.levels.map(function(e,t){return{index:t,level:e,label:n._addingSuffixCharacter(n._generateLabel(e))}}),this._levels.unshift({index:-1,label:"Auto"}),this.trigger(l.PLAYBACK_LEVELS_AVAILABLE,this._levels))}},{key:"initLevelFromLocalStorage",value:function(){if(E.array(this._levels)&&this.options.quality){var e=Xt(this._levels,"label",this.options.quality);E.object(e)&&E.object(e.level)&&(this.currentLevel=e.index,this.startLevel=e.index)}}},{key:"_recoverMediaError",value:function(e){return this._recoverRetry+=1,this._recoverRetry>this._config.recoverMaxRetry?(f.error(this.name,"could not recover from error after maximum number of attempts",e),this.trigger(l.PLAYBACK_ERROR,e),void this.stop()):(f.warn(this.name,"recovering fatal error (".concat(this._recoverRetry,"/").concat(this._config.recoverMaxRetry,"):"),e),this._recoveredMediaError?(this._hls.swapAudioCodec(),void this._hls.recoverMediaError()):(this._recoveredMediaError=!0,void this._hls.recoverMediaError()))}},{key:"_onError",value:function(){var e=this.el.error;if(e){var t=e.code,n={code:t,description:e.message,raw:e};if(t===e.MEDIA_ERR_DECODE)return this._recoverMediaError(n);this.trigger(l.PLAYBACK_ERROR,n)}else f.warn(this.name,"HTML5 video unknown error")}},{key:"_onHLSJSError",value:function(e,t){if(t.fatal){var n={code:"".concat(t.type,"_").concat(t.details),description:t.reason||(t.response?"status: ".concat(t.response.code,", text: ").concat(t.response.text):"unknown"),raw:t};return t.type===P.a.ErrorTypes.NETWORK_ERROR&&t.response.code<400?(f.debug(this.name,"recovering network error, user may be offline:",n),void this._hls.startLoad()):t.type!==P.a.ErrorTypes.MEDIA_ERROR?(f.error(this.name,"unrecoverable fatal error: ".concat(t.type),n),this.trigger(l.PLAYBACK_ERROR,n),void this.stop()):void this._recoverMediaError(n)}}},{key:"_onTimeUpdate",value:function(){this.el.duration&&this.trigger(l.PLAYBACK_TIMEUPDATE,{current:this.el.currentTime,total:this.el.duration})}},{key:"_onFragLoadingProgress",value:function(e,t){var n=100/t.stats.total*t.stats.loaded;this.trigger(l.PLAYBACK_BUFFERING_CHANGE,n)}},{key:"_onFragLoadedProgress",value:function(){this.trigger(l.PLAYBACK_BUFFERFULL,this.name)}},{key:"getPlaybackType",value:function(){return this._playbackType}}]),s}();function fn(e){return(fn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function dn(e,t){return!t||"object"!==fn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function hn(e,t,n){return(hn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=pn(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function pn(e){return(pn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function gn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function vn(e,t,n){return t&&gn(e.prototype,t),n&&gn(e,n),e}function yn(e,t){return(yn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var mn=function(e){function o(){var e,t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=dn(this,(e=pn(o)).call.apply(e,[this].concat(r))))._ready=!1,t._readyDeferred=Dt(),t._isSeeking=!1,t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&yn(e,t)}(o,w),vn(o,[{key:"name",get:function(){return"youtube_playback"}},{key:"attributes",get:function(){return{"data-youtube-playback":"",class:"zplayer-youtube-playback",style:"height:100%",id:this.cid}}},{key:"buffering",get:function(){return!1}}],[{key:"canPlay",value:function(e){return this.isYTVideo(e)}},{key:"isYTVideo",value:function(e){return!!e.match(/^(?:https?:\/\/)?(?:www\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))((\w|-){11})(?:\S+)?$/)&&RegExp.$1}}]),vn(o,[{key:"ready",value:function(){this._ready=!0,this.$el.hide(),this._readyDeferred.resolve()}},{key:"qualityChange",value:function(){this.trigger(l.PLAYBACK_HIGHDEFINITIONUPDATE)}},{key:"stateChange",value:function(e){switch(e.data){case window.YT.PlayerState.PLAYING:this.$el.show(),this.trigger(l.PLAYBACK_PLAY),this._isSeeking&&(this._isSeeking=!1,this.trigger(l.PLAYBACK_SEEKED));break;case window.YT.PlayerState.PAUSE:this.$el.hide(),this.trigger(l.PLAYBACK_PAUSE);break;case window.YT.PlayerState.ENDED:this.ended(),this.seek(0),this.stop();break;default:this.$el.show()}}},{key:"play",value:function(){var e=this;this._progressTimer=this._progressTimer||setInterval(function(){return e.progress()},100),this._timeupdateTimer=setInterval(function(){return e.timeupdate()},100),this.player.playVideo(),this.trigger(l.PLAYBACK_PLAY),this.trigger(l.PLAYBACK_BUFFERFULL)}},{key:"pause",value:function(){this.clearTimer(),this.player&&this.player.pauseVideo(),this.trigger(l.PLAYBACK_PAUSE)}},{key:"seek",value:function(e){this.player&&(this.player.seekTo(e),this._isSeeking=!0,setTimeout(function(){},100))}},{key:"ended",value:function(){this.trigger(l.PLAYBACK_ENDED)}},{key:"stop",value:function(){this.player.stopVideo(),this.clearTimer()}},{key:"volume",value:function(e){this.player&&(this.player.setVolume(e),e<=0?this.player.mute():this.player.unMute(),this.trigger(l.PLAYBACK_VOLUMEUPDATE,e))}},{key:"isMuted",value:function(){return this.player&&this.player.isMuted()}},{key:"getVolume",value:function(){return this.player&&this.player.getVolume()}},{key:"progress",value:function(){var e=this.player.getDuration()*this.player.getVideoLoadedFraction();this.trigger(l.PLAYBACK_PROGRESS,0,e,this.player.getDuration())}},{key:"timeupdate",value:function(){this.trigger(l.PLAYBACK_TIMEUPDATE,{current:this.player.getCurrentTime(),total:this.player.getDuration()})}},{key:"isPlaying",value:function(){return this.player&&this._timeupdateTimer&&this.player.getPlayerState()==window.YT.PlayerState.PLAYING}},{key:"isReady",value:function(){return this._readyDeferred.promise}},{key:"getDuration",value:function(){var e=0;return this.player&&(e=this.player.getDuration()),parseFloat(e)}},{key:"render",value:function(){var e=this;return this.el.append(k("div",{},{id:"yt".concat(this.cid)})),setTimeout(function(){e._setupYoutubePlayer()},1),this}},{key:"setPlaybackRate",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.player.setPlaybackRate(e)}},{key:"_setupYoutubePlayer",value:function(){window.YT&&window.YT.Player?this._embedYoutubePlayer():this._embedYoutubeApiScript()}},{key:"_getVideoId",value:function(e){return void 0!==(e=e.split(/(vi\/|v=|\/v\/|youtu\.be\/|\/embed\/)/))[2]?e[2].split(/[^0-9a-z_\-]/i)[0]:e[0]}},{key:"_embedYoutubeApiScript",value:function(){var e=this,t=document.createElement("script");t.setAttribute("type","text/javascript"),t.setAttribute("async","async"),t.setAttribute("src","https://www.youtube.com/iframe_api"),document.body.appendChild(t),window.onYouTubeIframeAPIReady=function(){return e._embedYoutubePlayer()}}},{key:"_embedYoutubePlayer",value:function(){var t=this,e={controls:0,autoplay:this.options.autoPlay?1:0,disablekb:1,rel:0,enablejsapi:1,iv_load_policy:3,modestbranding:1,showinfo:0,html5:1,playsinline:this.options.playInline?1:0};this.player=new window.YT.Player("yt".concat(this.cid),{videoId:this._getVideoId(this.options.source),playerVars:e,width:"100%",height:"100%",events:{onReady:function(){return t.ready()},onStateChange:function(e){return t.stateChange(e)},onPlaybackQualityChange:function(e){return t.qualityChange(e)}}})}},{key:"getPlaybackType",value:function(){return w.VOD}},{key:"clearTimer",value:function(){clearInterval(this._timeupdateTimer),clearInterval(this._progressTimer),this._timeupdateTimer=null,this._progressTimer=null}},{key:"destroy",value:function(){this.clearTimer(),hn(pn(o.prototype),"destroy",this).call(this),this.stop(),this.player.destroy(),this.player=null}}]),o}();a(10);function bn(e){return(bn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function En(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Tn(e,t){return!t||"object"!==bn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function kn(e){return(kn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function wn(e,t){return(wn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var _n=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Tn(this,kn(t).apply(this,arguments))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wn(e,t)}(t,w),n=t,i=[{key:"canPlay",value:function(){return!0}}],(r=[{key:"render",value:function(){var e=k("p",{innerHTML:"Your browser does not support the playback of this video. Please try using a different browser."},{"data-no-op-msg":""});return this.el.append(e),this}},{key:"isReady",value:function(){return Promise.resolve()}},{key:"name",get:function(){return"no_op"}},{key:"attributes",get:function(){return{"data-no-op":""}}}])&&En(n.prototype,r),i&&En(n,i),t}(),Sn=(a(11),"--z--hide"),An="--z--full-width",Pn="--z--bg-transparent",On="--z--fadeout",Cn={layout:{left:["playpause","volume","time"],right:["settings","fullscreen"],default:["seekbar"]},type:{fullWidth:!1},alwaysShowControl:!1,showOnPauseMobile:!1,disabledAutoHide:!1,hideAnimation:!1,theme:"",disabled:!1},Ln={BG_TYPE_TRANSPARENT:"transparent",BG_TYPE_GRADIENT:"gradient",THEME:{RED:"red",BLUE:"blue",PURPLE:"purple",GREEN:"green",LIGHT_BLUE:"light_blue"},MAP_THEME_COLOR:{RED:"#f00",BLUE:"#2FA1B3",PURPLE:"#721799",GREEN:"#6cd936",LIGHT_BLUE:"#2196F3"}};a(12);function Dn(e){return(Dn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Rn(e,t){return!t||"object"!==Dn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function In(e){return(In=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Mn(e,t){return(Mn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var O=function(e){function r(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(n=Rn(this,In(r).call(this,e))).plugin=t,n.bindEvents(),n}var t,n,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Mn(e,t)}(r,v),t=r,(n=[{key:"destroy",value:function(){this.remove()}},{key:"handleClick",value:function(){}},{key:"className",get:function(){return["",this.name].join(" ")}},{key:"attributes",get:function(){return{class:this.className}}},{key:"events",get:function(){return{click:"handleClick"}}}])&&xn(t.prototype,n),i&&xn(t,i),r}();function Fn(e){return(Fn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Nn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function jn(e,t){return!t||"object"!==Fn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Un(e){return(Un=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Bn(e,t){return(Bn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Hn=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),jn(this,Un(t).apply(this,arguments))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Bn(e,t)}(t,O),n=t,(r=[{key:"name",get:function(){return"ButtonControl"}},{key:"tagName",get:function(){return"button"}},{key:"className",get:function(){return["--z--control --z--btn",this.name].join(" ")}}])&&Nn(n.prototype,r),i&&Nn(n,i),t}();function $n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var C=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"initializer",value:function(e,t){this.controls=t}},{key:"onMouseOver",value:function(){A||this.controls.disableAutoHide()}},{key:"onMouseOut",value:function(){this.controls.enableAutoHide()}},{key:"handleClick",value:function(){}},{key:"events",get:function(){return{click:"handleClick",mouseover:"onMouseOver",mouseout:"onMouseOut"}}}])&&$n(t.prototype,n),r&&$n(t,r),e}();function Gn(e){return(Gn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Vn(e){return(Vn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Yn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zn(e,t){return(zn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function L(t){for(var e=arguments.length,s=new Array(e>1?e-1:0),n=1;n<e;n++)s[n-1]=arguments[n];var r=function(e){function a(){for(var e,n,t,r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return function(e,t){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}(this),this,t=(e=Vn(a)).call.apply(e,[this].concat(i)),n=!t||"object"!==Gn(t)&&"function"!=typeof t?Yn(this):t,s.forEach(function(e){var t;(t=e.prototype.initializer).call.apply(t,[Yn(n)].concat(i))}),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zn(e,t)}(a,t),a}(),i=function(t,n){Object.getOwnPropertyNames(n).concat(Object.getOwnPropertySymbols(n)).forEach(function(e){e.match(/^(?:constructor|prototype|arguments|caller|name|bind|call|apply|toString|length)$/)||Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})};return s.forEach(function(e){i(r.prototype,e.prototype),i(r,e)}),r}function Kn(e){return(Kn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Wn(e,t){return!t||"object"!==Kn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function qn(e){return(qn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Xn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Qn(e,t,n){return t&&Xn(e.prototype,t),n&&Xn(e,n),e}function Jn(e,t){return(Jn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Zn=function(e){function a(){var e,t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];t=Wn(this,(e=qn(a)).call.apply(e,[this].concat(r)));var o=r[0];return t.config=d({},Cn,m(o.options,"controls.playPause")||{}),t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Jn(e,t)}(a,L(Hn,C)),Qn(a,[{key:"name",get:function(){return"PlayPauseControl"}},{key:"className",get:function(){return"--z--control --z--btn --z--control-play"}},{key:"listenEvents",get:function(){return[{name:l.PLAYER_ENDED,handler:this.onEnded},{name:l.PLAYER_CLICK,handler:this.toogleIcon},{name:l.PLAYER_PLAY,handler:this.toogleIcon},{name:l.PLAYER_PAUSE,handler:this.toogleIcon}]}}]),Qn(a,[{key:"toogleIcon",value:function(){h(this.iconEl,"pl-ic-refresh");var e=this.player.isPlaying();p(this.iconEl,"pl-ic-play_arrow",!e),p(this.iconEl,"pl-ic-pause",e),this.setAttribute("title",e?"Dá»«ng":"PhÃ¡t")}},{key:"onEnded",value:function(){h(this.iconEl,"pl-ic-play_arrow"),h(this.iconEl,"pl-ic-pause"),T(this.iconEl,"pl-ic-refresh"),this.setAttribute("title","PhÃ¡t láº¡i")}},{key:"handleClick",value:function(){this.player.togglePlay(),this.toogleIcon()}},{key:"render",value:function(){return this.iconEl=k("span",{},{class:"--z--icon pl-ic-play_arrow"}),this.config.color&&g(this.iconEl,{color:this.config.color}),this.el.append(this.iconEl),this}}]),a}();a(13);function er(e){return(er="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function tr(e,t){return!t||"object"!==er(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function nr(e){return(nr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function rr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ir(e,t,n){return t&&rr(e.prototype,t),n&&rr(e,n),e}function or(e,t){return(or=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ar=function(e){function r(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(n=tr(this,nr(r).call(this,e,t))).isDragging=!1,n.distance=0,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&or(e,t)}(r,O),ir(r,[{key:"name",get:function(){return"SliderControl"}}]),ir(r,[{key:"onMouseDown",value:function(e){(A||ze(e))&&(this.isDragging=!0,e&&e.preventDefault(),this.plugin.disableAutoHide(),window.on("mousemove",this.onMouseMove.bind(this)),window.on("mouseup",this.onBodyUnbindMouseMove.bind(this)))}},{key:"onMouseUp",value:function(e){this.isDragging=!1,this.distance=this.calculateDistance(e),this.handleMouseUp(),this.plugin.enableAutoHide()}},{key:"onMouseMove",value:function(e){A&&!this.isDragging||(this.distance=this.calculateDistance(e),(A||ze(e))&&(this.isDragging&&this.handleMouseMove(),this.plugin.disableAutoHide()))}},{key:"onBodyUnbindMouseMove",value:function(e){A&&!this.isDragging||(window.off("mousemove",this.onMouseMove.bind(this)),window.off("mouseup",this.onBodyUnbindMouseMove.bind(this)),this.onMouseUp(e))}},{key:"calculateDistance",value:function(e){var t=this.player.options,n=t.lockRotateFullscreen,r=t.customIosFullscreen,i=!this.player.isLandscapeScreen(),o=this.player.isFullscreen(),a=r&&n&&i&&o,s=Ye(this.el,e,a);return a?1-s.y:s.x}},{key:"handleClick",value:function(e){e.stopPropagation(),e.preventDefault()}},{key:"handleMouseMove",value:function(){throw new Error("this must be overridden")}},{key:"handleMouseUp",value:function(){throw new Error("this must be overridden")}},{key:"events",get:function(){return{click:"handleClick",touchmove:"onMouseMove",touchstart:"onMouseDown",mousedown:"onMouseDown",touchend:"onMouseUp"}}}]),r}();a(14);function sr(e){return(sr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function lr(e,t){return!t||"object"!==sr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ur(e){return(ur=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function cr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function fr(e,t,n){return t&&cr(e.prototype,t),n&&cr(e,n),e}function dr(e,t){return(dr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var hr={color:"",bulletColor:""},pr=function(e){function r(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(t=lr(this,ur(r).call(this,e))).config=d({},hr,n),t.render(),t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&dr(e,t)}(r,O),fr(r,[{key:"name",get:function(){return"SliderFillRecentBar"}},{key:"className",get:function(){return"--z--bar --z--bar-fill-recent"}},{key:"tagName",get:function(){return"span"}}]),fr(r,[{key:"update",value:function(e){if(E.number(e)){var t={width:"".concat(e,"%")};g(this.el,t)}}},{key:"render",value:function(){return this.config.color&&g(this.el,{backgroundColor:this.config.color}),this.bulletEl=k("span",{},{class:"--z--bullet"}),this.config.bulletColor&&g(this.bulletEl,{backgroundColor:this.config.bulletColor}),this.el.append(this.bulletEl),this}}]),r}();function gr(e){return(gr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vr(e,t){return!t||"object"!==gr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function yr(e){return(yr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function mr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function br(e,t,n){return t&&mr(e.prototype,t),n&&mr(e,n),e}function Er(e,t){return(Er=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Tr=function(e){function r(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r);var t=m(e.options,"controls.seekBar.foregroundColor")||"",n=m(e.options,"controls.seekBar.playHeadColor")||"";return vr(this,yr(r).call(this,e,{color:t,bulletColor:n}))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Er(e,t)}(r,pr),br(r,[{key:"name",get:function(){return"ProgressControl"}},{key:"listenEvents",get:function(){return[{name:l.PLAYER_TIMEUPDATE,handler:this.onTimeUpdate}]}}]),br(r,[{key:"onTimeUpdate",value:function(e){var t=e.current<0?e.total:e.current;this.currentPositionValue=t,this.currentDurationValue=e.total,this.currentSeekBarPercentage=this.currentPositionValue/this.currentDurationValue*100,this.update(this.currentSeekBarPercentage)}}]),r}();a(15);function kr(e){return(kr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wr(e,t){return!t||"object"!==kr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _r(e){return(_r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Sr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ar(e,t,n){return t&&Sr(e.prototype,t),n&&Sr(e,n),e}function Pr(e,t){return(Pr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Or={color:""},Cr=function(e){function r(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(t=wr(this,_r(r).call(this,e))).config=d({},Or,n),t.render(),t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Pr(e,t)}(r,O),Ar(r,[{key:"name",get:function(){return"SliderLoadedBar"}},{key:"className",get:function(){return"--z--bar --z--bar-fill-load"}},{key:"tagName",get:function(){return"span"}}]),Ar(r,[{key:"update",value:function(e){if(E.number(e)){var t={width:"".concat(e,"%")};g(this.el,t)}}},{key:"render",value:function(){return this.config.color&&g(this.el,{backgroundColor:this.config.color}),this}}]),r}();function Lr(e){return(Lr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Dr(e,t){return!t||"object"!==Lr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function xr(e){return(xr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Rr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ir(e,t,n){return t&&Rr(e.prototype,t),n&&Rr(e,n),e}function Mr(e,t){return(Mr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Fr=function(e){function n(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);var t=m(e.options,"controls.seekBar.bufferedColor")||"";return Dr(this,xr(n).call(this,e,{color:t}))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Mr(e,t)}(n,Cr),Ir(n,[{key:"name",get:function(){return"LoadProgressBar"}},{key:"listenEvents",get:function(){return[{name:l.PLAYER_PROGRESS,handler:this.onProgressUpdate}]}}]),Ir(n,[{key:"onProgressUpdate",value:function(e){var t=e.start/e.total*100,n=e.current/e.total*100;this.processLoaded=n-t,this.update(this.processLoaded)}}]),n}();a(16);function Nr(e){return(Nr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function jr(e,t){return!t||"object"!==Nr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ur(e){return(Ur=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Br(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Hr(e,t,n){return t&&Br(e.prototype,t),n&&Br(e,n),e}function $r(e,t){return($r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Gr={color:""},Vr=function(e){function r(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(t=jr(this,Ur(r).call(this,e))).config=d({},Gr,n),t.render(),t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$r(e,t)}(r,O),Hr(r,[{key:"name",get:function(){return"SliderBackgroundBar"}},{key:"className",get:function(){return"--z--bar --z--bar-bg"}},{key:"tagName",get:function(){return"span"}}]),Hr(r,[{key:"render",value:function(){return this.config.color&&g(this.el,{backgroundColor:this.config.color}),this}}]),r}(),Yr=function(e){return parseInt(e/60/60%60,10)},zr=function(e){return parseInt(e/60%60,10)},Kr=function(e){return parseInt(e%60,10)};function Wr(){return(new Date).getTime()/1e3}function qr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!E.number(e))return"";var r=function(e){return"0".concat(e).slice(-2)},i=Yr(e),o=zr(e),a=Kr(e);return i=t||i>0?"".concat(i,":"):"","".concat(n&&e>0?"-":"").concat(i).concat(r(o),":").concat(r(a))}function Xr(e){return(Xr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Qr(e,t){return!t||"object"!==Xr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Jr(e){return(Jr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Zr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ei(e,t,n){return t&&Zr(e.prototype,t),n&&Zr(e,n),e}function ti(e,t){return(ti=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ni=function(e){function n(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(t=Qr(this,Jr(n).call(this,e))).enabled=!0,t.render(),t.hide(),t.bindEvents(),t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ti(e,t)}(n,v),ei(n,[{key:"name",get:function(){return"SeekTime"}},{key:"tagName",get:function(){return"span"}},{key:"attributes",get:function(){return{class:"--z--seek-time"}}},{key:"listenEvents",get:function(){return[{name:l.MEDIACONTROL_MOUSEMOVE_SEEKBAR,handler:this.onMouseMoveSeekbar},{name:l.MEDIACONTROL_MOUSELEAVE_SEEKBAR,handler:this.onMouseLeaveSeekbar}]}}]),ei(n,[{key:"onMouseMoveSeekbar",value:function(e,t){var n=t*this.player.getDuration();g(this.el,{left:100*t+"%",marginLeft:-this.el.offsetWidth/2+"px"}),this.el.textContent=qr(n),this.show()}},{key:"onMouseLeaveSeekbar",value:function(){this.hide()}},{key:"enable",value:function(){this.enabled||(this.bindEvents(),this.show(),this.enabled=!0)}},{key:"disable",value:function(){this.unbindEvents(),this.hide(),this.enabled=!1}},{key:"render",value:function(){return this.el.innerHTML="00:00",this}}]),n}();function ri(e){return(ri="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ii(e,t){return!t||"object"!==ri(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function oi(e,t,n){return(oi="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ai(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function ai(e){return(ai=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function si(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function li(e,t,n){return t&&si(e.prototype,t),n&&si(e,n),e}function ui(e,t){return(ui=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ci=function(e){function s(){var e,t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];t=ii(this,(e=ai(s)).call.apply(e,[this].concat(r)));var o=r[0],a=m(o.options,"controls.seekBar.backgroundColor")||"";return t.loadProgressBar=new Fr(o),t.progressControl=new Tr(o),t.barBackground=new Vr(o,{color:a}),t.seekTime=new ni(o),t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ui(e,t)}(s,L(ar,C)),li(s,[{key:"name",get:function(){return"SeekBarControl"}},{key:"className",get:function(){return"--z--progress-bar"}},{key:"events",get:function(){return{touchmove:"onMouseMove",mousedown:"onMouseDown",touchstart:"onMouseDown",touchend:"onMouseUp",mouseleave:"onMouseLeave",mouseover:"onMouseOver",mouseout:"onMouseOut",mousemove:"onMouseMove"}}},{key:"listenEvents",get:function(){return[{once:!0,name:l.PLAYER_DVRSTATECHANGED,handler:this.dvrChanged}]}}]),li(s,[{key:"onMouseLeave",value:function(e){this.player.trigger(l.MEDIACONTROL_MOUSELEAVE_SEEKBAR,e)}},{key:"onMouseMove",value:function(e){f.debug(this.name,"onMouseMove"),oi(ai(s.prototype),"onMouseMove",this).call(this,e),this.player.trigger(l.MEDIACONTROL_MOUSEMOVE_SEEKBAR,e,this.distance)}},{key:"onMouseDown",value:function(e){f.debug(this.name,"onMouseDown"),oi(ai(s.prototype),"onMouseDown",this).call(this,e),this.addClass("active"),this.isPlayingBeforeSeek=this.player.isPlaying(),this.isPlayingBeforeSeek&&this.player.pause()}},{key:"update",value:function(){var e=100*this.distance;this.player.seekPercentage(e),this.currentSeekBarPercentage=e,this.progressControl.update(this.currentSeekBarPercentage)}},{key:"handleMouseMove",value:function(){this.player.mediaControl.draggingSeekBar=!0,this.update()}},{key:"handleMouseUp",value:function(){this.plugin.draggingSeekBar=!1,this.update(),this.removeClass("active"),this.seekTime.hide(),this.isPlayingBeforeSeek&&this.player.play()}},{key:"dvrChanged",value:function(){this.player.isLive()&&this.hide()}},{key:"render",value:function(){return this.el.append(this.barBackground.el),this.el.append(this.loadProgressBar.el),this.el.append(this.progressControl.el),this.el.append(this.seekTime.el),this}},{key:"remove",value:function(){[this.loadProgressBar,this.progressControl,this.barBackground,this.seekTime].forEach(function(e){e.remove()}),oi(ai(s.prototype),"remove",this).call(this)}}]),s}();a(17);function fi(e){return(fi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function di(e,t){return!t||"object"!==fi(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function hi(e){return(hi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function pi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function gi(e,t,n){return t&&pi(e.prototype,t),n&&pi(e,n),e}function vi(e,t){return(vi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var yi={currentTimeColor:"",totalTimeColor:"",delimiterColor:"",delimiter:"/"},mi=function(e){function n(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(t=di(this,hi(n).call(this,e))).config=d({},yi,m(e.options,"controls.time")||{}),t.currentTime=0,t.duration=t.player.getDuration(),t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&vi(e,t)}(n,O),gi(n,[{key:"name",get:function(){return"TimeControl"}},{key:"className",get:function(){return"--z--control --z--control-time"}},{key:"listenEvents",get:function(){return[{name:l.PLAYER_TIMEUPDATE,handler:this.onTimeUpdate},{name:l.PLAYER_LOADEDMETADATA,handler:this.onLoadedMetaData},{once:!0,name:l.PLAYER_DVRSTATECHANGED,handler:this.dvrChanged}]}}]),gi(n,[{key:"onLoadedMetaData",value:function(){this.duration=this.player.getDuration(),this.update()}},{key:"update",value:function(){this.currentTimeEl&&(this.currentTimeEl.textContent=qr(this.currentTime)),this.durationEl&&(this.durationEl.textContent=qr(this.duration))}},{key:"onTimeUpdate",value:function(e){this.el&&(this.currentTime=e.current<0?e.total:e.current,this.duration||(this.duration=this.player.getDuration()),this.update())}},{key:"dvrChanged",value:function(){this.player.isLive()&&this.hide()}},{key:"render",value:function(){return this.currentTimeEl=k("span"),this.spaceEl=k("span",{innerHTML:this.config.delimiter}),this.durationEl=k("span",{innerHTML:qr(this.duration)}),g(this.currentTimeEl,{color:this.config.currentTimeColor}),g(this.spaceEl,{color:this.config.delimiterColor}),g(this.durationEl,{color:this.config.totalTimeColor}),this.el.append(this.currentTimeEl),this.el.append(this.spaceEl),this.el.append(this.durationEl),this}}]),n}();a(18),a(19);function bi(e){return(bi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ei(e,t){return!t||"object"!==bi(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ti(e){return(Ti=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ki(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function wi(e,t,n){return t&&ki(e.prototype,t),n&&ki(e,n),e}function _i(e,t){return(_i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Si={color:""},Ai=function(e){function n(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(t=Ei(this,Ti(n).call(this,e))).config=d({},Si,m(e.options,"controls.volumeButton")||{}),t.volume=e.options.mute?0:e.options.volume,t.cachedVolume=e.options.volume||100,t.volumeIconClass="",t._chooseVolumeIconInit(),t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_i(e,t)}(n,Hn),wi(n,[{key:"name",get:function(){return"VolumeButton"}},{key:"className",get:function(){return"--z--control --z--btn --z--volume-icon"}},{key:"listenEvents",get:function(){return[{name:l.PLAYER_VOLUMEUPDATE,handler:this.onVolumeUpdated}]}}]),wi(n,[{key:"_chooseVolumeIconInit",value:function(){0===this.volume?this.volumeIconClass="pl-ic-volume_off":this.volume>=50?this.volumeIconClass="pl-ic-volume_up":this.volume<50&&(this.volumeIconClass="pl-ic-volume_down")}},{key:"handleClick",value:function(){this.player.isMuted()?this.player.setVolume(this.cachedVolume,!0):this.player.setVolume(0,!0)}},{key:"onVolumeUpdated",value:function(e){this.volume=e,e>0&&(this.cachedVolume=e),this.updateIcon(e),this.setAttribute("title",0===e?"Báº­t Ã¢m thanh":"Táº¯t tiáº¿ng")}},{key:"updateIcon",value:function(e){p(this.iconEl,"pl-ic-volume_down",e<50),p(this.iconEl,"pl-ic-volume_up",e>=50),p(this.iconEl,"pl-ic-volume_off",0===e)}},{key:"render",value:function(){return this.iconEl=k("span",{},{class:"--z--icon ".concat(this.volumeIconClass)}),this.config.color&&g(this.iconEl,{color:this.config.color}),this.el.append(this.iconEl),this}}]),n}();a(20);function Pi(e){return(Pi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Oi(e,t){return!t||"object"!==Pi(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ci(e,t,n){return(Ci="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Li(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function Li(e){return(Li=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Di(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function xi(e,t,n){return t&&Di(e.prototype,t),n&&Di(e,n),e}function Ri(e,t){return(Ri=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ii=function(e){function s(e,t,n){var r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(r=Oi(this,Li(s).call(this,e,n))).volume=e.options.mute?0:e.options.volume,r.parent=t;var i=m(e.options,"controls.volumeBar.foregroundColor")||"",o=m(e.options,"controls.volumeBar.backgroundColor")||"",a=m(e.options,"controls.volumeBar.volumeHeadColor")||"";return r.barFill=new pr(e,{color:i,bulletColor:a}),r.barBackground=new Vr(e,{color:o}),r.update(),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ri(e,t)}(s,ar),xi(s,[{key:"name",get:function(){return"VolumeBar"}},{key:"className",get:function(){return"--z--volume-bar"}},{key:"tagName",get:function(){return"span"}},{key:"listenEvents",get:function(){return[{name:l.PLAYER_VOLUMEUPDATE,handler:this.onVolumeUpdated},{name:l.PLAYER_READY,handler:this.onPlayerReady},{name:l.PLAYER_FULLSCREEN,handler:this.onPlayerReady}]}}]),xi(s,[{key:"onPlayerReady",value:function(){this.player.getPlayerSize().width<=400?this.hide():this.show()}},{key:"onVolumeUpdated",value:function(e){this.volume=e,this.update()}},{key:"setVolume",value:function(e){e=Math.min(100,Math.max(e,0)),this.volume=e,this.player.setVolume(e,!0),this.update()}},{key:"update",value:function(){this.barFill&&this.barFill.update(this.volume)}},{key:"onMouseDown",value:function(e){Ci(Li(s.prototype),"onMouseDown",this).call(this,e),this.parent.toggleHideAnimation(!1)}},{key:"handleMouseMove",value:function(){this.handleMouse()}},{key:"handleMouseUp",value:function(){this.handleMouse(),this.parent.toggleHideAnimation(!0)}},{key:"handleMouse",value:function(){this.player.mediaControl.draggingVolumeBar=!0,this.setVolume(100*this.distance)}},{key:"render",value:function(){return this.el.append(this.barBackground.el),this.el.append(this.barFill.el),this}}]),s}();function Mi(e){return(Mi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Fi(e,t,n){return(Fi="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Ni(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function Ni(e){return(Ni=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ji(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ui(e,t,n){return t&&ji(e.prototype,t),n&&ji(e,n),e}function Bi(e,t){return(Bi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Hi(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var $i=!0,Gi=function(e){function c(){var e,t,n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];n=this,t=!(r=(e=Ni(c)).call.apply(e,[this].concat(o)))||"object"!==Mi(r)&&"function"!=typeof r?Hi(n):r;var s=o[0],l=o[1];t.volumeButton=new Ai(s),t.volumeBar=new Ii(s,Hi(Hi(t)),l);var u=m(s.options,"controls.volumeBarShowOnHover");return E.nullOrUndefined(u)&&(u=$i),t.toggleHideAnimation(u),t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Bi(e,t)}(c,L(O,C)),Ui(c,[{key:"name",get:function(){return"VolumeControl"}},{key:"className",get:function(){return"--z--control --z--control-volume"}}]),Ui(c,[{key:"toggleHideAnimation",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.toggleClass("--z--hide-animation",e)}},{key:"render",value:function(){return this.el.append(this.volumeButton.render().el),this.el.append(this.volumeBar.render().el),this}},{key:"remove",value:function(){[this.volumeButton,this.volumeBar].forEach(function(e){e.remove()}),Fi(Ni(c.prototype),"remove",this).call(this)}}]),c}(),D=(a(21),{isFullscreenIos:!1,isFullscreen:function(){return!!(document.fullscreenElement||document.webkitFullscreenElement||document.webkitIsFullScreen||document.mozFullScreen||document.msFullscreenElement||this.isFullscreenIos)},requestFullscreen:function(e){e.requestFullscreen?e.requestFullscreen().catch(function(e){f.error("requestFullscreen | ",e)}):e.webkitRequestFullscreen?e.webkitRequestFullscreen().catch(function(e){f.error("webkitRequestFullscreen | ",e)}):e.mozRequestFullScreen?e.mozRequestFullScreen().catch(function(e){f.error("mozRequestFullScreen | ",e)}):e.msRequestFullscreen?e.msRequestFullscreen().catch(function(e){f.error("msRequestFullscreen | ",e)}):e.querySelector&&e.querySelector("video")&&e.querySelector("video").webkitEnterFullScreen?e.querySelector("video").webkitEnterFullScreen().catch(function(e){f.error("webkitEnterFullScreen | ",e)}):e.webkitEnterFullScreen&&e.webkitEnterFullScreen().catch(function(e){f.error("webkitEnterFullScreen | ",e)})},cancelFullscreen:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;return e.exitFullscreen?e.exitFullscreen().catch(function(e){f.error("exitFullscreen | ",e)}):e.webkitCancelFullScreen?e.webkitCancelFullScreen().catch(function(e){f.error("webkitCancelFullScreen | ",e)}):e.webkitExitFullscreen?e.webkitExitFullscreen().catch(function(e){f.error("webkitExitFullscreen | ",e)}):e.mozCancelFullScreen?e.mozCancelFullScreen().catch(function(e){f.error("mozCancelFullScreen | ",e)}):e.msExitFullscreen?e.msExitFullscreen().catch(function(e){f.error("msExitFullscreen | ",e)}):void 0},fullscreenEnabled:function(){return!!(document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled)}});function Vi(e){return(Vi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Yi(e,t){return!t||"object"!==Vi(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function zi(e){return(zi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ki(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Wi(e,t,n){return t&&Ki(e.prototype,t),n&&Ki(e,n),e}function qi(e,t){return(qi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Xi={color:""},Qi=function(e){function a(){var e,t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];t=Yi(this,(e=zi(a)).call.apply(e,[this].concat(r)));var o=r[0];return t.config=d({},Xi,m(o.options,"controls.fullscreen")||{}),t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qi(e,t)}(a,L(Hn,C)),Wi(a,[{key:"name",get:function(){return"FullScreenControl"}},{key:"className",get:function(){return"--z--control --z--btn --z--control-full-screen"}},{key:"listenEvents",get:function(){return[{name:l.PLAYER_FULLSCREEN,handler:this._onFullScreenChange},{name:l.PLAYER_DBLCLICK,handler:this._onDblClicked}]}}]),Wi(a,[{key:"handleClick",value:function(){this.config.functionFullscreen?this.config.functionFullscreen():this.player.toggleFullscreen()}},{key:"_onDblClicked",value:function(){this.config.dblClickToFullScreen&&this.handleClick()}},{key:"toogleIconFullScreen",value:function(e){p(this.iconEl,"pl-ic-fullscreen_exit",e),p(this.iconEl,"pl-ic-fullscreen",!e),this.setButtonTooltip(e)}},{key:"setButtonTooltip",value:function(e){var t=this.config.buttonTooltip,n=t?t.on:"ToÃ n mÃ n hÃ¬nh",r=t?t.off:"ThoÃ¡t cháº¿ Äá» toÃ n mÃ n hÃ¬nh";this.setAttribute("title",e?r:n)}},{key:"render",value:function(){return this.iconEl=k("span",{},{class:"--z--icon pl-ic-fullscreen"}),this.setButtonTooltip(this.player.isFullscreen()),this.config.color&&g(this.iconEl,{color:this.config.color}),this.el.append(this.iconEl),this}},{key:"_onFullScreenChange",value:function(e){this.toogleIconFullScreen(e)}}]),a}();a(22);function Ji(e){return(Ji="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Zi(e,t,n){return(Zi="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=eo(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function eo(e){return(eo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function to(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function no(e,t,n){return t&&to(e.prototype,t),n&&to(e,n),e}function ro(e,t){return(ro=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function io(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var oo={color:"",labelBgColor:"",labelTextColor:""},ao=function(e){function o(e,t){var n,r,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r=this,(n=!(i=eo(o).call(this,e))||"object"!==Ji(i)&&"function"!=typeof i?io(r):i).config=d({},oo,m(e.options,"controls.SettingsButton")||{}),n.parent=t,n.label="",window.on("click.".concat(n.name),n.clickOutsideSettingsButton.bind(io(io(n)))),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ro(e,t)}(o,O),no(o,[{key:"name",get:function(){return"SettingsButton"}},{key:"className",get:function(){return"--z--btn --z--btn-settings"}},{key:"tagName",get:function(){return"button"}}]),no(o,[{key:"clickOutsideSettingsButton",value:function(e){Le(e.target,"pl-ic-settings")||this.parent.hideSettingsMenu()}},{key:"remove",value:function(){window.off("click.".concat(this.name),this.clickOutsideSettingsButton.bind(this)),Zi(eo(o.prototype),"remove",this).call(this)}},{key:"handleClick",value:function(e){e.stopPropagation(),this.parent.toggleVisibleSettingsMenu()}},{key:"updateBadgeLabel",value:function(e){this.label=e,this.iconLabelEl.textContent=e}},{key:"render",value:function(){return this.iconEl=k("span",{},{class:"--z--icon pl-ic-settings"}),this.iconLabelEl=k("span",{},{class:"--z--badge"}),this.iconLabelEl.textContent=this.label,this.setAttribute("title","CÃ i Äáº·t"),g(this.iconEl,{color:this.config.color}),g(this.iconLabelEl,{backgroundColor:this.config.labelBgColor,color:this.config.labelTextColor}),this.el.append(this.iconEl),this.el.append(this.iconLabelEl),this}}]),o}(),x={MENU_TYPE:{TOGGLE:"toggle",EXPAND:"expand"},LIST_MENU_TYPE:{CHECKLIST:"checklist",MIXIN:"mixin"}};function so(e){return(so="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function lo(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(e){uo(t,e,n[e])})}return t}function uo(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function co(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function fo(e,t){return!t||"object"!==so(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ho(e){return(ho=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function po(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function go(e,t,n){return t&&po(e.prototype,t),n&&po(e,n),e}function vo(e,t){return(vo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var R=function(){},yo=function(e){function a(){var e,t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];t=fo(this,(e=ho(a)).call.apply(e,[this].concat(r)));var o=r[2];return t.render(),t.parent=o,t.controls=t.parent.controls,t.settingsMenuItems={},t.routeHistory=[],t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&vo(e,t)}(a,L(O,C)),go(a,[{key:"name",get:function(){return"SettingsMenu"}},{key:"className",get:function(){return"--z--zpl-settings-menu"}},{key:"listenEvents",get:function(){return[{name:l.PLAYER_READY,handler:this.onPlayerReady},{name:l.PLAYER_MEDIACONTROL_HIDE,handler:this.onHideMediaControl},{name:l.PLAYER_SETTINGS_MENU_HIDE,handler:this.hideMenu},{name:l.PLAYER_PLAY,handler:this.hideMenu},{name:l.PLAYER_PAUSE,handler:this.hideMenu},{name:l.PLAYER_FULLSCREEN,handler:this.hideMenu},{name:l.PLAYER_MEDIACONTROL_CLICK,handler:this.hideMenu},{name:l.PLAYER_VOLUMEUPDATE,handler:this.hideMenu}]}}]),go(a,[{key:"handleClick",value:function(e){e.stopPropagation()}},{key:"onHideMediaControl",value:function(){this.hideMenu()}},{key:"onPlayerReady",value:function(){var e=be(this.settingsMenuItems);e.length&&(e=qt(e,"order")),e.length?(this.createMenu({type:x.LIST_MENU_TYPE.MIXIN,config:{itemsList:e}}),this.parent.show(),this.parent.settingsButton.show()):this.parent.hide()}},{key:"registerMenuItem",value:function(e){var t=e.pluginKey,n=void 0===t?"":t,r=e.type,i=void 0===r?x.MENU_TYPE.TOGGLE:r,o=e.config,a=void 0===o?{}:o,s=e.order,l=void 0===s?0:s,u=e.callback,c=void 0===u?R:u,f=e.optionsConfig;if(!n)throw new Error("pluginKey must be required");this.settingsMenuItems[n]={type:i,config:a,order:l,callback:c,optionsConfig:f}}},{key:"asyncRegisterMenuItem",value:function(){this.registerMenuItem.apply(this,arguments),this.onPlayerReady()}},{key:"createToggleItem",value:function(e){var s=this,t=e.title,n=void 0===t?"":t,r=e.checked,i=void 0!==r&&r,o=e.clickCallback,l=void 0===o?R:o,u=e.itemIndex,c=k("div",{innerHTML:'\n            <div class="--z--zpl-item-label">\n                '.concat(n,'\n            </div>\n            <div class="--z--zpl-item-content">\n                <div class="--z--zpl-toggle-checkbox"></div>\n            </div>\n        ')},{class:"--z--zpl-menu-item","aria-checked":i});return c.on("click",function(e){E.function(l)&&l(e,c);var t="true"!==Be(c,"aria-checked");He(c,"aria-checked",t);var n=s.routeHistory.length;if(n){var r=s.routeHistory[n-1];if("mixin"===m(r,"config.headerConfig.optionsMenu.type")){var i=m(r,"config.headerConfig.optionsMenu.data");if(E.array(i)&&i.length){var o=i[u],a=m(o,"config.checked");o&&!E.nullOrUndefined(a)&&(o.config.checked=t)}}}}),c}},{key:"createExpandableItem",value:function(e){var n=this,t=e.title,r=void 0===t?"":t,i=e.activeItemIndex,o=void 0===i?0:i,a=e.clickCallback,s=void 0===a?R:a,l=e.subMenu,u=e.optionsConfig,c=e.historyData,f=e.itemIndex,d=l.type,h=l.data,p=l.clickCallback,g=l.titleClickCallback,v=h&&E.array(h)&&h[o],y=v&&v.displayName||v&&v.label||"",m=k("div",{innerHTML:'\n            <div class="--z--zpl-item-label">\n                '.concat(r,'\n            </div>\n            <div class="--z--zpl-item-content">\n                <div class="--z--zpl-has-expand">\n                    <span> ').concat(y,' </span>\n                    <i class="pl-ic-keyboard_arrow_right"></i>\n                </div>\n            </div>\n        ')},{class:"--z--zpl-menu-item"});return h.map(function(e,t){return e.checked=o===t,e}),m.data={title:r,activeItemIndex:o,subMenu:l,optionsConfig:u,itemIndex:f},m.on("click",function(e){if(E.function(s)&&s(e,m),E.nullOrUndefined(c)||E.empty(c)||(n.routeHistory=[].concat(co(n.routeHistory),[c])),d===x.LIST_MENU_TYPE.CHECKLIST){var t={headerConfig:{title:r,showOptions:!!u,optionText:u&&u.label,optionsClickCallback:u&&u.clickCallback,optionsMenu:u&&u.subMenu,titleClickCallback:g},itemsList:h,clickCallback:p,itemIndex:f};n.createCheckListMenu(t,{type:x.LIST_MENU_TYPE.CHECKLIST,config:t})}}),m}},{key:"createCheckableItem",value:function(e){var f=this,t=e.label,n=void 0===t?"":t,r=e.disabled,d=void 0!==r&&r,i=e.checked,o=void 0!==i&&i,a=e.callback,h=void 0===a?R:a,p=e.itemIndex,g=k("div",{innerHTML:'\n            <div class="--z--zpl-item-label">\n                <i class="pl-ic-done"></i>\n                <span class="txt">'.concat(n,"</span>\n            </div>\n        ")},{class:"--z--zpl-menu-item","aria-checked":o,"aria-disabled":d});return g.on("click",function(e){if(E.function(h)&&h(e,g),d)return!1;for(var t=(g.parentNode||g.parentElement).childNodes,n=t.length,r=0;r<n;r++){He(t[r],"aria-checked",!1)}He(g,"aria-checked",!0);var i=f.routeHistory.length,o=f.routeHistory[i-1],a=m(o,"config.itemsList"),s=a&&E.array(a)&&a[p],l=m(g.data,"index");if(E.nullOrUndefined(l))throw new Error("Element must be have index property in data",g);if(s&&!E.nullOrUndefined(s.type)){var u=m(s,"config.activeItemIndex");E.nullOrUndefined(u)||(s.config.activeItemIndex=l)}else{var c=m(o,"config.headerConfig.optionsMenu");c&&!E.nullOrUndefined(m(c,"activeItemIndex"))&&(c.activeItemIndex=l)}}),g}},{key:"goBack",value:function(){var e=this.routeHistory.length;if(e){var t=this.routeHistory[e-1];t&&(this.createMenu(t),this.routeHistory.pop())}}},{key:"createMenuHeader",value:function(e){var u=this,t=e.title,n=void 0===t?"":t,r=e.showOptions,i=void 0!==r&&r,o=e.optionText,c=void 0===o?"Options":o,a=e.titleClickCallback,s=void 0===a?R:a,l=e.optionsClickCallback,f=void 0===l?R:l,d=e.optionsMenu,h=e.historyData,p=e.itemIndex,g=k("div",{},{class:"--z--zpl-panel-header --z--clearfix"}),v=k("button",{innerHTML:'<i class="pl-ic-keyboard_arrow_left"></i> '.concat(n)},{class:"--z--panel-title"});if(v.on("click",function(e){e.stopPropagation(),u.goBack(),E.function(s)&&s(e)}),g.append(v),i){var y=k("div",{innerText:c},{class:"--z--zpl-options"});y.on("click",function(e){e.stopPropagation();var t=u.routeHistory[u.routeHistory.length-1],n=t&&m(t,"config.itemsList"),r=n&&E.array(n)&&n[p];if(r){var i=m(r,"config.activeItemIndex");E.nullOrUndefined(i)||(h.config.activeItemIndex=i,m(h,"config.itemsList")&&h.config.itemsList.map(function(e,t){return e.checked=i===t,e}))}E.nullOrUndefined(h)||E.empty(h)||(u.routeHistory=[].concat(co(u.routeHistory),[h])),E.function(f)&&f(e);var o=d.type,a=d.data,s=d.activeItemIndex,l={headerConfig:{title:c},itemsList:a,itemIndex:p};o===x.LIST_MENU_TYPE.CHECKLIST?(E.number(s)&&a.map(function(e,t){return e.checked=s===t,e}),u.createCheckListMenu(l,{type:x.LIST_MENU_TYPE.CHECKLIST,config:l})):o===x.LIST_MENU_TYPE.MIXIN&&u.createMixinMenu(l,{type:x.LIST_MENU_TYPE.MIXIN,config:l})}),g.append(y)}return g}},{key:"createMenu",value:function(e){var t=e.type,n=e.config;"checklist"===t?this.createCheckListMenu(lo({},n),{type:t,config:n}):"mixin"===t&&this.createMixinMenu(lo({},n),{type:t,config:n})}},{key:"createCheckListMenu",value:function(e,t){var n=e.headerConfig,r=e.itemsList,i=void 0===r?[]:r,o=e.clickCallback,a=void 0===o?R:o,s=e.itemIndex;if(this.panelEl.innerHTML="",n){var l=this.createMenuHeader(lo({},n,{historyData:t,itemIndex:s}));this.panelEl.append(l)}for(var u=k("div",{},{class:"--z--panel-scroll-wrapper"}),c=k("div",{},{class:"--z--zpl-panel-menu"}),f=i.length,d=0;d<f;d++){var h=i[d];if(!E.object(h)||!h.label)return;var p=this.createCheckableItem({label:h.displayName||h.label,checked:!!h.checked,disabled:!!h.disabled,callback:a,itemIndex:s});p.data=h,c.append(p)}u.append(c),this.panelEl.append(u)}},{key:"createMixinMenu",value:function(e,t){var n=e.headerConfig,r=e.itemsList,i=void 0===r?[]:r;if(this.panelEl.innerHTML="",n){var o=this.createMenuHeader(n);this.panelEl.append(o)}for(var a=k("div",{},{class:"--z--panel-scroll-wrapper"}),s=k("div",{},{class:"--z--zpl-panel-inner"}),l=i.length,u=0;u<l;u++){var c=i[u],f=c.type,d=c.config,h=c.callback,p=c.optionsConfig,g=null;f===x.MENU_TYPE.TOGGLE?g=this.createToggleItem(lo({},d,{itemIndex:u})):f===x.MENU_TYPE.EXPAND&&(g=this.createExpandableItem(lo({},d,{optionsConfig:p,historyData:t,itemIndex:u}))),E.function(h)&&h(g),g&&s.append(g)}a.append(s),this.panelEl.append(a)}},{key:"toggleVisibleMenu",value:function(){p(this.el,"--z--show"),this.player.isMenuOpen=!this.player.isMenuOpen}},{key:"hideMenu",value:function(){h(this.el,"--z--show"),this.player.isMenuOpen=!1}},{key:"render",value:function(){this.panelEl=k("div",{},{class:"--z--zpl-panel"}),this.el.append(this.panelEl),this.player.el.append(this.el)}}]),a}();function mo(e){return(mo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function bo(e,t,n){return(bo="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Eo(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function Eo(e){return(Eo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function To(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ko(e,t,n){return t&&To(e.prototype,t),n&&To(e,n),e}function wo(e,t){return(wo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _o(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function So(e){return(So="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ao(e,t){return!t||"object"!==So(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Po(e){return(Po=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Oo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Co(e,t,n){return t&&Oo(e.prototype,t),n&&Oo(e,n),e}function Lo(e,t){return(Lo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Do(e){return(Do="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ro(e,t){return!t||"object"!==Do(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Io(e,t,n){return(Io="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=I(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function I(e){return(I=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Mo(e,t){return(Mo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Fo={playpause:Zn,seekbar:ci,time:mi,volume:Gi,fullscreen:Qi,settings:function(e){function u(){var e,t,n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];n=this,t=!(r=(e=Eo(u)).call.apply(e,[this].concat(o)))||"object"!==mo(r)&&"function"!=typeof r?_o(n):r;var s=o[0],l=o[1];return t.settingsButton=new ao(s,_o(_o(t))),t.settingsMenu=new yo(s,l,_o(_o(t))),t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wo(e,t)}(u,L(O,C)),ko(u,[{key:"name",get:function(){return"SettingsControl"}},{key:"className",get:function(){return"--z--control --z--control-settings"}}]),ko(u,[{key:"toggleVisibleSettingsMenu",value:function(){this.settingsMenu.toggleVisibleMenu()}},{key:"hideSettingsMenu",value:function(){this.settingsMenu.hideMenu()}},{key:"render",value:function(){return this.el.append(this.settingsButton.render().el),this}},{key:"remove",value:function(){[this.settingsButton,this.settingsMenu].forEach(function(e){e.remove()}),bo(Eo(u.prototype),"remove",this).call(this)}}]),u}(),theatermode:function(e){function a(){var e,t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];t=Ao(this,(e=Po(a)).call.apply(e,[this].concat(r)));var o=r[0];return t.config=d({},Cn,m(o.options,"controls.theaterMode")||{}),t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Lo(e,t)}(a,L(Hn,C)),Co(a,[{key:"name",get:function(){return"TheaterModeControl"}},{key:"className",get:function(){return"--z--control --z--btn --z--control-theater-mode"}},{key:"listenEvents",get:function(){return[{name:l.PLAYER_THEATER_MODE_CHANGE,handler:this._onTheaterModeChange}]}}]),Co(a,[{key:"toggleIcon",value:function(e){p(this.iconEl,"pl-ic-theater",e),p(this.iconEl,"pl-ic-theater-mini",!e),this.setButtonTooltip(e)}},{key:"handleClick",value:function(){this.player.toggleTheaterMode()}},{key:"setButtonTooltip",value:function(e){var t=this.config.buttonTooltip,n=t?t.on:"Cháº¿ Äá» ráº¡p chiáº¿u",r=t?t.off:"ThoÃ¡t cháº¿ Äá» ráº¡p chiáº¿u";this.setAttribute("title",e?r:n)}},{key:"render",value:function(){var e=this.options.theaterMode,t=e?"pl-ic-theater":"pl-ic-theater-mini";return this.iconEl=k("span",{},{class:"--z--icon ".concat(t)}),this.setButtonTooltip(e),this.el.append(this.iconEl),this}},{key:"_onTheaterModeChange",value:function(e){this.toggleIcon(e)}}]),a}()},No=function(e){function b(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,b),Ro(this,I(b).apply(this,arguments))}var t,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Mo(e,t)}(b,y),t=b,r=[{key:"NAME_EVENTS",get:function(){return[{name:l.PLAYER_MOUSE_MOVE,handler:this.onMouseMove},{name:l.PLAYER_MOUSE_LEAVE,handler:this.onMouseLeave},{name:l.PLAYER_PLAY,handler:this.onPlay},{name:l.PLAYER_PAUSE,handler:this.onPause}]}}],(n=[{key:"setUp",value:function(){this.draggingVolumeBar=!1,this.draggingSeekBar=!1,this.autoHideDisabled=!1,this.setting=d({},this.pluginOptions),this.setting.layout=m(this.pluginOptions,"layout"),this.controls=[],this.leftElement=null,this.rightElement=null,this.pluginOptions.disabled||this.onMouseMove()}},{key:"setupTheme",value:function(){var n=this,e=this.setting,t=e.type,r=e.theme;if(t.fullWidth){T(this.innerEl,An),T(this.el,An);var i=t.fullWidth;switch(i.backgoundType){case Ln.BG_TYPE_TRANSPARENT:T(this.innerEl,Pn);break;case Ln.BG_TYPE_GRADIENT:T(this.innerEl,Pn),T(this.el,Pn)}var o=i.paddingTop;E.number(o)&&o>=0&&g(this.innerEl,{paddingTop:String(o).indexOf("px")>-1?o:"".concat(o,"px")}),g(this.innerEl,{backgroundImage:i.backgroundImage,backgroundColor:i.backgroundColor}),this.setting.hideAnimation&&(this.hideClass=On)}r&&(be(Ln.THEME).indexOf(r)>-1&&a(23)("./".concat(r,".scss")).then(function(e){var t=k("style",{innerHTML:e.default});n.innerEl.append(t)}))}},{key:"onClicked",value:function(e){e.stopPropagation(),this.player.trigger(l.PLAYER_MEDIACONTROL_CLICK)}},{key:"onDblClicked",value:function(e){e.stopPropagation(),this.player.trigger(l.PLAYER_MEDIACONTROL_DBLCLICK)}},{key:"onMouseLeave",value:function(){this.autoHideDisabled||this.setting.alwaysShowControl||(clearTimeout(this.hideTimeout),this.hide())}},{key:"onMouseMove",value:function(){var e=this;this.autoHideDisabled||this.setting.disabledAutoHide||(clearTimeout(this.hideTimeout),this.show(),this.setting.alwaysShowControl||(this.hideTimeout=setTimeout(function(){return e.onMouseLeave()},3e3)))}},{key:"onPlay",value:function(){this.enableAutoHide()}},{key:"onPause",value:function(){this.onMouseLeave(),A?this.setting.showOnPauseMobile&&this.disableAutoHide():this.disableAutoHide()}},{key:"disableAutoHide",value:function(){this.autoHideDisabled=!0,clearTimeout(this.hideTimeout),this.show()}},{key:"enableAutoHide",value:function(){this.setting.disabledAutoHide||this.player.isPlaying()&&(this.autoHideDisabled=!1,this.onMouseMove())}},{key:"disable",value:function(){Io(I(b.prototype),"disable",this).call(this),this.player.disableMediaControl()}},{key:"enable",value:function(){Io(I(b.prototype),"enable",this).call(this),this.player.enableMediaControl()}},{key:"show",value:function(){f.debug(this.name,"show"),h(this.el,this.hideClass),this.player.showMediaControl()}},{key:"hide",value:function(){this.hideClass||(this.hideClass=Sn),f.debug(this.name,"hide",this.hideClass),T(this.el,this.hideClass),this.player.hideMediaControl()}},{key:"destroy",value:function(){Io(I(b.prototype),"destroy",this).call(this),this.controls.forEach(function(e){return e.remove()}),this.remove()}},{key:"getControl",value:function(t){return this.controls&&this.controls.filter(function(e){return e.name===t})[0]}},{key:"renderControl",value:function(e,t){if(t){var n=Fo[t];if(n){var r=new n(this.player,this);e.append(r.render().el),this.controls.push(r)}}}},{key:"render",value:function(){var e=this;if(!this.controls)return this;if(Io(I(b.prototype),"render",this).call(this),this.leftElement=k("div",{},{class:"--z--control-left"}),this.rightElement=k("div",{},{class:"--z--control-right"}),this.innerEl=k("div",{},{class:"--z--controls"}),(!this.setting.layout.left||!this.setting.layout.left.length)&&T(this.rightElement,"--z--only-right-control"),this.setting.layout.default){var t=!0,n=!1,r=void 0;try{for(var i,o=this.setting.layout.default[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;this.renderControl(this.innerEl,a)}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}}if(this.setting.layout.left){var s=!0,l=!1,u=void 0;try{for(var c,f=this.setting.layout.left[Symbol.iterator]();!(s=(c=f.next()).done);s=!0){var d=c.value;this.renderControl(this.leftElement,d)}}catch(e){l=!0,u=e}finally{try{s||null==f.return||f.return()}finally{if(l)throw u}}}if(this.setting.layout.right){var h=!0,p=!1,g=void 0;try{for(var v,y=this.setting.layout.right[Symbol.iterator]();!(h=(v=y.next()).done);h=!0){var m=v.value;this.renderControl(this.rightElement,m)}}catch(e){p=!0,g=e}finally{try{h||null==y.return||y.return()}finally{if(p)throw g}}}return this.setupTheme(),this.innerEl.append(this.leftElement),this.innerEl.append(this.rightElement),this.el.append(this.innerEl),this.player.$el.append(this.el),setTimeout(function(){e.player.mediaControlReady()},0),this}},{key:"name",get:function(){return"ControlsPlugin"}},{key:"attributes",get:function(){return{class:"--z--controls-wrapper"}}},{key:"events",get:function(){return{click:"onClicked",dblclick:"onDblClicked"}}},{key:"listenEvents",get:function(){return[{name:l.PLAYER_MOUSE_MOVE,handler:this.onMouseMove},{name:l.PLAYER_MOUSE_LEAVE,handler:this.onMouseLeave},{name:l.PLAYER_PLAY,handler:this.onPlay},{name:l.PLAYER_PAUSE,handler:this.onPause}]}},{key:"defaultOptions",get:function(){return Cn}}])&&xo(t.prototype,n),r&&xo(t,r),b}();a(24);function jo(e){return(jo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Uo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Bo(e,t){return!t||"object"!==jo(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ho(e){return(Ho=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function $o(e,t){return($o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Go={poster:"//static.tienphong.vn/zplayer/images/poster_default.jpg"},Vo=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Bo(this,Ho(t).apply(this,arguments))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$o(e,t)}(t,y),n=t,(r=[{key:"_onPlayerPlayIntent",value:function(){this.hide()}},{key:"_onPlayerEnded",value:function(){this.player.options.customIosFullscreen||this.show()}},{key:"handleClick",value:function(){return this.player.play(),!1}},{key:"getPosterUrl",value:function(){return this.options.poster||this.pluginOptions.poster}},{key:"render",value:function(){var e=this.getPosterUrl(),t=k("div",{},{class:"--z--poster-controls --z--play-wrapper --z--active"});return this.el.setAttribute("style","background-image : url(".concat(e,");")),E.empty(this.pluginOptions.styles)||g(this.el,this.pluginOptions.styles),this.$el.append(t),this.player.$el.append(this.el),this}},{key:"name",get:function(){return"PosterPlugin"}},{key:"attributes",get:function(){return{class:"--z--player-poster"}}},{key:"events",get:function(){return{click:"handleClick",touch:"handleClick"}}},{key:"defaultOptions",get:function(){return Go}},{key:"listenEvents",get:function(){return[{name:l.PLAYER_PLAY_INTENT,handler:this._onPlayerPlayIntent},{name:l.PLAYER_ENDED,handler:this._onPlayerEnded}]}}])&&Uo(n.prototype,r),i&&Uo(n,i),t}();a(25);function Yo(e){return(Yo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function zo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ko(e,t){return!t||"object"!==Yo(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Wo(e,t,n){return(Wo="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=qo(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function qo(e){return(qo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Xo(e,t){return(Xo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Qo={showLabel:!1},Jo=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Ko(this,qo(t).apply(this,arguments))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Xo(e,t)}(t,y),n=t,(r=[{key:"setUp",value:function(){Wo(qo(t.prototype),"setUp",this).call(this),this.bufferingPercent=1,this.shouldUpdate=!0}},{key:"onBuffering",value:function(){this.shouldUpdate=!0,this.show()}},{key:"onBufferingChange",value:function(e){E.number(e)&&((e=Math.floor(e))<1?e=1:e>99&&(e=99),this.bufferingPercent=e,this.update())}},{key:"onBufferFull",value:function(){f.debug(this.name,"onBufferFull"),this.bufferingPercent=1,this.update(),this.hide(),this.shouldUpdate=!1}},{key:"onStop",value:function(){f.debug(this.name,"onStop"),this.bufferingPercent=1,this.hide()}},{key:"show",value:function(){var e=this;null===this.showTimeout&&(this.showTimeout=setTimeout(function(){e.player.trigger(l.LOADING_SPINNER_SHOW),e.$el.show()},300))}},{key:"hide",value:function(){null!==this.showTimeout&&(clearTimeout(this.showTimeout),this.showTimeout=null),this.player.trigger(l.LOADING_SPINNER_HIDE),this.$el.hide()}},{key:"update",value:function(){this.shouldUpdate&&this.pieWrapperEl&&(De(this.pieWrapperEl,"--z--pie-wrapper --z--progress-".concat(this.bufferingPercent)),this.labelEl&&je(this.labelEl,"".concat(this.bufferingPercent,"%")))}},{key:"render",value:function(){return this.pieEl=k("div",{},{class:"--z--pie-progress-size"}),this.pieWrapperEl=k("div",{innerHTML:'\n                <div class="--z--pie">\n                    <div class="--z--left-side --z--half-circle"></div>\n                    <div class="--z--right-side --z--half-circle"></div>\n                </div>\n                <div class="--z--shadow"></div>\n                '},{class:"--z--pie-wrapper"}),this.pluginOptions.showLabel&&(this.labelEl=k("div",{innerHTML:"".concat(this.bufferingPercent,"%")},{class:"--z--label"}),this.pieWrapperEl.prepend(this.labelEl)),this.pieEl.append(this.pieWrapperEl),this.$el.append(this.pieEl),this.player.$el.append(this.$el),this.$el.hide(),this.player.buffering&&this.onBuffering(),this}},{key:"_onPlayerPlayIntent",value:function(){this.player.buffering&&this.show()}},{key:"name",get:function(){return"LoadingSpinnerPlugin"}},{key:"attributes",get:function(){return{class:"--z--loading-wrapper"}}},{key:"defaultOptions",get:function(){return Qo}},{key:"listenEvents",get:function(){return[{name:l.PLAYER_PLAY_INTENT,handler:this._onPlayerPlayIntent},{name:l.PLAYER_BUFFERING,handler:this.onBuffering},{name:l.PLAYER_BUFFERING_CHANGE,handler:this.onBufferingChange},{name:l.PLAYER_BUFFERFULL,handler:this.onBufferFull},{name:l.PLAYER_STOP,handler:this.onStop},{name:l.PLAYER_ENDED,handler:this.onStop},{name:l.PLAYER_ERROR,handler:this.onStop}]}}])&&zo(n.prototype,r),i&&zo(n,i),t}();function Zo(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e?e.toString().replace(/{(\d+)}/g,function(e,t){return n[t].toString()}):e}function ea(e){var t=document.createElement("div");return t.appendChild(document.createTextNode(e)),t.innerHTML}function ta(e){var t=document.createDocumentFragment(),n=document.createElement("div");return t.appendChild(n),n.innerHTML=e,t.firstChild.innerText}function na(e){return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"")}function ra(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return String.prototype.startsWith?e.startsWith(t,n):(n=!n||n<0?0:+n,e.indexOf(t)===n)}function ia(e,t,n){return String.prototype.endsWith?e.endsWith(t,n):((void 0===n||n>e.length)&&(n=e.length),e.substring(n-t.length,n)===t)}function oa(e){return"".concat(e,"-").concat(Math.floor(1e4*Math.random()))}function aa(e,t){return 0===e||0===t||Number.isNaN(e)||Number.isNaN(t)?0:(e/t*100).toFixed(2)}function sa(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return e.replace(new RegExp(t.toString().replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1"),"g"),n.toString())}function la(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").toString().replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})}function ua(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").toString();return e=sa(e,"-"," "),e=sa(e,"_"," "),sa(e=la(e)," ","")}function ca(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").toString();return(e=ua(e)).charAt(0).toLowerCase()+e.slice(1)}function fa(e){var t=document.createDocumentFragment(),n=document.createElement("div");return t.appendChild(n),n.innerHTML=e,t.firstChild.innerText}function da(e){var t=document.createElement("div");return t.appendChild(e),t.innerHTML}function ha(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var pa=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.data=[]}var t,n,r;return t=e,(n=[{key:"getItem",value:function(e){return this.data[e]}},{key:"setItem",value:function(e,t){this.data[e]=String(t)}},{key:"removeItem",value:function(e){delete this.data[e]}}])&&ha(t.prototype,n),r&&ha(t,r),e}();function ga(){try{return"localStorage"in window&&(window.localStorage.setItem("__test__","__test__"),window.localStorage.removeItem("__test__"),!0)}catch(e){return!1}}var va=ga()?window.localStorage:new pa;function ya(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ma=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"zplayer";!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.key=e}var e,n,r;return e=t,r=[{key:"supported",value:function(){return ga()}}],(n=[{key:"get",value:function(e){var t=va.getItem(this.key);if(E.empty(t))return{};var n=function(e){try{return JSON.parse(e)}catch(e){return{}}}(t);return E.string(e)&&e.length?n[e]:n}},{key:"set",value:function(e){if(E.object(e)){var t=this.get();E.empty(t)&&(t={}),d(t,e),va.setItem(this.key,JSON.stringify(t))}}},{key:"clean",value:function(){va.removeItem(this.key)}}])&&ya(e.prototype,n),r&&ya(e,r),t}();function ba(e){return(ba="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ea(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ta(e,t){return!t||"object"!==ba(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ka(e,t,n){return(ka="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=wa(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function wa(e){return(wa=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _a(e,t){return(_a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Sa="zplayer-trk",Aa=5e3,Pa=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Ta(this,wa(t).apply(this,arguments))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_a(e,t)}(t,y),n=t,(r=[{key:"setUp",value:function(){this.options.sources!=[{source:"",mimeType:""}]&&(this._isFirstLoad=!0,this._isBuffering=!0,this._trackingApi=this.pluginOptions.trackingApi,this._storage=new ma(oa(Sa)),this._reset(),this._sendLastReports())}},{key:"destroy",value:function(){ka(wa(t.prototype),"destroy",this).call(this),this._stopMonitoring()}},{key:"_now",value:function(){return Date.now()}},{key:"_onPlayIntent",value:function(){this._timeOnStartLoad=this._now(),this._start("startup"),this._startMonitoring()}},{key:"_onBitrate",value:function(e){var t=parseInt(e.label),n=this._now(),r=this._metrics.extra.bitratesHistory.length;if(r>0){var i=this._metrics.extra.bitratesHistory[r-1];i.end=n,i.time=n-i.start}this._metrics.extra.bitratesHistory.push({start:this._now(),bitrate:t}),this._inc("changeLevel")}},{key:"_onFirstPlaying",value:function(){this.listenTo(this.player,l.PLAYER_TIMEUPDATE,this._onContainerUpdateWhilePlaying),this.listenEvents.push({name:l.PLAYER_TIMEUPDATE,handler:this._onContainerUpdateWhilePlaying}),this._start("watch"),this._stop("startup")}},{key:"_onContainerUpdateWhilePlaying",value:function(){this.player.isPlaying()&&(this._stop("watch"),this._start("watch"))}},{key:"_onCanPlayThrough",value:function(e){if(this.player.isPlaying()){var t=e.time;this._isFirstLoad?(this._isFirstLoad=!1,this._timeOnCanPlayFirstLoad=t):(this._timeOnCanPlayThrough=t,this._trackLatencyHistory(this._isBuffering))}}},{key:"_trackLatencyHistory",value:function(e){if(e)if(this._isSeeking)this._seekLatencyHistory.push(this._timeOnCanPlayThrough-this._timeOnSeeking),this._isSeeking=!1;else if(this._isWaiting){var t=this._timeOnCanPlayThrough-this._timeOnWaiting;this._metrics.timers.playLatency+=t,this._isWaiting=!1}}},{key:"_onSeeking",value:function(e){this._isSeeking=!0,this._timeOnSeeking=e.time}},{key:"_onWaiting",value:function(e){this._isSeeking||(this._isWaiting=!0,this._timeOnWaiting=e.time)}},{key:"_onPlayerEnded",value:function(){this._sendReportThenReset(),this.stopListening(),this.bindEvents()}},{key:"_onPlayerError",value:function(e){this._metrics.extra.errorDetail.push("code: ".concat(e.code,", description: ").concat(e.description)),this._inc("error"),this._sendReportThenReset()}},{key:"_startMonitoring",value:function(){var e=this;this._intervalId=setInterval(function(){e._buildReport(),e._sendLastReports()},Aa),this._buildReport(),f.info(this.name,"started monitoring")}},{key:"_stopMonitoring",value:function(){clearInterval(this._intervalId),f.info(this.name,"stopped monitoring")}},{key:"_sendReportThenReset",value:function(){this._stopMonitoring(),this._buildReport(),this._sendReport(this._storage.get()),this._reset()}},{key:"_reset",value:function(){this._isFirstLoad=!0,this._seekLatencyHistory=[],this._newMetrics(),this._storage.clean()}},{key:"_sendLastReports",value:function(){var r=this;Object.keys(va).filter(Oa).forEach(function(e){var t,n=JSON.parse(va.getItem(e));r._storage.key===e||(t=n)&&Date.now()-t._updatedAt<Aa||(r._sendReport(n),va.removeItem(e),f.debug(r.name,"sent report:",e))})}},{key:"_saveMetrics",value:function(){var e={_updatedAt:this._now(),userAgent:navigator.userAgent,fromUrl:window.location.href,params:JSON.stringify(this._metrics)};this._storage.set(e)}},{key:"_sendReport",value:function(t){f.debug(this.name,"sending report:",t),this._trackingApi.forEach(function(e){(new Image).src=e+"?userAgent="+encodeURIComponent(t.userAgent)+"&fromUrl="+encodeURIComponent(t.fromUrl)+"&params="+encodeURIComponent(t.params)})}},{key:"onPlay",value:function(){this._inc("play")}},{key:"onPause",value:function(){this._stop("watch"),this._start("pause"),this._inc("pause"),this.listenToOnce(this.player,l.PLAYER_PLAY,this.playAfterPause)}},{key:"playAfterPause",value:function(){this._stop("pause"),this._start("watch")}},{key:"onSeek",value:function(e){this._inc("seek"),this._metrics.extra.watchHistory.push([1e3*e,1e3*e])}},{key:"onFullScreen",value:function(){this._inc("fullscreen")}},{key:"onProgress",value:function(e){this._metrics.extra.buffersize=1e3*e.current}},{key:"onTimeUpdate",value:function(e){var t=1e3*e.current,n=1e3*e.total,r=this._metrics.extra.watchHistory.length;this._metrics.extra.duration=n,this._metrics.extra.currentTime=t,0===r?this._metrics.extra.watchHistory.push([t,t]):this._metrics.extra.watchHistory[r-1][1]=t}},{key:"onBuffering",value:function(){this._isBuffering=!0,this._inc("buffering"),this._start("buffering"),this.listenToOnce(this.player,l.PLAYER_BUFFERFULL,this.onBufferfull)}},{key:"onBufferfull",value:function(){this._isBuffering=!1,this._stop("buffering"),this.listenToOnce(this.player,l.PLAYER_BUFFERING,this.onBuffering)}},{key:"_inc",value:function(e){this._metrics.counters[e]+=1}},{key:"_timerHasStarted",value:function(e){return void 0!==this["_start".concat(e)]}},{key:"_start",value:function(e){this["_start".concat(e)]=this._now()}},{key:"_stop",value:function(e){this._metrics.timers[e]+=this._now()-this["_start".concat(e)]}},{key:"_fetchFPS",value:function(){var e={html5_video:this._html5FetchFPS,hls:this._html5FetchFPS};e[this._playbackName]&&e[this._playbackName].call(this)}},{key:"_calculateBitrates",value:function(){var t=this,e=this._metrics.extra.bitratesHistory.map(function(e){return e.bitrate});this._metrics.extra.bitrateMean=e.reduce(function(e,t){return e+t},0)/e.length,this._metrics.extra.bitrateVariance=e.map(function(e){return Math.pow(e-t._metrics.extra.bitrateMean,2)}).reduce(function(e,t){return e+t},0)/e.length,this._metrics.extra.bitrateStandardDeviation=Math.sqrt(this._metrics.extra.bitrateVariance),this._metrics.extra.bitrateMostUsed=this._metrics.extra.bitratesHistory.sort(function(e,t){return e.time<t.time})[0]}},{key:"_calculatePercentages",value:function(){this._metrics.extra.duration>0&&(this._metrics.extra.watchedPercentage=this._metrics.timers.watch/this._metrics.extra.duration*100,this._metrics.extra.bufferingPercentage=this._metrics.timers.buffering/this._metrics.extra.duration*100)}},{key:"_calculateStartLatency",value:function(){!this._timeOnCanPlayFirstLoad||this._timeOnCanPlayFirstLoad<=0||(this._metrics.timers.startLatency=this._timeOnCanPlayFirstLoad-this._timeOnStartLoad)}},{key:"_calculateSeekLatency",value:function(){this._metrics.timers.seekLatency=Qt(this._seekLatencyHistory)}},{key:"_newMetrics",value:function(){var t=this;this._metrics={counters:{play:0,pause:0,error:0,buffering:0,decodedFrames:0,droppedFrames:0,fps:0,changeLevel:0,seek:0,fullscreen:0,dvrUsage:0},timers:{startup:0,watch:0,pause:0,buffering:0,session:0,startLatency:0,seekLatency:0,playLatency:0,getSourceLatency:0},extra:{product:"",level:"",playbackName:"",playbackType:"",playbackRedirector:"",playbackSrc:"",mimeType:"",platform:A?"webm":"webd",zdnServer:"",bitratesHistory:[],bitrateMean:0,bitrateVariance:0,bitrateStandardDeviation:0,bitrateMostUsed:0,buffersize:0,errorDetail:[],watchHistory:[],watchedPercentage:0,bufferingPercentage:0,isOnline:!0}},window.ZA&&E.function(window.ZA.getVisitorID)&&window.ZA.getVisitorID(function(e){f.debug(t.name,"ZA visitor ID:",e),t._metrics.extra.visitorId=e})}},{key:"_buildReport",value:function(){this._stop("session"),this._start("session"),this._metrics.extra.playbackName=this._playbackName,this._metrics.extra.playbackType=this._playbackType,this._metrics.extra.product=this.options.product,this._calculateBitrates(),this._calculatePercentages(),this._fetchFPS(),this._calculateStartLatency(),this._calculateSeekLatency(),this._metrics.extra.playbackSrc=this.player.isHlsPlayback()?this.player.options.source:this.player.playback.el.src,this._metrics.extra.mimeType=this.player.options.mimeType,this._saveMetrics()}},{key:"_html5FetchFPS",value:function(){var e=this.player.playback.el,t=e.webkitDecodedFrameCount||e.mozDecodedFrames||0,n=e.webkitDroppedFrameCount||e.mozParsedFrames-e.mozDecodedFrames||0,r=t-(this._lastDecodedFramesCount||0);this._metrics.counters.decodedFrames=t,this._metrics.counters.droppedFrames=n,this._metrics.counters.fps=r/(Aa/1e3),this._lastDecodedFramesCount=t}},{key:"name",get:function(){return"StatsPlugin"}},{key:"defaultOptions",get:function(){return{trackingApi:["https://zplayer-trk.zdn.vn/track"]}}},{key:"_playbackName",get:function(){return this.player.playback.name}},{key:"_playbackType",get:function(){return this.player.getPlaybackType()}},{key:"listenEvents",get:function(){return[{once:!0,name:l.PLAYER_PLAY_INTENT,handler:this._onPlayIntent},{once:!0,name:l.PLAYER_PLAY,handler:this._onFirstPlaying},{name:l.PLAYER_QUALITY_LEVELS_SELECTED,handler:this._onBitrate},{name:l.PLAYER_CANPLAYTHROUGH,handler:this._onCanPlayThrough},{name:l.PLAYER_PLAY,handler:this.onPlay},{name:l.PLAYER_PAUSE,handler:this.onPause},{once:!0,name:l.PLAYER_ERROR,handler:this._onPlayerError},{name:l.PLAYER_ENDED,handler:this._onPlayerEnded},{name:l.PLAYER_SEEKING,handler:this._onSeeking},{name:l.PLAYER_SEEK,handler:this.onSeek},{name:l.PLAYER_WAITING,handler:this._onWaiting},{name:l.PLAYER_FULLSCREEN,handler:this.onFullScreen},{name:l.PLAYER_PROGRESS,handler:this.onProgress},{name:l.PLAYER_TIMEUPDATE,handler:this.onTimeUpdate},{once:!0,name:l.PLAYER_BUFFERING,handler:this.onBuffering},{once:!0,name:l.PLAYER_BUFFERFULL,handler:this.onBufferfull}]}}])&&Ea(n.prototype,r),i&&Ea(n,i),t}();function Oa(e){return e&&0===e.indexOf(Sa)}a(26);function Ca(e){return(Ca="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function La(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Da(e,t){return!t||"object"!==Ca(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function xa(e){return(xa=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ra(e,t){return(Ra=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ia=["PosterPlugin","LoadingSpinnerPlugin","BigPlayButtonPlugin","ClickToPausePlugin","PauseAdPlugin","PlayPauseFaceoutPlugin","HotKeysPlugin"],Ma=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Da(this,xa(t).apply(this,arguments))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ra(e,t)}(t,y),n=t,(r=[{key:"setUp",value:function(){var t=this;if(this.defaultOptions.disabled)return this.disable();this.shouldRender=!0,this.interferedPlugins=Ia.map(function(e){return t.player.getPlugin(e)})}},{key:"bindReload",value:function(){this.reloadButton=this.$el.find(".player-error-screen__reload"),this.reloadButton&&this.reloadButton.on("click",this.reload.bind(this))}},{key:"reload",value:function(){var e=this;this.listenToOnce(this.player,l.PLAYER_READY,function(){return e.player.play()}),this.unbindReload()}},{key:"unbindReload",value:function(){this.reloadButton&&this.reloadButton.off("click")}},{key:"onError",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.err=e,this.player.mediaControl.disable(),this._disableInterferedPlugins(),this.render(),this.show(),this.shouldRender=!1}},{key:"_disableInterferedPlugins",value:function(){this.interferedPlugins.forEach(function(e){return e&&e.disable()})}},{key:"render",value:function(){if(this.err&&this.shouldRender){var e=k("div",{innerHTML:'\n            <div class="player-error-screen__title" data-error-screen>'.concat(this.pluginOptions.message,'.</div>\n            <div class="player-error-screen__code" data-error-screen>Error code: ').concat(this.err.code,"</div>\n            ")},{"data-error-screen":"",class:"player-error-screen__content"});return this.el.append(e),this.player.el.append(this.el),this.bindReload(),this}}},{key:"name",get:function(){return"ErrorScreenPlugin"}},{key:"attributes",get:function(){return{class:"player-error-screen","data-error-screen":""}}},{key:"listenEvents",get:function(){return[{name:l.PLAYER_ERROR,handler:this.onError}]}},{key:"defaultOptions",get:function(){return{message:"CÃ³ lá»i xáº£y ra!"}}}])&&La(n.prototype,r),i&&La(n,i),t}();function Fa(e){return(Fa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Na(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ja(e,t){return!t||"object"!==Fa(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ua(e){return(Ua=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ba(e,t){return(Ba=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ha={disableHotKeys:!1},$a=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),ja(this,Ua(t).apply(this,arguments))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ba(e,t)}(t,Ae),n=t,(r=[{key:"playPauseKey",value:function(e){return 32===e.which||179===e.which}},{key:"rewindKey",value:function(e){return 37===e.which||177===e.which}},{key:"forwardKey",value:function(e){return 39===e.which||176===e.which}},{key:"volumeUpKey",value:function(e){return 38===e.which}},{key:"volumeDownKey",value:function(e){return 40===e.which}},{key:"muteKey",value:function(e){return 77===e.which}},{key:"fullscreenKey",value:function(e){return 70===e.which}},{key:"numberKey",value:function(e){return e.which>47&&e.which<59||e.which>95&&e.which<106}},{key:"getNumberKey",value:function(e){var t=48;return e.which>95&&(t=96),e.which-t}},{key:"getKey",value:function(e){return!(e.metaKey||e.ctrlKey||e.altKey)&&(this.playPauseKey(e)?1:this.volumeUpKey(e)?2:this.volumeDownKey(e)?3:this.muteKey(e)?8:this.fullscreenKey(e)?4:this.rewindKey(e)?5:this.forwardKey(e)?6:this.numberKey(e)?9:void 0)}},{key:"_onPlayerKeydown",value:function(e){if(this.player.mediaControl.disabled)return!0;var t=this.getKey(e);if(!t)return!0;e.preventDefault(),e.stopPropagation(),this.player.mediaControl.show();var n=this.player.getCurrentTime(),r=100*this.player.getVolume(),i=this.player.getDuration(),o=this.getNumberKey(e);switch(t){case 1:this.player.togglePlay();break;case 2:this.player.setVolume(r+5,!0);break;case 3:this.player.setVolume(r-5,!0);break;case 8:this.player.isMuted()?this.player.unmute(!0):this.player.mute(!0);break;case 4:this.player.toggleFullscreen();break;case 5:this.player.seek(n-5);break;case 6:this.player.seek(n+5);break;case 9:this.player.seek(i*o*.1)}}},{key:"name",get:function(){return"HotKeysPlugin"}},{key:"defaultOptions",get:function(){return Ha}},{key:"listenEvents",get:function(){return[{name:l.PLAYER_KEYDOWN,handler:this._onPlayerKeydown}]}}])&&Na(n.prototype,r),i&&Na(n,i),t}();function Ga(e){return(Ga="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Va(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ya(e,t){return!t||"object"!==Ga(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function za(e){return(za=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ka(e,t){return(Ka=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Wa=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Ya(this,za(t).apply(this,arguments))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ka(e,t)}(t,Ae),n=t,(r=[{key:"setUp",value:function(){this.userInteractive=!1}},{key:"_onPlayerClickEvent",value:function(){this.player.isMenuOpen||(A?(this.userInteractive&&this.player.togglePlay(),this.userInteractive=!0):this.player.togglePlay())}},{key:"_onHideMediaControl",value:function(){this.userInteractive=!1}},{key:"name",get:function(){return"ClickToPausePlugin"}},{key:"listenEvents",get:function(){return[{name:l.PLAYER_CLICK,handler:this._onPlayerClickEvent},{name:l.PLAYER_MEDIACONTROL_HIDE,handler:this._onHideMediaControl}]}}])&&Va(n.prototype,r),i&&Va(n,i),t}();function qa(e){return(qa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Xa(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Qa(e,t){return!t||"object"!==qa(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ja(e){return(Ja=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Za(e,t){return(Za=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var es=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Qa(this,Ja(t).apply(this,arguments))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Za(e,t)}(t,Ae),n=t,(r=[{key:"_onDblClicked",value:function(){this.options.dblClickToFullScreen&&!A&&this.player.toggleFullscreen()}},{key:"name",get:function(){return"DoubleClickToFullscreen"}},{key:"listenEvents",get:function(){return[{name:l.PLAYER_DBLCLICK,handler:this._onDblClicked}]}}])&&Xa(n.prototype,r),i&&Xa(n,i),t}(),ts=a(4),ns=a(2),rs=a.n(ns),is=function(){return new Promise(function(e,t){var n=new XMLHttpRequest;n.open("HEAD","//static.tienphong.vn/zplayer/ads.js?ad",!0),n.onreadystatechange=function(){n.readyState===XMLHttpRequest.DONE&&(200===n.status?e():t(new Error("Ad Blocker is enabled")))},n.send()})};function os(){var e=Array.prototype.slice.call(arguments);if(window.fetch)return window.fetch.apply(window,e);function r(e){if("string"!=typeof e&&(e=e.toString()),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function i(e){return"string"!=typeof e&&(e=e.toString()),e}function o(t){var n=this;this.map={},t instanceof o?t.forEach(function(t,e){e.forEach(function(e){n.append(t,e)})}):t&&Object.getOwnPropertyNames(t).forEach(function(e){n.append(e,t[e])})}function a(e){if(e.bodyUsed)return fetch.Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function s(n){return new fetch.Promise(function(e,t){n.onload=function(){e(n.result)},n.onerror=function(){t(n.error)}})}function t(e){var t=new FileReader;return t.readAsArrayBuffer(e),s(t)}o.prototype.append=function(e,t){e=r(e),t=i(t);var n=this.map[e];n||(n=[],this.map[e]=n),n.push(t)},o.prototype.delete=function(e){delete this.map[r(e)]},o.prototype.get=function(e){var t=this.map[r(e)];return t?t[0]:null},o.prototype.getAll=function(e){return this.map[r(e)]||[]},o.prototype.has=function(e){return this.map.hasOwnProperty(r(e))},o.prototype.set=function(e,t){this.map[r(e)]=[i(t)]},o.prototype.forEach=function(t){var n=this;Object.getOwnPropertyNames(this.map).forEach(function(e){t(e,n.map[e])})};var l={blob:"FileReader"in window&&"Blob"in window&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:"FormData"in window};function n(){return this.bodyUsed=!1,this._initBody=function(e){if(this._bodyInit=e,"string"==typeof e)this._bodyText=e;else if(l.blob&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(l.formData&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else{if(e)throw new Error("unsupported BodyInit type");this._bodyText=""}},l.blob?(this.blob=function(){var e=a(this);if(e)return e;if(this._bodyBlob)return fetch.Promise.resolve(this._bodyBlob);if(this._bodyFormData)throw new Error("could not read FormData body as blob");return fetch.Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this.blob().then(t)},this.text=function(){var e,t,n=a(this);if(n)return n;if(this._bodyBlob)return e=this._bodyBlob,(t=new FileReader).readAsText(e),s(t);if(this._bodyFormData)throw new Error("could not read FormData body as text");return fetch.Promise.resolve(this._bodyText)}):this.text=function(){return a(this)||fetch.Promise.resolve(this._bodyText)},l.formData&&(this.formData=function(){return this.text().then(f)}),this.json=function(){return this.text().then(function(e){return JSON.parse(e)})},this}var u=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function c(e,t){var n,r;if(t=t||{},this.url=e,this.credentials=t.credentials||"omit",this.headers=new o(t.headers),this.method=(r=(n=t.method||"GET").toUpperCase(),u.indexOf(r)>-1?r:n),this.mode=t.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&t.body)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(t.body)}function f(e){var i=new FormData;return e.trim().split("&").forEach(function(e){if(e){var t=e.split("="),n=t.shift().replace(/\+/g," "),r=t.join("=").replace(/\+/g," ");i.append(decodeURIComponent(n),decodeURIComponent(r))}}),i}function d(e){var i=new o;return e.getAllResponseHeaders().trim().split("\n").forEach(function(e){var t=e.trim().split(":"),n=t.shift().trim(),r=t.join(":").trim();i.append(n,r)}),i}var h=!("undefined"==typeof window||!window.ActiveXObject||window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent);function p(e,t){t||(t={}),this._initBody(e),this.type="default",this.url=null,this.status=t.status,this.ok=this.status>=200&&this.status<300,this.statusText=t.statusText,this.headers=t.headers instanceof o?t.headers:new o(t.headers),this.url=t.url||""}return n.call(c.prototype),n.call(p.prototype),window.Headers=o,window.Request=c,window.Response=p,window.fetch=function(e,t){var n;return n=c.prototype.isPrototypeOf(e)&&!t?e:new c(e,t),new fetch.Promise(function(r,i){var o=function(){return h&&!/^(get|post|head|put|delete|options)$/i.test(this.method)?(this.usingActiveXhr=!0,new window.ActiveXObject("Microsoft.XMLHTTP")):new XMLHttpRequest}.call(this);function e(){if(4===o.readyState){var e=1223===o.status?204:o.status;if(e<100||e>599)i(new TypeError("Network request failed"));else{var t={status:e,statusText:o.statusText,headers:d(o),url:"responseURL"in o?o.responseURL:/^X-Request-URL:/m.test(o.getAllResponseHeaders())?o.getResponseHeader("X-Request-URL"):void 0},n="response"in o?o.response:o.responseText;r(new p(n,t))}}}"cors"===n.credentials&&(o.withCredentials=!0),o.onreadystatechange=e,this.usingActiveXhr||(o.onload=e,o.onerror=function(){i(new TypeError("Network request failed"))}),o.open(n.method,n.url,!0),"responseType"in o&&l.blob&&(o.responseType="blob"),n.headers.forEach(function(t,e){e.forEach(function(e){o.setRequestHeader(t,e)})}),o.send(void 0===n._bodyInit?null:n._bodyInit)})},fetch.Promise=window.Promise,window.fetch.polyfill=!0,window.fetch.apply(window,e)}var as={load:function(e,t){return Promise.resolve().then(is).then(function(){return function(e){if("function"==typeof e)return e();return e}(e)}).then(ss).then(function(e){return function(e,n){var r;f.debug("AdLoader","loading ad from source:",e);var t=os(e,{credentials:"include"}).then(function(e){return e.json()}).then(function(e){return clearTimeout(r),e&&e.ads?e.ads.schedule:[]}),i=new Promise(function(e,t){r=setTimeout(function(){return t(new Error("Timeout reached: ".concat(n)))},n)});return Promise.race([t,i])}(e,t)})}};function ss(e){if(!e)throw new Error("no ad source");return e}function ls(e){return(ls="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function us(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function cs(e,t){return!t||"object"!==ls(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function fs(e,t,n){return(fs="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ds(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function ds(e){return(ds=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function hs(e,t){return(hs=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ps=["PosterPlugin","ClickToPausePlugin","DoubleClickToFullscreen","PauseAdPlugin","HotKeysPlugin"],gs=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),cs(this,ds(t).apply(this,arguments))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&hs(e,t)}(t,y),n=t,(r=[{key:"setUp",value:function(){this.interferedPlugins=[],this.pauseContentRequested=!1,this.interferedPluginNames=ps.slice(0),f.debug(this.name,"initializing"),this._loadSource()}},{key:"addInterferedPlugin",value:function(e){this.interferedPluginNames.push(e)}},{key:"getPluginOptions",value:function(){return d(this.defaultOptions,m(this._options,"pluginsOptions.ads")||this.defaultOptions)}},{key:"render",value:function(){fs(ds(t.prototype),"render",this).call(this),this.$el.hide()}},{key:"init",value:function(){throw new Error("this must be overridden")}},{key:"canHandle",value:function(e){throw new Error("this must be overridden")}},{key:"onAdsDataLoaded",value:function(e){throw new Error("this must be overridden")}},{key:"onAdWillStart",value:function(){f.info(this.name,"ad will start"),this.player.trigger(l.PLAYER_AD_WILL_START)}},{key:"onAdStarted",value:function(){f.info(this.name,"ad started"),this.player.trigger(l.PLAYER_AD_STARTED)}},{key:"onAdStopped",value:function(e){f.info(this.name,"ad stopped:",e),this.player.trigger(l.PLAYER_AD_STOPPED,{reason:e})}},{key:"onAdSkipped",value:function(){f.info(this.name,"ad skipped"),this.player.trigger(l.PLAYER_AD_SKIPPED)}},{key:"pauseForAd",value:function(){return this.pauseContentRequested?rs.a.resolve():(f.debug(this.name,"pauseForAd"),this.pauseContentRequested=!0,this._disableMediaControl(),this._disableInterferedPlugins(),this.$el.show(),this._pausePlayback())}},{key:"resumeAfterAd",value:function(){return f.debug(this.name,"resumeAfterAd"),this.pauseContentRequested?(this.pauseContentRequested=!1,this._enableMediaControl(),this._enableInterferedPlugins(),this.$el.hide(),this._resumePlayback()):rs.a.resolve()}},{key:"_pausePlayback",value:function(){return this.player.pause()}},{key:"_resumePlayback",value:function(){return this.player.playback.ended?rs.a.resolve():this.player.play()}},{key:"_disableInterferedPlugins",value:function(){var t=this;this.interferedPlugins=this.interferedPluginNames.map(function(e){return function(e){if(!e||!e.enabled)return{enable:function(){},disable:function(){}};return{enable:e.enable.bind(e),disable:e.disable.bind(e)}}(t.player.getPlugin(e))}),this.interferedPlugins.forEach(function(e){return e.disable()})}},{key:"_enableInterferedPlugins",value:function(){this.interferedPlugins.forEach(function(e){return e.enable()})}},{key:"_disableMediaControl",value:function(){this.mediaControlDisabled=this.player.mediaControl.disabled,this.mediaControlDisabled||this.player.mediaControl.disable()}},{key:"_enableMediaControl",value:function(){this.mediaControlDisabled||this.player.mediaControl.enable()}},{key:"_loadSource",value:function(){var t=this,e=this.pluginOptions,n=e.source,r=e.loadTimeout,i=void 0===r?3e3:r;(this.pluginOptions.adLoadFn||as.load)(n,i).then(function(e){return t.onAdsDataLoaded(e)},function(e){/timeout reached/.test(e.message)&&t.player.trigger(l.PLAYER_AD_LOAD_TIMEOUT),f.error(t.name,"Cannot load ad:",e),t.onAdsDataLoaded(null)})}},{key:"name",get:function(){return"AdsBase"}},{key:"attributes",get:function(){return{class:this.name}}}])&&us(n.prototype,r),i&&us(n,i),t}();a(27);function vs(e){return(vs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ys(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ms(e,t){return!t||"object"!==vs(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function bs(e,t,n){return(bs="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Es(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function Es(e){return(Es=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ts(e,t){return(Ts=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ks=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),ms(this,Es(t).apply(this,arguments))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ts(e,t)}(t,gs),n=t,(r=[{key:"setUp",value:function(){f.debug(this.name,"setUp"),bs(Es(t.prototype),"setUp",this).call(this),this.metadataDeferred=Dt(),this.runnerDeferred=Dt(),this.runnerDeferredPromise=this.runnerDeferred.promise,this.rootPosterConfig=this.pluginOptions.poster,this._onResize=this._onResize.bind(this),window.on("resize.ads",this._onResize,!1),this.player.$el.append(this.$el),this.nonLinearAdContainer=k("div",{},{class:"AdsPluginNonLinear"}),this.player.$el.append(this.nonLinearAdContainer),this.runner=null}},{key:"onAdsDataLoaded",value:function(e){var t=this;this._transformAdsData(e).then(function(e){e&&e.length?t._runnerProxy(function(){t.runner.onAdsDataLoaded(e)}):(f.info(t.name,"empty ad data, destroying plugin..."),t.destroy())})}},{key:"destroy",value:function(){var e=this;bs(Es(t.prototype),"destroy",this).call(this),window.off("resize.ads",this._onResize,!1),Ke(this.nonLinearAdContainer),this._runnerProxy(function(){e.runner.destroy(),e.runner=null}),f.debug(this.name,"destroyed")}},{key:"getPoster",value:function(){var e=this.player.getPlayerSize().width;if(this.pluginOptions.poster=!(e<=400)&&this.rootPosterConfig,!this.pluginOptions.poster)return Promise.resolve();var t=this.player.getPlugin("PosterPlugin");return t?Promise.resolve(t.getPosterUrl()):Promise.resolve()}},{key:"getContentPlayer",value:function(){return this.player.playback.el}},{key:"getContentVolume",value:function(){return this.player.isMuted()?0:100*this.player.getVolume()}},{key:"getContentMetadata",value:function(){return this.metadataDeferred.promise}},{key:"getAdContainers",value:function(){var e=this.player.mediaControl.getControl("SeekBarControl");return{linear:this.el,nonLinear:this.nonLinearAdContainer,notification:this.player.el,adMark:e&&e.el}}},{key:"getLogger",value:function(){return f}},{key:"onAdStarted",value:function(){var e=this;bs(Es(t.prototype),"onAdStarted",this).call(this),!this.player.options.customIosFullscreen&&S&&D.isFullscreen()&&(f.info(this.name,"player in fullscreen mode on iOS, skipping ad..."),this._runnerProxy(function(){e.runner.stopAd()}))}},{key:"_onUserActionEvent",value:function(){var e=this;this._runnerProxy(function(){e.runner.onUserAction()})}},{key:"_onPlaybackEnded",value:function(){var e=this;this._runnerProxy(function(){e.runner.onContentEnded()}),this.pluginOptions.replayAds&&this._loadSource()}},{key:"_onPlayerError",value:function(){this.destroy()}},{key:"_onTimeUpdate",value:function(e){var t=this;this.player.mediaControl.draggingSeekBar||this._runnerProxy(function(){t.runner.onContentProgress(e)})}},{key:"_onLoadedMetadata",value:function(e){this.player.getDuration()<this.pluginOptions.minDurationShowAd&&this.destroy(),this.metadataDeferred.resolve(e)}},{key:"_onAdPauseRequest",value:function(){this._pauseAd()}},{key:"_onAdResumeRequest",value:function(){this._resumeAd()}},{key:"_onResize",value:function(t){var n=this,r=arguments,e=this.player.getPlayerSize().width,i=this.rootPosterConfig&&e>400;this._runnerProxy(function(){var e=n.runner;E.nullOrUndefined(e)||(e.showPosterAndPlayIcon(i),"resize"===t.type?e.resize():e.resize.apply(e,r))})}},{key:"_pauseAd",value:function(){var e=this;this._runnerProxy(function(){e.runner.pauseAd()})}},{key:"_resumeAd",value:function(){var e=this;this._runnerProxy(function(){e.runner.resumeAd()})}},{key:"_transformAdsData",value:function(t){var n=this.pluginOptions.transform;return"function"!=typeof n?Promise.resolve(t):(f.debug(this.name,"transforming ad data..."),this.getContentMetadata().then(function(e){return n(t,e)}))}},{key:"_runnerProxy",value:function(e){this.runnerDeferred&&this.runnerDeferredPromise.then(e)}},{key:"_toggleMediaControls",value:function(){var t=this,n=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._runnerProxy(function(){var e=n?"addClass":"removeClass";t.runner.adUi.countdownToPlay[e]("has_controls_bar"),t.runner.adUi.$uiLoading[e]("has_controls_bar")})}},{key:"_onPlayerControlShow",value:function(){this._toggleMediaControls()}},{key:"_onPlayerControlHide",value:function(){this._toggleMediaControls(!1)}},{key:"_onPlayerControlReady",value:function(){this.runner||(this.runnerOptions={startTimeout:this.pluginOptions.startTimeout/1e3,skipTimeout:this.pluginOptions.skipTimeout/1e3,countdownPlay:!this.pluginOptions.noCountdownPlay,showSlideBlack:this.pluginOptions.showSlideBlack,removeAdmarkOnError:this.pluginOptions.removeAdmarkOnError,autoPlayAdBreaks:this.pluginOptions.autoPlayAdBreaks,autoPlay:!!this.player.options.autoPlay,mute:!!this.player.options.mute},this.runner=new ts.Runner(this,this.runnerOptions),this.runnerDeferred.resolve())}},{key:"_onPlayerFullscreen",value:function(){this._onResize("resize")}},{key:"name",get:function(){return"AdsPlugin"}},{key:"defaultOptions",get:function(){return{replayAds:!1,showSlideBlack:!0,removeAdmarkOnError:!0,startTimeout:1e4,skipTimeout:3e3,autoPlayAdBreaks:!0,minDurationShowAd:5}}},{key:"listenEvents",get:function(){return[{name:l.PLAYER_PLAY_INTENT,handler:this._onUserActionEvent},{name:l.PLAYER_TIMEUPDATE,handler:this._onTimeUpdate},{once:!0,name:l.PLAYER_LOADEDMETADATA,handler:this._onLoadedMetadata},{once:!this.pluginOptions.replayAds,name:l.PLAYER_ENDED,handler:this._onPlaybackEnded},{name:l.PLAYER_ERROR,handler:this._onPlayerError},{name:l.PLAYER_AD_PAUSE_REQUEST,handler:this._onAdPauseRequest},{name:l.PLAYER_AD_RESUME_REQUEST,handler:this._onAdResumeRequest},{name:l.PLAYER_UPDATE_SIZE,handler:this._onResize},{name:l.PLAYER_MEDIACONTROL_SHOW,handler:this._onPlayerControlShow},{name:l.PLAYER_MEDIACONTROL_HIDE,handler:this._onPlayerControlHide},{once:!0,name:l.PLAYER_MEDIACONTROL_READY,handler:this._onPlayerControlReady},{name:l.PLAYER_FULLSCREEN,handler:this._onPlayerFullscreen}]}}])&&ys(n.prototype,r),i&&ys(n,i),t}();a(28);function ws(e){return(ws="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ss(e,t){return!t||"object"!==ws(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function As(e){return(As=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ps(e,t){return(Ps=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Os=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Ss(this,As(t).apply(this,arguments))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ps(e,t)}(t,y),n=t,(r=[{key:"setUp",value:function(){this.pluginOptions.disabled&&this.disable()}},{key:"handleClick",value:function(e){return e.stopPropagation(),this.player.play(),this.player.el.focus(),!1}},{key:"_onPlayerPlay",value:function(){this.hide()}},{key:"_onPlayerPause",value:function(){this.pluginOptions.showOnPauseMobile&&this.show()}},{key:"render",value:function(){var e=k("span",{},{class:"--z--icon pl-ic-play_arrow"});return g(e,this.pluginOptions.iconStyles),g(this.el,this.pluginOptions.buttonStyles),this.setAttribute("title","PhÃ¡t"),this.el.append(e),this.player.el.append(this.el),this}},{key:"name",get:function(){return"BigPlayButtonPlugin"}},{key:"tagName",get:function(){return"button"}},{key:"className",get:function(){return"--z--big-play-button"}},{key:"attributes",get:function(){return{class:this.className,type:"button"}}},{key:"events",get:function(){return{click:"handleClick",touch:"handleClick"}}},{key:"listenEvents",get:function(){return[{name:l.PLAYER_PLAY,handler:this._onPlayerPlay},{name:l.PLAYER_PLAY_INTENT,handler:this._onPlayerPlay},{name:l.PLAYER_PAUSE,handler:this._onPlayerPause}]}},{key:"defaultOptions",get:function(){return{showOnPauseMobile:!0}}}])&&_s(n.prototype,r),i&&_s(n,i),t}();a(29);function Cs(e){return(Cs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ls(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ds(e,t){return!t||"object"!==Cs(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function xs(e){return(xs=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Rs(e,t){return(Rs=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Is=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Ds(this,xs(t).apply(this,arguments))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Rs(e,t)}(t,y),n=t,(r=[{key:"setUp",value:function(){this.pluginOptions.disabled||A?this.disable():(this.bigPlayButtonPlugin=this.player.getPlugin("BigPlayButtonPlugin"),this.isPlaying=!this.player.isPlaying(),this.mediaControlDisabled=this.player.mediaControl.disabled,this.bigPlayButtonEnabled=this.bigPlayButtonPlugin.enabled)}},{key:"_disableInterferedPlugins",value:function(){this.bigPlayButtonEnabled&&this.bigPlayButtonPlugin.disable()}},{key:"_onPlayerPlayIntent",value:function(){this._disableInterferedPlugins()}},{key:"_onPlayerClick",value:function(){this.player.isMenuOpen||this._togglePlayPause()}},{key:"_togglePlayPause",value:function(){var e=this;this.isPlaying=!this.isPlaying,g(this.el,{display:"flex"}),setTimeout(function(){g(e.el,{display:"none"})},500),p(this.iconEl,"pl-ic-play_arrow",this.isPlaying),p(this.iconEl,"pl-ic-pause",!this.isPlaying)}},{key:"_onPlayerEnded",value:function(){this.bigPlayButtonEnabled&&this.bigPlayButtonPlugin.enable(),this.mediaControlDisabled||this.player.mediaControl.enable()}},{key:"render",value:function(){return this.iconEl=k("span",{},{class:"--z--icon pl-ic-play_arrow"}),g(this.iconEl,this.pluginOptions.iconStyles),g(this.el,this.pluginOptions.buttonStyles),this.el.append(this.iconEl),this.player.el.append(this.el),this}},{key:"name",get:function(){return"PlayPauseFaceoutPlugin"}},{key:"tagName",get:function(){return"button"}},{key:"className",get:function(){return"--z--playpause-fadeout"}},{key:"attributes",get:function(){return{class:this.className,type:"button"}}},{key:"listenEvents",get:function(){return[{name:l.PLAYER_CLICK,handler:this._onPlayerClick},{name:l.PLAYER_ENDED,handler:this._onPlayerEnded},{name:l.PLAYER_PLAY_INTENT,handler:this._onPlayerPlayIntent}]}}])&&Ls(n.prototype,r),i&&Ls(n,i),t}(),Ms=new Blob([new Uint8Array([255,227,24,196,0,0,0,3,72,1,64,0,0,4,132,16,31,227,192,225,76,255,67,12,255,221,27,255,228,97,73,63,255,195,131,69,192,232,223,255,255,207,102,239,255,255,255,101,158,206,70,20,59,255,254,95,70,149,66,4,16,128,0,2,2,32,240,138,255,36,106,183,255,227,24,196,59,11,34,62,80,49,135,40,0,253,29,191,209,200,141,71,7,255,252,152,74,15,130,33,185,6,63,255,252,195,70,203,86,53,15,255,255,247,103,76,121,64,32,47,255,34,227,194,209,138,76,65,77,69,51,46,57,55,170,170,170,170,170,170,170,170,170,170,255,227,24,196,73,13,153,210,100,81,135,56,0,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170])],{type:"audio/mpeg"}),Fs=new Blob([new Uint8Array([0,0,0,28,102,116,121,112,105,115,111,109,0,0,2,0,105,115,111,109,105,115,111,50,109,112,52,49,0,0,0,8,102,114,101,101,0,0,2,239,109,100,97,116,33,16,5,32,164,27,255,192,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,55,167,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,112,33,16,5,32,164,27,255,192,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,55,167,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,112,0,0,2,194,109,111,111,118,0,0,0,108,109,118,104,100,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,232,0,0,0,47,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,1,236,116,114,97,107,0,0,0,92,116,107,104,100,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,47,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,36,101,100,116,115,0,0,0,28,101,108,115,116,0,0,0,0,0,0,0,1,0,0,0,47,0,0,0,0,0,1,0,0,0,0,1,100,109,100,105,97,0,0,0,32,109,100,104,100,0,0,0,0,0,0,0,0,0,0,0,0,0,0,172,68,0,0,8,0,85,196,0,0,0,0,0,45,104,100,108,114,0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0,0,0,1,15,109,105,110,102,0,0,0,16,115,109,104,100,0,0,0,0,0,0,0,0,0,0,0,36,100,105,110,102,0,0,0,28,100,114,101,102,0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1,0,0,0,211,115,116,98,108,0,0,0,103,115,116,115,100,0,0,0,0,0,0,0,1,0,0,0,87,109,112,52,97,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,2,0,16,0,0,0,0,172,68,0,0,0,0,0,51,101,115,100,115,0,0,0,0,3,128,128,128,34,0,2,0,4,128,128,128,20,64,21,0,0,0,0,1,244,0,0,1,243,249,5,128,128,128,2,18,16,6,128,128,128,1,2,0,0,0,24,115,116,116,115,0,0,0,0,0,0,0,1,0,0,0,2,0,0,4,0,0,0,0,28,115,116,115,99,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,2,0,0,0,1,0,0,0,28,115,116,115,122,0,0,0,0,0,0,0,0,0,0,0,2,0,0,1,115,0,0,1,116,0,0,0,20,115,116,99,111,0,0,0,0,0,0,0,1,0,0,0,44,0,0,0,98,117,100,116,97,0,0,0,90,109,101,116,97,0,0,0,0,0,0,0,33,104,100,108,114,0,0,0,0,0,0,0,0,109,100,105,114,97,112,112,108,0,0,0,0,0,0,0,0,0,0,0,0,45,105,108,115,116,0,0,0,37,169,116,111,111,0,0,0,29,100,97,116,97,0,0,0,1,0,0,0,0,76,97,118,102,53,54,46,52,48,46,49,48,49])],{type:"video/mp4"});function Ns(e){return Object.assign({muted:!1,timeout:250,inline:!1},e)}function js(e,t){var n=e.muted,r=e.timeout,i=e.inline,o=t(),a=o.element,s=o.source,l=void 0,u=void 0,c=void 0;return a.muted=n,!0===n&&a.setAttribute("muted","muted"),!0===i&&a.setAttribute("playsinline","playsinline"),a.src=s,new Promise(function(n){l=a.play(),u=setTimeout(function(){c(!1,new Error("Timeout "+r+" ms has been reached"))},r),c=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;clearTimeout(u),n({result:e,error:t})},void 0!==l?l.then(function(){return c(!0)}).catch(function(e){return c(!1,e)}):c(!0)})}var Us={audio:function(e){return js(e=Ns(e),function(){return{element:document.createElement("audio"),source:URL.createObjectURL(Ms)}})},video:function(e){return js(e=Ns(e),function(){return{element:document.createElement("video"),source:URL.createObjectURL(Fs)}})}};a(30);function Bs(e){return(Bs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Hs(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function $s(e,t){return!t||"object"!==Bs(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Gs(e,t,n){return(Gs="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Vs(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function Vs(e){return(Vs=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ys(e,t){return(Ys=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var zs=function(e){function r(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(n=$s(this,Vs(r).call(this,e))).pluginOptions=t,n.render(),n.bindEvents(),n}var t,n,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ys(e,t)}(r,v),t=r,(n=[{key:"render",value:function(){return Gs(Vs(r.prototype),"render",this).call(this),this.el.innerHTML='<button class="--z--btn-unmute" title=\''.concat(this.pluginOptions.boxUnmute.message,'\'>\n                                <i class="--z--icon pl-ic-volume_off"></i>\n                            </button>\n                            <span>').concat(this.pluginOptions.boxUnmute.message,"</span>"),this.player.el.append(this.el),this}},{key:"handleClick",value:function(e){e.stopPropagation(),this.player.unmute(),this.remove()}},{key:"_update",value:function(){this.player.isMuted()||this.remove()}},{key:"attributes",get:function(){return{class:"--z--unmute-box"}}},{key:"listenEvents",get:function(){return[{name:l.PLAYER_VOLUMEUPDATE,handler:this._update}]}},{key:"events",get:function(){return{click:"handleClick",touch:"handleClick"}}}])&&Hs(t.prototype,n),i&&Hs(t,i),r}();function Ks(e){return(Ks="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ws(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function qs(e,t){return!t||"object"!==Ks(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Xs(e,t,n){return(Xs="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Qs(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function Qs(e){return(Qs=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Js(e,t){return(Js=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Zs=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),qs(this,Qs(t).apply(this,arguments))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Js(e,t)}(t,Ae),n=t,i=[{key:"NAME_EVENTS",get:function(){return["PLUGIN_AUTOPLAY_MUTE"]}}],(r=[{key:"registerMenuCallback",value:function(e){this.menuItemEl=e}},{key:"setUp",value:function(){var r=this;if(this.options.autoPlay&&this.enabled){var t="";switch(this.player.getPlaybackType()){case w.VOD:t="video";break;case w.AOD:t="audio"}t&&Us[t]({timeout:this.pluginOptions.timeout,inline:!0}).then(function(e){e.result?r.player.play():(r.player.mute(),Us[t]({timeout:r.pluginOptions.timeout,muted:!0,inline:!0}).then(function(e){var t=e.result,n=e.error;t?(f.info(r.name,"autoplay muted"),r.player.play(),r.trigger(r._nameEvents.PLUGIN_AUTOPLAY_MUTE),r.pluginOptions.showBoxUnmute&&(r.boxUnmute=new zs(r.player,r.pluginOptions))):(f.warn(r.name,"autoplay failed: ",n),r.player.unmute())}).catch(function(){r.player.unmute()}))}),this.player.getPlayerControl("SettingsControl")&&this.pluginOptions.showInSettingsMenu&&(this.pluginLabel="Tá»± Äá»ng phÃ¡t",this.autoPlayChecked=!!this.options.autoPlay,this.updateSettingsControl())}else this.disable()}},{key:"_toggleAutoPlay",value:function(e){e.stopPropagation(),this.autoPlayChecked=!this.autoPlayChecked,this.updateSettingsControl(!0)}},{key:"updateSettingsControl",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0]?"asyncRegisterMenuItem":"registerMenuItem",t=this.player.getPlayerControl("SettingsControl");t&&t.settingsMenu[e]({pluginKey:this.name,type:x.MENU_TYPE.TOGGLE,config:{title:this.pluginLabel,checked:this.autoPlayChecked,clickCallback:this._toggleAutoPlay.bind(this)},order:0,callback:this.registerMenuCallback.bind(this)})}},{key:"destroy",value:function(){Xs(Qs(t.prototype),"destroy",this).call(this),this.boxUnmute&&this.boxUnmute.remove()}},{key:"name",get:function(){return"AutoPlayPlugin"}},{key:"defaultOptions",get:function(){return{showInSettingsMenu:!1,timeout:1e3,showBoxUnmute:!0,boxUnmute:{message:"Nháº¥n Äá» báº­t tiáº¿ng"}}}}])&&Ws(n.prototype,r),i&&Ws(n,i),t}();function el(e,t){if(E.array(e)&&t){var n=Xt(e.filter(function(e){return!e.disabled}),"label",t);if(E.object(n)&&(n.source||n.level))return n}}function tl(e){return(tl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function nl(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function rl(e,t){return!t||"object"!==tl(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function il(e){return(il=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ol(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function al(e,t,n){return t&&ol(e.prototype,t),n&&ol(e,n),e}function sl(e,t){return(sl=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ll=function(e){function n(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(t=rl(this,il(n).call(this,e))).pluginLabel="Cháº¥t lÆ°á»£ng",t.currentSourceLevel=null,t.autoEnabled=!0,t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&sl(e,t)}(n,y),al(n,[{key:"name",get:function(){return"QualityPlugin"}},{key:"defaultOptions",get:function(){return{autoText:"Auto",autoTextItem:"Auto"}}}]),al(n,[{key:"registerMenuCallback",value:function(e){this.menuItemEl=e}},{key:"render",value:function(){if(this.player.isHlsPlayback())return this.listenTo(this.player,l.PLAYER_LEVELS_AVAILABEL,this.onPlayerLevelsAvailabel),void this.listenTo(this.player,l.PLAYER_LEVEL_SWITCHED,this.onPlayerLevelSwitched);if(this.autoEnabled=!1,this.levels=this.player.options.sources||[],this.handleDisplayName(),this.currentSourceLevel=void 0!==this.player.options.currentSourceLevel?this.findIndexFromSourceLevels(this.player.options.currentSourceLevel):0,this.levels.length<2||-1===this.currentSourceLevel)this.disable();else{this.levels=this.orderLevelsByIndex(this.levels),this.handleDisplayName();var e=this.levels[this.currentSourceLevel];this.settingBadgeLabel=this._generateHdLabel(e.label),this.updateSettingsControl()}}},{key:"updateSettingsControl",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0]?"asyncRegisterMenuItem":"registerMenuItem",t=this.player.mediaControl.getControl("SettingsControl");t&&(t.settingsButton.updateBadgeLabel(this.settingBadgeLabel),t.settingsMenu[e]({pluginKey:this.name,type:x.MENU_TYPE.EXPAND,config:{title:this.pluginLabel,activeItemIndex:this.currentSourceLevel,clickCallback:this.handleExpandQuality.bind(this),subMenu:{type:x.LIST_MENU_TYPE.CHECKLIST,clickCallback:this.handleQualitySelected.bind(this),titleClickCallback:this.titleClickCallback.bind(this),data:this.levels}},order:0,callback:this.registerMenuCallback.bind(this)}))}},{key:"handleDisplayName",value:function(){var e=this.pluginOptions,n=e.displayName,r=e.autoTextItem;(n||r)&&this.levels.map(function(e){if(n&&e.label){var t=n[e.label];t&&(e.displayName=t)}return"auto"==e.label.toLowerCase()&&(e.label=r),e})}},{key:"orderLevelsByIndex",value:function(e){return qt(e,"index",!1)}},{key:"onPlayerLevelsAvailabel",value:function(e){var t=this.player.options.sources||[];this.levels=this.orderLevelsByIndex([].concat(nl(e),nl(t))),this.handleDisplayName();var n=el(this.levels,this.player.options.quality);n&&(this.player.options.currentSourceLevel=n.index,this.settingBadgeLabel=this._generateHdLabel(n.label),this.offAuto=!0),this.currentSourceLevel=void 0!==this.player.options.currentSourceLevel?this.findIndexFromSourceLevels(this.player.options.currentSourceLevel):this.findIndexFromSourceLevels(-1);var r=this.levels[this.currentSourceLevel];r&&-1!==r.index&&this.handleHLSLevelSelect(r)}},{key:"findIndexFromSourceLevels",value:function(e){return Jt(this.levels,"index",e)}},{key:"_generateHdLabel",value:function(e){var t=parseInt(e);return this.currentLabel=e,t>=720?"HD":""}},{key:"onPlayerLevelSwitched",value:function(e){var t=e.label;this.currentSwitchedLabel=t,clearTimeout(this.playerLevelSwitchedTimeout),!this.offAuto&&(this.settingBadgeLabel=this._generateHdLabel(t)),this.updateSettingsControl(!0);var n=Oe()(this.menuItemEl).find(".--z--zpl-has-expand span"),r=this.pluginOptions.autoText;this.autoEnabled&&(n.empty(),n.text(r+" "+this.transformDisplayNameLabel(t)))}},{key:"titleClickCallback",value:function(){var e=Oe()(this.menuItemEl).find(".--z--zpl-has-expand span"),t=this.pluginOptions.autoText;this.autoEnabled&&(e.empty(),e.text(t+" "+this.transformDisplayNameLabel(this.currentLabel)))}},{key:"transformDisplayNameLabel",value:function(e){var t=this.pluginOptions.displayName;return t&&t[e]||e}},{key:"handleQualitySelected",value:function(e,t){e.stopPropagation();var n=t.data;if(this.player.trigger(l.PLAYER_QUALITY_LEVELS_SELECTED,n,t),this.player.trigger(l.PLAYER_SETTINGS_MENU_HIDE),n&&!n.disabled){var r=this.findIndexFromSourceLevels(n.index);if(this.currentSourceLevel===r)return!1;this.player.storage.set({quality:n.label}),this.player.isHlsPlayback()?this.handleHLSLevelSelect(n):this.handleMP4QualitySelect(n)}}},{key:"handleMP4QualitySelect",value:function(e){var t=this.player.getCurrentTime(),n=this.player.isPlaying();this.player.stop(),this.player.setupSource(e.source),this.player.setPreload("metadata"),n&&this.listenToOnce(this.player,l.PLAYER_SEEKED,this.onPlayerSeeked),this.player.seek(t),this.currentSourceLevel=this.findIndexFromSourceLevels(e.index),this.settingBadgeLabel=this._generateHdLabel(e.label),this.autoEnabled=!1,this.updateSettingsControl(!0)}},{key:"onPlayerSeeked",value:function(){this.player.play()}},{key:"handleHLSLevelSelect",value:function(e){var t=this,n=e.index,r=-1===n;r&&(this.offAuto=!1),this.currentSourceLevel=this.findIndexFromSourceLevels(n),this.autoEnabled=r,this.player.setCurrentLevel(n),this.player.setStartLevel(n),this.playerLevelSwitchedTimeout=setTimeout(function(){t.onPlayerLevelSwitched({label:t.currentSwitchedLabel})},1e3)}},{key:"handleExpandQuality",value:function(e){e.stopPropagation()}}]),n}();a(31);function ul(e){return(ul="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function cl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function fl(e,t){return!t||"object"!==ul(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function dl(e){return(dl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function hl(e,t){return(hl=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var pl=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),fl(this,dl(t).apply(this,arguments))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&hl(e,t)}(t,y),n=t,(r=[{key:"setUp",value:function(){this.pluginOptions.disabled&&this.disable()}},{key:"dvrChanged",value:function(){f.info(this.name,"dvrChanged"),this.addDvrToMediaControls()}},{key:"addDvrToMediaControls",value:function(){if(this.player.isLive()){var e=k("button",{innerHTML:'<span class="icon-live"></span><span class="text">LIVE</span>'},{class:"--z--control --z--btn --z--drv-icon"});this.$el.append(e),this.player.mediaControl.leftElement.append(this.el)}}},{key:"name",get:function(){return"DVRControlsPlugin"}},{key:"attributes",get:function(){return{class:"--z--control --z--control-dvr","data-dvr-controls":""}}},{key:"listenEvents",get:function(){return[{once:!0,name:l.PLAYER_DVRSTATECHANGED,handler:this.dvrChanged}]}}])&&cl(n.prototype,r),i&&cl(n,i),t}();function gl(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var vl=function e(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.playbackPlugins=[mn,cn,Wt,_n],this.plugins=[],n&&this.plugins.push(No);var r=[Vo,Os,Is,Wa,es,Zs,Jo,Ma,$a,ks,pl,ll];if(this.plugins=[].concat(gl(this.plugins),r),this.plugins.push(Pa),!E.empty(t)){var i=!0,o=!1,a=void 0;try{for(var s,l=t[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var u=s.value;E.function(u)&&this.plugins.push(u)}}catch(e){o=!0,a=e}finally{try{i||null==l.return||l.return()}finally{if(o)throw a}}}},yl=function(e,t,n){this.namespaces||(this.namespaces={}),this.namespaces[e]=t;var r=n||!1;return this.addEventListener(e.split(".")[0],t,r),this},ml=function(e){return this.removeEventListener(e.split(".")[0],this.namespaces[e]),delete this.namespaces[e],this};function bl(e){return(bl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function El(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Tl(e,t){return!t||"object"!==bl(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function kl(e){return(kl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function wl(e,t){return(wl=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}window.on=document.on=Element.prototype.on=yl,window.off=document.off=Element.prototype.off=ml;var _l=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Tl(this,kl(t).apply(this,arguments))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wl(e,t)}(t,y),n=t,(r=[{key:"getControl",value:function(){return null}},{key:"show",value:function(){}},{key:"hide",value:function(){}}])&&El(n.prototype,r),i&&El(n,i),t}();function Sl(e){return(Sl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Al(e,t,n){return(Al="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Pl(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function Pl(e){return(Pl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ol(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Cl(e,t,n){return t&&Ol(e.prototype,t),n&&Ol(e,n),e}function Ll(e,t){return(Ll=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function M(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Dl={mute:!1,loop:!1,autoPlay:!1,volume:100,height:360,width:640,preload:"metadata",dblClickToFullScreen:!0,lockRotateFullscreen:!1,setStorageTheaterMode:!0},xl=function(e){function a(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a);var n,r,i=e.storageKey,o=new ma(void 0===i?"zplayer":i);return n=this,(t=!(r=Pl(a).call(this,null,d({},Dl,e,o.get())))||"object"!==Sl(r)&&"function"!=typeof r?M(n):r)._extendsOptions(t.options),f.debug(t.name,"player initialized with option:",e),t.storage=o,t.plugins=[],t._onFullScreenChanged=t._onFullScreenChanged.bind(M(M(t))),t.onWindowBlur=t.onWindowBlur.bind(M(M(t))),t._onOrientationChanged=t._onOrientationChanged.bind(M(M(t))),t.isMenuOpen=!1,t.theaterMode=!!t.options.theaterMode,t.toggleClass("--theater-mode",t.theaterMode),t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ll(e,t)}(a,v),Cl(a,[{key:"name",get:function(){return"Player"}},{key:"attributes",get:function(){var e=this.options,t=e.width,n=e.height;return{class:e.className||"--z--player","data-player":"",tabindex:1,style:"\n                width: ".concat(t&&E.number(t)?t+"px":t,";\n                height: ").concat(n&&E.number(n)?n+"px":n,"\n            ")}}},{key:"events",get:function(){return{click:"onClicked",dblclick:"onDblClicked",contextmenu:"onContextMenu",keydown:"onKeydown",mousemove:"onMouseMove",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchstart:"onMouseMove",touchleave:"onMouseLeave"}}},{key:"listenEvents",get:function(){return[{name:l.PLAYBACK_BUFFERING,handler:this.onBuffering},{name:l.PLAYBACK_BUFFERING_CHANGE,handler:this.onBufferingChange},{name:l.PLAYBACK_BUFFERFULL,handler:this.onBufferfull},{name:l.PLAYBACK_LOADEDMETADATA,handler:this.onLoadedMetadata},{name:l.PLAYBACK_TIMEUPDATE,handler:this.onTimeUpdated},{name:l.PLAYBACK_PROGRESS,handler:this.onProgress},{name:l.PLAYBACK_SEEKED,handler:this.onSeeked},{name:l.PLAYBACK_SEEKING,handler:this.onSeeking},{name:l.PLAYBACK_ENDED,handler:this.onEnded},{name:l.PLAYBACK_PLAY,handler:this.onPlay},{name:l.PLAYBACK_PAUSE,handler:this.onPaused},{name:l.PLAYBACK_STOP,handler:this.onStopped},{name:l.PLAYBACK_ERROR,handler:this.onError},{name:l.PLAYBACK_VOLUMEUPDATE,handler:this.onVolumeUpdated},{name:l.PLAYBACK_LEVELS_AVAILABLE,handler:this.onLevelsAvailabel},{name:l.PLAYBACK_LEVEL_SWITCHED,handler:this.onLevelSwitched},{name:l.PLAYBACK_FULLSCREEN_IOS,handler:this._onFullScreenIosChanged},{name:l.PLAYBACK_CANPLAYTHROUGH,handler:this.onCanPlayThrough},{name:l.PLAYBACK_WAITING,handler:this.onWaiting},{once:!0,name:l.PLAYBACK_DVRSTATECHANGED,handler:this.onDrvChanged},{once:!0,name:l.PLAYBACK_PLAY,handler:this.onDrvChanged}]}},{key:"buffering",get:function(){return this.playback.buffering}},{key:"loader",set:function(e){this.loader=e},get:function(){return this._loader||(this._loader=new vl(this.options.plugins,this.options.useDefaultControl)),this._loader}},{key:"mediaControl",get:function(){return this.getPlugin("ControlsPlugin")||this.dummyMediaControl}},{key:"dummyMediaControl",get:function(){return this._dummyMediaControl?this._dummyMediaControl:(this._dummyMediaControl=new _l(this),this._dummyMediaControl)}}]),Cl(a,[{key:"bindEvents",value:function(){Al(Pl(a.prototype),"bindEvents",this).call(this,this.playback),this._addEventsFullScreen(),window.on("orientationchange",this._onOrientationChanged,!1),window.on("blur",this.onWindowBlur,!1)}},{key:"unbindEvents",value:function(){Al(Pl(a.prototype),"unbindEvents",this).call(this,this.playback),this._removeEventsFullScreen(),window.off("orientationchange",this._onOrientationChanged,!1),window.off("blur",this.onWindowBlur,!1)}},{key:"hasPlugin",value:function(e){return!!this.getPlugin(e)}},{key:"getPlugin",value:function(t){return this.plugins.find(function(e){return e.name===t})}},{key:"removePlugin",value:function(t){this.plugins=this.plugins.filter(function(e){return e.name!==t})}},{key:"getPlaybackType",value:function(){return this.playback.getPlaybackType()}},{key:"getPlaybackName",value:function(){return this.playback.name}},{key:"appendToParent",value:function(){if(!this.el)return null;this.options.parentElement.appendChild(this.el)}},{key:"render",value:function(){if(!this.el)return null;this.$el.append(this.playback.render().el)}},{key:"destroy",value:function(){this.plugins.forEach(function(e){return e.destroy()}),this.playback.destroy(),this.unbindEvents(),this.remove()}},{key:"attachTo",value:function(e){var t=this;this.options.parentElement=e,this._initPlayback(),this.bindEvents(),this.render(),this._initPlugins(),this.appendToParent(),this.playback.isReady().then(function(){return t._initConfig()}).then(function(){return Promise.all(t.plugins.map(function(e){return e.initialize()}))}).then(function(){f.info(t.name,"IS LIVE",t.isLive()),t.trigger(l.PLAYER_READY,t.name)}).catch(function(e){f.error(t.name,"error while initializing player:",e)}),this.setPlayerFontSizeBase()}},{key:"getDuration",value:function(){return this.playback.getDuration()}},{key:"isPlaying",value:function(){return this.playback.isPlaying()}},{key:"play",value:function(){this.isPlaying()||(this.trigger(l.PLAYER_PLAY_INTENT),this.playback.play())}},{key:"pause",value:function(){this.isPlaying()&&this.playback.pause()}},{key:"togglePlay",value:function(){this.buffering||(this.isPlaying()?this.pause():this.play())}},{key:"stop",value:function(){this.playback.stop()}},{key:"pauseAd",value:function(){this.trigger(l.PLAYER_AD_PAUSE_REQUEST)}},{key:"resumeAd",value:function(){this.trigger(l.PLAYER_AD_RESUME_REQUEST)}},{key:"getVolume",value:function(){return this.playback.getVolume()}},{key:"setVolume",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!E.number(e)||e<0||e>100)f.debug(this.name,"setVolume fail , volume = ",e);else{var n=this.getVolume();this.playback.volume(e),t&&this.storage.set({volume:e,beforeMuteVolume:n})}}},{key:"mute",value:function(e){return this.setVolume(0,e),this}},{key:"unmute",value:function(e){var t=this.storage.get("beforeMuteVolume");return(!E.number(t)||t<=0)&&(t=1),this.setVolume(100*t,e),this}},{key:"isMuted",value:function(){return this.playback.isMuted()}},{key:"seek",value:function(e){this.isLive()||e<0||e>this.getDuration()||(this.trigger(l.PLAYER_SEEK,e,this.name),this.playback.seek(e))}},{key:"isFullscreen",value:function(){return D.isFullscreen()}},{key:"isTheaterMode",value:function(){return this.theaterMode}},{key:"setupSource",value:function(e){this.playback.setupSource(e)}},{key:"getSource",value:function(){this.playback.getSource()}},{key:"setCurrentLevel",value:function(e){this.playback.currentLevel=e}},{key:"setStartLevel",value:function(e){this.playback.startLevel=e}},{key:"setPreload",value:function(e){this.playback.setPreload(e)}},{key:"getPlayerControl",value:function(e){return this.mediaControl&&this.mediaControl.getControl(e)}},{key:"setPlaybackRate",value:function(e){this.playback.setPlaybackRate(e)}},{key:"isHlsPlayback",value:function(){return this.playback.isHlsPlayback()}},{key:"isMp4Playback",value:function(){return!this.isHlsPlayback()}},{key:"seekPercentage",value:function(e){var t=this.getDuration();if(e>=0&&e<=100){var n=t*(e/100);this.seek(n)}}},{key:"setPlayerFontSizeBase",value:function(){A&&g(this.el,{fontSize:(this.isFullscreen()?70:60)+"%"})}},{key:"toggleFullscreen",value:function(){var e=this.options,t=e.customIosFullscreen;e.lockRotateFullscreen&&(this.isLandscapeScreen()?S&&this.removeClass("is-portrait"):(S&&this.addClass("--z--orient-lock-fullscreen"),S&&this.addClass("is-portrait"),setTimeout(function(){screen&&screen.orientation.lock("landscape")},300)),this.isFullscreen()&&(S&&this.removeClass("--z--orient-lock-fullscreen"),S&&this.removeClass("is-portrait"),setTimeout(function(){return screen&&screen.orientation.unlock()},300))),t?this._toggleFullScreenIos():this._toggleFullScreenNative()}},{key:"isLandscapeScreen",value:function(){return window.innerWidth>window.innerHeight}},{key:"getPlayBack",value:function(){return function(e,t,n){var r=null,i=n.mimeType;E.object(t)?(r=t.source.toString(),t.mimeType&&(i=t.mimeType)):r=t.toString(),r.match(/^\/\//)&&(r=window.location.protocol+r);var o=d({},n,{src:r,mimeType:i}),a=e.filter(function(e){return e.canPlay(t,i)})[0];return"no_op"===a.name&&n.fallbackSrc&&(a=e.filter(function(e){return e.canPlay(n.fallbackSrc,i)})[0]),new a(o)}(this.loader.playbackPlugins,this.options.source,this.options)}},{key:"isLive",value:function(){return this.getPlaybackType()===w.LIVE}},{key:"getCurrentTime",value:function(){return this.playback.el.currentTime}},{key:"getPlayerSize",value:function(){return{width:this.el.offsetWidth,height:this.el.offsetHeight}}},{key:"updateSize",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"px",r={};e&&(r.width=e+n),t&&(r.height=t+n),g(this.el,r),this.trigger(l.PLAYER_UPDATE_SIZE,this.el.offsetWidth,this.el.offsetHeight,this.isFullscreen())}},{key:"onClicked",value:function(){f.debug(this.name,"onClicked"),this.trigger(l.PLAYER_CLICK,this,this.name)}},{key:"onDblClicked",value:function(){this.trigger(l.PLAYER_DBLCLICK,this,this.name)}},{key:"onKeydown",value:function(e){this.trigger(l.PLAYER_KEYDOWN,e,this.name)}},{key:"onMouseEnter",value:function(){this.trigger(l.PLAYER_MOUSE_ENTER)}},{key:"onMouseLeave",value:function(){this.trigger(l.PLAYER_MOUSE_LEAVE)}},{key:"onMouseMove",value:function(){this.trigger(l.PLAYER_MOUSE_MOVE)}},{key:"onContextMenu",value:function(e){this.trigger(l.PLAYER_CONTEXTMENU,e,this.name)}},{key:"onBuffering",value:function(){this.trigger(l.PLAYER_BUFFERING,this.name)}},{key:"onBufferingChange",value:function(e){this.trigger(l.PLAYER_BUFFERING_CHANGE,e)}},{key:"onBufferfull",value:function(){this.trigger(l.PLAYER_BUFFERFULL,this.name)}},{key:"onLoadedMetadata",value:function(e){this.trigger(l.PLAYER_LOADEDMETADATA,e)}},{key:"onTimeUpdated",value:function(e){this.currentTime=e.current,this.trigger(l.PLAYER_TIMEUPDATE,e,this.name)}},{key:"onSeeked",value:function(){this.trigger(l.PLAYER_SEEKED,this.name)}},{key:"onSeeking",value:function(e){this.currentTime=e.data.target.currentTime,this.trigger(l.PLAYER_SEEKING,e)}},{key:"onWaiting",value:function(e){this.trigger(l.PLAYER_WAITING,e)}},{key:"onPlay",value:function(){f.debug(this.name,"PLAYER_PLAY"),this.trigger(l.PLAYER_PLAY,this.name)}},{key:"onPaused",value:function(){f.debug(this.name,"PLAYER_PAUSE"),this.trigger(l.PLAYER_PAUSE,this.name)}},{key:"onError",value:function(e){f.error(this.name,"player error:",e),this.trigger(l.PLAYER_ERROR,e,this.name)}},{key:"onStopped",value:function(){this.trigger(l.PLAYER_STOP)}},{key:"onEnded",value:function(){this.trigger(l.PLAYER_ENDED,this.name),this.currentTime=0}},{key:"onVolumeUpdated",value:function(e){this.trigger(l.PLAYER_VOLUMEUPDATE,e)}},{key:"onLevelsAvailabel",value:function(e){this.trigger(l.PLAYER_LEVELS_AVAILABEL,e)}},{key:"onLevelSwitched",value:function(e){this.trigger(l.PLAYER_LEVEL_SWITCHED,e)}},{key:"onCanPlayThrough",value:function(e){this.trigger(l.PLAYER_CANPLAYTHROUGH,e)}},{key:"onProgress",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.trigger.apply(this,[l.PLAYER_PROGRESS].concat(t,[this.name]))}},{key:"onDrvChanged",value:function(){this.trigger(l.PLAYER_DVRSTATECHANGED)}},{key:"onWindowBlur",value:function(){A&&this.options.pauseOnBlur&&this.pause()}},{key:"_addEventsFullScreen",value:function(){document.on("webkitfullscreenchange",this._onFullScreenChanged,!1),document.on("mozfullscreenchange",this._onFullScreenChanged,!1),document.on("fullscreenchange",this._onFullScreenChanged,!1),document.on("MSFullscreenChange",this._onFullScreenChanged,!1)}},{key:"_removeEventsFullScreen",value:function(){document.off("webkitfullscreenchange",this._onFullScreenChanged,!1),document.off("mozfullscreenchange",this._onFullScreenChanged,!1),document.off("fullscreenchange",this._onFullScreenChanged,!1),document.off("MSFullscreenChange",this._onFullScreenChanged,!1)}},{key:"_onFullScreenIosChanged",value:function(e){f.debug(this.name,"fullscreen status changed on iOS:",e),D.isFullscreenIos=e,this._onFullScreenChanged()}},{key:"_onFullScreenChanged",value:function(){f.debug(this.name,"fullscreen status changed:",this.isFullscreen()),this.isFullscreen()?this.$el.addClass("--z--full-screen"):this.$el.removeClass("--z--full-screen"),this.setPlayerFontSizeBase(),this.trigger(l.PLAYER_FULLSCREEN,this.isFullscreen(),this.name)}},{key:"_onOrientationChanged",value:function(){var e=this,t=this.options,n=t.customIosFullscreen,r=t.lockRotateFullscreen;this.setPlayerFontSizeBase(),n&&this.isFullscreen()&&this.backdropEl&&g(this.backdropEl,{height:window.innerHeight+"px"}),r&&this.isFullscreen()&&S&&setTimeout(function(){e.isLandscapeScreen()?(e.removeClass("--z--orient-lock-fullscreen"),e.removeClass("is-portrait")):(e.addClass("is-portrait"),e.addClass("--z--orient-lock-fullscreen"))},300),this.trigger(l.PLAYER_ORIENTATION_CHANGE,this.isFullscreen())}},{key:"_initPlayback",value:function(){this.playback=this.getPlayBack(),f.debug(this.name,"found playback",this.getPlaybackName()),f.debug(this.name,"found playbacktype",this.getPlaybackType())}},{key:"_initConfig",value:function(){var e=this.options.mute?0:this.options.volume;this.setVolume(e)}},{key:"_initPlugins",value:function(){var t=this;E.empty(this.loader.plugins)||this.loader.plugins.forEach(function(e){t.plugins.push(new e(t))})}},{key:"_extendsOptions",value:function(e){var t=el(e.sources,e.quality);t&&(e.source=t.source,e.currentSourceLevel=t.index)}},{key:"_onTouchMove",value:function(e){e.preventDefault(),e.stopPropagation()}},{key:"_toggleFullScreenIos",value:function(){this.backdropEl=this.backdropEl||k("div",{},{class:"--z--player-backdrop"}),this.isFullscreen()?(this.removeClass("--z--custom-ios-fullscreen"),this.options.parentElement.append(this.el),this.backdropEl.innerHTML="",p(this.backdropEl,"--z--show"),D.isFullscreenIos=!1,this.scrollTopPos&&window.scrollTo(0,this.scrollTopPos)):(this.scrollTopPos=this.scrollTopPos||window.scrollY,window.scrollTo(0,0),this.addClass("--z--custom-ios-fullscreen"),g(this.backdropEl,{height:window.innerHeight+"px"}),this.backdropEl.append(this.el),document.body.append(this.backdropEl),p(this.backdropEl,"--z--show"),D.isFullscreenIos=!0),this.setPlayerFontSizeBase(),this.trigger(l.PLAYER_FULLSCREEN,this.isFullscreen())}},{key:"_toggleFullScreenNative",value:function(){this.isFullscreen()?D.cancelFullscreen():D.requestFullscreen(this.el)}},{key:"toggleTheaterMode",value:function(){this.theaterMode=!this.theaterMode,this.toggleClass("--theater-mode",this.theaterMode),this.options.setStorageTheaterMode&&this.storage.set({theaterMode:this.theaterMode}),this.trigger(l.PLAYER_THEATER_MODE_CHANGE,this.theaterMode)}},{key:"mediaControlReady",value:function(){f.debug(this.name,"mediaControlReady"),this.trigger(l.PLAYER_MEDIACONTROL_READY,this.name)}},{key:"disableMediaControl",value:function(){this.trigger(l.PLAYER_MEDIACONTROL_DISABLE,this.name)}},{key:"enableMediaControl",value:function(){this.trigger(l.PLAYER_MEDIACONTROL_ENABLE,this.name)}},{key:"showMediaControl",value:function(){this.trigger(l.PLAYER_MEDIACONTROL_SHOW,this.name)}},{key:"hideMediaControl",value:function(){this.trigger(l.PLAYER_MEDIACONTROL_HIDE,this.name)}}]),a}();function Rl(i){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:400,a=arguments.length>2?arguments[2]:void 0;i.style.opacity||(i.style.opacity=1);var s=null;window.requestAnimationFrame(function e(t){var n=t-(s=s||t),r=parseFloat(1-n/o,2);i.style.opacity=r<0?0:r,n>o?E.function(a)&&a():window.requestAnimationFrame(e)})}function Il(i){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:400,a=arguments.length>2?arguments[2]:void 0;i.style.opacity||(i.style.opacity=0);var s=null;window.requestAnimationFrame(function e(t){var n=t-(s=s||t),r=parseFloat(n/o,2);i.style.opacity=r>1?1:r,n>o?E.function(a)&&a():window.requestAnimationFrame(e)})}a.d(e,"AdRunner",function(){return Ml}),a.d(e,"Constant",function(){return Fl}),a.d(e,"PromiseUtils",function(){return N}),a.d(e,"AdUtils",function(){return j}),a.d(e,"AnimationUtils",function(){return B}),a.d(e,"ArraysUtils",function(){return i}),a.d(e,"BaseObject",function(){return ue}),a.d(e,"BasePlugin",function(){return Ae}),a.d(e,"BrowserUtils",function(){return r}),a.d(e,"DomUtils",function(){return n}),a.d(e,"Events",function(){return l}),a.d(e,"HttpUtils",function(){return U}),a.d(e,"IsUtils",function(){return E}),a.d(e,"Log",function(){return f}),a.d(e,"ObjectUtils",function(){return t}),a.d(e,"Player",function(){return xl}),a.d(e,"Storage",function(){return ma}),a.d(e,"StringsUtils",function(){return s}),a.d(e,"TimeUtils",function(){return o}),a.d(e,"UIObject",function(){return v}),a.d(e,"UIPlugin",function(){return y});var Ml=null;Ml=a(4);var Fl={MediaControlConst:{BG_TYPE_TRANSPARENT:"transparent",BG_TYPE_GRADIENT:"gradient",THEME:{RED:"red",BLUE:"blue",PURPLE:"purple",GREEN:"green",LIGHT_BLUE:"light_blue"},MAP_THEME_COLOR:{RED:"#f00",BLUE:"#2FA1B3",PURPLE:"#721799",GREEN:"#6cd936",LIGHT_BLUE:"#2196F3"}},SettingsMenuConst:x};f.setLevel(f.LEVEL_DISABLED)}])});var base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){var t,n,r,i,o,a,s,l="",u=0;for(e=base64._utf8_encode(e);u<e.length;)t=e.charCodeAt(u++),n=e.charCodeAt(u++),r=e.charCodeAt(u++),i=t>>2,o=(3&t)<<4|n>>4,a=(15&n)<<2|r>>6,s=63&r,isNaN(n)?a=s=64:isNaN(r)&&(s=64),l=l+this._keyStr.charAt(i)+this._keyStr.charAt(o)+this._keyStr.charAt(a)+this._keyStr.charAt(s);return l},decode:function(e){var t,n,r,i,o,a,s,l="",u=0;for(e=e.replace(/[^A-Za-z0-9+/=]/g,"");u<e.length;)i=this._keyStr.indexOf(e.charAt(u++)),o=this._keyStr.indexOf(e.charAt(u++)),a=this._keyStr.indexOf(e.charAt(u++)),s=this._keyStr.indexOf(e.charAt(u++)),t=i<<2|o>>4,n=(15&o)<<4|a>>2,r=(3&a)<<6|s,l+=String.fromCharCode(t),64!==a&&(l+=String.fromCharCode(n)),64!==s&&(l+=String.fromCharCode(r));return base64._utf8_decode(l)},_utf8_encode:function(e){e=e.replace(/rn/g,"n");var t,n;for(t="",n=0;n<e.length;n++){var r=e.charCodeAt(n);128>r?t+=String.fromCharCode(r):r>127&&2048>r?(t+=String.fromCharCode(r>>6|192),t+=String.fromCharCode(63&r|128)):(t+=String.fromCharCode(r>>12|224),t+=String.fromCharCode(r>>6&63|128),t+=String.fromCharCode(63&r|128))}return t},_utf8_decode:function(e){var t,n,r,i,o;for(r="",i=0,o=t=0;i<e.length;)o=e.charCodeAt(i),128>o?(r+=String.fromCharCode(o),i++):o>191&&224>o?(t=e.charCodeAt(i+1),r+=String.fromCharCode((31&o)<<6|63&t),i+=2):(t=e.charCodeAt(i+1),n=e.charCodeAt(i+2),r+=String.fromCharCode((15&o)<<12|(63&t)<<6|63&n),i+=3);return r}};var windowHeight=$(window).height();var windowWidth=$(window).width();function loadPlugin(e,t,n){var r=window.cmsConfig.domainStatic+"/js";if($("body").hasClass(e)){if(n)n();return}var i=t.search("http")<0?r+t:t;$.getScript(i,function(){$("body").addClass(e);if(n)n()})}function loadStyle(e,t){var n=$("#"+e);if(n.length>0)return;n=$("<link>",{rel:"stylesheet",type:"text/css",href:t,media:"all",id:e});$("head").append(n)}function getTitle(e){e=e.toString();if(e.indexOf("|")>0){e=e.substr(0,e.lastIndexOf("|")-1)}if(e.indexOf("|")>0){e=e.substr(0,e.lastIndexOf("|")-1)}return e}function openInNewTab(e){var t=window.open(e,"_blank");t.focus()}function getUrlParameter(e){var t=decodeURIComponent(window.location.search.substring(1)),n=t.split("&"),r,i;for(i=0;i<n.length;i++){r=n[i].split("=");if(r[0]===e){return r[1]===undefined?true:r[1]}}}function getNumberStr(e){return e<10?"0"+e:e}function getWeekDay(e){switch(e){case 1:return"Thá»© Hai";case 2:return"Thá»© Ba";case 3:return"Thá»© TÆ°";case 4:return"Thá»© NÄm";case 5:return"Thá»© SÃ¡u";case 6:return"Thá»© Báº£y";case 0:return"Chá»§ Nháº­t"}}function removeDangerousTag(e){var t=""+e;t=t.replace(/&nbsp;/gi," ");t=t.replace(/&amp;/gi,"&");t=t.replace(/&quot;/gi,'"');t=t.replace(/&lt;/gi,"<");t=t.replace(/&gt;/gi,">");t=t.replace(/<br>/gi," ");t=t.replace(/<br\s\/>/gi," ");t=t.replace(/<br\/>/gi," ");t=t.replace(/<p.*>/gi," ");t=t.replace(/<a.*href="(.*?)".*>(.*?)<\/a>/gi," $2 ");t=t.replace(/<script.*>[\w\W]{1,}(.*?)[\w\W]{1,}<\/script>/gi," ");t=t.replace(/<script.*src\s*=\s*[\"']?([^\"']+)[\"']?[^\<>]/gi,"$1");t=t.replace(/<style.*>[\w\W]{1,}(.*?)[\w\W]{1,}<\/style>/gi," ");t=t.replace(/<style.*src\s*=\s*[\"']?([^\"']+)[\"']?[^\<>]/gi,"$1");t=t.replace(/<(?:.|\s)*?>/g," ");t=t.replace(/(?:(?:\r\n|\r|\n)\s*){2,}/gim," ");t=t.replace(/ +(?= )/g," ");t=t.replace(/</gi,"");t=t.replace(/>/gi,"");t=t.replace(/onerror/gi,"");t=t.replace(/prompt/gi,"");t=t.replace(/throw/gi,"");t=t.replace(/alert/gi,"");t=t.replace(/mouseover/gi,"");t=t.replace(/mouseout/gi,"");t=t.replace(/onhover/gi,"");t=t.replace(/function/gi,"");t=t.replace(/onfocus/gi,"");t=t.replace(/onblur/gi,"");t=t.replace(/=/gi,"");t=t.replace(/;/gi,"");t=t.replace(/%/gi,"").replace(/\+/gi,"").replace(/!/gi,"").replace(/\(/gi,"").replace(/\)/gi,"").replace(/'/gi,"");return t}function stickyBox(r,e,i,o,a){var t=$(r).height();var n=$(e).height();if(n<=t){var s=$(e).width();$(window).scroll(function(){var e=$(window).scrollTop();var t=e-a;if($(i).length>0){t=e-$(i).offset().top-$(i).height()}var n=e-$(r).offset().top-$(r).height()+$(o).height()+a;if(t>0){$(o).css("position","fixed");$(o).css("top",a+"px");$(o).css("width",s+"px");$(o).css("margin","0 auto")}else{$(o).removeAttr("style")}if(n>0)$(o).css("top",-1*n)})}}function buildJustifiedGallery(){if($(".image-group .images").length<=0){return}$(".image-group .images img").each(function(){var e=$(this).attr("src");if(e.indexOf("data:image")>=0&&$(this).attr("data-src").length>0){$(this).attr("src",$(this).attr("data-src"))}});loadStyle("justified-gallery-css","https://cdnjs.cloudflare.com/ajax/libs/justifiedGallery/3.8.1/css/justifiedGallery.min.css");loadPlugin("justified-gallery-js","https://cdnjs.cloudflare.com/ajax/libs/justifiedGallery/3.8.1/js/jquery.justifiedGallery.min.js",function(){$('.image-group .images:not(".justified-gallery")').justifiedGallery({rowHeight:$(".emagazine, .longform, .emag").length>0?200:300,lastRow:"justify",selector:"a, figure",imgSelector:"> img, > a > img, > svg, > a > svg",captions:false,randomize:false})})}function photoCompare(){var e=$(".twentytwenty-container");if(e.length<=0){return}loadStyle("photo_twentytwenty",window.cmsConfig.domainStatic+"/js/twentytwenty/css/twentytwenty.css");loadPlugin("compare","/twentytwenty/jquery.event.move.js",function(){loadPlugin("twentytwenty","/twentytwenty/jquery.twentytwenty.js",function(){$(".twentytwenty-container[data-orientation!='vertical']").twentytwenty({default_offset_pct:.7});$(".twentytwenty-container[data-orientation='vertical']").twentytwenty({default_offset_pct:.3,orientation:"vertical"})})})}function photoSwipe(){if($(".cms-body").length<=0)return;loadStyle("photoswipe_css",window.cmsConfig.domainStatic+"/js/photoswipe/photoswipe.css");loadStyle("photoswipe_css_default",window.cmsConfig.domainStatic+"/js/photoswipe/default-skin/default-skin.css");var o=0;$(".cms-body img").wrap(function(e){if($(this).parent("a").length||$(this).parents(".long-form, .article__story, .aside-img, .zone--aside, .slider, .box-collapse, .banner, .article-hot-video, .twentytwenty-container, .story--horizontal").length){return}var t=$(this).attr("src");if(t.indexOf("data:image")>=0&&$(this).attr("data-src").length>0){t=$(this).attr("data-src")}if(typeof t!=="undefined"&&t.length>0){t=t.replace("w645","w1000").replace("cw645","cw1000");var n=$(this).attr("cms-photo-caption");n=n?n.replace('"',"&quot;").replace("â","&quot;").replace("â","&quot;").replace("â","").replace("â",""):document.title;var r="";var i=$(this).parent(".photo");if(i.length<=0){r="<a class='photo' href='"+t+"' data-desc='"+(!n?"":n)+"' data-index='"+o+"' />";o++}else{i.attr("data-index",o);o++}return r}});$(".cms-body").each(function(){var e=$(this),t=function(){var t=[];e.find("a.photo").each(function(){var e={src:$(this).attr("href"),w:0,h:0,title:$(this).attr("data-desc")};t.push(e)});return t};var r=t();var i=$(".pswp")[0];e.on("click","a.photo",function(e){e.preventDefault();var t=$(this).data("index");var n={index:t,showAnimationDuration:0,hideAnimationDuration:0,tapToClose:true,shareEl:false,captionEl:true};loadPlugin("photoswipe","/photoswipe/photoswipe.min.js",function(){loadPlugin("photoswipe-ui","/photoswipe/photoswipe-ui-default.min.js",function(){var e=new PhotoSwipe(i,PhotoSwipeUI_Default,r,n);e.init()})})})})}function httpGet(r){return new Promise((e,t)=>{const n=new XMLHttpRequest;n.open("GET",r,true);n.withCredentials=true;n.onreadystatechange=()=>{if(n.readyState===XMLHttpRequest.DONE){if(n.status===200){e(n.responseText)}else{t(console.log("unexpected status code or empty body"))}}};n.send()})}function showPlayer(){$(".cms-body video, .cms-body iframe").each(function(){var e=$(this);var t=$(".longform-page").length>0||$(".infographic-page").length>0?760:$("#livestream").length>0?$("#livestream").width():$(".interview-content").length>0?$(".interview-content").width():$(".cms-body").width();if(e[0].tagName==="IFRAME"){if($(this).attr("src").indexOf("youtube.com")>=0||$(this).attr("src").indexOf("facebook.com")>=0){var n=$(".video-page").length>0?580:Math.round(t/5*3);$(this).attr("height",n);$(this).css("text-align","center")}}else{var r=e.find("source");var i=r.length>0?r.attr("src"):e.attr("src");if(!i)return;var o=$(this).attr("data-content-ids");if(typeof zPlayer!=="undefined"){var a=e.attr("poster");if(!a||a.length<=0){a=window.cmsConfig.domainStatic+"/styles/img/tpo_poster.jpg"}var s=$(".video-page").length>0?580:$(".longform-page").length>0?350:Math.round(t/5*3);var l="video/mp4";if(i.indexOf("m3u8")>0){l="video/mpeg"}var u={mimeType:l,source:i,poster:a,height:s,width:"100%",pluginsOptions:{ads:{source:"https://adnetwork.adasiaholdings.com/ac?siteid=123376&pgid=718410&fmtid=43981&ab=1&tgt=&oc=1&out=vast2&ps=1&pb=0&visit=S&vcn=s&vph=[playerHeight]&vpw=[playerWidth]&vpmt=[playbackMethod]&tmstp=[timestamp]",loadTimeout:3e3,startTimeout:5e3,skipTimeout:3e3,poster:true,adLoadFn:function(e,t){return httpGet(e).then(e=>{return[{xml:e}]}).then(e=>{return e.map(e=>{return{position:"pre-roll",startTime:0,skipoffset:"00:00:05",duration:e.duration,server:{tag:e.xml}}})})}}}};var c=new zPlayer.Player(u);var f=document.createElement("div");f.id="player-wrapper-"+Math.floor(Math.random()*100);if(o&&o.length>0){f.setAttribute("data-content-ids",o)}e.after(f);c.attachTo(f);e.remove()}}})}function showGalleries(){if($(".galleria").length<=0){return}loadPlugin("galleria-js",window.cmsConfig.domainStatic+"/js/galleria/galleria.min.js",function(){Galleria.loadTheme(window.cmsConfig.domainStatic+"/js/galleria/themes/classic/galleria.classic.min.js");Galleria.configure({showInfo:true,_toggleInfo:false,showCounter:false,autoplay:4e3});Galleria.run(".galleria",{height:450})})}function showDialog(e,t,n){if(t===null)return;var r=$("#dialog");if(r.length===0){$("body").append($("<div>",{id:"dialog"}));r=$("#dialog");var i="<div>"+'<div class="header"></div>'+'<div class="content"></div>'+'<div class="action"><button class="btnSubmit">Äá»ng Ã½</button><button class="btnCancel">ÄÃ³ng</button></div>'+"</div>";r.html(i)}var o=r.find(".action button.btnSubmit"),a=r.find(".action button.btnCancel");r.find(".header").html(e||"ThÃ´ng bÃ¡o");r.find(".content").html(t);a.text("ÄÃ³ng");if(n){if(n.submit){o.html(n.submit.text||"Äá»ng Ã½");o.on("click",function(){n.submit.action()}).show()}else{o.hide()}if(n.cancel){if(n.cancel.text){a.html(n.cancel.text)}}}a.on("click",function(){if(n&&n.cancel&&n.cancel.action){n.cancel.action()}self.closeDialog()});a.show();r.show()}function closeDialog(){var e=$("#dialog");e.hide();e.find(".header").empty();e.find(".content").empty();e.find(".action button").unbind("click").hide()}function interviewSubmit(){$(".interview-submit").click(function(){var e=$(this).parents(".interviews").attr("data-id");var t=$(".interview-fullname");var n=$(".interview-email");var r=$(".interview-content");var i={iid:e,name:$.trim(t.val()),email:$.trim(n.val()),content:$.trim(r.val())};if(parseInt(e)<=0||i.name===""||i.email===""||i.content===""){alert("Báº¡n chÆ°a nháº­p Äá»§ thÃ´ng tin!")}else{$.ajax({url:"/api/interviews/post/question",method:"POST",cache:false,data:i,success:function(e){alert("Gá»­i cÃ¢u há»i thÃ nh cÃ´ng");$(t,n,r).val("")}})}})}function countWords(e){e=e.replace(/<[^>]*>/g," ");e=e.replace(/\s+/g," ");e=e.replace(/\n /,"\n");e=e.trim();return e.split(" ").length}function removeHash(){var e=window.location.toString();if(e.indexOf("#")>0){window.history.pushState("",document.title,window.location.pathname+window.location.search)}}function trackingImps(){if(typeof logImps=="undefined"){return}$("*[data-tracking]").bind("inview",function(e,t){if(!t)return;var n=$(this).attr("data-tracking");if(!n)return;var r=n.split("|id")[0];n=n.split("|id")[1];var i=n.split("|index")[0];var o=+n.split("|index")[1];if(!r){var a=$(this).parents("div[data-source]");if(a){r=a.attr("data-source");if(o<=0){o=a.find('[data-id="'+i+'"]').index()}}}if(!i||!r)return;logImps(i,r,o);var s=$(this).closest("article, li");var l=s.find("a.cms-link");if(l){l.attr("href",l.attr("href")+"#"+i+"|"+r+"|"+o)}$(this).removeAttr("data-tracking")});var e=window.location.hash.substring(1);if(e){var t=e.split("|");var n=t[0];var r=t[1];var i=t[2];if(!n||!r)return;logImps(n,r,i,"click");removeHash()}}var windowHeight=$(window).height();var windowWidth=$(window).width();function setupNextPage(a){if(a.length===0)return;var e=a.attr("data-page");if(e>300)return;var t=a.attr("data-zone");var n=a.attr("data-type");var r=a.attr("data-phrase");var i=a.attr("data-bydate");var o=a.attr("data-tag");var s=getUrlParameter("stm");var l=getUrlParameter("sz");var u=getUrlParameter("st");var c=getUrlParameter("sm");var f=getUrlParameter("order");var d=parseInt(e)+1;var h="/api/morenews-"+n+"-"+t+"-"+d+".html?phrase="+(typeof r!="undefined"&&r.length>0?r:"")+(typeof o!="undefined"&&o.length>0?"&tag_id="+o:"")+(typeof i!="undefined"&&i.length>0?"&bydate="+i:"")+(typeof s!="undefined"&&s.length>0?"&stm="+s:"")+(typeof l!="undefined"&&l.length>0?"&sz="+l:"")+(typeof u!="undefined"&&u.length>0?"&st="+u:"")+(typeof c!="undefined"&&c.length>0?"&sm="+c:"")+(typeof f!="undefined"&&f.length>0?"&order="+f:"");$.get(h,function(e){if($(e).length>0&&e.data&&e.data.articles){var t=$(".content-list").find(".story").last();if(t.length>0){var n=t.offset();$("html, body").stop().animate({scrollTop:n.top},500)}var r=$("<div>").html(e.data.articles);r.find("article, div").each(function(){if($(".content-list").find('div[data-id="'+$(this).attr("data-id")+'"]').length>0||$(".content-list").find('article[data-id="'+$(this).attr("data-id")+'"]').length>0){$(this).remove()}});$(".content-list").append(r.html());a.attr("data-page",d);if(!e.data.hasMoreContent){a.attr("data-page",301);a.hide()}if(typeof gtag!=="undefined"){gtag("config","G-0Z1MC7SXVQ",{page_path:window.location.pathname})}if(typeof ga!=="undefined"){ga("send","pageview",window.location.pathname)}var i=window.cmsConfig.loggingUrl;if(!i){var o=$("#loggingUrl");if(o&&o.attr("src")){i=o.attr("src")}if(!i){i=getLogUrl()}}if(i){$.getScript(i+"#"+Math.random())}}else{a.attr("data-page",301);a.hide()}})}function recommend(){if($(".recommend-news").length<=0)return;var e="";if($(".video-page").length>0)e="video";else if($(".longform-page").length>0||$(".infographic-page").length>0)e="grid";$.ajax({type:"POST",url:"/api/morenews/post/recommend",data:{content_id:contentId?contentId:0,zone_id:cateId?cateId:0,layout:e},cache:false,beforeSend:function(e){e.withCredentials=true}}).done(function(e){if($(e).length>0&&e.data&&e.data.articles){var t=$("<div>").html(e.data.articles);t.find("a").each(function(){var e=$(this).attr("href");$(this).attr("href",e+"?utm_source=tienphong&utm_medium=cpc&utm_campaign=recommendation")});$(".recommend-news").html(t.html())}})}function doSearch(e){var t={};var n="";if($("#dlTime").length>0){n=$("#dlTime").val();if(n.length>0&&n!=="0"){t["stm"]=n}}var r="";if($("#dlTime").length>0){r=$("#dlZone").val();if(r.length>0&&r!=="0"){t["sz"]=r}}var i="";if($("#dlType").length>0){i=$("#dlType").val();if(i.length>0&&i!=="0"){t["st"]=i}}var o="";if($("#dlMode").length>0){o=$("#dlMode").val();if(o.length>0&&o!=="0"){t["sm"]=o}}var a="";if($("#dlOrder").length>0){a=$("#dlOrder").val();if(a.length>0&&a!==""){t["order"]=a}}var s=jQuery.param(t);var l=window.cmsConfig.domainDesktop+"/search/"+encodeURIComponent(e.replace("/","##"))+".tpo";window.location.href=l+(s.length>0?"?"+s:"");return false}function buildSearch(){if(typeof keyword!=="undefined"&&keyword.length>0)$(".txtsearch2").val(keyword);if($("#search-tools").length>0){var e=getUrlParameter("stm");if(typeof e!=="undefined"&&e.length>0)$("#dlTime").val(e);var t=getUrlParameter("sz");if(typeof t!=="undefined"&&t.length>0)$("#dlZone").val(t);var n=getUrlParameter("st");if(typeof n!=="undefined"&&n.length>0)$("#dlType").val(n);var r=getUrlParameter("sm");if(typeof r!=="undefined"&&r.length>0)$("#dlMode").val(r);var i=getUrlParameter("order");if(typeof i!=="undefined"&&i.length>0)$("#dlOrder").val(i);$("#dlTime,#dlZone,#dlType,#dlMode,#dlOrder").on("change",function(e){doSearch($(".txtsearch2").val())})}$(".btn_search").click(function(e){e.preventDefault();var t=$(".txtsearch").val();if(t===""){return}doSearch(t)});$(".txtsearch").keypress(function(e){if(e.keyCode===13){var t=$(".txtsearch").val();if(t===""){return}doSearch(t)}});$(".btn_search2").click(function(e){e.preventDefault();var t=$(".txtsearch2").val();if(t===""){return}doSearch(t)});$(".txtsearch2").keypress(function(e){if(e.keyCode===13){var t=$(".txtsearch2").val();if(t===""){return}doSearch(t)}})}function buildSlider(){if($(".site-header__trending .wrap").length>0){$(".site-header__trending .wrap").slick({infinite:true,slidesToShow:1,slidesToScroll:1,arrows:false,autoplay:true})}if($(".slider-style-1 .wrap").length>0){$(".slider-style-1 .wrap").slick({infinite:true,variableWidth:true,slidesToShow:1,slidesToScroll:1,arrows:false,dots:true,autoplay:true,autoplaySpeed:6e3})}if($(".slider-style-2 .rank-1 .wrap").length>0){$(".slider-style-2 .rank-1 .wrap").slick({infinite:true,slidesToShow:1,slidesToScroll:1,arrows:false,vertical:true})}if($(".slider-style-2 .rank-2 .wrap").length>0){$(".slider-style-2 .rank-2 .wrap").slick({infinite:true,slidesToShow:4,slidesToScroll:1,vertical:true,arrows:false,focusOnSelect:true,centerMode:true,asNavFor:".slider-style-2 .rank-1 .wrap"})}if($(".slider-style-3 .wrap").length>0){$(".slider-style-3 .wrap").slick({infinite:true,variableWidth:true,slidesToShow:1,slidesToScroll:1,arrows:false,dots:true})}if($(".slider-style-4 .wrap").length>0){$(".slider-style-4 .wrap").slick({infinite:true,slidesToShow:1,slidesToScroll:1,arrows:false,dots:true,appendDots:$(".dots-container-2"),autoplay:true})}if($(".slider-style-5 .wrap").length>0){$(".slider-style-5 .wrap").slick({infinite:true,variableWidth:true,slidesToShow:1,slidesToScroll:1,arrows:false,dots:true,autoplay:true})}if($(".event-page-slider .wrap").length>0){$(".event-page-slider .wrap").each(function(){$(this).slick({infinite:true,variableWidth:true,slidesToShow:4,slidesToScroll:1,arrows:true,dots:false,autoplay:true,prevArrow:$(this).parent().find(".btn-prev"),nextArrow:$(this).parent().find(".btn-next")})})}if($(".event-page-slider-2 .wrap").length>0){$(".event-page-slider-2 .wrap").slick({infinite:true,variableWidth:true,slidesToShow:1,slidesToScroll:1,arrows:true,dots:false,autoplay:true,prevArrow:".event-page-slider-2 .btn-prev",nextArrow:".event-page-slider-2 .btn-next"})}if($(".event-page-multimedia .wrap").length>0){$(".event-page-multimedia .wrap").slick({infinite:true,variableWidth:true,slidesToShow:1,slidesToScroll:1,arrows:true,dots:false,autoplay:true,prevArrow:".event-page-multimedia .btn-prev",nextArrow:".event-page-multimedia .btn-next"})}if($(".slider-epaper .wrap").length>0){$(".slider-epaper .wrap").slick({infinite:true,variableWidth:true,slidesToShow:1,slidesToScroll:1,arrows:true,autoplay:true,prevArrow:".slider-epaper .btn-prev",nextArrow:".slider-epaper .btn-next"})}}function buildShare(){$(".sendmail").attr("href","mailto:email@domain.com?subject="+window.encodeURIComponent(document.title)+"&body="+window.encodeURIComponent(window.location.toString()));$(".article__share .social").click(function(e){e.preventDefault();var t="";var n=$(this).attr("data-href");switch($(this).attr("rel")){case"facebook":t="https://www.facebook.com/sharer.php?u="+(n.length>0?n:window.location.href)+"&p[title]="+getTitle(document.title);break;case"twitter":t="https://twitter.com/share?url="+(n.length>0?n:window.location.href)+"&title="+getTitle(document.title);break;case"gplus":t="https://plus.google.com/share?url="+(n.length>0?n:window.location.href);break}if(t==="")return false;window.open(t,"","_blank,resizable=yes,width=800,height=450");return false});$(".sendprint").click(function(e){e.preventDefault();window.open("/print.tpo","_blank","height=500,width=800,status=yes,location=no,menubar=no,resizable=yes,scrollbars=yes,titlebar=yes,top=50,left=100",true)})}function buildSticky(){$(window).scroll(function(){if($(this).scrollTop()>$(".site-header").height()){$(".navigation").addClass("sticky-top")}else{$(".navigation").removeClass("sticky-top")}});$(window).scroll(function(){if($(this).scrollTop()>500){$(".verticle-menu").addClass("sticky-aside")}else{$(".verticle-menu").removeClass("sticky-aside")}});if($("#sidebar-sticky-1").length>0){stickyBox(".content-col",".sidebar-col","#sidebar-top-1","#sidebar-sticky-1",55)}if($("#sidebar-sticky-2").length>0){if($(".middle-col").length>0){stickyBox(".article-content",".middle-col","#sidebar-top-2","#sidebar-sticky-2",55)}else{stickyBox(".content-col",".sidebar-col","#sidebar-top-2","#sidebar-sticky-2",55)}}if($("#livetimeline").length>0&&$("#livestream").length>0){stickyBox("#livestream",".timeline-index-wrap","#livetimeline-top","#livetimeline",55)}if($("#interview-form").length>0&&$(".interview-zone").length>0){stickyBox(".interview-content",".interview-intro","#interview-form-top","#interview-form",55)}}if($(".article__most-read").length>0){$(".article__most-read").hide()}function scrollToCurentDateElm(){var e=$(".accordion-title[data-current=1]");if(e.length>0){$(".accordion-container").animate({scrollTop:e.offset().top},"slow")}}function displayTime(){if($("#fulltime").length<=0)return;var e=new Date;$("#fulltime").html(getWeekDay(e.getDay())+", "+getNumberStr(e.getDate())+"/"+getNumberStr(e.getMonth()+1)+"/"+e.getFullYear()+", "+getNumberStr(e.getHours())+":"+getNumberStr(e.getMinutes())+":"+getNumberStr(e.getSeconds())+" GMT+7")}function buildFloatingAds(){if($(".floating-ads").length<=0||$("#photo360-container").length>0){return}if(windowWidth<1280){$(".floating-ads").remove();return}$(".floating-ads").removeClass("hidden");var e=$(".site-body .container").offset().left-10;$("#floating-right").css("left",windowWidth-e);$("#floating-left").css("right",windowWidth-e);setTimeout(function(){var e=$(".site-header").length>0?$(".site-header").height():0;var i=$(".navigation-wrap").length>0?$(".navigation-wrap").height():0;var o=e+i+10;$(".floating-ads").css("top",o);if($(".floating-ads").height()<$(".site-body").height()+10){$(window).scroll(function(){var e=$(window).scrollTop();if(e>o){var t=$(".navigation-wrap .navigation");var n=e-$(".navigation-wrap").offset().top-$(".navigation-wrap").height();if(t.length>0&&t.hasClass("sticky-top")){$(".floating-ads").css("position","fixed");$(".floating-ads").css("top",i+10)}else{$(".floating-ads").css("position","absolute");$(".floating-ads").css("top",o)}var r=e-$(".site-footer").offset().top-$(".site-footer").height()+$(".floating-ads").height();if(r>0)$(".floating-ads").css("top",-1*r);else $(".floating-ads").css("top",i+10)}else{$(".floating-ads").css("top",o)}})}},1e3)}function genToken(t){$.ajax({url:"/api/tools/post/token?event_name=Seagames32&event_key=Leaderboard",type:"POST",success:function(e){console.log("msg.data",e.data);if(e.data&&t&&typeof t==="function"){t(e.data)}}})}$(document).ready(function(){displayTime();buildSearch();buildSticky();buildShare();buildSlider();buildFloatingAds();$("#go-top").click(function(){$("body,html").animate({scrollTop:0},800);return false});$(document).scroll(function(){var e=$(document).scrollTop();if(e>0)$("#go-top").fadeIn();else $("#go-top").fadeOut()});$(".ads-menu .box-content a").click(function(e){e.preventDefault();$(".ads-menu .box-content a").removeClass("is-active");$(this).addClass("is-active");var t=$(this).attr("data-target");$(".ads-preview .ads-content").not(t).css("display","none");$("#"+t).show()});$(".ads-menu .fa-chevron-down").on("click",function(e){e.stopPropagation();$(this).toggleClass("open");var t=$(this).closest("li");t.find(".sub-menu").slideToggle()});if($("#wrapper-photo360").length>0){$(".detail-page").after($("#wrapper-photo360").html());$("#wrapper-photo360").show()}if($(".zone-highlight-video[data-url]").length>0){var e=$(".zone-highlight-video[data-url]").attr("data-url");if(e&&e.length>0){if(typeof gtag!=="undefined"){gtag("config","G-0Z1MC7SXVQ",{page_path:e})}$.getScript(getLogUrl(e)+"#"+Math.random())}}if($("#sea-games-medal").length>0){function r(){var e=$(".nav-tab-sea-games-31 .tab-pane .item[data-current=1]");if(e.length>0){$(".nav-tab-sea-games-31 .tab-pane").animate({scrollTop:e.offset().top-20},"slow")}}genToken(function(e){if(!e)return;$.ajax({url:"https://service-cms.epi.vn/api/v1/utility/event/get/data?event_name=Seagames32&event_key=Leaderboard&secure_code="+e,type:"GET",xhrFields:{withCredentials:true},success:function(e){if(e.error_code<0||!e.data){return}$("#sea-games-medal").html("");$("#sea-games-medal").append('<h3 class="box-heading"><span class="title">Báº£ng tá»ng sáº¯p huy chÆ°Æ¡ng</span></h3>');$("#sea-games-medal").append('<div class="box-content" id="sea-games-medal-content"><div class="item-head"><span>#</span><span>Quá»c gia</span><span class="gold">VÃ ng</span><span class="silver">Báº¡c</span><span class="copper">Äá»ng</span><span class="all">Tá»ng</span></div>');var t=e.data.items;for(var n=0;n<t.length;n++){var r=t[n];$("#sea-games-medal").find("#sea-games-medal-content").append('<div class="item"> <span>'+(n+1)+'</span><span> <img src="'+r.Icon+'" alt=""> '+r.Name+'</span><span class="gold">'+r.Gold+'</span><span class="silver">'+r.Silver+'</span><span class="copper">'+r.Bronze+'</span><span class="all">'+(r.Gold+r.Silver+r.Bronze)+"</span></div>")}$("#sea-games-medal").append("</div>")}})});r();$(".nav-tab-sea-games-31 .nav-tab__link a").click(function(e){e.preventDefault();const t=$(e.target);const n=t.attr("data-link");$(".nav-tab-sea-games-31 .nav-tab__link a").removeClass("active");$(this).addClass("active");$(".nav-tab-sea-games-31 .nav-tab__content").find(".tab-pane").removeClass("active");$(".nav-tab-sea-games-31 .nav-tab__content ."+n).addClass("active");r()})}if($("#so-bao-danh").length>0){$("#so-bao-danh").keypress(function(e){if(e.which===13){e.preventDefault();var t=$("#so-bao-danh").val();if(t===""){window.alert("Má»i báº¡n nháº­p Sá» bÃ¡o danh Äá» tra cá»©u.");return}window.location.href=window.cmsConfig.domainDesktop+"/tra-cuu-diem-thi.tpo?sbd="+encodeURIComponent(t)}});$(".btn_diemthi").click(function(e){e.preventDefault();var t=$("#so-bao-danh").val();if(t===""){window.alert("Má»i báº¡n nháº­p Sá» bÃ¡o danh Äá» tra cá»©u.");return}window.location.href=window.cmsConfig.domainDesktop+"/tra-cuu-diem-thi.tpo?sbd="+encodeURIComponent(t)})}if($(".box-soccer").length>0){r();var t=$(".box-soccer .nav a");var n=$(".box-soccer .nav-tab ");t.click(function(e){e.preventDefault();t.removeClass("active");$(this).addClass("active");n.find(".tab-pane").removeClass("active");$(".box-soccer .nav-tab ."+$(this).attr("data-link")).addClass("active");r()});$(".js-accordion-title").on("click",function(){$(this).next().slideToggle(200);$(this).toggleClass("open",200)})}$(".control__loadmore").click(function(e){setupNextPage($(this))});if($(".longform-page").length>0){$(".article__body div .full-media,.article__body div .half-media,.article__body div .aside-media,.article__body div .quotes").each(function(){if($(this).parent().is("div")&&$(this).parent().hasClass("")){$(this).unwrap()}});$(".article__body .picture:not(.full-width)").each(function(){var e=$(this).attr("align");var t=$(this).attr("class");var n=$(this).find("img");var r=n.attr("data-src");if(n&&r&&r.length>0){if(e&&(e=="right"||e=="left")){n.attr("data-src",r.replace("/w1966/","/w500/").replace("/w2000/","/w500/"));n.attr("src",r.replace("/w1966/","/w500/").replace("/w2000/","/w500/"))}else if(t&&t.indexOf("max-width")>-1){n.attr("data-src",r.replace("/w1966/","/w1200/").replace("/w2000/","/w1200/"));n.attr("src",r.replace("/w1966/","/w1200/").replace("/w2000/","/w1200/"))}}})}if($(".article__body").length>0){if($("div[data-position='Web_AdsArticlePRAfterAvatar']").length>0&&$(".ads_middle").length>0){$(".ads_middle").after($("div[data-position='Web_AdsArticlePRAfterAvatar']"));$("div[data-position='Web_AdsArticlePRAfterAvatar']").removeClass("hidden")}if($("#livetimeline").length>0){$("#livetimeline").html("");$("#livestream > div.hastitle").each(function(){$("#livetimeline").append('<a class="item" href="#'+$(this).attr("id")+'"><time>'+$(this).find(".cms-live-time").html()+"</time><p>"+$(this).find(".blockcap strong").html()+"</p></a>")});$("#livetimeline > a").click(function(e){e.preventDefault();$("html, body").animate({scrollTop:$($(this).attr("href")).offset().top-30},"slow")})}if($(".article__most-read").length>0){var i=countWords($(".article__body").text());if(i>200){console.log("wordcount:"+i);$(".article__most-read").show()}}$('.article__body [style*="font-size"]').css("font-size","");$(".article__body font[size]").removeAttr("size");if($(".copy-link").length>0){var o=$("<input>");var a=$(location).attr("href");$(".copy-link").on("click",function(){$("body").append(o);o.val(a).select();document.execCommand("copy");o.remove()})}interviewSubmit();photoSwipe();photoCompare();showGalleries();showPlayer();recommend();buildJustifiedGallery()}if(typeof getLogUrl!="undefined"){$("*[data-content-ids]").bind("inview",function(e,t){var n=$(this).attr("data-content-ids");if(t&&n&&n.length>0){var r=n.split(",");for(var i=0;i<r.length;i++){var o="/video-post"+r[i]+".tpo";gtag("config","G-0Z1MC7SXVQ",{page_path:o});var a=getLogUrl(o);$.getScript(a+"#"+Math.random())}}$(this).removeAttr("data-content-ids")})}});if($(".world-cup").length>0){const $navTabLink1=$(".nav-tab .nav-tab__link a");const $navTabContent1=$(".nav-tab .nav-tab__content ");$(".nav-tab .nav-tab__link a").click(function(e){e.preventDefault();const t=$(e.target);const n=t.attr("data-link");$navTabLink1.removeClass("active");t.addClass("active");$navTabContent1.find(".tab-pane").removeClass("active");$(".nav-tab .nav-tab__content ."+n).addClass("active")});$(".world-cup .menu1 .wrap").slick({infinite:true,variableWidth:true,slidesToShow:1,slidesToScroll:1,arrows:true,dots:false,autoplay:false});$(".world-cup .menu2 .wrap").slick({infinite:true,variableWidth:true,slidesToShow:1,slidesToScroll:1,arrows:true,dots:false,autoplay:false})}$('.article__body *[data-display="mobile"]').remove();(function(){var s="ePi.log.ads";var e;function t(){var e=document.cookie.split(";");for(var t=0;t<e.length;t++){var n=e[t];var r=n.indexOf("=");var i=r>-1?n.substr(0,r):n;if(i.toLowerCase()==s.toLowerCase()||i.toLowerCase().indexOf("epi")!=1){continue}document.cookie=i+"=;expires=Thu, 01 Jan 1970 00:00:00 GMT"}}t();function l(e){var t=new RegExp("(?:^|; )"+encodeURIComponent(e)+"=([^;]*)");var n=t.exec(document.cookie);return n?n[1]:null}function u(e,t){var n=new Date;n.setTime(n.getTime()+365*24*60*60*1e3);var r="; expires="+n.toGMTString();document.cookie=e+"="+t+r+"; path=/"}function o(t,n){try{var r=JSON.parse(l(s));var i=Math.round((new Date).getTime()/1e3/60);var o=false;var e=-1;if(r!==null&&r.length>0){var a=0;while(a<r.length){if(r[a].a===t+"_"+n){if(i-r[a].d>=5){o=true}e=a;break}a++}}else{r=new Array;o=true}if(e===-1){r.push({a:t+"_"+n,d:i});o=true}else{r[e].d=i}}catch(e){r=new Array;r.push({a:t+"_"+n,d:i});o=true}u(s,JSON.stringify(r));return o}$('[class*="banner_"]').hover(function(){if($(this).find("iframe").length>0){e=this}},function(){e=null});$(window).blur(function(){if(e){n($(e))}});$("body").on("click",'[class*="banner_"]',function(){n($(this))});function n(e){var t=parseInt(e.attr("rel"));var n=e.attr("tag");if(!o(t,n)){return}if(!isNaN(t)){var r=base64.encode('{"platform":1, "id":'+t+"}");var i=window.cmsConfig.domainLog+"/ads?data="+r;$.getScript(i);if(typeof window.gtag!=="undefined"){window.gtag("event","click",{event_category:"adsbanner",event_label:n})}if(typeof window.ga!=="undefined"){window.ga("send","event","adsbanner","click",n)}}}})();(function(){var s="ePi.log.vote";var t="/api/votes/get/stats";var r="/api/votes/post/vote";$(".voteresult").on("click",function(){var e=$(this).data("voteid");$.get(t,{vote_id:e},function(e){n(e)})});$(".votebutton").on("click",function(){var e=$(this).data("voteid");var t=$(this).parents(".poll-box").find("input:checked");if(t.length===0){alert("Báº¡n chÆ°a chá»n má»¥c nÃ o.");return}var n=t.parent().data("optionid");if(!i(e,n)){$.post(r,{vote_id:e,option_id:n});alert("Cáº£m Æ¡n báº¡n ÄÃ£ bÃ¬nh chá»n!")}});function n(e){if(e.data){var t=e.data.stats;if(t){showDialog("Káº¿t quáº£ bÃ¬nh chá»n",t,{cancel:{action:function(){closeDialog()}}})}}}function l(e){var t=new RegExp("(?:^|; )"+encodeURIComponent(e)+"=([^;]*)");var n=t.exec(document.cookie);return n?n[1]:null}function u(e,t){var n=new Date;n.setTime(n.getTime()+7*24*60*60*1e3);var r="; expires="+n.toGMTString();document.cookie=e+"="+t+r+"; path=/"}function i(t,n){try{var r=JSON.parse(l(s));var i=Math.round((new Date).getTime()/1e3/60);var o=false;var e=-1;if(r!==null&&r.length>0){var a=0;while(a<r.length){if(r[a].voteId===t){if(i-r[a].date>=7*24*60){o=true}e=a;break}a++}}else{r=new Array;o=true}if(e===-1){r.push({voteId:t,optionId:n,date:i});o=true}else{r[e].date=i}}catch(e){r=new Array;r.push({voteId:t,optionId:n,date:i});o=true}u(s,JSON.stringify(r));return o?0:r[e].optionId}})();var createCSS=function(e){var t=document.createElement("style");t.type="text/css";parent.document.querySelector("head").appendChild(t);t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))};setTimeout(function(){var s=document.querySelector(".site-header");var l=document.querySelector(".site-body");var u=document.querySelector("#bg-img");var c=document.querySelector("#bg-href");if(u){var f=0;createCSS(".floating-ads { display: none; } .bg-banner{display: block; height: 210px; overflow: hidden} .bg-wrapper{width:100%; height:100vh; margin-top: -10px} #bg-href { z-index: 0; display: block; width: 100vw; height: calc(100vh); min-height: 300px; position: fixed; left: 50%; transform: translateX(-50%); margin-top: 10px; } #bg-img{z-index: -1; width: 100%; height: calc(100vh + 220px); min-height: 300px; position: absolute; left: 50%; transform: translateX(-50%); transition: all .1s ease-out; background-position: top center; background-repeat: no-repeat;} .site-body{padding-top: 10px !important;}.site-body>.container,.site-footer>.container{position: relative;background-color:#fff} .site-body>.container{width: 1296px!important;max-width: 1296px!important; padding: 10px;} .site-footer>.container{padding-left:10px; padding-right:10px}.site-body>.banner.qc{ position: relative; } [data-position=Web_AdsTop]{margin-top:0}.ads_background .video-page{ background-color: transparent; }.ads_background .video-page .site-body>.container, .ads_background .video-page .site-footer>.container{background-color: #495057}");document.querySelector("body").classList.add("ads_background");u.style.backgroundImage="url("+u.dataset.src+")";u.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==";document.addEventListener("scroll",function(e){var t=window.scrollY;var n=s.offsetHeight;var r=n-document.querySelector(".header__topbanner").offsetHeight-document.querySelector(".navigation-wrap").offsetHeight;if(r>f)f=r;var i=document.body,o=document.documentElement;var a=Math.max(i.scrollHeight,i.offsetHeight,o.clientHeight,o.scrollHeight,o.offsetHeight);if(t<n){c.style.top=n-t+"px"}else{c.style.top=0}if(t>a-window.innerHeight-170){u.style.position="fixed";u.style.bottom=0}else if(t>250+l.offsetTop+f){l.style.paddingTop="10px !important";u.style.position="fixed";u.style.bottom="-50px"}else{l.style.paddingTop="10px !important";u.style.position="absolute";u.style.bottom=null}})}},10);